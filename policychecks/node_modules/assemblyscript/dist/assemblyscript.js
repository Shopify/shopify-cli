/**
 * @license
 * The AssemblyScript Compiler.
 * Copyright Daniel Wirtz / The AssemblyScript Authors.
 * SPDX-License-Identifier: Apache-2.0
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("binaryen")):"function"==typeof define&&define.amd?define(["binaryen"],t):"object"==typeof exports?exports.assemblyscript=t(require("binaryen")):e.assemblyscript=t(e.binaryen)}("undefined"!=typeof self?self:this,(function(e){return(()=>{var t={720:e=>{e.exports=r;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function i(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var n={},s={};function a(e,t){var r,i,a;return t?(a=0<=(e>>>=0)&&e<256)&&(i=s[e])?i:(r=l(e,(0|e)<0?-1:0,!0),a&&(s[e]=r),r):(a=-128<=(e|=0)&&e<128)&&(i=n[e])?i:(r=l(e,e<0?-1:0,!1),a&&(n[e]=r),r)}function o(e,t){if(isNaN(e))return t?T:y;if(t){if(e<0)return T;if(e>=h)return x}else{if(e<=-d)return I;if(e+1>=d)return b}return e<0?o(-e,t).neg():l(e%_|0,e/_|0,t)}function l(e,t,i){return new r(e,t,i)}r.fromInt=a,r.fromNumber=o,r.fromBits=l;var u=Math.pow;function c(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return c(e.substring(1),t,r).neg();for(var n=o(u(r,8)),s=y,a=0;a<e.length;a+=8){var l=Math.min(8,e.length-a),p=parseInt(e.substring(a,a+l),r);if(l<8){var _=o(u(r,l));s=s.mul(_).add(o(p))}else s=(s=s.mul(n)).add(o(p))}return s.unsigned=t,s}function p(e,t){return"number"==typeof e?o(e,t):"string"==typeof e?c(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=c,r.fromValue=p;var _=4294967296,h=_*_,d=h/2,m=a(1<<24),y=a(0);r.ZERO=y;var T=a(0,!0);r.UZERO=T;var g=a(1);r.ONE=g;var f=a(1,!0);r.UONE=f;var E=a(-1);r.NEG_ONE=E;var b=l(-1,2147483647,!1);r.MAX_VALUE=b;var x=l(-1,-1,!0);r.MAX_UNSIGNED_VALUE=x;var I=l(0,-2147483648,!1);r.MIN_VALUE=I;var A=r.prototype;A.toInt=function(){return this.unsigned?this.low>>>0:this.low},A.toNumber=function(){return this.unsigned?(this.high>>>0)*_+(this.low>>>0):this.high*_+(this.low>>>0)},A.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(I)){var t=o(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var n=o(u(e,6),this.unsigned),s=this,a="";;){var l=s.div(n),c=(s.sub(l.mul(n)).toInt()>>>0).toString(e);if((s=l).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},A.getHighBits=function(){return this.high},A.getHighBitsUnsigned=function(){return this.high>>>0},A.getLowBits=function(){return this.low},A.getLowBitsUnsigned=function(){return this.low>>>0},A.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},A.isZero=function(){return 0===this.high&&0===this.low},A.eqz=A.isZero,A.isNegative=function(){return!this.unsigned&&this.high<0},A.isPositive=function(){return this.unsigned||this.high>=0},A.isOdd=function(){return 1==(1&this.low)},A.isEven=function(){return 0==(1&this.low)},A.equals=function(e){return i(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},A.eq=A.equals,A.notEquals=function(e){return!this.eq(e)},A.neq=A.notEquals,A.ne=A.notEquals,A.lessThan=function(e){return this.comp(e)<0},A.lt=A.lessThan,A.lessThanOrEqual=function(e){return this.comp(e)<=0},A.lte=A.lessThanOrEqual,A.le=A.lessThanOrEqual,A.greaterThan=function(e){return this.comp(e)>0},A.gt=A.greaterThan,A.greaterThanOrEqual=function(e){return this.comp(e)>=0},A.gte=A.greaterThanOrEqual,A.ge=A.greaterThanOrEqual,A.compare=function(e){if(i(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},A.comp=A.compare,A.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(g)},A.neg=A.negate,A.add=function(e){i(e)||(e=p(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,s=65535&this.low,a=e.high>>>16,o=65535&e.high,u=e.low>>>16,c=0,_=0,h=0,d=0;return h+=(d+=s+(65535&e.low))>>>16,_+=(h+=n+u)>>>16,c+=(_+=r+o)>>>16,c+=t+a,l((h&=65535)<<16|(d&=65535),(c&=65535)<<16|(_&=65535),this.unsigned)},A.subtract=function(e){return i(e)||(e=p(e)),this.add(e.neg())},A.sub=A.subtract,A.multiply=function(e){if(this.isZero())return y;if(i(e)||(e=p(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(I))return e.isOdd()?I:y;if(e.eq(I))return this.isOdd()?I:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return o(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,n=65535&this.high,s=this.low>>>16,a=65535&this.low,u=e.high>>>16,c=65535&e.high,_=e.low>>>16,h=65535&e.low,d=0,T=0,g=0,f=0;return g+=(f+=a*h)>>>16,T+=(g+=s*h)>>>16,g&=65535,T+=(g+=a*_)>>>16,d+=(T+=n*h)>>>16,T&=65535,d+=(T+=s*_)>>>16,T&=65535,d+=(T+=a*c)>>>16,d+=r*h+n*_+s*c+a*u,l((g&=65535)<<16|(f&=65535),(d&=65535)<<16|(T&=65535),this.unsigned)},A.mul=A.multiply,A.divide=function(e){if(i(e)||(e=p(e)),e.isZero())throw Error("division by zero");var r,n,s;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?T:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return T;if(e.gt(this.shru(1)))return f;s=T}else{if(this.eq(I))return e.eq(g)||e.eq(E)?I:e.eq(I)?g:(r=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?g:E:(n=this.sub(e.mul(r)),s=r.add(n.div(e)));if(e.eq(I))return this.unsigned?T:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=y}for(n=this;n.gte(e);){r=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),c=a<=48?1:u(2,a-48),_=o(r),h=_.mul(e);h.isNegative()||h.gt(n);)h=(_=o(r-=c,this.unsigned)).mul(e);_.isZero()&&(_=g),s=s.add(_),n=n.sub(h)}return s},A.div=A.divide,A.modulo=function(e){return i(e)||(e=p(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},A.mod=A.modulo,A.rem=A.modulo,A.not=function(){return l(~this.low,~this.high,this.unsigned)},A.and=function(e){return i(e)||(e=p(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},A.or=function(e){return i(e)||(e=p(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},A.xor=function(e){return i(e)||(e=p(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},A.shiftLeft=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},A.shl=A.shiftLeft,A.shiftRight=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},A.shr=A.shiftRight,A.shiftRightUnsigned=function(e){if(i(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},A.shru=A.shiftRightUnsigned,A.shr_u=A.shiftRightUnsigned,A.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},A.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},A.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},A.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},A.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,i){return i?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},60:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SourceKind=t.Statement=t.CompiledExpression=t.UnaryPrefixExpression=t.UnaryPostfixExpression=t.UnaryExpression=t.FalseExpression=t.TrueExpression=t.ThisExpression=t.TemplateLiteralExpression=t.SuperExpression=t.StringLiteralExpression=t.TernaryExpression=t.RegexpLiteralExpression=t.PropertyAccessExpression=t.ParenthesizedExpression=t.OmittedExpression=t.ObjectLiteralExpression=t.NullExpression=t.NewExpression=t.IntegerLiteralExpression=t.InstanceOfExpression=t.FunctionExpression=t.FloatLiteralExpression=t.ElementAccessExpression=t.ConstructorExpression=t.CommaExpression=t.ClassExpression=t.CallExpression=t.BinaryExpression=t.AssertionExpression=t.AssertionKind=t.ArrayLiteralExpression=t.LiteralExpression=t.LiteralKind=t.IdentifierExpression=t.Expression=t.CommentNode=t.CommentKind=t.DecoratorNode=t.DecoratorKind=t.ParameterNode=t.ParameterKind=t.TypeParameterNode=t.FunctionTypeNode=t.NamedTypeNode=t.TypeName=t.TypeNode=t.Node=t.NodeKind=void 0,t.isTypeOmitted=t.mangleInternalPath=t.findDecorator=t.WhileStatement=t.VoidStatement=t.VariableStatement=t.VariableDeclaration=t.TypeDeclaration=t.TryStatement=t.ThrowStatement=t.SwitchStatement=t.SwitchCase=t.ReturnStatement=t.NamespaceDeclaration=t.MethodDeclaration=t.InterfaceDeclaration=t.ImportStatement=t.ImportDeclaration=t.IfStatement=t.FunctionDeclaration=t.ArrowKind=t.ForOfStatement=t.ForStatement=t.FieldDeclaration=t.ExpressionStatement=t.ExportDefaultStatement=t.ExportStatement=t.ExportMember=t.ExportImportStatement=t.EnumValueDeclaration=t.EnumDeclaration=t.EmptyStatement=t.DoStatement=t.ContinueStatement=t.ClassDeclaration=t.BreakStatement=t.BlockStatement=t.VariableLikeDeclarationStatement=t.IndexSignatureNode=t.DeclarationStatement=t.Source=void 0;const i=r(200),n=r(411),s=r(910);var a,o,l,u;!function(e){e[e.SOURCE=0]="SOURCE",e[e.NAMEDTYPE=1]="NAMEDTYPE",e[e.FUNCTIONTYPE=2]="FUNCTIONTYPE",e[e.TYPENAME=3]="TYPENAME",e[e.TYPEPARAMETER=4]="TYPEPARAMETER",e[e.PARAMETER=5]="PARAMETER",e[e.IDENTIFIER=6]="IDENTIFIER",e[e.ASSERTION=7]="ASSERTION",e[e.BINARY=8]="BINARY",e[e.CALL=9]="CALL",e[e.CLASS=10]="CLASS",e[e.COMMA=11]="COMMA",e[e.ELEMENTACCESS=12]="ELEMENTACCESS",e[e.FALSE=13]="FALSE",e[e.FUNCTION=14]="FUNCTION",e[e.INSTANCEOF=15]="INSTANCEOF",e[e.LITERAL=16]="LITERAL",e[e.NEW=17]="NEW",e[e.NULL=18]="NULL",e[e.OMITTED=19]="OMITTED",e[e.PARENTHESIZED=20]="PARENTHESIZED",e[e.PROPERTYACCESS=21]="PROPERTYACCESS",e[e.TERNARY=22]="TERNARY",e[e.SUPER=23]="SUPER",e[e.THIS=24]="THIS",e[e.TRUE=25]="TRUE",e[e.CONSTRUCTOR=26]="CONSTRUCTOR",e[e.UNARYPOSTFIX=27]="UNARYPOSTFIX",e[e.UNARYPREFIX=28]="UNARYPREFIX",e[e.COMPILED=29]="COMPILED",e[e.BLOCK=30]="BLOCK",e[e.BREAK=31]="BREAK",e[e.CONTINUE=32]="CONTINUE",e[e.DO=33]="DO",e[e.EMPTY=34]="EMPTY",e[e.EXPORT=35]="EXPORT",e[e.EXPORTDEFAULT=36]="EXPORTDEFAULT",e[e.EXPORTIMPORT=37]="EXPORTIMPORT",e[e.EXPRESSION=38]="EXPRESSION",e[e.FOR=39]="FOR",e[e.FOROF=40]="FOROF",e[e.IF=41]="IF",e[e.IMPORT=42]="IMPORT",e[e.RETURN=43]="RETURN",e[e.SWITCH=44]="SWITCH",e[e.THROW=45]="THROW",e[e.TRY=46]="TRY",e[e.VARIABLE=47]="VARIABLE",e[e.VOID=48]="VOID",e[e.WHILE=49]="WHILE",e[e.CLASSDECLARATION=50]="CLASSDECLARATION",e[e.ENUMDECLARATION=51]="ENUMDECLARATION",e[e.ENUMVALUEDECLARATION=52]="ENUMVALUEDECLARATION",e[e.FIELDDECLARATION=53]="FIELDDECLARATION",e[e.FUNCTIONDECLARATION=54]="FUNCTIONDECLARATION",e[e.IMPORTDECLARATION=55]="IMPORTDECLARATION",e[e.INTERFACEDECLARATION=56]="INTERFACEDECLARATION",e[e.METHODDECLARATION=57]="METHODDECLARATION",e[e.NAMESPACEDECLARATION=58]="NAMESPACEDECLARATION",e[e.TYPEDECLARATION=59]="TYPEDECLARATION",e[e.VARIABLEDECLARATION=60]="VARIABLEDECLARATION",e[e.DECORATOR=61]="DECORATOR",e[e.EXPORTMEMBER=62]="EXPORTMEMBER",e[e.SWITCHCASE=63]="SWITCHCASE",e[e.INDEXSIGNATURE=64]="INDEXSIGNATURE",e[e.COMMENT=65]="COMMENT"}(a=t.NodeKind||(t.NodeKind={}));class c{constructor(e,t){this.kind=e,this.range=t}static createSimpleTypeName(e,t){return new _(c.createIdentifierExpression(e,t),null,t)}static createNamedType(e,t,r,i){return new h(e,t,r,i)}static createFunctionType(e,t,r,i,n){return new d(e,t,r,i,n)}static createOmittedType(e){return new h(c.createSimpleTypeName("",e),null,!1,e)}static createTypeParameter(e,t,r,i){return new m(e,t,r,i)}static createParameter(e,t,r,i,n){return new y(e,t,r,i,n)}static createDecorator(e,t,r){return new T(o.fromNode(e),e,t,r)}static createComment(e,t,r){return new g(e,t,r)}static createIdentifierExpression(e,t,r=!1){return new E(e,r,t)}static createEmptyIdentifierExpression(e){return new E("",!1,e)}static createArrayLiteralExpression(e,t){return new x(e,t)}static createAssertionExpression(e,t,r,i){return new I(e,t,r,i)}static createBinaryExpression(e,t,r,i){return new A(e,t,r,i)}static createCallExpression(e,t,r,i){return new N(e,t,r,i)}static createClassExpression(e){return new S(e)}static createCommaExpression(e,t){return new v(e,t)}static createConstructorExpression(e){return new C(e)}static createElementAccessExpression(e,t,r){return new O(e,t,r)}static createFalseExpression(e){return new X(e)}static createFloatLiteralExpression(e,t){return new R(e,t)}static createFunctionExpression(e){return new k(e)}static createInstanceOfExpression(e,t,r){return new L(e,t,r)}static createIntegerLiteralExpression(e,t){return new F(e,t)}static createNewExpression(e,t,r,i){return new D(e,t,r,i)}static createNullExpression(e){return new P(e)}static createObjectLiteralExpression(e,t,r){return new w(e,t,r)}static createOmittedExpression(e){return new B(e)}static createParenthesizedExpression(e,t){return new U(e,t)}static createPropertyAccessExpression(e,t,r){return new M(e,t,r)}static createRegexpLiteralExpression(e,t,r){return new G(e,t,r)}static createTernaryExpression(e,t,r,i){return new K(e,t,r,i)}static createStringLiteralExpression(e,t){return new V(e,t)}static createSuperExpression(e){return new z(e)}static createTemplateLiteralExpression(e,t,r,i,n){return new W(e,t,r,i,n)}static createThisExpression(e){return new Y(e)}static createTrueExpression(e){return new H(e)}static createUnaryPostfixExpression(e,t,r){return new Q(e,t,r)}static createUnaryPrefixExpression(e,t,r){return new j(e,t,r)}static createCompiledExpression(e,t,r){return new Z(e,t,r)}static createBlockStatement(e,t){return new re(e,t)}static createBreakStatement(e,t){return new ie(e,t)}static createClassDeclaration(e,t,r,i,n,s,a,o){return new ne(e,t,r,i,n,s,a,o)}static createContinueStatement(e,t){return new se(e,t)}static createDoStatement(e,t,r){return new ae(e,t,r)}static createEmptyStatement(e){return new oe(e)}static createEnumDeclaration(e,t,r,i,n){return new le(e,t,r,i,n)}static createEnumValueDeclaration(e,t,r,i){return new ue(e,t,r,i)}static createExportStatement(e,t,r,i){return new _e(e,t,r,i)}static createExportDefaultStatement(e,t){return new he(e,t)}static createExportImportStatement(e,t,r){return new ce(e,t,r)}static createExportMember(e,t,r){return t||(t=e),new pe(e,t,r)}static createExpressionStatement(e){return new de(e)}static createIfStatement(e,t,r,i){return new fe(e,t,r,i)}static createImportStatement(e,t,r){return new be(e,null,t,r)}static createWildcardImportStatement(e,t,r){return new be(null,e,t,r)}static createImportDeclaration(e,t,r){return t||(t=e),new Ee(t,e,r)}static createInterfaceDeclaration(e,t,r,i,n,s,a,o){return new xe(e,t,r,i,n,s,a,o)}static createFieldDeclaration(e,t,r,i,n,s){return new me(e,t,r,i,n,-1,s)}static createForStatement(e,t,r,i,n){return new ye(e,t,r,i,n)}static createForOfStatement(e,t,r,i){return new Te(e,t,r,i)}static createFunctionDeclaration(e,t,r,i,n,s,a,o){return new ge(e,t,r,i,n,s,a,o)}static createIndexSignature(e,t,r,i){return new ee(e,t,r,i)}static createMethodDeclaration(e,t,r,i,n,s,a){return new Ie(e,t,r,i,n,s,a)}static createNamespaceDeclaration(e,t,r,i,n){return new Ae(e,t,r,i,n)}static createReturnStatement(e,t){return new Ne(e,t)}static createSwitchStatement(e,t,r){return new ve(e,t,r)}static createSwitchCase(e,t,r){return new Se(e,t,r)}static createThrowStatement(e,t){return new Ce(e,t)}static createTryStatement(e,t,r,i,n){return new Oe(e,t,r,i,n)}static createTypeDeclaration(e,t,r,i,n,s){return new Re(e,t,r,i,n,s)}static createVariableStatement(e,t,r){return new Le(e,t,r)}static createVariableDeclaration(e,t,r,i,n,s){return new ke(e,t,r,i,n,s)}static createVoidStatement(e,t){return new Fe(e,t)}static createWhileStatement(e,t,r){return new De(e,t,r)}isLiteralKind(e){return this.kind==a.LITERAL&&changetype(this).literalKind==e}get isNumericLiteral(){if(this.kind==a.LITERAL)switch(changetype(this).literalKind){case l.FLOAT:case l.INTEGER:return!0}return!1}get compilesToConst(){switch(this.kind){case a.LITERAL:switch(changetype(this).literalKind){case l.FLOAT:case l.INTEGER:case l.STRING:return!0}break;case a.NULL:case a.TRUE:case a.FALSE:return!0}return!1}isAccessOn(e){let t=changetype(this);if(t.kind==a.CALL&&(t=t.expression),t.kind==a.PROPERTYACCESS){if(t.expression.kind==e)return!0}return!1}get isAccessOnThis(){return this.isAccessOn(a.THIS)}get isAccessOnSuper(){return this.isAccessOn(a.SUPER)}}t.Node=c;class p extends c{constructor(e,t,r){super(e,r),this.isNullable=t}hasGenericComponent(e){if(this.kind==a.NAMEDTYPE){let t=changetype(this);if(!t.name.next){let r=t.typeArguments;if(null!==r&&r.length>0){for(let t=0,i=r.length;t<i;++t)if(r[t].hasGenericComponent(e))return!0}else{let r=t.name.identifier.text;for(let t=0,i=e.length;t<i;++t)if(e[t].name.text==r)return!0}}}else if(this.kind==a.FUNCTIONTYPE){let t=changetype(this),r=t.parameters;for(let t=0,i=r.length;t<i;++t)if(r[t].type.hasGenericComponent(e))return!0;if(t.returnType.hasGenericComponent(e))return!0;let i=t.explicitThisType;if(null!==i&&i.hasGenericComponent(e))return!0}else assert(!1);return!1}}t.TypeNode=p;class _ extends c{constructor(e,t,r){super(a.TYPENAME,r),this.identifier=e,this.next=t}}t.TypeName=_;class h extends p{constructor(e,t,r,i){super(a.NAMEDTYPE,r,i),this.name=e,this.typeArguments=t}get hasTypeArguments(){var e=this.typeArguments;return null!==e&&e.length>0}}t.NamedTypeNode=h;class d extends p{constructor(e,t,r,i,n){super(a.FUNCTIONTYPE,i,n),this.parameters=e,this.returnType=t,this.explicitThisType=r}}t.FunctionTypeNode=d;class m extends c{constructor(e,t,r,i){super(a.TYPEPARAMETER,i),this.name=e,this.extendsType=t,this.defaultType=r}}t.TypeParameterNode=m,function(e){e[e.DEFAULT=0]="DEFAULT",e[e.OPTIONAL=1]="OPTIONAL",e[e.REST=2]="REST"}(t.ParameterKind||(t.ParameterKind={}));class y extends c{constructor(e,t,r,n,s){super(a.PARAMETER,s),this.parameterKind=e,this.name=t,this.type=r,this.initializer=n,this.implicitFieldDeclaration=null,this.flags=i.CommonFlags.NONE}is(e){return(this.flags&e)==e}isAny(e){return 0!=(this.flags&e)}set(e){this.flags|=e}}t.ParameterNode=y,function(e){e[e.CUSTOM=0]="CUSTOM",e[e.GLOBAL=1]="GLOBAL",e[e.OPERATOR=2]="OPERATOR",e[e.OPERATOR_BINARY=3]="OPERATOR_BINARY",e[e.OPERATOR_PREFIX=4]="OPERATOR_PREFIX",e[e.OPERATOR_POSTFIX=5]="OPERATOR_POSTFIX",e[e.UNMANAGED=6]="UNMANAGED",e[e.FINAL=7]="FINAL",e[e.INLINE=8]="INLINE",e[e.EXTERNAL=9]="EXTERNAL",e[e.BUILTIN=10]="BUILTIN",e[e.LAZY=11]="LAZY",e[e.UNSAFE=12]="UNSAFE"}(o=t.DecoratorKind||(t.DecoratorKind={})),function(e){e.fromNode=function(t){if(t.kind==a.IDENTIFIER){let r=t.text;switch(assert(r.length),r.charCodeAt(0)){case 98:if("builtin"==r)return e.BUILTIN;break;case 101:if("external"==r)return e.EXTERNAL;break;case 102:if("final"==r)return e.FINAL;break;case 103:if("global"==r)return e.GLOBAL;break;case 105:if("inline"==r)return e.INLINE;break;case 108:if("lazy"==r)return e.LAZY;break;case 111:if("operator"==r)return e.OPERATOR;break;case 117:if("unmanaged"==r)return e.UNMANAGED;if("unsafe"==r)return e.UNSAFE}}else if(t.kind==a.PROPERTYACCESS){let r=t,i=r.expression;if(i.kind==a.IDENTIFIER){let t=i.text;assert(t.length);let n=r.property.text;if(assert(n.length),"operator"==t)switch(n.charCodeAt(0)){case 98:if("binary"==n)return e.OPERATOR_BINARY;break;case 112:if("prefix"==n)return e.OPERATOR_PREFIX;if("postfix"==n)return e.OPERATOR_POSTFIX}}}return e.CUSTOM}}(o=t.DecoratorKind||(t.DecoratorKind={}));class T extends c{constructor(e,t,r,i){super(a.DECORATOR,i),this.decoratorKind=e,this.name=t,this.args=r}}t.DecoratorNode=T,function(e){e[e.LINE=0]="LINE",e[e.TRIPLE=1]="TRIPLE",e[e.BLOCK=2]="BLOCK"}(t.CommentKind||(t.CommentKind={}));class g extends c{constructor(e,t,r){super(a.COMMENT,r),this.commentKind=e,this.text=t}}t.CommentNode=g;class f extends c{}t.Expression=f;class E extends f{constructor(e,t,r){super(a.IDENTIFIER,r),this.text=e,this.isQuoted=t}}t.IdentifierExpression=E,function(e){e[e.FLOAT=0]="FLOAT",e[e.INTEGER=1]="INTEGER",e[e.STRING=2]="STRING",e[e.TEMPLATE=3]="TEMPLATE",e[e.REGEXP=4]="REGEXP",e[e.ARRAY=5]="ARRAY",e[e.OBJECT=6]="OBJECT"}(l=t.LiteralKind||(t.LiteralKind={}));class b extends f{constructor(e,t){super(a.LITERAL,t),this.literalKind=e}}t.LiteralExpression=b;class x extends b{constructor(e,t){super(l.ARRAY,t),this.elementExpressions=e}}t.ArrayLiteralExpression=x,function(e){e[e.PREFIX=0]="PREFIX",e[e.AS=1]="AS",e[e.NONNULL=2]="NONNULL",e[e.CONST=3]="CONST"}(t.AssertionKind||(t.AssertionKind={}));class I extends f{constructor(e,t,r,i){super(a.ASSERTION,i),this.assertionKind=e,this.expression=t,this.toType=r}}t.AssertionExpression=I;class A extends f{constructor(e,t,r,i){super(a.BINARY,i),this.operator=e,this.left=t,this.right=r}}t.BinaryExpression=A;class N extends f{constructor(e,t,r,i){super(a.CALL,i),this.expression=e,this.typeArguments=t,this.args=r}get typeArgumentsRange(){var e,t=this.typeArguments;return t&&(e=t.length)?n.Range.join(t[0].range,t[e-1].range):this.expression.range}get argumentsRange(){var e=this.args,t=e.length;return t?n.Range.join(e[0].range,e[t-1].range):this.expression.range}}t.CallExpression=N;class S extends f{constructor(e){super(a.CLASS,e.range),this.declaration=e}}t.ClassExpression=S;class v extends f{constructor(e,t){super(a.COMMA,t),this.expressions=e}}t.CommaExpression=v;class C extends E{constructor(e){super("constructor",!1,e),this.kind=a.CONSTRUCTOR}}t.ConstructorExpression=C;class O extends f{constructor(e,t,r){super(a.ELEMENTACCESS,r),this.expression=e,this.elementExpression=t}}t.ElementAccessExpression=O;class R extends b{constructor(e,t){super(l.FLOAT,t),this.value=e}}t.FloatLiteralExpression=R;class k extends f{constructor(e){super(a.FUNCTION,e.range),this.declaration=e}}t.FunctionExpression=k;class L extends f{constructor(e,t,r){super(a.INSTANCEOF,r),this.expression=e,this.isType=t}}t.InstanceOfExpression=L;class F extends b{constructor(e,t){super(l.INTEGER,t),this.value=e}}t.IntegerLiteralExpression=F;class D extends f{constructor(e,t,r,i){super(a.NEW,i),this.typeName=e,this.typeArguments=t,this.args=r}get typeArgumentsRange(){var e,t=this.typeArguments;return null!==t&&(e=t.length)>0?n.Range.join(t[0].range,t[e-1].range):this.typeName.range}get argumentsRange(){var e=this.args,t=e.length;return t?n.Range.join(e[0].range,e[t-1].range):this.typeName.range}}t.NewExpression=D;class P extends E{constructor(e){super("null",!1,e),this.kind=a.NULL}}t.NullExpression=P;class w extends b{constructor(e,t,r){super(l.OBJECT,r),this.names=e,this.values=t}}t.ObjectLiteralExpression=w;class B extends f{constructor(e){super(a.OMITTED,e)}}t.OmittedExpression=B;class U extends f{constructor(e,t){super(a.PARENTHESIZED,t),this.expression=e}}t.ParenthesizedExpression=U;class M extends f{constructor(e,t,r){super(a.PROPERTYACCESS,r),this.expression=e,this.property=t}}t.PropertyAccessExpression=M;class G extends b{constructor(e,t,r){super(l.REGEXP,r),this.pattern=e,this.patternFlags=t}}t.RegexpLiteralExpression=G;class K extends f{constructor(e,t,r,i){super(a.TERNARY,i),this.condition=e,this.ifThen=t,this.ifElse=r}}t.TernaryExpression=K;class V extends b{constructor(e,t){super(l.STRING,t),this.value=e}}t.StringLiteralExpression=V;class z extends E{constructor(e){super("super",!1,e),this.kind=a.SUPER}}t.SuperExpression=z;class W extends b{constructor(e,t,r,i,n){super(l.TEMPLATE,n),this.tag=e,this.parts=t,this.rawParts=r,this.expressions=i}}t.TemplateLiteralExpression=W;class Y extends E{constructor(e){super("this",!1,e),this.kind=a.THIS}}t.ThisExpression=Y;class H extends E{constructor(e){super("true",!1,e),this.kind=a.TRUE}}t.TrueExpression=H;class X extends E{constructor(e){super("false",!1,e),this.kind=a.FALSE}}t.FalseExpression=X;class q extends f{constructor(e,t,r,i){super(e,i),this.operator=t,this.operand=r}}t.UnaryExpression=q;class Q extends q{constructor(e,t,r){super(a.UNARYPOSTFIX,e,t,r)}}t.UnaryPostfixExpression=Q;class j extends q{constructor(e,t,r){super(a.UNARYPREFIX,e,t,r)}}t.UnaryPrefixExpression=j;class Z extends f{constructor(e,t,r){super(a.COMPILED,r),this.expr=e,this.type=t}}t.CompiledExpression=Z;class J extends c{}t.Statement=J,function(e){e[e.USER=0]="USER",e[e.USER_ENTRY=1]="USER_ENTRY",e[e.LIBRARY=2]="LIBRARY",e[e.LIBRARY_ENTRY=3]="LIBRARY_ENTRY"}(u=t.SourceKind||(t.SourceKind={}));t.Source=class extends c{constructor(e,t,r){super(a.SOURCE,new n.Range(0,r.length)),this.sourceKind=e,this.normalizedPath=t,this.text=r,this.statements=new Array,this.debugInfoIndex=-1,this.exportPaths=null,this.lineCache=null,this.lineColumn=1;var s=Pe(t);this.internalPath=s;var o=s.lastIndexOf(i.PATH_DELIMITER);this.simplePath=o>=0?s.substring(o+1):s,this.range.source=this}get isNative(){return this.internalPath==i.LIBRARY_SUBST}get isLibrary(){var e=this.sourceKind;return e==u.LIBRARY||e==u.LIBRARY_ENTRY}lineAt(e){assert(e>=0&&e<2147483647);var t=this.lineCache;if(!t){this.lineCache=t=[0];let e=this.text,r=0,i=e.length;for(;r<i;)10==e.charCodeAt(r++)&&t.push(r);t.push(2147483647)}for(var r=0,i=t.length-1;r<i;){let n=r+(i-r>>1),s=unchecked(t[n]);if(e<s)i=n;else{if(e<unchecked(t[n+1]))return this.lineColumn=e-s+1,n+1;r=n+1}}return assert(0)}columnAt(){return this.lineColumn}};class $ extends J{constructor(e,t,r,i,n){super(e,n),this.name=t,this.decorators=r,this.flags=i}is(e){return(this.flags&e)==e}isAny(e){return 0!=(this.flags&e)}set(e){this.flags|=e}}t.DeclarationStatement=$;class ee extends c{constructor(e,t,r,i){super(a.INDEXSIGNATURE,i),this.keyType=e,this.valueType=t,this.flags=r}}t.IndexSignatureNode=ee;class te extends ${constructor(e,t,r,i,n,s,a){super(e,t,r,i,a),this.type=n,this.initializer=s}}t.VariableLikeDeclarationStatement=te;class re extends J{constructor(e,t){super(a.BLOCK,t),this.statements=e}}t.BlockStatement=re;class ie extends J{constructor(e,t){super(a.BREAK,t),this.label=e}}t.BreakStatement=ie;class ne extends ${constructor(e,t,r,i,n,s,o,l){super(a.CLASSDECLARATION,e,t,r,l),this.typeParameters=i,this.extendsType=n,this.implementsTypes=s,this.members=o,this.indexSignature=null}get isGeneric(){var e=this.typeParameters;return null!=e&&e.length>0}}t.ClassDeclaration=ne;class se extends J{constructor(e,t){super(a.CONTINUE,t),this.label=e}}t.ContinueStatement=se;class ae extends J{constructor(e,t,r){super(a.DO,r),this.statement=e,this.condition=t}}t.DoStatement=ae;class oe extends J{constructor(e){super(a.EMPTY,e)}}t.EmptyStatement=oe;class le extends ${constructor(e,t,r,i,n){super(a.ENUMDECLARATION,e,t,r,n),this.values=i}}t.EnumDeclaration=le;class ue extends te{constructor(e,t,r,i){super(a.ENUMVALUEDECLARATION,e,null,t,null,r,i)}}t.EnumValueDeclaration=ue;class ce extends J{constructor(e,t,r){super(a.EXPORTIMPORT,r),this.name=e,this.externalName=t}}t.ExportImportStatement=ce;class pe extends c{constructor(e,t,r){super(a.EXPORTMEMBER,r),this.localName=e,this.exportedName=t}}t.ExportMember=pe;class _e extends J{constructor(e,t,r,n){if(super(a.EXPORT,n),this.members=e,this.path=t,this.isDeclare=r,t){let e=s.normalizePath(t.value);t.value.startsWith(".")?e=s.resolvePath(e,n.source.internalPath):e.startsWith(i.LIBRARY_PREFIX)||(e=i.LIBRARY_PREFIX+e),this.internalPath=e}else this.internalPath=null}}t.ExportStatement=_e;class he extends J{constructor(e,t){super(a.EXPORTDEFAULT,t),this.declaration=e}}t.ExportDefaultStatement=he;class de extends J{constructor(e){super(a.EXPRESSION,e.range),this.expression=e}}t.ExpressionStatement=de;class me extends te{constructor(e,t,r,i,n,s,o){super(a.FIELDDECLARATION,e,t,r,i,n,o),this.parameterIndex=s}}t.FieldDeclaration=me;class ye extends J{constructor(e,t,r,i,n){super(a.FOR,n),this.initializer=e,this.condition=t,this.incrementor=r,this.statement=i}}t.ForStatement=ye;class Te extends J{constructor(e,t,r,i){super(a.FOROF,i),this.variable=e,this.iterable=t,this.statement=r}}t.ForOfStatement=Te,function(e){e[e.NONE=0]="NONE",e[e.ARROW_PARENTHESIZED=1]="ARROW_PARENTHESIZED",e[e.ARROW_SINGLE=2]="ARROW_SINGLE"}(t.ArrowKind||(t.ArrowKind={}));class ge extends ${constructor(e,t,r,i,n,s,o,l){super(a.FUNCTIONDECLARATION,e,t,r,l),this.typeParameters=i,this.signature=n,this.body=s,this.arrowKind=o}get isGeneric(){var e=this.typeParameters;return null!=e&&e.length>0}clone(){return new ge(this.name,this.decorators,this.flags,this.typeParameters,this.signature,this.body,this.arrowKind,this.range)}}t.FunctionDeclaration=ge;class fe extends J{constructor(e,t,r,i){super(a.IF,i),this.condition=e,this.ifTrue=t,this.ifFalse=r}}t.IfStatement=fe;class Ee extends ${constructor(e,t,r){super(a.IMPORTDECLARATION,e,null,i.CommonFlags.NONE,r),this.foreignName=t}}t.ImportDeclaration=Ee;class be extends J{constructor(e,t,r,n){super(a.IMPORT,n),this.declarations=e,this.namespaceName=t,this.path=r;var o=s.normalizePath(r.value);r.value.startsWith(".")?o=s.resolvePath(o,n.source.internalPath):o.startsWith(i.LIBRARY_PREFIX)||(o=i.LIBRARY_PREFIX+o),this.internalPath=o}}t.ImportStatement=be;class xe extends ne{constructor(e,t,r,i,n,s,o,l){super(e,t,r,i,n,s,o,l),this.kind=a.INTERFACEDECLARATION}}t.InterfaceDeclaration=xe;class Ie extends ge{constructor(e,t,r,i,n,s,o){super(e,t,r,i,n,s,0,o),this.kind=a.METHODDECLARATION}}t.MethodDeclaration=Ie;class Ae extends ${constructor(e,t,r,i,n){super(a.NAMESPACEDECLARATION,e,t,r,n),this.members=i}}t.NamespaceDeclaration=Ae;class Ne extends J{constructor(e,t){super(a.RETURN,t),this.value=e}}t.ReturnStatement=Ne;class Se extends c{constructor(e,t,r){super(a.SWITCHCASE,r),this.label=e,this.statements=t}}t.SwitchCase=Se;class ve extends J{constructor(e,t,r){super(a.SWITCH,r),this.condition=e,this.cases=t}}t.SwitchStatement=ve;class Ce extends J{constructor(e,t){super(a.THROW,t),this.value=e}}t.ThrowStatement=Ce;class Oe extends J{constructor(e,t,r,i,n){super(a.TRY,n),this.statements=e,this.catchVariable=t,this.catchStatements=r,this.finallyStatements=i}}t.TryStatement=Oe;class Re extends ${constructor(e,t,r,i,n,s){super(a.TYPEDECLARATION,e,t,r,s),this.typeParameters=i,this.type=n}}t.TypeDeclaration=Re;class ke extends te{constructor(e,t,r,i,n,s){super(a.VARIABLEDECLARATION,e,t,r,i,n,s)}}t.VariableDeclaration=ke;class Le extends J{constructor(e,t,r){super(a.VARIABLE,r),this.decorators=e,this.declarations=t}}t.VariableStatement=Le;class Fe extends J{constructor(e,t){super(a.VOID,t),this.expression=e}}t.VoidStatement=Fe;class De extends J{constructor(e,t,r){super(a.WHILE,r),this.condition=e,this.statement=t}}function Pe(e){var t=e.lastIndexOf("."),r=e.length;if(t>=0&&r-t>=2){let i=t;for(;++i<r;)if(!s.isTrivialAlphanum(e.charCodeAt(i)))return assert(!1),e;return e.substring(0,t)}return assert(!1),e}t.WhileStatement=De,t.findDecorator=function(e,t){if(t)for(let r=0,i=t.length;r<i;++r){let i=t[r];if(i.decoratorKind==e)return i}return null},t.mangleInternalPath=Pe,t.isTypeOmitted=function(e){if(e.kind==a.NAMEDTYPE){let t=e.name;return!(null!==t.next||t.identifier.text.length>0)}return!1}},346:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compileClassInstanceOf=t.compileRTTI=t.compileVisitMembers=t.compileVisitGlobals=t.function_builtins=t.builtins=t.BuiltinContext=t.BuiltinNames=void 0;const i=r(256),n=r(60),s=r(699),a=r(656),o=r(974),l=r(154),u=r(742),c=r(200),p=r(910);var _;!function(e){e.start="~start",e.started="~started",e.argumentsLength="~argumentsLength",e.setArgumentsLength="~setArgumentsLength",e.abort="~lib/builtins/abort",e.trace="~lib/builtins/trace",e.seed="~lib/builtins/seed",e.isInteger="~lib/builtins/isInteger",e.isFloat="~lib/builtins/isFloat",e.isBoolean="~lib/builtins/isBoolean",e.isSigned="~lib/builtins/isSigned",e.isReference="~lib/builtins/isReference",e.isString="~lib/builtins/isString",e.isArray="~lib/builtins/isArray",e.isArrayLike="~lib/builtins/isArrayLike",e.isFunction="~lib/builtins/isFunction",e.isNullable="~lib/builtins/isNullable",e.isDefined="~lib/builtins/isDefined",e.isConstant="~lib/builtins/isConstant",e.isManaged="~lib/builtins/isManaged",e.isVoid="~lib/builtins/isVoid",e.add="~lib/builtins/add",e.sub="~lib/builtins/sub",e.mul="~lib/builtins/mul",e.div="~lib/builtins/div",e.clz="~lib/builtins/clz",e.ctz="~lib/builtins/ctz",e.popcnt="~lib/builtins/popcnt",e.rotl="~lib/builtins/rotl",e.rotr="~lib/builtins/rotr",e.abs="~lib/builtins/abs",e.max="~lib/builtins/max",e.min="~lib/builtins/min",e.ceil="~lib/builtins/ceil",e.floor="~lib/builtins/floor",e.copysign="~lib/builtins/copysign",e.nearest="~lib/builtins/nearest",e.reinterpret="~lib/builtins/reinterpret",e.sqrt="~lib/builtins/sqrt",e.trunc="~lib/builtins/trunc",e.load="~lib/builtins/load",e.store="~lib/builtins/store",e.atomic_load="~lib/builtins/atomic.load",e.atomic_store="~lib/builtins/atomic.store",e.atomic_add="~lib/builtins/atomic.add",e.atomic_sub="~lib/builtins/atomic.sub",e.atomic_and="~lib/builtins/atomic.and",e.atomic_or="~lib/builtins/atomic.or",e.atomic_xor="~lib/builtins/atomic.xor",e.atomic_xchg="~lib/builtins/atomic.xchg",e.atomic_cmpxchg="~lib/builtins/atomic.cmpxchg",e.atomic_wait="~lib/builtins/atomic.wait",e.atomic_notify="~lib/builtins/atomic.notify",e.atomic_fence="~lib/builtins/atomic.fence",e.sizeof="~lib/builtins/sizeof",e.alignof="~lib/builtins/alignof",e.offsetof="~lib/builtins/offsetof",e.nameof="~lib/builtins/nameof",e.lengthof="~lib/builtins/lengthof",e.select="~lib/builtins/select",e.unreachable="~lib/builtins/unreachable",e.changetype="~lib/builtins/changetype",e.assert="~lib/builtins/assert",e.call_indirect="~lib/builtins/call_indirect",e.unchecked="~lib/builtins/unchecked",e.instantiate="~lib/builtins/instantiate",e.idof="~lib/builtins/idof",e.i8="~lib/builtins/i8",e.i16="~lib/builtins/i16",e.i32="~lib/builtins/i32",e.i64="~lib/builtins/i64",e.isize="~lib/builtins/isize",e.u8="~lib/builtins/u8",e.u16="~lib/builtins/u16",e.u32="~lib/builtins/u32",e.u64="~lib/builtins/u64",e.usize="~lib/builtins/usize",e.bool="~lib/builtins/bool",e.f32="~lib/builtins/f32",e.f64="~lib/builtins/f64",e.v128="~lib/builtins/v128",e.i32_clz="~lib/builtins/i32.clz",e.i64_clz="~lib/builtins/i64.clz",e.i32_ctz="~lib/builtins/i32.ctz",e.i64_ctz="~lib/builtins/i64.ctz",e.i32_popcnt="~lib/builtins/i32.popcnt",e.i64_popcnt="~lib/builtins/i64.popcnt",e.i32_rotl="~lib/builtins/i32.rotl",e.i64_rotl="~lib/builtins/i64.rotl",e.i32_rotr="~lib/builtins/i32.rotr",e.i64_rotr="~lib/builtins/i64.rotr",e.f32_abs="~lib/builtins/f32.abs",e.f64_abs="~lib/builtins/f64.abs",e.f32_max="~lib/builtins/f32.max",e.f64_max="~lib/builtins/f64.max",e.f32_min="~lib/builtins/f32.min",e.f64_min="~lib/builtins/f64.min",e.f32_ceil="~lib/builtins/f32.ceil",e.f64_ceil="~lib/builtins/f64.ceil",e.f32_floor="~lib/builtins/f32.floor",e.f64_floor="~lib/builtins/f64.floor",e.f32_copysign="~lib/builtins/f32.copysign",e.f64_copysign="~lib/builtins/f64.copysign",e.f32_nearest="~lib/builtins/f32.nearest",e.f64_nearest="~lib/builtins/f64.nearest",e.i32_reinterpret_f32="~lib/builtins/i32.reinterpret_f32",e.i64_reinterpret_f64="~lib/builtins/i64.reinterpret_f64",e.f32_reinterpret_i32="~lib/builtins/f32.reinterpret_i32",e.f64_reinterpret_i64="~lib/builtins/f64.reinterpret_i64",e.f32_sqrt="~lib/builtins/f32.sqrt",e.f64_sqrt="~lib/builtins/f64.sqrt",e.f32_trunc="~lib/builtins/f32.trunc",e.f64_trunc="~lib/builtins/f64.trunc",e.i32_add="~lib/builtins/i32.add",e.i64_add="~lib/builtins/i64.add",e.f32_add="~lib/builtins/f32.add",e.f64_add="~lib/builtins/f64.add",e.i32_sub="~lib/builtins/i32.sub",e.i64_sub="~lib/builtins/i64.sub",e.f32_sub="~lib/builtins/f32.sub",e.f64_sub="~lib/builtins/f64.sub",e.i32_mul="~lib/builtins/i32.mul",e.i64_mul="~lib/builtins/i64.mul",e.f32_mul="~lib/builtins/f32.mul",e.f64_mul="~lib/builtins/f64.mul",e.i32_div_s="~lib/builtins/i32.div_s",e.i32_div_u="~lib/builtins/i32.div_u",e.i64_div_s="~lib/builtins/i64.div_s",e.i64_div_u="~lib/builtins/i64.div_u",e.f32_div="~lib/builtins/f32.div",e.f64_div="~lib/builtins/f64.div",e.i32_load8_s="~lib/builtins/i32.load8_s",e.i32_load8_u="~lib/builtins/i32.load8_u",e.i32_load16_s="~lib/builtins/i32.load16_s",e.i32_load16_u="~lib/builtins/i32.load16_u",e.i32_load="~lib/builtins/i32.load",e.i64_load8_s="~lib/builtins/i64.load8_s",e.i64_load8_u="~lib/builtins/i64.load8_u",e.i64_load16_s="~lib/builtins/i64.load16_s",e.i64_load16_u="~lib/builtins/i64.load16_u",e.i64_load32_s="~lib/builtins/i64.load32_s",e.i64_load32_u="~lib/builtins/i64.load32_u",e.i64_load="~lib/builtins/i64.load",e.f32_load="~lib/builtins/f32.load",e.f64_load="~lib/builtins/f64.load",e.i32_store8="~lib/builtins/i32.store8",e.i32_store16="~lib/builtins/i32.store16",e.i32_store="~lib/builtins/i32.store",e.i64_store8="~lib/builtins/i64.store8",e.i64_store16="~lib/builtins/i64.store16",e.i64_store32="~lib/builtins/i64.store32",e.i64_store="~lib/builtins/i64.store",e.f32_store="~lib/builtins/f32.store",e.f64_store="~lib/builtins/f64.store",e.i32_atomic_load8_u="~lib/builtins/i32.atomic.load8_u",e.i32_atomic_load16_u="~lib/builtins/i32.atomic.load16_u",e.i32_atomic_load="~lib/builtins/i32.atomic.load",e.i64_atomic_load8_u="~lib/builtins/i64.atomic.load8_u",e.i64_atomic_load16_u="~lib/builtins/i64.atomic.load16_u",e.i64_atomic_load32_u="~lib/builtins/i64.atomic.load32_u",e.i64_atomic_load="~lib/builtins/i64.atomic.load",e.i32_atomic_store8="~lib/builtins/i32.atomic.store8",e.i32_atomic_store16="~lib/builtins/i32.atomic.store16",e.i32_atomic_store="~lib/builtins/i32.atomic.store",e.i64_atomic_store8="~lib/builtins/i64.atomic.store8",e.i64_atomic_store16="~lib/builtins/i64.atomic.store16",e.i64_atomic_store32="~lib/builtins/i64.atomic.store32",e.i64_atomic_store="~lib/builtins/i64.atomic.store",e.i32_atomic_rmw8_add_u="~lib/builtins/i32.atomic.rmw8.add_u",e.i32_atomic_rmw16_add_u="~lib/builtins/i32.atomic.rmw16.add_u",e.i32_atomic_rmw_add="~lib/builtins/i32.atomic.rmw.add",e.i64_atomic_rmw8_add_u="~lib/builtins/i64.atomic.rmw8.add_u",e.i64_atomic_rmw16_add_u="~lib/builtins/i64.atomic.rmw16.add_u",e.i64_atomic_rmw32_add_u="~lib/builtins/i64.atomic.rmw32.add_u",e.i64_atomic_rmw_add="~lib/builtins/i64.atomic.rmw.add",e.i32_atomic_rmw8_sub_u="~lib/builtins/i32.atomic.rmw8.sub_u",e.i32_atomic_rmw16_sub_u="~lib/builtins/i32.atomic.rmw16.sub_u",e.i32_atomic_rmw_sub="~lib/builtins/i32.atomic.rmw.sub",e.i64_atomic_rmw8_sub_u="~lib/builtins/i64.atomic.rmw8.sub_u",e.i64_atomic_rmw16_sub_u="~lib/builtins/i64.atomic.rmw16.sub_u",e.i64_atomic_rmw32_sub_u="~lib/builtins/i64.atomic.rmw32.sub_u",e.i64_atomic_rmw_sub="~lib/builtins/i64.atomic.rmw.sub",e.i32_atomic_rmw8_and_u="~lib/builtins/i32.atomic.rmw8.and_u",e.i32_atomic_rmw16_and_u="~lib/builtins/i32.atomic.rmw16.and_u",e.i32_atomic_rmw_and="~lib/builtins/i32.atomic.rmw.and",e.i64_atomic_rmw8_and_u="~lib/builtins/i64.atomic.rmw8.and_u",e.i64_atomic_rmw16_and_u="~lib/builtins/i64.atomic.rmw16.and_u",e.i64_atomic_rmw32_and_u="~lib/builtins/i64.atomic.rmw32.and_u",e.i64_atomic_rmw_and="~lib/builtins/i64.atomic.rmw.and",e.i32_atomic_rmw8_or_u="~lib/builtins/i32.atomic.rmw8.or_u",e.i32_atomic_rmw16_or_u="~lib/builtins/i32.atomic.rmw16.or_u",e.i32_atomic_rmw_or="~lib/builtins/i32.atomic.rmw.or",e.i64_atomic_rmw8_or_u="~lib/builtins/i64.atomic.rmw8.or_u",e.i64_atomic_rmw16_or_u="~lib/builtins/i64.atomic.rmw16.or_u",e.i64_atomic_rmw32_or_u="~lib/builtins/i64.atomic.rmw32.or_u",e.i64_atomic_rmw_or="~lib/builtins/i64.atomic.rmw.or",e.i32_atomic_rmw8_xor_u="~lib/builtins/i32.atomic.rmw8.xor_u",e.i32_atomic_rmw16_xor_u="~lib/builtins/i32.atomic.rmw16.xor_u",e.i32_atomic_rmw_xor="~lib/builtins/i32.atomic.rmw.xor",e.i64_atomic_rmw8_xor_u="~lib/builtins/i64.atomic.rmw8.xor_u",e.i64_atomic_rmw16_xor_u="~lib/builtins/i64.atomic.rmw16.xor_u",e.i64_atomic_rmw32_xor_u="~lib/builtins/i64.atomic.rmw32.xor_u",e.i64_atomic_rmw_xor="~lib/builtins/i64.atomic.rmw.xor",e.i32_atomic_rmw8_xchg_u="~lib/builtins/i32.atomic.rmw8.xchg_u",e.i32_atomic_rmw16_xchg_u="~lib/builtins/i32.atomic.rmw16.xchg_u",e.i32_atomic_rmw_xchg="~lib/builtins/i32.atomic.rmw.xchg",e.i64_atomic_rmw8_xchg_u="~lib/builtins/i64.atomic.rmw8.xchg_u",e.i64_atomic_rmw16_xchg_u="~lib/builtins/i64.atomic.rmw16.xchg_u",e.i64_atomic_rmw32_xchg_u="~lib/builtins/i64.atomic.rmw32.xchg_u",e.i64_atomic_rmw_xchg="~lib/builtins/i64.atomic.rmw.xchg",e.i32_atomic_rmw8_cmpxchg_u="~lib/builtins/i32.atomic.rmw8.cmpxchg_u",e.i32_atomic_rmw16_cmpxchg_u="~lib/builtins/i32.atomic.rmw16.cmpxchg_u",e.i32_atomic_rmw_cmpxchg="~lib/builtins/i32.atomic.rmw.cmpxchg",e.i64_atomic_rmw8_cmpxchg_u="~lib/builtins/i64.atomic.rmw8.cmpxchg_u",e.i64_atomic_rmw16_cmpxchg_u="~lib/builtins/i64.atomic.rmw16.cmpxchg_u",e.i64_atomic_rmw32_cmpxchg_u="~lib/builtins/i64.atomic.rmw32.cmpxchg_u",e.i64_atomic_rmw_cmpxchg="~lib/builtins/i64.atomic.rmw.cmpxchg",e.i32_wait="~lib/builtins/i32.wait",e.i64_wait="~lib/builtins/i64.wait",e.v128_splat="~lib/builtins/v128.splat",e.v128_extract_lane="~lib/builtins/v128.extract_lane",e.v128_replace_lane="~lib/builtins/v128.replace_lane",e.v128_shuffle="~lib/builtins/v128.shuffle",e.v128_swizzle="~lib/builtins/v128.swizzle",e.v128_load_splat="~lib/builtins/v128.load_splat",e.v128_load_ext="~lib/builtins/v128.load_ext",e.v128_load="~lib/builtins/v128.load",e.v128_load8x8_s="~lib/builtins/v128.load8x8_s",e.v128_load8x8_u="~lib/builtins/v128.load8x8_u",e.v128_load16x4_s="~lib/builtins/v128.load16x4_s",e.v128_load16x4_u="~lib/builtins/v128.load16x4_u",e.v128_load32x2_s="~lib/builtins/v128.load32x2_s",e.v128_load32x2_u="~lib/builtins/v128.load32x2_u",e.v128_load8_splat="~lib/builtins/v128.load8_splat",e.v128_load16_splat="~lib/builtins/v128.load16_splat",e.v128_load32_splat="~lib/builtins/v128.load32_splat",e.v128_load64_splat="~lib/builtins/v128.load64_splat",e.v128_store="~lib/builtins/v128.store",e.v128_add="~lib/builtins/v128.add",e.v128_sub="~lib/builtins/v128.sub",e.v128_mul="~lib/builtins/v128.mul",e.v128_div="~lib/builtins/v128.div",e.v128_neg="~lib/builtins/v128.neg",e.v128_add_sat="~lib/builtins/v128.add_sat",e.v128_sub_sat="~lib/builtins/v128.sub_sat",e.v128_shl="~lib/builtins/v128.shl",e.v128_shr="~lib/builtins/v128.shr",e.v128_and="~lib/builtins/v128.and",e.v128_or="~lib/builtins/v128.or",e.v128_xor="~lib/builtins/v128.xor",e.v128_andnot="~lib/builtins/v128.andnot",e.v128_not="~lib/builtins/v128.not",e.v128_bitselect="~lib/builtins/v128.bitselect",e.v128_any_true="~lib/builtins/v128.any_true",e.v128_all_true="~lib/builtins/v128.all_true",e.v128_bitmask="~lib/builtins/v128.bitmask",e.v128_min="~lib/builtins/v128.min",e.v128_max="~lib/builtins/v128.max",e.v128_pmin="~lib/builtins/v128.pmin",e.v128_pmax="~lib/builtins/v128.pmax",e.v128_dot="~lib/builtins/v128.dot",e.v128_avgr="~lib/builtins/v128.avgr",e.v128_abs="~lib/builtins/v128.abs",e.v128_sqrt="~lib/builtins/v128.sqrt",e.v128_ceil="~lib/builtins/v128.ceil",e.v128_floor="~lib/builtins/v128.floor",e.v128_trunc="~lib/builtins/v128.trunc",e.v128_nearest="~lib/builtins/v128.nearest",e.v128_eq="~lib/builtins/v128.eq",e.v128_ne="~lib/builtins/v128.ne",e.v128_lt="~lib/builtins/v128.lt",e.v128_le="~lib/builtins/v128.le",e.v128_gt="~lib/builtins/v128.gt",e.v128_ge="~lib/builtins/v128.ge",e.v128_convert="~lib/builtins/v128.convert",e.v128_trunc_sat="~lib/builtins/v128.trunc_sat",e.v128_narrow="~lib/builtins/v128.narrow",e.v128_extend_low="~lib/builtins/v128.extend_low",e.v128_extend_high="~lib/builtins/v128.extend_high",e.i8x16="~lib/builtins/i8x16",e.i16x8="~lib/builtins/i16x8",e.i32x4="~lib/builtins/i32x4",e.i64x2="~lib/builtins/i64x2",e.f32x4="~lib/builtins/f32x4",e.f64x2="~lib/builtins/f64x2",e.i8x16_splat="~lib/builtins/i8x16.splat",e.i8x16_extract_lane_s="~lib/builtins/i8x16.extract_lane_s",e.i8x16_extract_lane_u="~lib/builtins/i8x16.extract_lane_u",e.i8x16_replace_lane="~lib/builtins/i8x16.replace_lane",e.i8x16_add="~lib/builtins/i8x16.add",e.i8x16_sub="~lib/builtins/i8x16.sub",e.i8x16_mul="~lib/builtins/i8x16.mul",e.i8x16_min_s="~lib/builtins/i8x16.min_s",e.i8x16_min_u="~lib/builtins/i8x16.min_u",e.i8x16_max_s="~lib/builtins/i8x16.max_s",e.i8x16_max_u="~lib/builtins/i8x16.max_u",e.i8x16_avgr_u="~lib/builtins/i8x16.avgr_u",e.i8x16_abs="~lib/builtins/i8x16.abs",e.i8x16_neg="~lib/builtins/i8x16.neg",e.i8x16_add_sat_s="~lib/builtins/i8x16.add_sat_s",e.i8x16_add_sat_u="~lib/builtins/i8x16.add_sat_u",e.i8x16_sub_sat_s="~lib/builtins/i8x16.sub_sat_s",e.i8x16_sub_sat_u="~lib/builtins/i8x16.sub_sat_u",e.i8x16_shl="~lib/builtins/i8x16.shl",e.i8x16_shr_s="~lib/builtins/i8x16.shr_s",e.i8x16_shr_u="~lib/builtins/i8x16.shr_u",e.i8x16_all_true="~lib/builtins/i8x16.all_true",e.i8x16_bitmask="~lib/builtins/i8x16.bitmask",e.i8x16_eq="~lib/builtins/i8x16.eq",e.i8x16_ne="~lib/builtins/i8x16.ne",e.i8x16_lt_s="~lib/builtins/i8x16.lt_s",e.i8x16_lt_u="~lib/builtins/i8x16.lt_u",e.i8x16_le_s="~lib/builtins/i8x16.le_s",e.i8x16_le_u="~lib/builtins/i8x16.le_u",e.i8x16_gt_s="~lib/builtins/i8x16.gt_s",e.i8x16_gt_u="~lib/builtins/i8x16.gt_u",e.i8x16_ge_s="~lib/builtins/i8x16.ge_s",e.i8x16_ge_u="~lib/builtins/i8x16.ge_u",e.i8x16_narrow_i16x8_s="~lib/builtins/i8x16.narrow_i16x8_s",e.i8x16_narrow_i16x8_u="~lib/builtins/i8x16.narrow_i16x8_u",e.i8x16_shuffle="~lib/builtins/i8x16.shuffle",e.i8x16_swizzle="~lib/builtins/i8x16.swizzle",e.i16x8_splat="~lib/builtins/i16x8.splat",e.i16x8_extract_lane_s="~lib/builtins/i16x8.extract_lane_s",e.i16x8_extract_lane_u="~lib/builtins/i16x8.extract_lane_u",e.i16x8_replace_lane="~lib/builtins/i16x8.replace_lane",e.i16x8_add="~lib/builtins/i16x8.add",e.i16x8_sub="~lib/builtins/i16x8.sub",e.i16x8_mul="~lib/builtins/i16x8.mul",e.i16x8_min_s="~lib/builtins/i16x8.min_s",e.i16x8_min_u="~lib/builtins/i16x8.min_u",e.i16x8_max_s="~lib/builtins/i16x8.max_s",e.i16x8_max_u="~lib/builtins/i16x8.max_u",e.i16x8_avgr_u="~lib/builtins/i16x8.avgr_u",e.i16x8_abs="~lib/builtins/i16x8.abs",e.i16x8_neg="~lib/builtins/i16x8.neg",e.i16x8_add_sat_s="~lib/builtins/i16x8.add_sat_s",e.i16x8_add_sat_u="~lib/builtins/i16x8.add_sat_u",e.i16x8_sub_sat_s="~lib/builtins/i16x8.sub_sat_s",e.i16x8_sub_sat_u="~lib/builtins/i16x8.sub_sat_u",e.i16x8_shl="~lib/builtins/i16x8.shl",e.i16x8_shr_s="~lib/builtins/i16x8.shr_s",e.i16x8_shr_u="~lib/builtins/i16x8.shr_u",e.i16x8_all_true="~lib/builtins/i16x8.all_true",e.i16x8_bitmask="~lib/builtins/i16x8.bitmask",e.i16x8_eq="~lib/builtins/i16x8.eq",e.i16x8_ne="~lib/builtins/i16x8.ne",e.i16x8_lt_s="~lib/builtins/i16x8.lt_s",e.i16x8_lt_u="~lib/builtins/i16x8.lt_u",e.i16x8_le_s="~lib/builtins/i16x8.le_s",e.i16x8_le_u="~lib/builtins/i16x8.le_u",e.i16x8_gt_s="~lib/builtins/i16x8.gt_s",e.i16x8_gt_u="~lib/builtins/i16x8.gt_u",e.i16x8_ge_s="~lib/builtins/i16x8.ge_s",e.i16x8_ge_u="~lib/builtins/i16x8.ge_u",e.i16x8_narrow_i32x4_s="~lib/builtins/i16x8.narrow_i32x4_s",e.i16x8_narrow_i32x4_u="~lib/builtins/i16x8.narrow_i32x4_u",e.i16x8_extend_low_i8x16_s="~lib/builtins/i16x8.extend_low_i8x16_s",e.i16x8_extend_low_i8x16_u="~lib/builtins/i16x8.extend_low_i8x16_u",e.i16x8_extend_high_i8x16_s="~lib/builtins/i16x8.extend_high_i8x16_s",e.i16x8_extend_high_i8x16_u="~lib/builtins/i16x8.extend_high_i8x16_u",e.i32x4_splat="~lib/builtins/i32x4.splat",e.i32x4_extract_lane="~lib/builtins/i32x4.extract_lane",e.i32x4_replace_lane="~lib/builtins/i32x4.replace_lane",e.i32x4_add="~lib/builtins/i32x4.add",e.i32x4_sub="~lib/builtins/i32x4.sub",e.i32x4_mul="~lib/builtins/i32x4.mul",e.i32x4_min_s="~lib/builtins/i32x4.min_s",e.i32x4_min_u="~lib/builtins/i32x4.min_u",e.i32x4_max_s="~lib/builtins/i32x4.max_s",e.i32x4_max_u="~lib/builtins/i32x4.max_u",e.i32x4_dot_i16x8_s="~lib/builtins/i32x4.dot_i16x8_s",e.i32x4_abs="~lib/builtins/i32x4.abs",e.i32x4_neg="~lib/builtins/i32x4.neg",e.i32x4_shl="~lib/builtins/i32x4.shl",e.i32x4_shr_s="~lib/builtins/i32x4.shr_s",e.i32x4_shr_u="~lib/builtins/i32x4.shr_u",e.i32x4_all_true="~lib/builtins/i32x4.all_true",e.i32x4_bitmask="~lib/builtins/i32x4.bitmask",e.i32x4_eq="~lib/builtins/i32x4.eq",e.i32x4_ne="~lib/builtins/i32x4.ne",e.i32x4_lt_s="~lib/builtins/i32x4.lt_s",e.i32x4_lt_u="~lib/builtins/i32x4.lt_u",e.i32x4_le_s="~lib/builtins/i32x4.le_s",e.i32x4_le_u="~lib/builtins/i32x4.le_u",e.i32x4_gt_s="~lib/builtins/i32x4.gt_s",e.i32x4_gt_u="~lib/builtins/i32x4.gt_u",e.i32x4_ge_s="~lib/builtins/i32x4.ge_s",e.i32x4_ge_u="~lib/builtins/i32x4.ge_u",e.i32x4_trunc_sat_f32x4_s="~lib/builtins/i32x4.trunc_sat_f32x4_s",e.i32x4_trunc_sat_f32x4_u="~lib/builtins/i32x4.trunc_sat_f32x4_u",e.i32x4_extend_low_i16x8_s="~lib/builtins/i32x4.extend_low_i16x8_s",e.i32x4_extend_low_i16x8_u="~lib/builtins/i32x4.extend_low_i16x8_u",e.i32x4_extend_high_i16x8_s="~lib/builtins/i32x4.extend_high_i16x8_s",e.i32x4_extend_high_i16x8_u="~lib/builtins/i32x4.extend_high_i16x8_u",e.i64x2_splat="~lib/builtins/i64x2.splat",e.i64x2_extract_lane="~lib/builtins/i64x2.extract_lane",e.i64x2_replace_lane="~lib/builtins/i64x2.replace_lane",e.i64x2_add="~lib/builtins/i64x2.add",e.i64x2_sub="~lib/builtins/i64x2.sub",e.i64x2_mul="~lib/builtins/i64x2.mul",e.i64x2_neg="~lib/builtins/i64x2.neg",e.i64x2_shl="~lib/builtins/i64x2.shl",e.i64x2_shr_s="~lib/builtins/i64x2.shr_s",e.i64x2_shr_u="~lib/builtins/i64x2.shr_u",e.i64x2_all_true="~lib/builtins/i64x2.all_true",e.i64x2_eq="~lib/builtins/i64x2.eq",e.i64x2_ne="~lib/builtins/i64x2.ne",e.i64x2_lt_s="~lib/builtins/i64x2.lt_s",e.i64x2_lt_u="~lib/builtins/i64x2.lt_u",e.i64x2_le_s="~lib/builtins/i64x2.le_s",e.i64x2_le_u="~lib/builtins/i64x2.le_u",e.i64x2_gt_s="~lib/builtins/i64x2.gt_s",e.i64x2_gt_u="~lib/builtins/i64x2.gt_u",e.i64x2_ge_s="~lib/builtins/i64x2.ge_s",e.i64x2_ge_u="~lib/builtins/i64x2.ge_u",e.i64x2_extend_low_i32x4_s="~lib/builtins/i64x2.extend_low_i32x4_s",e.i64x2_extend_low_i32x4_u="~lib/builtins/i64x2.extend_low_i32x4_u",e.i64x2_extend_high_i32x4_s="~lib/builtins/i64x2.extend_high_i32x4_s",e.i64x2_extend_high_i32x4_u="~lib/builtins/i64x2.extend_high_i32x4_u",e.f32x4_splat="~lib/builtins/f32x4.splat",e.f32x4_extract_lane="~lib/builtins/f32x4.extract_lane",e.f32x4_replace_lane="~lib/builtins/f32x4.replace_lane",e.f32x4_add="~lib/builtins/f32x4.add",e.f32x4_sub="~lib/builtins/f32x4.sub",e.f32x4_mul="~lib/builtins/f32x4.mul",e.f32x4_div="~lib/builtins/f32x4.div",e.f32x4_neg="~lib/builtins/f32x4.neg",e.f32x4_min="~lib/builtins/f32x4.min",e.f32x4_max="~lib/builtins/f32x4.max",e.f32x4_pmin="~lib/builtins/f32x4.pmin",e.f32x4_pmax="~lib/builtins/f32x4.pmax",e.f32x4_abs="~lib/builtins/f32x4.abs",e.f32x4_sqrt="~lib/builtins/f32x4.sqrt",e.f32x4_ceil="~lib/builtins/f32x4.ceil",e.f32x4_floor="~lib/builtins/f32x4.floor",e.f32x4_trunc="~lib/builtins/f32x4.trunc",e.f32x4_nearest="~lib/builtins/f32x4.nearest",e.f32x4_eq="~lib/builtins/f32x4.eq",e.f32x4_ne="~lib/builtins/f32x4.ne",e.f32x4_lt="~lib/builtins/f32x4.lt",e.f32x4_le="~lib/builtins/f32x4.le",e.f32x4_gt="~lib/builtins/f32x4.gt",e.f32x4_ge="~lib/builtins/f32x4.ge",e.f32x4_convert_i32x4_s="~lib/builtins/f32x4.convert_i32x4_s",e.f32x4_convert_i32x4_u="~lib/builtins/f32x4.convert_i32x4_u",e.f64x2_splat="~lib/builtins/f64x2.splat",e.f64x2_extract_lane="~lib/builtins/f64x2.extract_lane",e.f64x2_replace_lane="~lib/builtins/f64x2.replace_lane",e.f64x2_add="~lib/builtins/f64x2.add",e.f64x2_sub="~lib/builtins/f64x2.sub",e.f64x2_mul="~lib/builtins/f64x2.mul",e.f64x2_div="~lib/builtins/f64x2.div",e.f64x2_neg="~lib/builtins/f64x2.neg",e.f64x2_min="~lib/builtins/f64x2.min",e.f64x2_max="~lib/builtins/f64x2.max",e.f64x2_pmin="~lib/builtins/f64x2.pmin",e.f64x2_pmax="~lib/builtins/f64x2.pmax",e.f64x2_abs="~lib/builtins/f64x2.abs",e.f64x2_sqrt="~lib/builtins/f64x2.sqrt",e.f64x2_ceil="~lib/builtins/f64x2.ceil",e.f64x2_floor="~lib/builtins/f64x2.floor",e.f64x2_trunc="~lib/builtins/f64x2.trunc",e.f64x2_nearest="~lib/builtins/f64x2.nearest",e.f64x2_eq="~lib/builtins/f64x2.eq",e.f64x2_ne="~lib/builtins/f64x2.ne",e.f64x2_lt="~lib/builtins/f64x2.lt",e.f64x2_le="~lib/builtins/f64x2.le",e.f64x2_gt="~lib/builtins/f64x2.gt",e.f64x2_ge="~lib/builtins/f64x2.ge",e.i31_new="~lib/builtins/i31.new",e.i31_get="~lib/builtins/i31.get",e.data_end="~lib/memory/__data_end",e.stack_pointer="~lib/memory/__stack_pointer",e.heap_base="~lib/memory/__heap_base",e.rtti_base="~lib/rt/__rtti_base",e.visit_globals="~lib/rt/__visit_globals",e.visit_members="~lib/rt/__visit_members",e.tostack="~lib/rt/__tostack",e.isNaN="~lib/number/isNaN",e.isFinite="~lib/number/isFinite",e.ERROR="~lib/diagnostics/ERROR",e.WARNING="~lib/diagnostics/WARNING",e.INFO="~lib/diagnostics/INFO",e.Function="~lib/function/Function",e.memory_size="~lib/memory/memory.size",e.memory_grow="~lib/memory/memory.grow",e.memory_copy="~lib/memory/memory.copy",e.memory_fill="~lib/memory/memory.fill",e.memory_data="~lib/memory/memory.data",e.Int8Array="~lib/typedarray/Int8Array",e.Uint8Array="~lib/typedarray/Uint8Array",e.Uint8ClampedArray="~lib/typedarray/Uint8ClampedArray",e.Int16Array="~lib/typedarray/Int16Array",e.Uint16Array="~lib/typedarray/Uint16Array",e.Int32Array="~lib/typedarray/Int32Array",e.Uint32Array="~lib/typedarray/Uint32Array",e.Int64Array="~lib/typedarray/Int64Array",e.Uint64Array="~lib/typedarray/Uint64Array",e.Float32Array="~lib/typedarray/Float32Array",e.Float64Array="~lib/typedarray/Float64Array",e.String_raw="~lib/string/String.raw",e.wasiAbort="~lib/wasi/index/abort",e.wasiTrace="~lib/wasi/index/trace",e.wasiSeed="~lib/wasi/index/seed"}(_=t.BuiltinNames||(t.BuiltinNames={}));function h(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,1))return r.unreachable();var n=e.typeArguments,o=n?t.compileExpression(e.operands[0],n[0],5):t.compileExpression(e.operands[0],s.Type.i32,4),l=t.currentType;if(l.isValue)switch(l.kind){case 10:case 0:case 5:case 1:case 6:case 2:case 7:return r.unary(a.UnaryOp.ClzI32,o);case 9:case 4:return r.unary(t.options.isWasm64?a.UnaryOp.ClzI64:a.UnaryOp.ClzI32,o);case 3:case 8:return r.unary(a.UnaryOp.ClzI64,o)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"clz",l.toString()),r.unreachable()}function d(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],5):t.compileExpression(n[0],s.Type.i32,4),u=t.currentType;if(u.isValue)switch(u.kind){case 10:case 0:case 5:case 1:case 6:case 2:case 7:return r.unary(a.UnaryOp.CtzI32,l);case 9:case 4:return r.unary(t.options.isWasm64?a.UnaryOp.CtzI64:a.UnaryOp.CtzI32,l);case 3:case 8:return r.unary(a.UnaryOp.CtzI64,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"ctz",u.toString()),r.unreachable()}function m(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],5):t.compileExpression(n[0],s.Type.i32,4),u=t.currentType;if(u.isValue)switch(t.currentType.kind){case 10:return l;case 0:case 5:case 1:case 6:case 2:case 7:return r.unary(a.UnaryOp.PopcntI32,l);case 3:case 8:return r.unary(a.UnaryOp.PopcntI64,l);case 4:case 9:return r.unary(t.options.isWasm64?a.UnaryOp.PopcntI64:a.UnaryOp.PopcntI32,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"popcnt",u.toString()),r.unreachable()}function y(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,o=e.typeArguments,u=o?t.compileExpression(n[0],o[0],5):t.compileExpression(n[0],s.Type.i32,4),c=t.currentType;if(c.isValue){let e=t.compileExpression(n[1],c,1);switch(c.kind){case 10:return u;case 0:case 1:case 5:case 6:{let i=t.currentFlow,n=i.getTempLocal(c,l.findUsedLocals(e));i.setLocalFlag(n.index,l.LocalFlags.WRAPPED);let s=i.getTempLocal(c);i.setLocalFlag(s.index,l.LocalFlags.WRAPPED);let o=r.binary(a.BinaryOp.OrI32,r.binary(a.BinaryOp.ShlI32,r.local_tee(n.index,u,!1),r.binary(a.BinaryOp.AndI32,r.local_tee(s.index,e,!1),r.i32(c.size-1))),r.binary(a.BinaryOp.ShrU32,r.local_get(n.index,a.NativeType.I32),r.binary(a.BinaryOp.AndI32,r.binary(a.BinaryOp.SubI32,r.i32(0),r.local_get(s.index,a.NativeType.I32)),r.i32(c.size-1))));return i.freeTempLocal(s),i.freeTempLocal(n),o}case 2:case 7:return r.binary(a.BinaryOp.RotlI32,u,e);case 9:case 4:return r.binary(t.options.isWasm64?a.BinaryOp.RotlI64:a.BinaryOp.RotlI32,u,e);case 3:case 8:return r.binary(a.BinaryOp.RotlI64,u,e)}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"rotl",c.toString()),r.unreachable()}function T(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,o=e.typeArguments,u=o?t.compileExpression(n[0],o[0],5):t.compileExpression(n[0],s.Type.i32,4),c=t.currentType;if(c.isValue){let e=t.compileExpression(n[1],c,1);switch(c.kind){case 10:return u;case 0:case 1:case 5:case 6:{let i=t.currentFlow,n=i.getTempLocal(c,l.findUsedLocals(e));i.setLocalFlag(n.index,l.LocalFlags.WRAPPED);let s=i.getTempLocal(c);i.setLocalFlag(s.index,l.LocalFlags.WRAPPED);let o=r.binary(a.BinaryOp.OrI32,r.binary(a.BinaryOp.ShrU32,r.local_tee(n.index,u,!1),r.binary(a.BinaryOp.AndI32,r.local_tee(s.index,e,!1),r.i32(c.size-1))),r.binary(a.BinaryOp.ShlI32,r.local_get(n.index,a.NativeType.I32),r.binary(a.BinaryOp.AndI32,r.binary(a.BinaryOp.SubI32,r.i32(0),r.local_get(s.index,a.NativeType.I32)),r.i32(c.size-1))));return i.freeTempLocal(s),i.freeTempLocal(n),o}case 2:case 7:return r.binary(a.BinaryOp.RotrI32,u,e);case 9:case 4:return r.binary(t.options.isWasm64?a.BinaryOp.RotrI64:a.BinaryOp.RotrI32,u,e);case 3:case 8:return r.binary(a.BinaryOp.RotrI64,u,e)}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"rotr",c.toString()),r.unreachable()}function g(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],5):t.compileExpression(n[0],s.Type.auto,4),u=t.currentType;if(u.isValue)switch(u.kind){case 0:case 1:case 2:{let e=t.currentFlow,i=e.getTempLocal(s.Type.i32),n=e.getTempLocal(s.Type.i32),o=r.binary(a.BinaryOp.XorI32,r.binary(a.BinaryOp.AddI32,r.local_tee(n.index,r.binary(a.BinaryOp.ShrI32,r.local_tee(i.index,l,!1),r.i32(31)),!1),r.local_get(i.index,a.NativeType.I32)),r.local_get(n.index,a.NativeType.I32));return e.freeTempLocal(n),e.freeTempLocal(i),o}case 4:{let e=t.options,i=t.currentFlow,n=e.isWasm64,s=i.getTempLocal(e.usizeType),o=i.getTempLocal(e.usizeType),u=r.binary(n?a.BinaryOp.XorI64:a.BinaryOp.XorI32,r.binary(n?a.BinaryOp.AddI64:a.BinaryOp.AddI32,r.local_tee(o.index,r.binary(n?a.BinaryOp.ShrI64:a.BinaryOp.ShrI32,r.local_tee(s.index,l,!1),n?r.i64(63):r.i32(31)),!1),r.local_get(s.index,e.nativeSizeType)),r.local_get(o.index,e.nativeSizeType));return i.freeTempLocal(o),i.freeTempLocal(s),u}case 3:{let e=t.currentFlow,i=e.getTempLocal(s.Type.i64),n=e.getTempLocal(s.Type.i64),o=r.binary(a.BinaryOp.XorI64,r.binary(a.BinaryOp.AddI64,r.local_tee(n.index,r.binary(a.BinaryOp.ShrI64,r.local_tee(i.index,l,!1),r.i64(63)),!1),r.local_get(i.index,a.NativeType.I64)),r.local_get(n.index,a.NativeType.I64));return e.freeTempLocal(n),e.freeTempLocal(i),o}case 9:case 5:case 6:case 7:case 8:case 10:return l;case 11:return r.unary(a.UnaryOp.AbsF32,l);case 12:return r.unary(a.UnaryOp.AbsF64,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"abs",u.toString()),r.unreachable()}function f(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,o=e.typeArguments,u=n[0],c=o?t.compileExpression(u,o[0],5):t.compileExpression(n[0],s.Type.auto,4),p=t.currentType;if(p.isValue){let e;!o&&u.isNumericLiteral?(e=t.compileExpression(n[1],p,4),t.currentType!=p&&(c=t.compileExpression(u,p=t.currentType,5))):e=t.compileExpression(n[1],p,5);let i=-1;switch(p.kind){case 0:case 1:case 2:i=a.BinaryOp.GtI32;break;case 5:case 6:case 7:case 10:i=a.BinaryOp.GtU32;break;case 3:i=a.BinaryOp.GtI64;break;case 8:i=a.BinaryOp.GtU64;break;case 4:i=t.options.isWasm64?a.BinaryOp.GtI64:a.BinaryOp.GtI32;break;case 9:i=t.options.isWasm64?a.BinaryOp.GtU64:a.BinaryOp.GtU32;break;case 11:return r.binary(a.BinaryOp.MaxF32,c,e);case 12:return r.binary(a.BinaryOp.MaxF64,c,e)}if(-1!=i){let n=t.currentFlow,s=p.toNativeType(),a=n.getTempLocal(p,l.findUsedLocals(e));n.setLocalFlag(a.index,l.LocalFlags.WRAPPED);let o=n.getTempLocal(p);n.setLocalFlag(o.index,l.LocalFlags.WRAPPED);let u=r.select(r.local_tee(a.index,c,!1),r.local_tee(o.index,e,!1),r.binary(i,r.local_get(a.index,s),r.local_get(o.index,s)));return n.freeTempLocal(o),n.freeTempLocal(a),u}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"max",p.toString()),r.unreachable()}function E(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,o=e.typeArguments,u=n[0],c=o?t.compileExpression(u,o[0],5):t.compileExpression(n[0],s.Type.auto,4),p=t.currentType;if(p.isValue){let e;!o&&u.isNumericLiteral?(e=t.compileExpression(n[1],p,4),t.currentType!=p&&(c=t.compileExpression(u,p=t.currentType,5))):e=t.compileExpression(n[1],p,5);let i=-1;switch(p.kind){case 0:case 1:case 2:i=a.BinaryOp.LtI32;break;case 5:case 6:case 7:case 10:i=a.BinaryOp.LtU32;break;case 3:i=a.BinaryOp.LtI64;break;case 8:i=a.BinaryOp.LtU64;break;case 4:i=t.options.isWasm64?a.BinaryOp.LtI64:a.BinaryOp.LtI32;break;case 9:i=t.options.isWasm64?a.BinaryOp.LtU64:a.BinaryOp.LtU32;break;case 11:return r.binary(a.BinaryOp.MinF32,c,e);case 12:return r.binary(a.BinaryOp.MinF64,c,e)}if(-1!=i){let n=t.currentFlow,s=p.toNativeType(),a=n.getTempLocal(p,l.findUsedLocals(e));n.setLocalFlag(a.index,l.LocalFlags.WRAPPED);let o=n.getTempLocal(p);n.setLocalFlag(o.index,l.LocalFlags.WRAPPED);let u=r.select(r.local_tee(a.index,c,!1),r.local_tee(o.index,e,!1),r.binary(i,r.local_get(a.index,s),r.local_get(o.index,s)));return n.freeTempLocal(o),n.freeTempLocal(a),u}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"min",p.toString()),r.unreachable()}function b(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],1):t.compileExpression(n[0],s.Type.auto,0),u=t.currentType;if(u.isValue)switch(u.kind){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return l;case 11:return r.unary(a.UnaryOp.CeilF32,l);case 12:return r.unary(a.UnaryOp.CeilF64,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"ceil",u.toString()),r.unreachable()}function x(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],1):t.compileExpression(n[0],s.Type.auto,0),u=t.currentType;if(u.isValue)switch(u.kind){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return l;case 11:return r.unary(a.UnaryOp.FloorF32,l);case 12:return r.unary(a.UnaryOp.FloorF64,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"floor",u.toString()),r.unreachable()}function I(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],1):t.compileExpression(n[0],s.Type.f64,0),u=t.currentType;if(u.isValue){let e=t.compileExpression(n[1],u,1);switch(u.kind){case 11:return r.binary(a.BinaryOp.CopysignF32,l,e);case 12:return r.binary(a.BinaryOp.CopysignF64,l,e)}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"copysign",u.toString()),r.unreachable()}function A(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],1):t.compileExpression(n[0],s.Type.auto,0),u=t.currentType;if(u.isValue)switch(u.kind){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return l;case 11:return r.unary(a.UnaryOp.NearestF32,l);case 12:return r.unary(a.UnaryOp.NearestF64,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"nearest",u.toString()),r.unreachable()}function N(e){var t=e.compiler,r=t.module;if(Ve(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,o=e.typeArguments[0];if(o.isValue)switch(o.kind){case 2:case 7:{let e=t.compileExpression(n[0],s.Type.f32,1);return t.currentType=o,r.unary(a.UnaryOp.ReinterpretF32,e)}case 3:case 8:{let e=t.compileExpression(n[0],s.Type.f64,1);return t.currentType=o,r.unary(a.UnaryOp.ReinterpretF64,e)}case 4:case 9:{let e=t.compileExpression(n[0],t.options.isWasm64?s.Type.f64:s.Type.f32,1);return t.currentType=o,r.unary(t.options.isWasm64?a.UnaryOp.ReinterpretF64:a.UnaryOp.ReinterpretF32,e)}case 11:{let e=t.compileExpression(n[0],s.Type.i32,1);return t.currentType=s.Type.f32,r.unary(a.UnaryOp.ReinterpretI32,e)}case 12:{let e=t.compileExpression(n[0],s.Type.i64,1);return t.currentType=s.Type.f64,r.unary(a.UnaryOp.ReinterpretI64,e)}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"reinterpret",o.toString()),r.unreachable()}function S(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],1):t.compileExpression(n[0],s.Type.f64,0),u=t.currentType;if(u.isValue)switch(u.kind){case 11:return r.unary(a.UnaryOp.SqrtF32,l);case 12:return r.unary(a.UnaryOp.SqrtF64,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"sqrt",u.toString()),r.unreachable()}function v(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],1):t.compileExpression(n[0],s.Type.auto,0),u=t.currentType;if(u.isValue)switch(u.kind){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return l;case 11:return r.unary(a.UnaryOp.TruncF32,l);case 12:return r.unary(a.UnaryOp.TruncF64,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"trunc",u.toString()),r.unreachable()}function C(e){var t=e.compiler,r=t.module;if(Ve(e,!0)|He(e,1,3))return r.unreachable();var i=e.operands,n=e.typeArguments,a=e.contextualType,o=n[0],l=a!=s.Type.auto&&o.isIntegerValue&&a.isIntegerValue&&a.size>o.size?a:o,u=t.compileExpression(i[0],t.options.usizeType,1),c=i.length,p=0,_=o.byteSize;if(c>=2){if((p=Me(i[1],t))<0)return t.currentType=l,r.unreachable();if(3==c&&(_=Ge(i[2],_,t))<0)return t.currentType=l,r.unreachable()}return t.currentType=l,r.load(o.byteSize,o.isSignedIntegerValue,u,l.toNativeType(),p,_)}function O(e){var t=e.compiler,r=t.module;if(t.currentType=s.Type.void,Ve(e)|He(e,2,4))return r.unreachable();var i=e.operands,n=i.length,a=e.typeArguments,o=e.contextualType,l=a[0],u=t.compileExpression(i[0],t.options.usizeType,1),c=e.contextIsExact?t.compileExpression(i[1],o,1):t.compileExpression(i[1],l,l.isIntegerValue?0:1),p=t.currentType;l.isIntegerValue&&(!p.isIntegerValue||p.size<l.size)&&(c=t.convertExpression(c,p,l,!1,i[1]),p=l);var _=0,h=l.byteSize;if(n>=3){if((_=Me(i[2],t))<0)return t.currentType=s.Type.void,r.unreachable();if(4==n&&(h=Ge(i[3],h,t))<0)return t.currentType=s.Type.void,r.unreachable()}return t.currentType=s.Type.void,r.store(l.byteSize,u,c,p.toNativeType(),_,h)}function R(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,a=e.typeArguments,o=n[0],l=a?t.compileExpression(o,a[0],1):t.compileExpression(n[0],s.Type.auto),u=t.currentType;if(u.isValue){let e;if(!a&&o.isNumericLiteral?(e=t.compileExpression(n[1],u),t.currentType!=u&&(l=t.compileExpression(o,u=t.currentType,1))):e=t.compileExpression(n[1],u,1),u.isNumericValue)return t.makeAdd(l,e,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"add",u.toString()),r.unreachable()}function k(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,a=e.typeArguments,o=n[0],l=a?t.compileExpression(o,a[0],1):t.compileExpression(n[0],s.Type.auto),u=t.currentType;if(u.isValue){let e;if(!a&&o.isNumericLiteral?(e=t.compileExpression(n[1],u),t.currentType!=u&&(l=t.compileExpression(o,u=t.currentType,1))):e=t.compileExpression(n[1],u,1),u.isNumericValue)return t.makeSub(l,e,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"sub",u.toString()),r.unreachable()}function L(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,a=e.typeArguments,o=n[0],l=a?t.compileExpression(o,a[0],1):t.compileExpression(n[0],s.Type.auto),u=t.currentType;if(u.isValue){let e;if(!a&&o.isNumericLiteral?(e=t.compileExpression(n[1],u),t.currentType!=u&&(l=t.compileExpression(o,u=t.currentType,1))):e=t.compileExpression(n[1],u,1),u.isNumericValue)return t.makeMul(l,e,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"mul",u.toString()),r.unreachable()}function F(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,a=e.typeArguments,o=n[0],l=a?t.compileExpression(o,a[0],1):t.compileExpression(n[0],s.Type.auto),u=t.currentType;if(u.isValue){let e;if(!a&&o.isNumericLiteral?(e=t.compileExpression(n[1],u),t.currentType!=u&&(l=t.compileExpression(o,u=t.currentType,1))):e=t.compileExpression(n[1],u,1),u.isNumericValue)return t.makeDiv(l,e,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"div",u.toString()),r.unreachable()}function D(e){var t=e.compiler,r=t.module;if(Ke(e,32)|Ve(e,!0)|He(e,1,2))return r.unreachable();var n=e.operands,s=e.typeArguments,a=e.contextualType,o=s[0],l=o.isIntegerValue&&a.isIntegerValue&&a.size>o.size?a:o;if(!o.isIntegerValue)return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"atomic.load",o.toString()),t.currentType=l,r.unreachable();var u=t.compileExpression(n[0],t.options.usizeType,1),c=2==n.length?Me(n[1],t):0;return c<0?(t.currentType=l,r.unreachable()):(t.currentType=l,r.atomic_load(o.byteSize,u,l.toNativeType(),c))}function P(e){var t=e.compiler,r=t.module;if(Ke(e,32)|Ve(e)|He(e,2,3))return r.unreachable();var n=e.operands,a=e.typeArguments,o=e.contextualType,l=a[0];if(!l.isIntegerValue)return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"atomic.store",l.toString()),t.currentType=s.Type.void,r.unreachable();var u=t.compileExpression(n[0],t.options.usizeType,1),c=e.contextIsExact?t.compileExpression(n[1],o,1):t.compileExpression(n[1],l,l.isIntegerValue?0:1),p=t.currentType;l.isIntegerValue&&(!p.isIntegerValue||p.size<l.size)&&(c=t.convertExpression(c,p,l,!1,n[1]),p=l);var _=3==n.length?Me(n[2],t):0;return _<0?(t.currentType=s.Type.void,r.unreachable()):(t.currentType=s.Type.void,r.atomic_store(l.byteSize,u,c,p.toNativeType(),_))}function w(e,t,r){var n=e.compiler,s=n.module;if(Ke(e,32)|Ve(e,!0)|He(e,2,3))return s.unreachable();var a=e.operands,o=e.typeArguments,l=e.contextualType,u=o[0];if(!u.isIntegerValue||u.size<8)return n.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,r,u.toString()),s.unreachable();var c=n.compileExpression(a[0],n.options.usizeType,1),p=e.contextIsExact?n.compileExpression(a[1],l,1):n.compileExpression(a[1],u,u.isIntegerValue?0:1),_=n.currentType;u.isIntegerValue&&(!_.isIntegerValue||_.size<u.size)&&(p=n.convertExpression(p,_,u,!1,a[1]),_=u);var h=3==a.length?Me(a[2],n):0;return h<0?(n.currentType=_,s.unreachable()):(n.currentType=_,s.atomic_rmw(t,u.byteSize,h,c,p,_.toNativeType()))}function B(e){return w(e,a.AtomicRMWOp.Add,"atomic.add")}function U(e){return w(e,a.AtomicRMWOp.Sub,"atomic.sub")}function M(e){return w(e,a.AtomicRMWOp.And,"atomic.and")}function G(e){return w(e,a.AtomicRMWOp.Or,"atomic.or")}function K(e){return w(e,a.AtomicRMWOp.Xor,"atomic.xor")}function V(e){return w(e,a.AtomicRMWOp.Xchg,"atomic.xchg")}function z(e){var t=e.compiler,r=t.module;if(Ke(e,32)|Ve(e,!0)|He(e,3,4))return r.unreachable();var n=e.operands,s=e.typeArguments,a=e.contextualType,o=s[0];if(!o.isIntegerValue||o.size<8)return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"atomic.cmpxchg",o.toString()),r.unreachable();var l=t.compileExpression(n[0],t.options.usizeType,1),u=e.contextIsExact?t.compileExpression(n[1],a,1):t.compileExpression(n[1],o,o.isIntegerValue?0:1),c=t.currentType,p=t.compileExpression(n[2],c,1);o.isIntegerValue&&(!c.isIntegerValue||c.size<o.size)&&(u=t.convertExpression(u,c,o,!1,n[1]),p=t.convertExpression(p,c,o,!1,n[2]),c=o);var _=4==n.length?Me(n[3],t):0;return _<0?(t.currentType=c,r.unreachable()):(t.currentType=c,r.atomic_cmpxchg(o.byteSize,_,l,u,p,c.toNativeType()))}function W(e){var t=e.compiler,r=t.module;if(Ke(e,32)|Ve(e)|Ye(e,3))return t.currentType=s.Type.i32,r.unreachable();var n=e.operands,a=e.typeArguments[0],o=t.compileExpression(n[0],t.options.usizeType,1),l=t.compileExpression(n[1],a,1),u=t.compileExpression(n[2],s.Type.i64,1);switch(t.currentType=s.Type.i32,a.kind){case 2:case 3:case 4:case 7:case 8:case 9:return r.atomic_wait(o,l,u,a.toNativeType())}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"atomic.wait",a.toString()),r.unreachable()}function Y(e,t){var r=e.compiler,n=r.module;We(e);var s=e.operands,a=e.reportNode;return r.emitDiagnostic(i.DiagnosticCode.User_defined_0,t,a.range,null,s.length?s[0].range.toString():a.range.toString()),t==i.DiagnosticCategory.ERROR?n.unreachable():n.nop()}function H(e,t){var r=e.compiler;return We(e)|Ye(e,1)?(r.currentType=t,r.module.unreachable()):r.compileExpression(e.operands[0],t,2)}function X(e){var t=e.compiler,r=t.module;if(Ke(e,16)|We(e)|Ye(e,16))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=new Uint8Array(16);for(let e=0;e<16;++e){let l=t.compileExpression(n[e],s.Type.i8,1),u=r.runExpression(l,a.ExpressionRunnerFlags.PreserveSideeffects);u?p.writeI8(a.getConstValueI32(u),o,e):t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,n[e].range)}return t.currentType=s.Type.v128,r.v128(o)}function q(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],o,1);if(t.currentType=s.Type.v128,o.isValue)switch(o.kind){case 0:case 5:return r.unary(a.UnaryOp.SplatI8x16,l);case 1:case 6:return r.unary(a.UnaryOp.SplatI16x8,l);case 2:case 7:return r.unary(a.UnaryOp.SplatI32x4,l);case 3:case 8:return r.unary(a.UnaryOp.SplatI64x2,l);case 4:case 9:return r.unary(t.options.isWasm64?a.UnaryOp.SplatI64x2:a.UnaryOp.SplatI32x4,l);case 11:return r.unary(a.UnaryOp.SplatF32x4,l);case 12:return r.unary(a.UnaryOp.SplatF64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.splat",o.toString()),r.unreachable()}function Q(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e,!0)|Ye(e,2))return r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.u8,1);t.currentType=o;var c=0,p=r.runExpression(u,a.ExpressionRunnerFlags.PreserveSideeffects);if(p?c=a.getConstValueI32(p):t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,n[1].range),o.isValue){let e=16/assert(o.byteSize)-1;switch((c<0||c>e)&&(t.error(i.DiagnosticCode._0_must_be_a_value_between_1_and_2_inclusive,n[1].range,"Lane index","0",e.toString()),c=0),o.kind){case 0:return r.simd_extract(a.SIMDExtractOp.ExtractLaneI8x16,l,c);case 5:return r.simd_extract(a.SIMDExtractOp.ExtractLaneU8x16,l,c);case 1:return r.simd_extract(a.SIMDExtractOp.ExtractLaneI16x8,l,c);case 6:return r.simd_extract(a.SIMDExtractOp.ExtractLaneU16x8,l,c);case 2:case 7:return r.simd_extract(a.SIMDExtractOp.ExtractLaneI32x4,l,c);case 3:case 8:return r.simd_extract(a.SIMDExtractOp.ExtractLaneI64x2,l,c);case 4:case 9:return r.simd_extract(t.options.isWasm64?a.SIMDExtractOp.ExtractLaneI64x2:a.SIMDExtractOp.ExtractLaneI32x4,l,c);case 11:return r.simd_extract(a.SIMDExtractOp.ExtractLaneF32x4,l,c);case 12:return r.simd_extract(a.SIMDExtractOp.ExtractLaneF64x2,l,c)}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.extract_lane",o.toString()),r.unreachable()}function j(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,3))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.u8,1),c=t.compileExpression(n[2],o,1);t.currentType=s.Type.v128;var p=0,_=r.runExpression(u,a.ExpressionRunnerFlags.PreserveSideeffects);if(_?p=a.getConstValueI32(_):t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,n[1].range),o.isValue){let e=16/assert(o.byteSize)-1;switch((p<0||p>e)&&(t.error(i.DiagnosticCode._0_must_be_a_value_between_1_and_2_inclusive,n[1].range,"Lane index","0",e.toString()),p=0),o.kind){case 0:case 5:return r.simd_replace(a.SIMDReplaceOp.ReplaceLaneI8x16,l,p,c);case 1:case 6:return r.simd_replace(a.SIMDReplaceOp.ReplaceLaneI16x8,l,p,c);case 2:case 7:return r.simd_replace(a.SIMDReplaceOp.ReplaceLaneI32x4,l,p,c);case 3:case 8:return r.simd_replace(a.SIMDReplaceOp.ReplaceLaneI64x2,l,p,c);case 4:case 9:return r.simd_replace(t.options.isWasm64?a.SIMDReplaceOp.ReplaceLaneI64x2:a.SIMDReplaceOp.ReplaceLaneI32x4,l,p,c);case 11:return r.simd_replace(a.SIMDReplaceOp.ReplaceLaneF32x4,l,p,c);case 12:return r.simd_replace(a.SIMDReplaceOp.ReplaceLaneF64x2,l,p,c)}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.replace_lane",o.toString()),r.unreachable()}function Z(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0];if(o.isValue){let l=o.byteSize,u=16/l;if(assert(isInteger(u)&&p.isPowerOf2(u)),Ye(e,2+u))return t.currentType=s.Type.v128,r.unreachable();let c=t.compileExpression(n[0],s.Type.v128,1),_=t.compileExpression(n[1],s.Type.v128,1);switch(o.kind){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 11:case 12:{let e=new Uint8Array(16),o=(u<<1)-1;for(let c=0;c<u;++c){let u=n[2+c],_=t.compileExpression(u,s.Type.u8,1),h=r.runExpression(_,a.ExpressionRunnerFlags.PreserveSideeffects),d=0;switch(h?(d=a.getConstValueI32(h),(d<0||d>o)&&(t.error(i.DiagnosticCode._0_must_be_a_value_between_1_and_2_inclusive,u.range,"Lane index","0",o.toString()),d=0)):t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,u.range),l){case 1:p.writeI8(d,e,c);break;case 2:{let t=c<<1,r=d<<1;p.writeI8(r,e,t),p.writeI8(r+1,e,t+1);break}case 4:{let t=c<<2,r=d<<2;p.writeI8(r,e,t),p.writeI8(r+1,e,t+1),p.writeI8(r+2,e,t+2),p.writeI8(r+3,e,t+3);break}case 8:{let t=c<<3,r=d<<3;p.writeI8(r,e,t),p.writeI8(r+1,e,t+1),p.writeI8(r+2,e,t+2),p.writeI8(r+3,e,t+3),p.writeI8(r+4,e,t+4),p.writeI8(r+5,e,t+5),p.writeI8(r+6,e,t+6),p.writeI8(r+7,e,t+7);break}default:assert(!1)}}return t.currentType=s.Type.v128,r.simd_shuffle(c,_,e)}}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.shuffle",o.toString()),t.currentType=s.Type.v128,r.unreachable()}function J(e){var t=e.compiler,r=t.module;if(Ke(e,16)|We(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var i=e.operands,n=t.compileExpression(i[0],s.Type.v128,1),o=t.compileExpression(i[1],s.Type.v128,1);return r.binary(a.BinaryOp.SwizzleV8x16,n,o)}function $(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e,!0)|He(e,1,3))return r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],t.options.usizeType,1),u=n.length,c=0,p=o.byteSize;if(u>=2){if((c=Me(n[1],t))<0)return t.currentType=s.Type.v128,r.unreachable();if(3==u&&(p=Ge(n[2],p,t))<0)return t.currentType=s.Type.v128,r.unreachable()}if(t.currentType=s.Type.v128,o.isValue)switch(o.kind){case 0:case 5:return r.simd_load(a.SIMDLoadOp.LoadSplatV8x16,l,c,p);case 1:case 6:return r.simd_load(a.SIMDLoadOp.LoadSplatV16x8,l,c,p);case 2:case 7:case 11:return r.simd_load(a.SIMDLoadOp.LoadSplatV32x4,l,c,p);case 4:case 9:if(!t.options.isWasm64)return r.simd_load(a.SIMDLoadOp.LoadSplatV32x4,l,c,p);case 3:case 8:case 12:return r.simd_load(a.SIMDLoadOp.LoadSplatV64x2,l,c,p)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.load_splat",o.toString()),r.unreachable()}function ee(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e,!0)|He(e,1,3))return r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],t.options.usizeType,1),u=n.length,c=0,p=o.byteSize;if(u>=2){if((c=Me(n[1],t))<0)return t.currentType=s.Type.v128,r.unreachable();if(3==u&&(p=Ge(n[2],p,t))<0)return t.currentType=s.Type.v128,r.unreachable()}if(t.currentType=s.Type.v128,o.isValue)switch(o.kind){case 0:return r.simd_load(a.SIMDLoadOp.LoadI8ToI16x8,l,c,p);case 5:return r.simd_load(a.SIMDLoadOp.LoadU8ToU16x8,l,c,p);case 1:return r.simd_load(a.SIMDLoadOp.LoadI16ToI32x4,l,c,p);case 6:return r.simd_load(a.SIMDLoadOp.LoadU16ToU32x4,l,c,p);case 4:if(t.options.isWasm64)break;case 2:return r.simd_load(a.SIMDLoadOp.LoadI32ToI64x2,l,c,p);case 9:if(t.options.isWasm64)break;case 7:return r.simd_load(a.SIMDLoadOp.LoadU32ToU64x2,l,c,p)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.load_ext",o.toString()),r.unreachable()}function te(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:case 5:return r.binary(a.BinaryOp.AddI8x16,l,u);case 1:case 6:return r.binary(a.BinaryOp.AddI16x8,l,u);case 2:case 7:return r.binary(a.BinaryOp.AddI32x4,l,u);case 3:case 8:return r.binary(a.BinaryOp.AddI64x2,l,u);case 4:case 9:return r.binary(t.options.isWasm64?a.BinaryOp.AddI64x2:a.BinaryOp.AddI32x4,l,u);case 11:return r.binary(a.BinaryOp.AddF32x4,l,u);case 12:return r.binary(a.BinaryOp.AddF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.add",o.toString()),r.unreachable()}function re(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:case 5:return r.binary(a.BinaryOp.SubI8x16,l,u);case 1:case 6:return r.binary(a.BinaryOp.SubI16x8,l,u);case 2:case 7:return r.binary(a.BinaryOp.SubI32x4,l,u);case 3:case 8:return r.binary(a.BinaryOp.SubI64x2,l,u);case 4:case 9:return r.binary(t.options.isWasm64?a.BinaryOp.SubI64x2:a.BinaryOp.SubI32x4,l,u);case 11:return r.binary(a.BinaryOp.SubF32x4,l,u);case 12:return r.binary(a.BinaryOp.SubF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.sub",o.toString()),r.unreachable()}function ie(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 1:case 6:return r.binary(a.BinaryOp.MulI16x8,l,u);case 2:case 7:return r.binary(a.BinaryOp.MulI32x4,l,u);case 3:case 8:return r.binary(a.BinaryOp.MulI64x2,l,u);case 4:case 9:return r.binary(t.options.isWasm64?a.BinaryOp.MulI64x2:a.BinaryOp.MulI32x4,l,u);case 11:return r.binary(a.BinaryOp.MulF32x4,l,u);case 12:return r.binary(a.BinaryOp.MulF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.mul",o.toString()),r.unreachable()}function ne(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 11:return r.binary(a.BinaryOp.DivF32x4,l,u);case 12:return r.binary(a.BinaryOp.DivF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.div",o.toString()),r.unreachable()}function se(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.binary(a.BinaryOp.AddSatI8x16,l,u);case 5:return r.binary(a.BinaryOp.AddSatU8x16,l,u);case 1:return r.binary(a.BinaryOp.AddSatI16x8,l,u);case 6:return r.binary(a.BinaryOp.AddSatU16x8,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.add_sat",o.toString()),r.unreachable()}function ae(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.binary(a.BinaryOp.SubSatI8x16,l,u);case 5:return r.binary(a.BinaryOp.SubSatU8x16,l,u);case 1:return r.binary(a.BinaryOp.SubSatI16x8,l,u);case 6:return r.binary(a.BinaryOp.SubSatU16x8,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.sub_sat",o.toString()),r.unreachable()}function oe(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.binary(a.BinaryOp.MinI8x16,l,u);case 5:return r.binary(a.BinaryOp.MinU8x16,l,u);case 1:return r.binary(a.BinaryOp.MinI16x8,l,u);case 6:return r.binary(a.BinaryOp.MinU16x8,l,u);case 4:if(t.options.isWasm64)break;case 2:return r.binary(a.BinaryOp.MinI32x4,l,u);case 9:if(t.options.isWasm64)break;case 7:return r.binary(a.BinaryOp.MinU32x4,l,u);case 11:return r.binary(a.BinaryOp.MinF32x4,l,u);case 12:return r.binary(a.BinaryOp.MinF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.min",o.toString()),r.unreachable()}function le(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.binary(a.BinaryOp.MaxI8x16,l,u);case 5:return r.binary(a.BinaryOp.MaxU8x16,l,u);case 1:return r.binary(a.BinaryOp.MaxI16x8,l,u);case 6:return r.binary(a.BinaryOp.MaxU16x8,l,u);case 4:if(t.options.isWasm64)break;case 2:return r.binary(a.BinaryOp.MaxI32x4,l,u);case 9:if(t.options.isWasm64)break;case 7:return r.binary(a.BinaryOp.MaxU32x4,l,u);case 11:return r.binary(a.BinaryOp.MaxF32x4,l,u);case 12:return r.binary(a.BinaryOp.MaxF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.max",o.toString()),r.unreachable()}function ue(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 11:return r.binary(a.BinaryOp.PminF32x4,l,u);case 12:return r.binary(a.BinaryOp.PminF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.pmin",o.toString()),r.unreachable()}function ce(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 11:return r.binary(a.BinaryOp.PmaxF32x4,l,u);case 12:return r.binary(a.BinaryOp.PmaxF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.pmax",o.toString()),r.unreachable()}function pe(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 1:return r.binary(a.BinaryOp.DotI16x8,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.dot",o.toString()),r.unreachable()}function _e(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 5:return r.binary(a.BinaryOp.AvgrU8x16,l,u);case 6:return r.binary(a.BinaryOp.AvgrU16x8,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.avgr",o.toString()),r.unreachable()}function he(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:case 5:return r.binary(a.BinaryOp.EqI8x16,l,u);case 1:case 6:return r.binary(a.BinaryOp.EqI16x8,l,u);case 2:case 7:return r.binary(a.BinaryOp.EqI32x4,l,u);case 3:case 8:return r.binary(a.BinaryOp.EqI64x2,l,u);case 4:case 9:return r.binary(t.options.isWasm64?a.BinaryOp.EqI64x2:a.BinaryOp.EqI32x4,l,u);case 11:return r.binary(a.BinaryOp.EqF32x4,l,u);case 12:return r.binary(a.BinaryOp.EqF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.eq",o.toString()),r.unreachable()}function de(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:case 5:return r.binary(a.BinaryOp.NeI8x16,l,u);case 1:case 6:return r.binary(a.BinaryOp.NeI16x8,l,u);case 2:case 7:return r.binary(a.BinaryOp.NeI32x4,l,u);case 3:case 8:return r.binary(a.BinaryOp.NeI64x2,l,u);case 4:case 9:return r.binary(t.options.isWasm64?a.BinaryOp.NeI64x2:a.BinaryOp.NeI32x4,l,u);case 11:return r.binary(a.BinaryOp.NeF32x4,l,u);case 12:return r.binary(a.BinaryOp.NeF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.ne",o.toString()),r.unreachable()}function me(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.binary(a.BinaryOp.LtI8x16,l,u);case 5:return r.binary(a.BinaryOp.LtU8x16,l,u);case 1:return r.binary(a.BinaryOp.LtI16x8,l,u);case 6:return r.binary(a.BinaryOp.LtU16x8,l,u);case 2:return r.binary(a.BinaryOp.LtI32x4,l,u);case 7:return r.binary(a.BinaryOp.LtU32x4,l,u);case 3:return r.binary(a.BinaryOp.LtI64x2,l,u);case 8:return r.binary(a.BinaryOp.LtU64x2,l,u);case 4:return r.binary(t.options.isWasm64?a.BinaryOp.LtI64x2:a.BinaryOp.LtI32x4,l,u);case 9:return r.binary(t.options.isWasm64?a.BinaryOp.LtU64x2:a.BinaryOp.LtU32x4,l,u);case 11:return r.binary(a.BinaryOp.LtF32x4,l,u);case 12:return r.binary(a.BinaryOp.LtF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.lt",o.toString()),r.unreachable()}function ye(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.binary(a.BinaryOp.LeI8x16,l,u);case 5:return r.binary(a.BinaryOp.LeU8x16,l,u);case 1:return r.binary(a.BinaryOp.LeI16x8,l,u);case 6:return r.binary(a.BinaryOp.LeU16x8,l,u);case 2:return r.binary(a.BinaryOp.LeI32x4,l,u);case 7:return r.binary(a.BinaryOp.LeU32x4,l,u);case 3:return r.binary(a.BinaryOp.LeI64x2,l,u);case 8:return r.binary(a.BinaryOp.LeU64x2,l,u);case 4:return r.binary(t.options.isWasm64?a.BinaryOp.LeI64x2:a.BinaryOp.LeI32x4,l,u);case 9:return r.binary(t.options.isWasm64?a.BinaryOp.LeU64x2:a.BinaryOp.LeU32x4,l,u);case 11:return r.binary(a.BinaryOp.LeF32x4,l,u);case 12:return r.binary(a.BinaryOp.LeF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.le",o.toString()),r.unreachable()}function Te(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.binary(a.BinaryOp.GtI8x16,l,u);case 5:return r.binary(a.BinaryOp.GtU8x16,l,u);case 1:return r.binary(a.BinaryOp.GtI16x8,l,u);case 6:return r.binary(a.BinaryOp.GtU16x8,l,u);case 2:return r.binary(a.BinaryOp.GtI32x4,l,u);case 7:return r.binary(a.BinaryOp.GtU32x4,l,u);case 3:return r.binary(a.BinaryOp.GtI64x2,l,u);case 8:return r.binary(a.BinaryOp.GtU64x2,l,u);case 4:return r.binary(t.options.isWasm64?a.BinaryOp.GtI64x2:a.BinaryOp.GtI32x4,l,u);case 9:return r.binary(t.options.isWasm64?a.BinaryOp.GtU64x2:a.BinaryOp.GtU32x4,l,u);case 11:return r.binary(a.BinaryOp.GtF32x4,l,u);case 12:return r.binary(a.BinaryOp.GtF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.gt",o.toString()),r.unreachable()}function ge(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.binary(a.BinaryOp.GeI8x16,l,u);case 5:return r.binary(a.BinaryOp.GeU8x16,l,u);case 1:return r.binary(a.BinaryOp.GeI16x8,l,u);case 6:return r.binary(a.BinaryOp.GeU16x8,l,u);case 2:return r.binary(a.BinaryOp.GeI32x4,l,u);case 7:return r.binary(a.BinaryOp.GeU32x4,l,u);case 3:return r.binary(a.BinaryOp.GeI64x2,l,u);case 8:return r.binary(a.BinaryOp.GeU64x2,l,u);case 4:return r.binary(t.options.isWasm64?a.BinaryOp.GeI64x2:a.BinaryOp.GeI32x4,l,u);case 9:return r.binary(t.options.isWasm64?a.BinaryOp.GeU64x2:a.BinaryOp.GeU32x4,l,u);case 11:return r.binary(a.BinaryOp.GeF32x4,l,u);case 12:return r.binary(a.BinaryOp.GeF64x2,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.ge",o.toString()),r.unreachable()}function fe(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.v128,1);if(o.isValue)switch(o.kind){case 1:return r.binary(a.BinaryOp.NarrowI16x8ToI8x16,l,u);case 6:return r.binary(a.BinaryOp.NarrowU16x8ToU8x16,l,u);case 2:return r.binary(a.BinaryOp.NarrowI32x4ToI16x8,l,u);case 7:return r.binary(a.BinaryOp.NarrowU32x4ToU16x8,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.narrow",o.toString()),r.unreachable()}function Ee(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:case 5:return r.unary(a.UnaryOp.NegI8x16,l);case 1:case 6:return r.unary(a.UnaryOp.NegI16x8,l);case 2:case 7:return r.unary(a.UnaryOp.NegI32x4,l);case 3:case 8:return r.unary(a.UnaryOp.NegI64x2,l);case 4:case 9:return r.unary(t.options.isWasm64?a.UnaryOp.NegI64x2:a.UnaryOp.NegI32x4,l);case 11:return r.unary(a.UnaryOp.NegF32x4,l);case 12:return r.unary(a.UnaryOp.NegF64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.neg",o.toString()),r.unreachable()}function be(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.unary(a.UnaryOp.AbsI8x16,l);case 1:return r.unary(a.UnaryOp.AbsI16x8,l);case 4:if(t.options.isWasm64)break;case 2:return r.unary(a.UnaryOp.AbsI32x4,l);case 9:if(t.options.isWasm64)break;case 5:case 6:case 7:return l;case 11:return r.unary(a.UnaryOp.AbsF32x4,l);case 12:return r.unary(a.UnaryOp.AbsF64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.abs",o.toString()),r.unreachable()}function xe(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 11:return r.unary(a.UnaryOp.SqrtF32x4,l);case 12:return r.unary(a.UnaryOp.SqrtF64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.sqrt",o.toString()),r.unreachable()}function Ie(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 11:return r.unary(a.UnaryOp.CeilF32x4,l);case 12:return r.unary(a.UnaryOp.CeilF64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.ceil",o.toString()),r.unreachable()}function Ae(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 11:return r.unary(a.UnaryOp.FloorF32x4,l);case 12:return r.unary(a.UnaryOp.FloorF64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.floor",o.toString()),r.unreachable()}function Ne(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 11:return r.unary(a.UnaryOp.TruncF32x4,l);case 12:return r.unary(a.UnaryOp.TruncF64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.trunc",o.toString()),r.unreachable()}function Se(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 11:return r.unary(a.UnaryOp.NearestF32x4,l);case 12:return r.unary(a.UnaryOp.NearestF64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.nearest",o.toString()),r.unreachable()}function ve(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 4:if(t.options.isWasm64)break;case 2:return r.unary(a.UnaryOp.ConvertI32x4ToF32x4,l);case 9:if(t.options.isWasm64)break;case 7:return r.unary(a.UnaryOp.ConvertU32x4ToF32x4,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.convert",o.toString()),r.unreachable()}function Ce(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 4:if(t.options.isWasm64)break;case 2:return r.unary(a.UnaryOp.TruncSatF32x4ToI32x4,l);case 9:if(t.options.isWasm64)break;case 7:return r.unary(a.UnaryOp.TruncSatF32x4ToU32x4,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.trunc_sat",o.toString()),r.unreachable()}function Oe(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.unary(a.UnaryOp.ExtendLowI8x16ToI16x8,l);case 5:return r.unary(a.UnaryOp.ExtendLowU8x16ToU16x8,l);case 1:return r.unary(a.UnaryOp.ExtendLowI16x8ToI32x4,l);case 6:return r.unary(a.UnaryOp.ExtendLowU16x8ToU32x4,l);case 4:if(t.options.isWasm64)break;case 2:return r.unary(a.UnaryOp.ExtendLowI32x4ToI64x2,l);case 9:if(t.options.isWasm64)break;case 7:return r.unary(a.UnaryOp.ExtendLowU32x4ToU64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.extend_low",o.toString()),r.unreachable()}function Re(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(o.isValue)switch(o.kind){case 0:return r.unary(a.UnaryOp.ExtendHighI8x16ToI16x8,l);case 5:return r.unary(a.UnaryOp.ExtendHighU8x16ToU16x8,l);case 1:return r.unary(a.UnaryOp.ExtendHighI16x8ToI32x4,l);case 6:return r.unary(a.UnaryOp.ExtendHighU16x8ToU32x4,l);case 4:if(t.options.isWasm64)break;case 2:return r.unary(a.UnaryOp.ExtendHighI32x4ToI64x2,l);case 9:if(t.options.isWasm64)break;case 7:return r.unary(a.UnaryOp.ExtendHighU32x4ToU64x2,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.extend_high",o.toString()),r.unreachable()}function ke(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.i32,1);if(t.currentType=s.Type.v128,o.isValue)switch(o.kind){case 0:case 5:return r.simd_shift(a.SIMDShiftOp.ShlI8x16,l,u);case 1:case 6:return r.simd_shift(a.SIMDShiftOp.ShlI16x8,l,u);case 2:case 7:return r.simd_shift(a.SIMDShiftOp.ShlI32x4,l,u);case 3:case 8:return r.simd_shift(a.SIMDShiftOp.ShlI64x2,l,u);case 4:case 9:return r.simd_shift(t.options.isWasm64?a.SIMDShiftOp.ShlI64x2:a.SIMDShiftOp.ShlI32x4,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.shl",o.toString()),r.unreachable()}function Le(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1),u=t.compileExpression(n[1],s.Type.i32,1);if(t.currentType=s.Type.v128,o.isValue)switch(o.kind){case 0:return r.simd_shift(a.SIMDShiftOp.ShrI8x16,l,u);case 5:return r.simd_shift(a.SIMDShiftOp.ShrU8x16,l,u);case 1:return r.simd_shift(a.SIMDShiftOp.ShrI16x8,l,u);case 6:return r.simd_shift(a.SIMDShiftOp.ShrU16x8,l,u);case 2:return r.simd_shift(a.SIMDShiftOp.ShrI32x4,l,u);case 7:return r.simd_shift(a.SIMDShiftOp.ShrU32x4,l,u);case 3:return r.simd_shift(a.SIMDShiftOp.ShrI64x2,l,u);case 8:return r.simd_shift(a.SIMDShiftOp.ShrU64x2,l,u);case 4:return r.simd_shift(t.options.isWasm64?a.SIMDShiftOp.ShrI64x2:a.SIMDShiftOp.ShrI32x4,l,u);case 9:return r.simd_shift(t.options.isWasm64?a.SIMDShiftOp.ShrU64x2:a.SIMDShiftOp.ShrU32x4,l,u)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.shr",o.toString()),r.unreachable()}function Fe(e,t){var r=e.compiler,i=r.module;if(Ke(e,16)|We(e)|Ye(e,2))return r.currentType=s.Type.v128,i.unreachable();var n=e.operands,a=r.compileExpression(n[0],s.Type.v128,1),o=r.compileExpression(n[1],s.Type.v128,1);return i.binary(t,a,o)}function De(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.bool,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(t.currentType=s.Type.bool,o.isValue)switch(o.kind){case 0:case 5:return r.unary(a.UnaryOp.AllTrueI8x16,l);case 1:case 6:return r.unary(a.UnaryOp.AllTrueI16x8,l);case 2:case 7:return r.unary(a.UnaryOp.AllTrueI32x4,l);case 3:case 8:return r.unary(a.UnaryOp.AllTrueI64x2,l);case 4:case 9:return r.unary(t.options.isWasm64?a.UnaryOp.AllTrueI64x2:a.UnaryOp.AllTrueI32x4,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.all_true",o.toString()),r.unreachable()}function Pe(e){var t=e.compiler,r=t.module;if(Ke(e,16)|Ve(e)|Ye(e,1))return t.currentType=s.Type.i32,r.unreachable();var n=e.operands,o=e.typeArguments[0],l=t.compileExpression(n[0],s.Type.v128,1);if(t.currentType=s.Type.i32,o.isValue)switch(o.kind){case 0:case 5:return r.unary(a.UnaryOp.BitmaskI8x16,l);case 1:case 6:return r.unary(a.UnaryOp.BitmaskI16x8,l);case 4:case 9:if(t.options.isWasm64)break;case 2:case 7:return r.unary(a.UnaryOp.BitmaskI32x4,l)}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"v128.bitmask",o.toString()),r.unreachable()}function we(e,t){if(assert(t.type.isManaged),!t.visitRef){var r=e.program,i=e.module,n=r.options.usizeType,l=n.toNativeType(),u=n.byteSize,c=assert(r.visitInstance),p=new Array,_=t.base;_&&p.push(i.call(_.internalName+"~visit",[i.local_get(0,l),i.local_get(1,a.NativeType.I32)],a.NativeType.None));var h=!1;if(t.isDeclaredInLibrary){let n=t.lookupInSelf("__visit");if(n){assert(n.kind==o.ElementKind.FUNCTION_PROTOTYPE);let u=r.resolver.resolveFunction(n,null);if(u&&e.compileFunction(u)){let e=u.signature,r=assert(e.thisType);assert(1==e.parameterTypes.length&&e.parameterTypes[0]==s.Type.u32&&e.returnType==s.Type.void&&t.type.isStrictlyAssignableTo(r)),p.push(i.call(u.internalName,[i.local_get(0,l),i.local_get(1,a.NativeType.I32)],a.NativeType.None))}else p.push(i.unreachable());h=!0}}var d=!1;if(!h){let e=t.members;if(e)for(let r=Map_values(e),n=0,s=r.length;n<s;++n){let e=unchecked(r[n]);if(e.kind==o.ElementKind.FIELD&&e.parent===t){if(e.type.isManaged){let t=e.memoryOffset;assert(t>=0),d=!0,p.push(i.if(i.local_tee(2,i.load(u,!1,i.local_get(0,l),l,t),!1),i.call(c.internalName,[i.local_get(2,l),i.local_get(1,a.NativeType.I32)],a.NativeType.None)))}}}}t.visitRef=i.addFunction(t.internalName+"~visit",a.createType([l,a.NativeType.I32]),a.NativeType.None,d?[l]:null,i.flatten(p,a.NativeType.None)),_&&we(e,_)}}function Be(e){var t=64*(1<<e.alignLog2);return e.is(1)&&(t|=2048),e.is(8)&&(t|=4096),e.is(512)&&(t|=8192),e.isManaged&&(t|=16384),t/64}function Ue(e){var t=e.compiler,r=e.operands,n=e.typeArguments;if(0==r.length)return n&&1==n.length?n[0]:(t.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.reportNode.typeArgumentsRange,"1",n?n.length.toString():"0"),null);if(1==r.length){if(null!==n&&n.length>0){if(n.length>1)return t.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.reportNode.typeArgumentsRange,"1",n.length.toString()),null;t.compileExpression(r[0],n[0],1)}else t.compileExpression(r[0],s.Type.auto);return t.currentType}return null!==n&&n.length>1&&t.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.reportNode.typeArgumentsRange,"1",n.length.toString()),t.error(i.DiagnosticCode.Expected_0_arguments_but_got_1,e.reportNode.argumentsRange,"1",r.length.toString()),null}function Me(e,t){var r,n=t.module;if(t.options.isWasm64){let o=t.compileExpression(e,s.Type.usize64,1),l=n.runExpression(o,a.ExpressionRunnerFlags.PreserveSideeffects);l?(assert(0==a.getConstValueI64High(l)),r=a.getConstValueI64Low(l)):(t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,e.range),r=-1)}else{let o=t.compileExpression(e,s.Type.usize32,1),l=n.runExpression(o,a.ExpressionRunnerFlags.PreserveSideeffects);l?r=a.getConstValueI32(l):(t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,e.range),r=-1)}return r}function Ge(e,t,r){var n=Me(e,r);return n<0?n:n<1||t>16?(r.error(i.DiagnosticCode._0_must_be_a_value_between_1_and_2_inclusive,e.range,"Alignment","1",t.toString()),-1):p.isPowerOf2(n)?n:(r.error(i.DiagnosticCode._0_must_be_a_power_of_two,e.range,"Alignment"),-1)}function Ke(e,t){var r=e.compiler;return r.options.hasFeature(t)?0:(r.error(i.DiagnosticCode.Feature_0_is_not_enabled,e.reportNode.range,c.featureToString(t)),1)}function Ve(e,t=!1){var r=e.compiler,n=e.typeArguments;if(n){let s=n.length;if(1==s)return 0;assert(s),t&&(r.currentType=n[0]),r.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.reportNode.typeArgumentsRange,"1",s.toString())}else r.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.reportNode.range,"1","0");return 1}function ze(e,t=!1){var r=e.typeArguments;if(r){let n=e.compiler,s=r.length;return 1==s?0:(assert(s),t&&(n.currentType=r[0]),n.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.reportNode.typeArgumentsRange,"1",s.toString()),1)}return 0}function We(e){if(e.typeArguments){let t=e.prototype;return t.program.error(i.DiagnosticCode.Type_0_is_not_generic,e.reportNode.typeArgumentsRange,t.internalName),1}return 0}function Ye(e,t){var r=e.operands;return r.length!=t?(e.compiler.error(i.DiagnosticCode.Expected_0_arguments_but_got_1,e.reportNode.range,t.toString(),r.length.toString()),1):0}function He(e,t,r){var n=e.operands.length;return n<t?(e.compiler.error(i.DiagnosticCode.Expected_at_least_0_arguments_but_got_1,e.reportNode.range,t.toString(),n.toString()),1):n>r?(e.compiler.error(i.DiagnosticCode.Expected_0_arguments_but_got_1,e.reportNode.range,r.toString(),n.toString()),1):0}function Xe(e,t,r){var i=e.module;if(r!=s.Type.auto&&r.isIntegerValue)switch(r.kind){case 2:if(i64_is_i32(t))return e.currentType=s.Type.i32,i.i32(i64_low(t));break;case 7:if(i64_is_u32(t))return e.currentType=s.Type.u32,i.i32(i64_low(t));break;case 3:case 8:return e.currentType=r,i.i64(i64_low(t),i64_high(t))}return e.options.isWasm64?(e.currentType=s.Type.usize64,i.i64(i64_low(t),i64_high(t))):(e.currentType=s.Type.usize32,assert(!i64_high(t)),i.i32(i64_low(t)))}t.BuiltinContext=class{constructor(e,t,r,i,n,s,a,o){this.compiler=e,this.prototype=t,this.typeArguments=r,this.operands=i,this.thisOperand=n,this.contextualType=s,this.reportNode=a,this.contextIsExact=o}},t.builtins=new Map,t.function_builtins=new Map,t.builtins.set(_.isInteger,(function(e){var t=e.compiler,r=t.module,i=Ue(e);return t.currentType=s.Type.bool,i?r.i32(i.isIntegerValue?1:0):r.unreachable()})),t.builtins.set(_.isFloat,(function(e){var t=e.compiler,r=t.module,i=Ue(e);return t.currentType=s.Type.bool,i?r.i32(i.isFloatValue?1:0):r.unreachable()})),t.builtins.set(_.isBoolean,(function(e){var t=e.compiler,r=t.module,i=Ue(e);return t.currentType=s.Type.bool,i?r.i32(i.isBooleanValue?1:0):r.unreachable()})),t.builtins.set(_.isSigned,(function(e){var t=e.compiler,r=t.module,i=Ue(e);return t.currentType=s.Type.bool,i?r.i32(i.isSignedIntegerValue?1:0):r.unreachable()})),t.builtins.set(_.isReference,(function(e){var t=e.compiler,r=t.module,i=Ue(e);return t.currentType=s.Type.bool,i?r.i32(i.isReference?1:0):r.unreachable()})),t.builtins.set(_.isString,(function(e){var t=e.compiler,r=t.module,i=Ue(e);if(t.currentType=s.Type.bool,!i)return r.unreachable();var n=i.getClass();return r.i32(null!==n&&n.isAssignableTo(t.program.stringInstance)?1:0)})),t.builtins.set(_.isArray,(function(e){var t=e.compiler,r=t.module,i=Ue(e);if(t.currentType=s.Type.bool,!i)return r.unreachable();var n=i.getClass();return r.i32(null!==n&&n.extends(t.program.arrayPrototype)?1:0)})),t.builtins.set(_.isArrayLike,(function(e){var t=e.compiler,r=t.module,i=Ue(e);if(t.currentType=s.Type.bool,!i)return r.unreachable();var n=i.getClass();return r.i32(null!==n&&n.isArrayLike?1:0)})),t.builtins.set(_.isFunction,(function(e){var t=e.compiler,r=t.module,i=Ue(e);return t.currentType=s.Type.bool,i?r.i32(i.isFunction?1:0):r.unreachable()})),t.builtins.set(_.isNullable,(function(e){var t=e.compiler,r=t.module,i=Ue(e);return t.currentType=s.Type.bool,i?r.i32(i.isNullableReference?1:0):r.unreachable()})),t.builtins.set(_.isDefined,(function(e){var t=e.compiler,r=t.module;if(t.currentType=s.Type.bool,We(e)|Ye(e,1))return r.unreachable();var i=t.resolver.lookupExpression(e.operands[0],t.currentFlow,s.Type.auto,u.ReportMode.SWALLOW);return r.i32(null!==i?1:0)})),t.builtins.set(_.isConstant,(function(e){var t=e.compiler,r=t.module;if(t.currentType=s.Type.bool,We(e)|Ye(e,1))return r.unreachable();var i=t.compileExpression(e.operands[0],s.Type.auto);return t.currentType=s.Type.bool,r.i32(a.getExpressionId(i)==a.ExpressionId.Const?1:0)})),t.builtins.set(_.isManaged,(function(e){var t=e.compiler,r=t.module,i=Ue(e);return t.currentType=s.Type.bool,i?r.i32(i.isManaged?1:0):r.unreachable()})),t.builtins.set(_.isVoid,(function(e){var t=e.compiler,r=t.module,i=Ue(e);return t.currentType=s.Type.bool,i?r.i32(20==i.kind?1:0):r.unreachable()})),t.builtins.set(_.lengthof,(function(e){var t=e.compiler,r=t.module,n=Ue(e);if(t.currentType=s.Type.i32,!n)return r.unreachable();var a=n.signatureReference;return a?r.i32(a.parameterTypes.length):(t.error(i.DiagnosticCode.Type_0_has_no_call_signatures,e.reportNode.range,n.toString()),r.unreachable())})),t.builtins.set(_.sizeof,(function(e){var t=e.compiler,r=t.module;if(t.currentType=t.options.usizeType,Ve(e)|Ye(e,0))return r.unreachable();var n=e.typeArguments[0],s=n.byteSize;return s?Xe(t,i64_new(s),e.contextualType):(t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"sizeof",n.toString()),r.unreachable())})),t.builtins.set(_.alignof,(function(e){var t=e.compiler,r=t.module;if(t.currentType=t.options.usizeType,Ve(e)|Ye(e,0))return r.unreachable();var n=e.typeArguments[0],s=n.byteSize;return p.isPowerOf2(s)?Xe(t,i64_new(ctz(s)),e.contextualType):(t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"alignof",n.toString()),r.unreachable())})),t.builtins.set(_.offsetof,(function(e){var t=e.compiler,r=t.module;if(t.currentType=t.options.usizeType,Ve(e)|He(e,0,1))return r.unreachable();var a=e.operands,l=e.contextualType,u=e.typeArguments[0],c=u.getClassOrWrapper(t.program);if(!c)return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"offsetof",u.toString()),t.options.isWasm64?l.isIntegerValue&&l.size<=32&&(t.currentType=s.Type.u32):l.isIntegerValue&&64==l.size&&(t.currentType=s.Type.u64),r.unreachable();if(a.length){let e=a[0];if(!e.isLiteralKind(n.LiteralKind.STRING))return t.error(i.DiagnosticCode.String_literal_expected,a[0].range),r.unreachable();let s=e.value,u=c.members;if(null!==u&&u.has(s)){let e=assert(u.get(s));if(e.kind==o.ElementKind.FIELD)return Xe(t,i64_new(e.memoryOffset),l)}return t.error(i.DiagnosticCode.Type_0_has_no_property_1,e.range,c.internalName,s),r.unreachable()}return Xe(t,i64_new(c.nextMemoryOffset),l)})),t.builtins.set(_.nameof,(function(e){var t,r=e.compiler,i=r.module,n=Ue(e);if(!n)return r.currentType=r.program.stringInstance.type,i.unreachable();if(n.isInternalReference){let e=n.getClass();e?t=e.name:(assert(n.getSignature()),t="Function")}else t=n.toString();return r.ensureStaticString(t)})),t.builtins.set(_.idof,(function(e){var t=e.compiler,r=t.module,n=Ue(e);if(t.currentType=s.Type.u32,!n)return r.unreachable();let a=n.getSignature();if(a)return r.i32(a.id);let l=n.getClassOrWrapper(t.program);return null===l||l.hasDecorator(o.DecoratorFlags.UNMANAGED)?(t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"idof",n.toString()),r.unreachable()):r.i32(l.id)})),t.builtins.set(_.clz,h),t.builtins.set(_.ctz,d),t.builtins.set(_.popcnt,m),t.builtins.set(_.rotl,y),t.builtins.set(_.rotr,T),t.builtins.set(_.abs,g),t.builtins.set(_.max,f),t.builtins.set(_.min,E),t.builtins.set(_.ceil,b),t.builtins.set(_.floor,x),t.builtins.set(_.copysign,I),t.builtins.set(_.nearest,A),t.builtins.set(_.reinterpret,N),t.builtins.set(_.sqrt,S),t.builtins.set(_.trunc,v),t.builtins.set(_.isNaN,(function(e){var t=e.compiler,r=t.module;if(ze(e)|Ye(e,1))return t.currentType=s.Type.bool,r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],1):t.compileExpression(n[0],s.Type.auto),u=t.currentType;if(t.currentType=s.Type.bool,u.isValue)switch(u.kind){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:return r.maybeDropCondition(l,r.i32(0));case 11:{if(a.getExpressionId(l)==a.ExpressionId.LocalGet)return r.binary(a.BinaryOp.NeF32,l,r.local_get(a.getLocalGetIndex(l),a.NativeType.F32));let e=t.currentFlow,i=e.getTempLocal(s.Type.f32),n=r.binary(a.BinaryOp.NeF32,r.local_tee(i.index,l,!1),r.local_get(i.index,a.NativeType.F32));return e.freeTempLocal(i),n}case 12:{if(a.getExpressionId(l)==a.ExpressionId.LocalGet)return r.binary(a.BinaryOp.NeF64,l,r.local_get(a.getLocalGetIndex(l),a.NativeType.F64));let e=t.currentFlow,i=e.getTempLocal(s.Type.f64),n=r.binary(a.BinaryOp.NeF64,r.local_tee(i.index,l,!1),r.local_get(i.index,a.NativeType.F64));return e.freeTempLocal(i),n}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"isNaN",u.toString()),r.unreachable()})),t.builtins.set(_.isFinite,(function(e){var t=e.compiler,r=t.module;if(ze(e)|Ye(e,1))return t.currentType=s.Type.bool,r.unreachable();var n=e.operands,o=e.typeArguments,l=o?t.compileExpression(n[0],o[0],1):t.compileExpression(n[0],s.Type.auto),u=t.currentType;if(t.currentType=s.Type.bool,u.isValue)switch(u.kind){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:return r.maybeDropCondition(l,r.i32(1));case 11:{if(a.getExpressionId(l)==a.ExpressionId.LocalGet)return r.binary(a.BinaryOp.EqF32,r.binary(a.BinaryOp.SubF32,l,r.local_get(a.getLocalGetIndex(l),a.NativeType.F32)),r.f32(0));let e=t.currentFlow,i=e.getTempLocal(s.Type.f32),n=r.binary(a.BinaryOp.EqF32,r.binary(a.BinaryOp.SubF32,r.local_tee(i.index,l,!1),r.local_get(i.index,a.NativeType.F32)),r.f32(0));return e.freeTempLocal(i),n}case 12:{if(a.getExpressionId(l)==a.ExpressionId.LocalGet)return r.binary(a.BinaryOp.EqF64,r.binary(a.BinaryOp.SubF64,l,r.local_get(a.getLocalGetIndex(l),a.NativeType.F64)),r.f64(0));let e=t.currentFlow,i=e.getTempLocal(s.Type.f64),n=r.binary(a.BinaryOp.EqF64,r.binary(a.BinaryOp.SubF64,r.local_tee(i.index,l,!1),r.local_get(i.index,a.NativeType.F64)),r.f64(0));return e.freeTempLocal(i),n}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"isFinite",u.toString()),r.unreachable()})),t.builtins.set(_.load,C),t.builtins.set(_.store,O),t.builtins.set(_.add,R),t.builtins.set(_.sub,k),t.builtins.set(_.mul,L),t.builtins.set(_.div,F),t.builtins.set(_.atomic_load,D),t.builtins.set(_.atomic_store,P),t.builtins.set(_.atomic_add,B),t.builtins.set(_.atomic_sub,U),t.builtins.set(_.atomic_and,M),t.builtins.set(_.atomic_or,G),t.builtins.set(_.atomic_xor,K),t.builtins.set(_.atomic_xchg,V),t.builtins.set(_.atomic_cmpxchg,z),t.builtins.set(_.atomic_wait,W),t.builtins.set(_.atomic_notify,(function(e){var t=e.compiler,r=t.module;if(Ke(e,32)|We(e)|Ye(e,2))return t.currentType=s.Type.i32,r.unreachable();var i=e.operands,n=t.compileExpression(i[0],t.options.usizeType,1),a=t.compileExpression(i[1],s.Type.i32,1);return t.currentType=s.Type.i32,r.atomic_notify(n,a)})),t.builtins.set(_.atomic_fence,(function(e){var t=e.compiler,r=t.module;return t.currentType=s.Type.void,Ke(e,32)|We(e)|Ye(e,0)?r.unreachable():r.atomic_fence()})),t.builtins.set(_.select,(function(e){var t=e.compiler,r=t.module;if(ze(e,!0)|Ye(e,3))return r.unreachable();var n=e.operands,a=e.typeArguments,o=a?t.compileExpression(n[0],a[0],1):t.compileExpression(n[0],s.Type.auto),l=t.currentType;if(!l.isAny(384))return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"select",l.toString()),r.unreachable();var u=t.compileExpression(n[1],l,1),c=t.makeIsTrueish(t.compileExpression(n[2],s.Type.bool),t.currentType,n[2]);return t.currentType=l,r.select(o,u,c)})),t.builtins.set(_.unreachable,(function(e){return We(e),Ye(e,0),e.compiler.module.unreachable()})),t.builtins.set(_.memory_size,(function(e){var t=e.compiler,r=t.module;return t.currentType=s.Type.i32,We(e)|Ye(e,0)?r.unreachable():r.memory_size()})),t.builtins.set(_.memory_grow,(function(e){var t=e.compiler,r=t.module;return t.currentType=s.Type.i32,We(e)|Ye(e,1)?r.unreachable():r.memory_grow(t.compileExpression(e.operands[0],s.Type.i32,1))})),t.builtins.set(_.memory_copy,(function(e){var t=e.compiler,r=t.module;if(t.currentType=s.Type.void,We(e)|Ye(e,3))return r.unreachable();var i=e.operands;if(!t.options.hasFeature(8)){let n=t.resolver.resolveFunction(e.prototype,null);return t.currentType=s.Type.void,n&&t.compileFunction(n,!0)?t.compileCallDirect(n,i,e.reportNode):r.unreachable()}var n=t.options.usizeType,a=t.compileExpression(i[0],n,1),o=t.compileExpression(i[1],n,1),l=t.compileExpression(i[2],n,1);return t.currentType=s.Type.void,r.memory_copy(a,o,l)})),t.builtins.set(_.memory_fill,(function(e){var t=e.compiler,r=t.module;if(t.currentType=s.Type.void,We(e)|Ye(e,3))return r.unreachable();var i=e.operands;if(!t.options.hasFeature(8)){let n=t.resolver.resolveFunction(e.prototype,null);return t.currentType=s.Type.void,n&&t.compileFunction(n,!0)?t.compileCallDirect(n,i,e.reportNode):r.unreachable()}var n=t.options.usizeType,a=t.compileExpression(i[0],n,1),o=t.compileExpression(i[1],s.Type.u8,1),l=t.compileExpression(i[2],n,1);return t.currentType=s.Type.void,r.memory_fill(a,o,l)})),t.builtins.set(_.memory_data,(function(e){var t=e.compiler,r=t.module;if(t.currentType=s.Type.i32,ze(e)|He(e,1,2))return r.unreachable();var o,l=e.typeArguments,u=e.operands,c=u.length,p=t.options.usizeType;if(null!==l&&l.length>0){let s=l[0];if(!s.isValue)return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"memory.data",s.toString()),t.currentType=p,r.unreachable();let _=u[0];if(_.kind!=n.NodeKind.LITERAL||_.literalKind!=n.LiteralKind.ARRAY)return t.error(i.DiagnosticCode.Array_literal_expected,u[0].range),t.currentType=p,r.unreachable();let h=_.elementExpressions,d=h.length,m=new Array(d),y=!0;for(let e=0;e<d;++e){let i=h[e];if(i.kind!=n.NodeKind.OMITTED){let n=t.compileExpression(i,s,1),o=r.runExpression(n,a.ExpressionRunnerFlags.PreserveSideeffects);o?n=o:y=!1,m[e]=n}else m[e]=t.makeZero(s,i)}if(!y)return t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,_.range),t.currentType=p,r.unreachable();let T=s.byteSize;if(2==c&&(T=Ge(u[1],T,t),T<0))return t.currentType=p,r.unreachable();let g=new Uint8Array(d*s.byteSize);assert(t.writeStaticBuffer(g,0,s,m)==g.byteLength),o=t.addAlignedMemorySegment(g,T).offset}else{let e=t.compileExpression(u[0],s.Type.i32,1),n=r.runExpression(e,a.ExpressionRunnerFlags.PreserveSideeffects);if(!n)return t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,u[0].range),t.currentType=p,r.unreachable();let l=a.getConstValueI32(n);if(l<1)return t.error(i.DiagnosticCode._0_must_be_a_value_between_1_and_2_inclusive,u[0].range,"1",i32.MAX_VALUE.toString()),t.currentType=p,r.unreachable();let _=16;if(2==c&&(_=Ge(u[1],_,t),_<0))return t.currentType=p,r.unreachable();o=t.addAlignedMemorySegment(new Uint8Array(l),_).offset}return t.currentType=p,p==s.Type.usize32?(assert(!i64_high(o)),r.i32(i64_low(o))):r.i64(i64_low(o),i64_high(o))})),t.builtins.set(_.i31_new,(function(e){var t=e.compiler,r=t.module;if(We(e)|Ye(e,1))return r.unreachable();var i=e.operands,n=t.compileExpression(i[0],s.Type.i32,1);return t.currentType=s.Type.i31ref,r.i31_new(n)})),t.builtins.set(_.i31_get,(function(e){var t=e.compiler,r=t.module;if(We(e)|Ye(e,1))return r.unreachable();var i=e.operands,n=t.compileExpression(i[0],s.Type.i31ref,1);return e.contextualType.is(2)?(t.currentType=s.Type.u32,r.i31_get(n,!1)):(t.currentType=s.Type.i32,r.i31_get(n,!0))})),t.builtins.set(_.changetype,(function(e){var t=e.compiler,r=t.module;if(Ve(e,!0)|Ye(e,1))return r.unreachable();var n=e.operands,a=e.typeArguments[0],o=t.compileExpression(n[0],s.Type.auto),l=t.currentType;return t.currentType=a,l.isChangeableTo(a)?o:(t.error(i.DiagnosticCode.Type_0_cannot_be_changed_to_type_1,e.reportNode.range,l.toString(),a.toString()),r.unreachable())})),t.builtins.set(_.assert,(function(e){var t=e.compiler,r=t.module,n=e.typeArguments;if(ze(e,!0)|He(e,1,2))return n&&(assert(n.length),t.currentType=n[0].nonNullableType),r.unreachable();var o=e.operands,u=e.contextualType,c=n?t.compileExpression(o[0],n[0],5):t.compileExpression(o[0],s.Type.bool,4),p=t.currentType;if(t.currentType=p.nonNullableType,t.options.noAssert)return c;var _=r.runExpression(c,a.ExpressionRunnerFlags.Default);if(_)switch(a.getExpressionType(_)){case a.NativeType.I32:if(a.getConstValueI32(_))return c;break;case a.NativeType.I64:if(a.getConstValueI64Low(_)|a.getConstValueI64High(_))return c;break;case a.NativeType.F32:if(a.getConstValueF32(_))return c;break;case a.NativeType.F64:if(a.getConstValueF64(_))return c}var h=t.makeAbort(2==o.length?o[1]:null,e.reportNode);if(t.currentType=p.nonNullableType,u==s.Type.void)switch(t.currentType=s.Type.void,p.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:return r.if(r.unary(a.UnaryOp.EqzI32,c),h);case 3:case 8:return r.if(r.unary(a.UnaryOp.EqzI64,c),h);case 4:case 9:return r.if(r.unary(t.options.isWasm64?a.UnaryOp.EqzI64:a.UnaryOp.EqzI32,c),h);case 11:return r.if(r.binary(a.BinaryOp.EqF32,c,r.f32(0)),h);case 12:return r.if(r.binary(a.BinaryOp.EqF64,c,r.f64(0)),h);case 14:case 15:case 16:case 17:case 19:case 18:return r.if(r.ref_is(a.RefIsOp.RefIsNull,c),h)}else{t.currentType=p.nonNullableType;let e=t.currentFlow;switch(t.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:{let t=e.getTempLocal(p);e.setLocalFlag(t.index,l.LocalFlags.WRAPPED);let i=r.if(r.local_tee(t.index,c,!1),r.local_get(t.index,a.NativeType.I32),h);return e.freeTempLocal(t),i}case 3:case 8:{let t=e.getTempLocal(s.Type.i64),i=r.if(r.unary(a.UnaryOp.EqzI64,r.local_tee(t.index,c,!1)),h,r.local_get(t.index,a.NativeType.I64));return e.freeTempLocal(t),i}case 4:case 9:{let i=e.getTempLocal(t.options.usizeType),n=r.if(r.unary(t.options.isWasm64?a.UnaryOp.EqzI64:a.UnaryOp.EqzI32,r.local_tee(i.index,c,p.isManaged)),h,r.local_get(i.index,t.options.nativeSizeType));return e.freeTempLocal(i),n}case 11:{let t=e.getTempLocal(s.Type.f32),i=r.if(r.binary(a.BinaryOp.EqF32,r.local_tee(t.index,c,!1),r.f32(0)),h,r.local_get(t.index,a.NativeType.F32));return e.freeTempLocal(t),i}case 12:{let t=e.getTempLocal(s.Type.f64),i=r.if(r.binary(a.BinaryOp.EqF64,r.local_tee(t.index,c,!1),r.f64(0)),h,r.local_get(t.index,a.NativeType.F64));return e.freeTempLocal(t),i}case 14:case 15:case 16:case 17:case 19:case 18:{let t=e.getTempLocal(p),i=r.if(r.ref_is(a.RefIsOp.RefIsNull,r.local_tee(t.index,c,!1)),h,r.local_get(t.index,p.toNativeType()));return e.freeTempLocal(t),i}}}return t.error(i.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,e.reportNode.typeArgumentsRange,"assert",t.currentType.toString()),h})),t.builtins.set(_.unchecked,(function(e){var t=e.compiler,r=t.module;if(We(e)|Ye(e,1))return r.unreachable();var i=t.currentFlow,n=i.is(32768);i.set(32768);var s=t.compileExpression(e.operands[0],e.contextualType);return n||i.unset(32768),s})),t.builtins.set(_.call_indirect,(function(e){var t=e.compiler,r=t.module;if(ze(e,!0)|He(e,1,i32.MAX_VALUE))return r.unreachable();var i,n=e.operands,o=e.typeArguments;o?(assert(o.length),i=o[0]):i=e.contextualType;var l=t.compileExpression(n[0],s.Type.u32,1),u=n.length-1,c=new Array(u),p=new Array(u);for(let e=0;e<u;++e)c[e]=t.compileExpression(n[1+e],s.Type.auto),p[e]=t.currentType.toNativeType();return t.currentType=i,r.call_indirect(l,c,a.createType(p),i.toNativeType())})),t.builtins.set(_.instantiate,(function(e){var t=e.compiler,r=t.module;if(Ve(e,!0))return r.unreachable();var n=e.operands,s=e.typeArguments[0].getClass();if(!s)return t.error(i.DiagnosticCode.This_expression_is_not_constructable,e.reportNode.expression.range),r.unreachable();t.currentType=s.type;var a=t.ensureConstructor(s,e.reportNode);return t.checkFieldInitialization(s,e.reportNode),t.compileInstantiate(a,n,0,e.reportNode)})),t.builtins.set(_.ERROR,(function(e){return Y(e,i.DiagnosticCategory.ERROR)})),t.builtins.set(_.WARNING,(function(e){return Y(e,i.DiagnosticCategory.WARNING)})),t.builtins.set(_.INFO,(function(e){return Y(e,i.DiagnosticCategory.INFO)})),t.function_builtins.set("call",(function(e){var t=e.compiler,r=e.prototype.parent;assert(r.kind==o.ElementKind.CLASS);var a=r;assert(a.prototype==t.program.functionPrototype);var l=assert(a.typeArguments);assert(1==l.length);var u=l[0],c=assert(u.getSignature()),p=c.returnType;if(We(e)|He(e,1+c.requiredParameters,1+c.parameterTypes.length))return t.currentType=p,t.module.unreachable();var _=t.compileExpression(assert(e.thisOperand),u,1),h=assert(e.operands.shift()),d=c.thisType,m=0;if(d)m=t.compileExpression(h,d,1);else if(h.kind!=n.NodeKind.NULL)return t.error(i.DiagnosticCode._this_cannot_be_referenced_in_current_location,h.range),t.module.unreachable();return t.compileCallIndirect(c,_,e.operands,e.reportNode,m,e.contextualType==s.Type.void)})),t.builtins.set(_.String_raw,(function(e){var t=e.compiler,r=t.module;return t.currentType=e.compiler.program.stringInstance.type,t.error(i.DiagnosticCode.Not_implemented_0,e.reportNode.range,"String.raw"),r.unreachable()})),t.builtins.set(_.i8,(function(e){return H(e,s.Type.i8)})),t.builtins.set(_.i16,(function(e){return H(e,s.Type.i16)})),t.builtins.set(_.i32,(function(e){return H(e,s.Type.i32)})),t.builtins.set(_.i64,(function(e){return H(e,s.Type.i64)})),t.builtins.set(_.isize,(function(e){return H(e,e.compiler.options.isizeType)})),t.builtins.set(_.u8,(function(e){return H(e,s.Type.u8)})),t.builtins.set(_.u16,(function(e){return H(e,s.Type.u16)})),t.builtins.set(_.u32,(function(e){return H(e,s.Type.u32)})),t.builtins.set(_.u64,(function(e){return H(e,s.Type.u64)})),t.builtins.set(_.usize,(function(e){return H(e,e.compiler.options.usizeType)})),t.builtins.set(_.bool,(function(e){return H(e,s.Type.bool)})),t.builtins.set(_.f32,(function(e){return H(e,s.Type.f32)})),t.builtins.set(_.f64,(function(e){return H(e,s.Type.f64)})),t.builtins.set(_.v128,(function(e){return X(e)})),t.builtins.set(_.i8x16,X),t.builtins.set(_.i16x8,(function(e){var t=e.compiler,r=t.module;if(Ke(e,16)|We(e)|Ye(e,8))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=new Uint8Array(16);for(let e=0;e<8;++e){let l=t.compileExpression(n[e],s.Type.i16,1),u=r.runExpression(l,a.ExpressionRunnerFlags.PreserveSideeffects);u?p.writeI16(a.getConstValueI32(u),o,e<<1):t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,n[e].range)}return t.currentType=s.Type.v128,r.v128(o)})),t.builtins.set(_.i32x4,(function(e){var t=e.compiler,r=t.module;if(Ke(e,16)|We(e)|Ye(e,4))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=new Uint8Array(16);for(let e=0;e<4;++e){let l=t.compileExpression(n[e],s.Type.i32,1),u=r.runExpression(l,a.ExpressionRunnerFlags.PreserveSideeffects);u?p.writeI32(a.getConstValueI32(u),o,e<<2):t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,n[e].range)}return t.currentType=s.Type.v128,r.v128(o)})),t.builtins.set(_.i64x2,(function(e){var t=e.compiler,r=t.module;if(Ke(e,16)|We(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=new Uint8Array(16);for(let e=0;e<2;++e){let l=t.compileExpression(n[e],s.Type.i64,1),u=r.runExpression(l,a.ExpressionRunnerFlags.PreserveSideeffects);if(u){let t=e<<3;p.writeI32(a.getConstValueI64Low(u),o,t),p.writeI32(a.getConstValueI64High(u),o,t+4)}else t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,n[e].range)}return t.currentType=s.Type.v128,r.v128(o)})),t.builtins.set(_.f32x4,(function(e){var t=e.compiler,r=t.module;if(Ke(e,16)|We(e)|Ye(e,4))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=new Uint8Array(16);for(let e=0;e<4;++e){let l=t.compileExpression(n[e],s.Type.f32,1),u=r.runExpression(l,a.ExpressionRunnerFlags.PreserveSideeffects);u?p.writeF32(a.getConstValueF32(u),o,e<<2):t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,n[e].range)}return t.currentType=s.Type.v128,r.v128(o)})),t.builtins.set(_.f64x2,(function(e){var t=e.compiler,r=t.module;if(Ke(e,16)|We(e)|Ye(e,2))return t.currentType=s.Type.v128,r.unreachable();var n=e.operands,o=new Uint8Array(16);for(let e=0;e<2;++e){let l=t.compileExpression(n[e],s.Type.f64,1),u=r.runExpression(l,a.ExpressionRunnerFlags.PreserveSideeffects);u?p.writeF64(a.getConstValueF64(u),o,e<<3):t.error(i.DiagnosticCode.Expression_must_be_a_compile_time_constant,n[e].range)}return t.currentType=s.Type.v128,r.v128(o)})),t.builtins.set(_.v128_splat,q),t.builtins.set(_.v128_extract_lane,Q),t.builtins.set(_.v128_replace_lane,j),t.builtins.set(_.v128_shuffle,Z),t.builtins.set(_.v128_swizzle,J),t.builtins.set(_.v128_load_splat,$),t.builtins.set(_.v128_load_ext,ee),t.builtins.set(_.v128_add,te),t.builtins.set(_.v128_sub,re),t.builtins.set(_.v128_mul,ie),t.builtins.set(_.v128_div,ne),t.builtins.set(_.v128_add_sat,se),t.builtins.set(_.v128_sub_sat,ae),t.builtins.set(_.v128_min,oe),t.builtins.set(_.v128_max,le),t.builtins.set(_.v128_pmin,ue),t.builtins.set(_.v128_pmax,ce),t.builtins.set(_.v128_dot,pe),t.builtins.set(_.v128_avgr,_e),t.builtins.set(_.v128_eq,he),t.builtins.set(_.v128_ne,de),t.builtins.set(_.v128_lt,me),t.builtins.set(_.v128_le,ye),t.builtins.set(_.v128_gt,Te),t.builtins.set(_.v128_ge,ge),t.builtins.set(_.v128_narrow,fe),t.builtins.set(_.v128_neg,Ee),t.builtins.set(_.v128_abs,be),t.builtins.set(_.v128_sqrt,xe),t.builtins.set(_.v128_ceil,Ie),t.builtins.set(_.v128_floor,Ae),t.builtins.set(_.v128_trunc,Ne),t.builtins.set(_.v128_nearest,Se),t.builtins.set(_.v128_convert,ve),t.builtins.set(_.v128_trunc_sat,Ce),t.builtins.set(_.v128_extend_low,Oe),t.builtins.set(_.v128_extend_high,Re),t.builtins.set(_.v128_shl,ke),t.builtins.set(_.v128_shr,Le),t.builtins.set(_.v128_and,(function(e){return Fe(e,a.BinaryOp.AndV128)})),t.builtins.set(_.v128_or,(function(e){return Fe(e,a.BinaryOp.OrV128)})),t.builtins.set(_.v128_xor,(function(e){return Fe(e,a.BinaryOp.XorV128)})),t.builtins.set(_.v128_andnot,(function(e){return Fe(e,a.BinaryOp.AndNotV128)})),t.builtins.set(_.v128_not,(function(e){return function(e,t){var r=e.compiler,i=r.module;if(Ke(e,16)|We(e)|Ye(e,1))return r.currentType=s.Type.v128,i.unreachable();var n=e.operands,a=r.compileExpression(n[0],s.Type.v128,1);return i.unary(t,a)}(e,a.UnaryOp.NotV128)})),t.builtins.set(_.v128_bitselect,(function(e){return function(e,t){var r=e.compiler,i=r.module;if(Ke(e,16)|We(e)|Ye(e,3))return r.currentType=s.Type.v128,i.unreachable();var n=e.operands,a=r.compileExpression(n[0],s.Type.v128,1),o=r.compileExpression(n[1],s.Type.v128,1),l=r.compileExpression(n[2],s.Type.v128,1);return i.simd_ternary(t,a,o,l)}(e,a.SIMDTernaryOp.Bitselect)})),t.builtins.set(_.v128_any_true,(function(e){var t=e.compiler,r=t.module;if(Ke(e,16)|We(e)|Ye(e,1))return t.currentType=s.Type.bool,r.unreachable();var i=e.operands,n=t.compileExpression(i[0],s.Type.v128,1);return t.currentType=s.Type.bool,r.unary(a.UnaryOp.AnyTrueI8x16,n)})),t.builtins.set(_.v128_all_true,De),t.builtins.set(_.v128_bitmask,Pe),t.builtins.set(_.visit_globals,(function(e){var t=e.compiler,r=t.module;if(We(e)|Ye(e,1))return t.currentType=s.Type.void,r.unreachable();var i=e.operands,n=t.compileExpression(i[0],s.Type.u32,1);return t.runtimeFeatures|=16,t.currentType=s.Type.void,r.call(_.visit_globals,[n],a.NativeType.None)})),t.builtins.set(_.visit_members,(function(e){var t=e.compiler,r=t.module;if(We(e)|Ye(e,2))return t.currentType=s.Type.void,r.unreachable();var i=e.operands,n=t.compileExpression(i[0],t.options.usizeType,1),o=t.compileExpression(i[1],s.Type.u32,1);return t.runtimeFeatures|=32,t.currentType=s.Type.void,r.call(_.visit_members,[n,o],a.NativeType.None)})),t.builtins.set(_.i32_clz,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,h(e)})),t.builtins.set(_.i64_clz,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,h(e)})),t.builtins.set(_.i32_ctz,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,d(e)})),t.builtins.set(_.i64_ctz,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,d(e)})),t.builtins.set(_.i32_popcnt,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,m(e)})),t.builtins.set(_.i64_popcnt,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,m(e)})),t.builtins.set(_.i32_rotl,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,y(e)})),t.builtins.set(_.i64_rotl,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,y(e)})),t.builtins.set(_.i32_rotr,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,T(e)})),t.builtins.set(_.i64_rotr,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,T(e)})),t.builtins.set(_.f32_abs,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,g(e)})),t.builtins.set(_.f64_abs,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,g(e)})),t.builtins.set(_.f32_max,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,f(e)})),t.builtins.set(_.f64_max,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,f(e)})),t.builtins.set(_.f32_min,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,E(e)})),t.builtins.set(_.f64_min,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,E(e)})),t.builtins.set(_.f32_ceil,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,b(e)})),t.builtins.set(_.f64_ceil,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,b(e)})),t.builtins.set(_.f32_floor,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,x(e)})),t.builtins.set(_.f64_floor,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,x(e)})),t.builtins.set(_.f32_copysign,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,I(e)})),t.builtins.set(_.f64_copysign,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,I(e)})),t.builtins.set(_.f32_nearest,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,A(e)})),t.builtins.set(_.f64_nearest,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,A(e)})),t.builtins.set(_.i32_reinterpret_f32,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.f32,N(e)})),t.builtins.set(_.i64_reinterpret_f64,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.f64,N(e)})),t.builtins.set(_.f32_reinterpret_i32,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.i32,N(e)})),t.builtins.set(_.f64_reinterpret_i64,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.i64,N(e)})),t.builtins.set(_.f32_sqrt,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,S(e)})),t.builtins.set(_.f64_sqrt,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,S(e)})),t.builtins.set(_.f32_trunc,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,v(e)})),t.builtins.set(_.f64_trunc,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,v(e)})),t.builtins.set(_.i32_add,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,R(e)})),t.builtins.set(_.i64_add,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,R(e)})),t.builtins.set(_.f32_add,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,R(e)})),t.builtins.set(_.f64_add,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,R(e)})),t.builtins.set(_.i32_sub,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,k(e)})),t.builtins.set(_.i64_sub,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,k(e)})),t.builtins.set(_.f32_sub,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,k(e)})),t.builtins.set(_.f64_sub,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,k(e)})),t.builtins.set(_.i32_mul,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,L(e)})),t.builtins.set(_.i64_mul,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,L(e)})),t.builtins.set(_.f32_mul,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,L(e)})),t.builtins.set(_.f64_mul,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,L(e)})),t.builtins.set(_.i32_div_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,F(e)})),t.builtins.set(_.i32_div_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.u32,F(e)})),t.builtins.set(_.i64_div_s,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,F(e)})),t.builtins.set(_.i64_div_u,(function(e){return We(e),e.typeArguments=[s.Type.u64],e.contextualType=s.Type.u64,F(e)})),t.builtins.set(_.f32_div,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,F(e)})),t.builtins.set(_.f64_div,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,F(e)})),t.builtins.set(_.i32_load8_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.i32,C(e)})),t.builtins.set(_.i32_load8_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,C(e)})),t.builtins.set(_.i32_load16_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.i32,C(e)})),t.builtins.set(_.i32_load16_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,C(e)})),t.builtins.set(_.i32_load,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,C(e)})),t.builtins.set(_.i64_load8_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.i64,C(e)})),t.builtins.set(_.i64_load8_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i64,C(e)})),t.builtins.set(_.i64_load16_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.i64,C(e)})),t.builtins.set(_.i64_load16_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,C(e)})),t.builtins.set(_.i64_load32_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i64,C(e)})),t.builtins.set(_.i64_load32_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.i64,C(e)})),t.builtins.set(_.i64_load,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,C(e)})),t.builtins.set(_.f32_load,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,C(e)})),t.builtins.set(_.f64_load,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,C(e)})),t.builtins.set(_.i32_store8,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.i32,e.contextIsExact=!0,O(e)})),t.builtins.set(_.i32_store16,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.i32,e.contextIsExact=!0,O(e)})),t.builtins.set(_.i32_store,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,e.contextIsExact=!0,O(e)})),t.builtins.set(_.i64_store8,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.i64,e.contextIsExact=!0,O(e)})),t.builtins.set(_.i64_store16,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.i64,e.contextIsExact=!0,O(e)})),t.builtins.set(_.i64_store32,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i64,e.contextIsExact=!0,O(e)})),t.builtins.set(_.i64_store,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,e.contextIsExact=!0,O(e)})),t.builtins.set(_.f32_store,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,e.contextIsExact=!0,O(e)})),t.builtins.set(_.f64_store,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,e.contextIsExact=!0,O(e)})),t.builtins.set(_.i32_atomic_load8_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,D(e)})),t.builtins.set(_.i32_atomic_load16_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,D(e)})),t.builtins.set(_.i32_atomic_load,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,D(e)})),t.builtins.set(_.i64_atomic_load8_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i64,D(e)})),t.builtins.set(_.i64_atomic_load16_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,D(e)})),t.builtins.set(_.i64_atomic_load32_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.i64,D(e)})),t.builtins.set(_.i64_atomic_load,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,D(e)})),t.builtins.set(_.i32_atomic_store8,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.i32,e.contextIsExact=!0,P(e)})),t.builtins.set(_.i32_atomic_store16,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.i32,e.contextIsExact=!0,P(e)})),t.builtins.set(_.i32_atomic_store,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,e.contextIsExact=!0,P(e)})),t.builtins.set(_.i64_atomic_store8,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.i64,e.contextIsExact=!0,P(e)})),t.builtins.set(_.i64_atomic_store16,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,e.contextIsExact=!0,P(e)})),t.builtins.set(_.i64_atomic_store32,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i64,e.contextIsExact=!0,P(e)})),t.builtins.set(_.i64_atomic_store,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,e.contextIsExact=!0,P(e)})),t.builtins.set(_.i32_atomic_rmw8_add_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,e.contextIsExact=!0,B(e)})),t.builtins.set(_.i32_atomic_rmw16_add_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,e.contextIsExact=!0,B(e)})),t.builtins.set(_.i32_atomic_rmw_add,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,e.contextIsExact=!0,B(e)})),t.builtins.set(_.i64_atomic_rmw8_add_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i64,e.contextIsExact=!0,B(e)})),t.builtins.set(_.i64_atomic_rmw16_add_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,e.contextIsExact=!0,B(e)})),t.builtins.set(_.i64_atomic_rmw32_add_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.i64,e.contextIsExact=!0,B(e)})),t.builtins.set(_.i64_atomic_rmw_add,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,e.contextIsExact=!0,B(e)})),t.builtins.set(_.i32_atomic_rmw8_sub_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,e.contextIsExact=!0,U(e)})),t.builtins.set(_.i32_atomic_rmw16_sub_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,e.contextIsExact=!0,U(e)})),t.builtins.set(_.i32_atomic_rmw_sub,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,e.contextIsExact=!0,U(e)})),t.builtins.set(_.i64_atomic_rmw8_sub_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i64,e.contextIsExact=!0,U(e)})),t.builtins.set(_.i64_atomic_rmw16_sub_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,e.contextIsExact=!0,U(e)})),t.builtins.set(_.i64_atomic_rmw32_sub_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.i64,e.contextIsExact=!0,U(e)})),t.builtins.set(_.i64_atomic_rmw_sub,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,e.contextIsExact=!0,U(e)})),t.builtins.set(_.i32_atomic_rmw8_and_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,e.contextIsExact=!0,M(e)})),t.builtins.set(_.i32_atomic_rmw16_and_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,e.contextIsExact=!0,M(e)})),t.builtins.set(_.i32_atomic_rmw_and,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,e.contextIsExact=!0,M(e)})),t.builtins.set(_.i64_atomic_rmw8_and_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i64,e.contextIsExact=!0,M(e)})),t.builtins.set(_.i64_atomic_rmw16_and_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,e.contextIsExact=!0,M(e)})),t.builtins.set(_.i64_atomic_rmw32_and_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.i64,e.contextIsExact=!0,M(e)})),t.builtins.set(_.i64_atomic_rmw_and,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,e.contextIsExact=!0,M(e)})),t.builtins.set(_.i32_atomic_rmw8_or_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,e.contextIsExact=!0,G(e)})),t.builtins.set(_.i32_atomic_rmw16_or_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,e.contextIsExact=!0,G(e)})),t.builtins.set(_.i32_atomic_rmw_or,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,e.contextIsExact=!0,G(e)})),t.builtins.set(_.i64_atomic_rmw8_or_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i64,e.contextIsExact=!0,G(e)})),t.builtins.set(_.i64_atomic_rmw16_or_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,e.contextIsExact=!0,G(e)})),t.builtins.set(_.i64_atomic_rmw32_or_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.i64,e.contextIsExact=!0,G(e)})),t.builtins.set(_.i64_atomic_rmw_or,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,e.contextIsExact=!0,G(e)})),t.builtins.set(_.i32_atomic_rmw8_xor_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,e.contextIsExact=!0,K(e)})),t.builtins.set(_.i32_atomic_rmw16_xor_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,e.contextIsExact=!0,K(e)})),t.builtins.set(_.i32_atomic_rmw_xor,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,e.contextIsExact=!0,K(e)})),t.builtins.set(_.i64_atomic_rmw8_xor_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i64,e.contextIsExact=!0,K(e)})),t.builtins.set(_.i64_atomic_rmw16_xor_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,e.contextIsExact=!0,K(e)})),t.builtins.set(_.i64_atomic_rmw32_xor_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.i64,e.contextIsExact=!0,K(e)})),t.builtins.set(_.i64_atomic_rmw_xor,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,e.contextIsExact=!0,K(e)})),t.builtins.set(_.i32_atomic_rmw8_xchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,e.contextIsExact=!0,V(e)})),t.builtins.set(_.i32_atomic_rmw16_xchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,e.contextIsExact=!0,V(e)})),t.builtins.set(_.i32_atomic_rmw_xchg,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,e.contextIsExact=!0,V(e)})),t.builtins.set(_.i64_atomic_rmw8_xchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i64,e.contextIsExact=!0,V(e)})),t.builtins.set(_.i64_atomic_rmw16_xchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,e.contextIsExact=!0,V(e)})),t.builtins.set(_.i64_atomic_rmw32_xchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.i64,e.contextIsExact=!0,V(e)})),t.builtins.set(_.i64_atomic_rmw_xchg,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,e.contextIsExact=!0,V(e)})),t.builtins.set(_.i32_atomic_rmw8_cmpxchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,e.contextIsExact=!0,z(e)})),t.builtins.set(_.i32_atomic_rmw16_cmpxchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,e.contextIsExact=!0,z(e)})),t.builtins.set(_.i32_atomic_rmw_cmpxchg,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,e.contextIsExact=!0,z(e)})),t.builtins.set(_.i64_atomic_rmw8_cmpxchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i64,e.contextIsExact=!0,z(e)})),t.builtins.set(_.i64_atomic_rmw16_cmpxchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i64,e.contextIsExact=!0,z(e)})),t.builtins.set(_.i64_atomic_rmw32_cmpxchg_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.i64,e.contextIsExact=!0,z(e)})),t.builtins.set(_.i64_atomic_rmw_cmpxchg,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,e.contextIsExact=!0,z(e)})),t.builtins.set(_.i32_wait,(function(e){return We(e),e.typeArguments=[s.Type.i32],W(e)})),t.builtins.set(_.i64_wait,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i32,W(e)})),t.builtins.set(_.v128_load,(function(e){return We(e),e.typeArguments=[s.Type.v128],e.contextualType=s.Type.v128,C(e)})),t.builtins.set(_.v128_load8x8_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,ee(e)})),t.builtins.set(_.v128_load8x8_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,ee(e)})),t.builtins.set(_.v128_load16x4_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,ee(e)})),t.builtins.set(_.v128_load16x4_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,ee(e)})),t.builtins.set(_.v128_load32x2_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,ee(e)})),t.builtins.set(_.v128_load32x2_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,ee(e)})),t.builtins.set(_.v128_load8_splat,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,$(e)})),t.builtins.set(_.v128_load16_splat,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,$(e)})),t.builtins.set(_.v128_load32_splat,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,$(e)})),t.builtins.set(_.v128_load64_splat,(function(e){return We(e),e.typeArguments=[s.Type.u64],e.contextualType=s.Type.v128,$(e)})),t.builtins.set(_.v128_store,(function(e){return We(e),e.typeArguments=[s.Type.v128],e.contextualType=s.Type.v128,e.contextIsExact=!0,O(e)})),t.builtins.set(_.i8x16_splat,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,q(e)})),t.builtins.set(_.i8x16_extract_lane_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.i32,Q(e)})),t.builtins.set(_.i8x16_extract_lane_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.i32,Q(e)})),t.builtins.set(_.i8x16_replace_lane,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,j(e)})),t.builtins.set(_.i8x16_add,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,te(e)})),t.builtins.set(_.i8x16_sub,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,re(e)})),t.builtins.set(_.i8x16_min_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,oe(e)})),t.builtins.set(_.i8x16_min_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,oe(e)})),t.builtins.set(_.i8x16_max_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,le(e)})),t.builtins.set(_.i8x16_max_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,le(e)})),t.builtins.set(_.i8x16_avgr_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,_e(e)})),t.builtins.set(_.i8x16_abs,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,be(e)})),t.builtins.set(_.i8x16_neg,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,Ee(e)})),t.builtins.set(_.i8x16_add_sat_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,se(e)})),t.builtins.set(_.i8x16_add_sat_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,se(e)})),t.builtins.set(_.i8x16_sub_sat_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,ae(e)})),t.builtins.set(_.i8x16_sub_sat_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,ae(e)})),t.builtins.set(_.i8x16_shl,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,ke(e)})),t.builtins.set(_.i8x16_shr_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,Le(e)})),t.builtins.set(_.i8x16_shr_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,Le(e)})),t.builtins.set(_.i8x16_all_true,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.i32,De(e)})),t.builtins.set(_.i8x16_bitmask,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.i32,Pe(e)})),t.builtins.set(_.i8x16_eq,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,he(e)})),t.builtins.set(_.i8x16_ne,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,de(e)})),t.builtins.set(_.i8x16_lt_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.i8x16_lt_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.i8x16_le_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.i8x16_le_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.i8x16_gt_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.i8x16_gt_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.i8x16_ge_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,ge(e)})),t.builtins.set(_.i8x16_ge_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,ge(e)})),t.builtins.set(_.i8x16_narrow_i16x8_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,fe(e)})),t.builtins.set(_.i8x16_narrow_i16x8_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,fe(e)})),t.builtins.set(_.i8x16_shuffle,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,Z(e)})),t.builtins.set(_.i8x16_swizzle,(function(e){return We(e),e.typeArguments=null,e.contextualType=s.Type.v128,J(e)})),t.builtins.set(_.i16x8_splat,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,q(e)})),t.builtins.set(_.i16x8_extract_lane_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.i32,Q(e)})),t.builtins.set(_.i16x8_extract_lane_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.i32,Q(e)})),t.builtins.set(_.i16x8_replace_lane,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,j(e)})),t.builtins.set(_.i16x8_add,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,te(e)})),t.builtins.set(_.i16x8_sub,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,re(e)})),t.builtins.set(_.i16x8_mul,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,ie(e)})),t.builtins.set(_.i16x8_min_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,oe(e)})),t.builtins.set(_.i16x8_min_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,oe(e)})),t.builtins.set(_.i16x8_max_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,le(e)})),t.builtins.set(_.i16x8_max_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,le(e)})),t.builtins.set(_.i16x8_avgr_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,_e(e)})),t.builtins.set(_.i16x8_abs,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,be(e)})),t.builtins.set(_.i16x8_neg,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,Ee(e)})),t.builtins.set(_.i16x8_add_sat_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,se(e)})),t.builtins.set(_.i16x8_add_sat_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,se(e)})),t.builtins.set(_.i16x8_sub_sat_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,ae(e)})),t.builtins.set(_.i16x8_sub_sat_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,ae(e)})),t.builtins.set(_.i16x8_shl,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,ke(e)})),t.builtins.set(_.i16x8_shr_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,Le(e)})),t.builtins.set(_.i16x8_shr_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,Le(e)})),t.builtins.set(_.i16x8_all_true,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.i32,De(e)})),t.builtins.set(_.i16x8_bitmask,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.i32,Pe(e)})),t.builtins.set(_.i16x8_eq,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,he(e)})),t.builtins.set(_.i16x8_ne,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,de(e)})),t.builtins.set(_.i16x8_lt_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.i16x8_lt_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.i16x8_le_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.i16x8_le_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.i16x8_gt_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.i16x8_gt_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.i16x8_ge_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,ge(e)})),t.builtins.set(_.i16x8_ge_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,ge(e)})),t.builtins.set(_.i16x8_narrow_i32x4_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,fe(e)})),t.builtins.set(_.i16x8_narrow_i32x4_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,fe(e)})),t.builtins.set(_.i16x8_extend_low_i8x16_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,Oe(e)})),t.builtins.set(_.i16x8_extend_low_i8x16_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,Oe(e)})),t.builtins.set(_.i16x8_extend_high_i8x16_s,(function(e){return We(e),e.typeArguments=[s.Type.i8],e.contextualType=s.Type.v128,Re(e)})),t.builtins.set(_.i16x8_extend_high_i8x16_u,(function(e){return We(e),e.typeArguments=[s.Type.u8],e.contextualType=s.Type.v128,Re(e)})),t.builtins.set(_.i32x4_splat,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,q(e)})),t.builtins.set(_.i32x4_extract_lane,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,Q(e)})),t.builtins.set(_.i32x4_replace_lane,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,j(e)})),t.builtins.set(_.i32x4_add,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,te(e)})),t.builtins.set(_.i32x4_sub,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,re(e)})),t.builtins.set(_.i32x4_mul,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,ie(e)})),t.builtins.set(_.i32x4_min_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,oe(e)})),t.builtins.set(_.i32x4_min_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,oe(e)})),t.builtins.set(_.i32x4_max_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,le(e)})),t.builtins.set(_.i32x4_max_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,le(e)})),t.builtins.set(_.i32x4_dot_i16x8_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,pe(e)})),t.builtins.set(_.i32x4_abs,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,be(e)})),t.builtins.set(_.i32x4_neg,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,Ee(e)})),t.builtins.set(_.i32x4_shl,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,ke(e)})),t.builtins.set(_.i32x4_shr_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,Le(e)})),t.builtins.set(_.i32x4_shr_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,Le(e)})),t.builtins.set(_.i32x4_all_true,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,De(e)})),t.builtins.set(_.i32x4_bitmask,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.i32,Pe(e)})),t.builtins.set(_.i32x4_eq,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,he(e)})),t.builtins.set(_.i32x4_ne,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,de(e)})),t.builtins.set(_.i32x4_lt_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.i32x4_lt_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.i32x4_le_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.i32x4_le_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.i32x4_gt_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.i32x4_gt_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.i32x4_ge_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,ge(e)})),t.builtins.set(_.i32x4_ge_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,ge(e)})),t.builtins.set(_.i32x4_trunc_sat_f32x4_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,Ce(e)})),t.builtins.set(_.i32x4_trunc_sat_f32x4_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,Ce(e)})),t.builtins.set(_.i32x4_extend_low_i16x8_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,Oe(e)})),t.builtins.set(_.i32x4_extend_low_i16x8_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,Oe(e)})),t.builtins.set(_.i32x4_extend_high_i16x8_s,(function(e){return We(e),e.typeArguments=[s.Type.i16],e.contextualType=s.Type.v128,Re(e)})),t.builtins.set(_.i32x4_extend_high_i16x8_u,(function(e){return We(e),e.typeArguments=[s.Type.u16],e.contextualType=s.Type.v128,Re(e)})),t.builtins.set(_.i64x2_splat,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,q(e)})),t.builtins.set(_.i64x2_extract_lane,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i64,Q(e)})),t.builtins.set(_.i64x2_replace_lane,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,j(e)})),t.builtins.set(_.i64x2_add,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,te(e)})),t.builtins.set(_.i64x2_sub,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,re(e)})),t.builtins.set(_.i64x2_mul,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,ie(e)})),t.builtins.set(_.i64x2_neg,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,Ee(e)})),t.builtins.set(_.i64x2_shl,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,ke(e)})),t.builtins.set(_.i64x2_shr_s,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,Le(e)})),t.builtins.set(_.i64x2_shr_u,(function(e){return We(e),e.typeArguments=[s.Type.u64],e.contextualType=s.Type.v128,Le(e)})),t.builtins.set(_.i64x2_all_true,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.i32,De(e)})),t.builtins.set(_.i64x2_eq,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,he(e)})),t.builtins.set(_.i64x2_ne,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,de(e)})),t.builtins.set(_.i64x2_lt_s,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.i64x2_lt_u,(function(e){return We(e),e.typeArguments=[s.Type.u64],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.i64x2_le_s,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.i64x2_le_u,(function(e){return We(e),e.typeArguments=[s.Type.u64],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.i64x2_gt_s,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.i64x2_gt_u,(function(e){return We(e),e.typeArguments=[s.Type.u64],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.i64x2_ge_s,(function(e){return We(e),e.typeArguments=[s.Type.i64],e.contextualType=s.Type.v128,ge(e)})),t.builtins.set(_.i64x2_ge_u,(function(e){return We(e),e.typeArguments=[s.Type.u64],e.contextualType=s.Type.v128,ge(e)})),t.builtins.set(_.i64x2_extend_low_i32x4_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,Oe(e)})),t.builtins.set(_.i64x2_extend_low_i32x4_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,Oe(e)})),t.builtins.set(_.i64x2_extend_high_i32x4_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,Re(e)})),t.builtins.set(_.i64x2_extend_high_i32x4_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,Re(e)})),t.builtins.set(_.f32x4_splat,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,q(e)})),t.builtins.set(_.f32x4_extract_lane,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.f32,Q(e)})),t.builtins.set(_.f32x4_replace_lane,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,j(e)})),t.builtins.set(_.f32x4_add,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,te(e)})),t.builtins.set(_.f32x4_sub,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,re(e)})),t.builtins.set(_.f32x4_mul,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,ie(e)})),t.builtins.set(_.f32x4_div,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,ne(e)})),t.builtins.set(_.f32x4_neg,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,Ee(e)})),t.builtins.set(_.f32x4_min,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,oe(e)})),t.builtins.set(_.f32x4_max,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,le(e)})),t.builtins.set(_.f32x4_pmin,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,ue(e)})),t.builtins.set(_.f32x4_pmax,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,ce(e)})),t.builtins.set(_.f32x4_abs,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,be(e)})),t.builtins.set(_.f32x4_sqrt,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,xe(e)})),t.builtins.set(_.f32x4_ceil,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,Ie(e)})),t.builtins.set(_.f32x4_floor,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,Ae(e)})),t.builtins.set(_.f32x4_trunc,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,Ne(e)})),t.builtins.set(_.f32x4_nearest,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,Se(e)})),t.builtins.set(_.f32x4_eq,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,he(e)})),t.builtins.set(_.f32x4_ne,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,de(e)})),t.builtins.set(_.f32x4_lt,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.f32x4_le,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.f32x4_gt,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.f32x4_ge,(function(e){return We(e),e.typeArguments=[s.Type.f32],e.contextualType=s.Type.v128,ge(e)})),t.builtins.set(_.f32x4_convert_i32x4_s,(function(e){return We(e),e.typeArguments=[s.Type.i32],e.contextualType=s.Type.v128,ve(e)})),t.builtins.set(_.f32x4_convert_i32x4_u,(function(e){return We(e),e.typeArguments=[s.Type.u32],e.contextualType=s.Type.v128,ve(e)})),t.builtins.set(_.f64x2_splat,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,q(e)})),t.builtins.set(_.f64x2_extract_lane,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.f64,Q(e)})),t.builtins.set(_.f64x2_replace_lane,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,j(e)})),t.builtins.set(_.f64x2_add,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,te(e)})),t.builtins.set(_.f64x2_sub,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,re(e)})),t.builtins.set(_.f64x2_mul,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,ie(e)})),t.builtins.set(_.f64x2_div,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,ne(e)})),t.builtins.set(_.f64x2_neg,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,Ee(e)})),t.builtins.set(_.f64x2_min,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,oe(e)})),t.builtins.set(_.f64x2_max,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,le(e)})),t.builtins.set(_.f64x2_pmin,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,ue(e)})),t.builtins.set(_.f64x2_pmax,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,ce(e)})),t.builtins.set(_.f64x2_abs,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,be(e)})),t.builtins.set(_.f64x2_sqrt,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,xe(e)})),t.builtins.set(_.f64x2_ceil,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,Ie(e)})),t.builtins.set(_.f64x2_floor,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,Ae(e)})),t.builtins.set(_.f64x2_trunc,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,Ne(e)})),t.builtins.set(_.f64x2_nearest,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,Se(e)})),t.builtins.set(_.f64x2_eq,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,he(e)})),t.builtins.set(_.f64x2_ne,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,de(e)})),t.builtins.set(_.f64x2_lt,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,me(e)})),t.builtins.set(_.f64x2_le,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,ye(e)})),t.builtins.set(_.f64x2_gt,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,Te(e)})),t.builtins.set(_.f64x2_ge,(function(e){return We(e),e.typeArguments=[s.Type.f64],e.contextualType=s.Type.v128,ge(e)})),t.compileVisitGlobals=function(e){var t=e.module,r=new Array,i=e.options.nativeSizeType,n=assert(e.program.visitInstance);e.compileFunction(n,!0);for(let s=Map_values(e.program.elementsByName),l=0,u=s.length;l<u;++l){let u=unchecked(s[l]);if(u.kind!=o.ElementKind.GLOBAL)continue;let p=u,_=p.type.getClass();if(null!==_&&!_.hasDecorator(o.DecoratorFlags.UNMANAGED)&&p.is(c.CommonFlags.COMPILED))if(p.is(c.CommonFlags.INLINED)){let i=p.constantIntegerValue;(i64_low(i)||i64_high(i))&&r.push(t.call(n.internalName,[e.options.isWasm64?t.i64(i64_low(i),i64_high(i)):t.i32(i64_low(i)),t.local_get(0,a.NativeType.I32)],a.NativeType.None))}else r.push(t.if(t.local_tee(1,t.global_get(p.internalName,i),!1),t.call(n.internalName,[t.local_get(1,i),t.local_get(0,a.NativeType.I32)],a.NativeType.None)))}t.addFunction(_.visit_globals,a.NativeType.I32,a.NativeType.None,[i],r.length?t.block(null,r):t.nop())},t.compileVisitMembers=function(e){var t=e.program,r=e.module,i=t.options.usizeType.toNativeType(),n=t.managedClasses,s=assert(t.visitInstance);e.compileFunction(s,!0);var o=new Array,l=new Array,u=0;for(let t=Map_keys(n),s=0,c=t.length;s<c;++s){let c=t[s];assert(c==u++);let p=assert(n.get(c));o[s]=p.internalName,p.isPointerfree?l[s]=r.return():(l[s]=r.block(null,[r.call(p.internalName+"~visit",[r.local_get(0,i),r.local_get(1,a.NativeType.I32)],a.NativeType.None),r.return()],a.NativeType.None),we(e,p))}var c=r.block(o[0],[r.switch(o,"invalid",r.load(4,!1,i==a.NativeType.I64?r.binary(a.BinaryOp.SubI64,r.local_get(0,i),r.i64(8)):r.binary(a.BinaryOp.SubI32,r.local_get(0,i),r.i32(8)),a.NativeType.I32,0))],a.NativeType.None);for(let e=0,t=o.length-1;e<t;++e)c=r.block(o[e+1],[c,l[e]],a.NativeType.None);c=r.block("invalid",[c,l[o.length-1]],a.NativeType.None),r.addFunction(_.visit_members,a.createType([i,a.NativeType.I32]),a.NativeType.None,null,r.flatten([c,r.unreachable()]))},t.compileRTTI=function(e){var t=e.program,r=e.module,i=t.managedClasses,n=i.size,s=4+8*n,o=new Uint8Array(s);p.writeI32(n,o,0);var l=4,u=t.arrayBufferViewInstance,c=u.prototype,h=t.arrayPrototype,d=t.setPrototype,m=t.mapPrototype,y=t.staticArrayPrototype,T=0;for(let e=Map_keys(i),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]),n=assert(i.get(r));assert(r==T++);let s=0;if(n.isPointerfree&&(s|=32),n!==u&&n.extends(c)){let e=n.getArrayValueType();s|=1,s|=64*Be(e)}else if(n.extends(h)){let e=n.getArrayValueType();s|=2,s|=64*Be(e)}else if(n.extends(d)){let e=assert(n.getTypeArgumentsTo(d));assert(1==e.length),s|=8,s|=64*Be(e[0])}else if(n.extends(m)){let e=assert(n.getTypeArgumentsTo(m));assert(2==e.length),s|=16,s|=32768*Be(e[0]),s|=64*Be(e[1])}else if(n.extends(y)){let e=n.getArrayValueType();s|=4,s|=64*Be(e)}p.writeI32(s,o,l),l+=4,n.rttiFlags=s;let a=n.base;p.writeI32(a?a.id:0,o,l),l+=4}assert(l==s);var g=t.options.usizeType,f=e.addAlignedMemorySegment(o);if(8==g.size){let e=f.offset;r.addGlobal(_.rtti_base,a.NativeType.I64,!1,r.i64(i64_low(e),i64_high(e)))}else r.addGlobal(_.rtti_base,a.NativeType.I32,!1,r.i32(i64_low(f.offset)))},t.compileClassInstanceOf=function(e,t){var r=e.module,i=e.options.nativeSizeType,n=assert(t.program.instanceofInstance);e.compileFunction(n);var s=new Array;s.push(r.if(r.unary(i==a.NativeType.I64?a.UnaryOp.EqzI64:a.UnaryOp.EqzI32,r.local_get(0,i)),r.return(r.i32(0))));var o=t.instances;if(null!==o&&o.size>0)for(let e=Map_values(o),t=0,l=e.length;t<l;++t){let o=unchecked(e[t]);s.push(r.if(r.call(n.internalName,[r.local_get(0,i),r.i32(o.id)],a.NativeType.I32),r.return(r.i32(1))))}s.push(r.return(r.i32(0))),r.addFunction(t.internalName+"~instanceof",i,a.NativeType.I32,null,r.flatten(s))}},200:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeinfoFlags=t.Typeinfo=t.Target=t.featureToString=t.Feature=t.CommonNames=t.STUB_DELIMITER=t.INDEX_SUFFIX=t.LIBRARY_PREFIX=t.LIBRARY_SUBST=t.INNER_DELIMITER=t.STATIC_DELIMITER=t.INSTANCE_DELIMITER=t.SETTER_PREFIX=t.GETTER_PREFIX=t.PARENT_SUBST=t.PATH_DELIMITER=t.CommonFlags=void 0,function(e){e[e.NONE=0]="NONE",e[e.IMPORT=1]="IMPORT",e[e.EXPORT=2]="EXPORT",e[e.DECLARE=4]="DECLARE",e[e.CONST=8]="CONST",e[e.LET=16]="LET",e[e.STATIC=32]="STATIC",e[e.READONLY=64]="READONLY",e[e.ABSTRACT=128]="ABSTRACT",e[e.PUBLIC=256]="PUBLIC",e[e.PRIVATE=512]="PRIVATE",e[e.PROTECTED=1024]="PROTECTED",e[e.GET=2048]="GET",e[e.SET=4096]="SET",e[e.DEFINITELY_ASSIGNED=8192]="DEFINITELY_ASSIGNED",e[e.AMBIENT=16384]="AMBIENT",e[e.GENERIC=32768]="GENERIC",e[e.GENERIC_CONTEXT=65536]="GENERIC_CONTEXT",e[e.INSTANCE=131072]="INSTANCE",e[e.CONSTRUCTOR=262144]="CONSTRUCTOR",e[e.MODULE_EXPORT=524288]="MODULE_EXPORT",e[e.MODULE_IMPORT=1048576]="MODULE_IMPORT",e[e.RESOLVED=2097152]="RESOLVED",e[e.COMPILED=4194304]="COMPILED",e[e.ERRORED=8388608]="ERRORED",e[e.INLINED=16777216]="INLINED",e[e.SCOPED=33554432]="SCOPED",e[e.STUB=67108864]="STUB",e[e.VIRTUAL=134217728]="VIRTUAL",e[e.CLOSURE=268435456]="CLOSURE",e[e.QUOTED=536870912]="QUOTED"}(t.CommonFlags||(t.CommonFlags={})),t.PATH_DELIMITER="/",t.PARENT_SUBST="..",t.GETTER_PREFIX="get:",t.SETTER_PREFIX="set:",t.INSTANCE_DELIMITER="#",t.STATIC_DELIMITER=".",t.INNER_DELIMITER="~",t.LIBRARY_SUBST="~lib",t.LIBRARY_PREFIX=t.LIBRARY_SUBST+t.PATH_DELIMITER,t.INDEX_SUFFIX=t.PATH_DELIMITER+"index",t.STUB_DELIMITER="@",function(e){e.EMPTY="",e.i8="i8",e.i16="i16",e.i32="i32",e.i64="i64",e.isize="isize",e.u8="u8",e.u16="u16",e.u32="u32",e.u64="u64",e.usize="usize",e.bool="bool",e.f32="f32",e.f64="f64",e.v128="v128",e.funcref="funcref",e.externref="externref",e.anyref="anyref",e.eqref="eqref",e.i31ref="i31ref",e.dataref="dataref",e.i8x16="i8x16",e.u8x16="u8x16",e.i16x8="i16x8",e.u16x8="u16x8",e.i32x4="i32x4",e.u32x4="u32x4",e.i64x2="i64x2",e.u64x2="u64x2",e.f32x4="f32x4",e.f64x2="f64x2",e.void_="void",e.number="number",e.boolean="boolean",e.string="string",e.native="native",e.indexof="indexof",e.valueof="valueof",e.returnof="returnof",e.null_="null",e.true_="true",e.false_="false",e.this_="this",e.super_="super",e.constructor="constructor",e.ASC_TARGET="ASC_TARGET",e.ASC_NO_TREESHAKING="ASC_NO_TREESHAKING",e.ASC_NO_ASSERT="ASC_NO_ASSERT",e.ASC_MEMORY_BASE="ASC_MEMORY_BASE",e.ASC_TABLE_BASE="ASC_TABLE_BASE",e.ASC_OPTIMIZE_LEVEL="ASC_OPTIMIZE_LEVEL",e.ASC_SHRINK_LEVEL="ASC_SHRINK_LEVEL",e.ASC_LOW_MEMORY_LIMIT="ASC_LOW_MEMORY_LIMIT",e.ASC_EXPORT_RUNTIME="ASC_EXPORT_RUNTIME",e.ASC_WASI="ASC_WASI",e.ASC_FEATURE_SIGN_EXTENSION="ASC_FEATURE_SIGN_EXTENSION",e.ASC_FEATURE_MUTABLE_GLOBALS="ASC_FEATURE_MUTABLE_GLOBALS",e.ASC_FEATURE_NONTRAPPING_F2I="ASC_FEATURE_NONTRAPPING_F2I",e.ASC_FEATURE_BULK_MEMORY="ASC_FEATURE_BULK_MEMORY",e.ASC_FEATURE_SIMD="ASC_FEATURE_SIMD",e.ASC_FEATURE_THREADS="ASC_FEATURE_THREADS",e.ASC_FEATURE_EXCEPTION_HANDLING="ASC_FEATURE_EXCEPTION_HANDLING",e.ASC_FEATURE_TAIL_CALLS="ASC_FEATURE_TAIL_CALLS",e.ASC_FEATURE_REFERENCE_TYPES="ASC_FEATURE_REFERENCE_TYPES",e.ASC_FEATURE_MULTI_VALUE="ASC_FEATURE_MULTI_VALUE",e.ASC_FEATURE_GC="ASC_FEATURE_GC",e.ASC_FEATURE_MEMORY64="ASC_FEATURE_MEMORY64",e.ASC_VERSION_MAJOR="ASC_VERSION_MAJOR",e.ASC_VERSION_MINOR="ASC_VERSION_MINOR",e.ASC_VERSION_PATCH="ASC_VERSION_PATCH",e.I8="I8",e.I16="I16",e.I32="I32",e.I64="I64",e.Isize="Isize",e.U8="U8",e.U16="U16",e.U32="U32",e.U64="U64",e.Usize="Usize",e.Bool="Bool",e.F32="F32",e.F64="F64",e.V128="V128",e.Funcref="Funcref",e.Externref="Externref",e.Anyref="Anyref",e.Eqref="Eqref",e.I31ref="I31ref",e.Dataref="Dataref",e.String="String",e.Object="Object",e.Array="Array",e.StaticArray="StaticArray",e.Set="Set",e.Map="Map",e.Function="Function",e.ArrayBufferView="ArrayBufferView",e.ArrayBuffer="ArrayBuffer",e.Math="Math",e.Mathf="Mathf",e.NativeMath="NativeMath",e.NativeMathf="NativeMathf",e.Int8Array="Int8Array",e.Int16Array="Int16Array",e.Int32Array="Int32Array",e.Int64Array="Int64Array",e.Uint8Array="Uint8Array",e.Uint8ClampedArray="Uint8ClampedArray",e.Uint16Array="Uint16Array",e.Uint32Array="Uint32Array",e.Uint64Array="Uint64Array",e.Float32Array="Float32Array",e.Float64Array="Float64Array",e.TemplateStringsArray="TemplateStringsArray",e.Error="Error",e.abort="abort",e.trace="trace",e.seed="seed",e.pow="pow",e.ipow32="ipow32",e.ipow64="ipow64",e.mod="mod",e.alloc="__alloc",e.realloc="__realloc",e.free="__free",e.new_="__new",e.renew="__renew",e.link="__link",e.collect="__collect",e.typeinfo="__typeinfo",e.instanceof_="__instanceof",e.visit="__visit",e.newBuffer="__newBuffer",e.newArray="__newArray",e.BLOCK="~lib/rt/common/BLOCK",e.OBJECT="~lib/rt/common/OBJECT"}(t.CommonNames||(t.CommonNames={}));var i=r(466);Object.defineProperty(t,"Feature",{enumerable:!0,get:function(){return i.Feature}}),Object.defineProperty(t,"featureToString",{enumerable:!0,get:function(){return i.featureToString}});var n=r(607);Object.defineProperty(t,"Target",{enumerable:!0,get:function(){return n.Target}});var s=r(604);Object.defineProperty(t,"Typeinfo",{enumerable:!0,get:function(){return s.Typeinfo}}),Object.defineProperty(t,"TypeinfoFlags",{enumerable:!0,get:function(){return s.TypeinfoFlags}})},220:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Compiler=t.ExportNames=t.RuntimeFeatures=t.Constraints=t.Options=void 0;const i=r(346),n=r(256),s=r(656),a=r(200),o=r(974),l=r(154),u=r(742),c=r(411),p=r(60),_=r(699),h=r(910),d=r(865),m=r(231);var y;t.Options=class{constructor(){this.target=a.Target.WASM32,this.noAssert=!1,this.exportMemory=!0,this.importMemory=!1,this.initialMemory=0,this.maximumMemory=0,this.sharedMemory=!1,this.importTable=!1,this.exportTable=!1,this.sourceMap=!1,this.explicitStart=!1,this.memoryBase=0,this.tableBase=0,this.globalAliases=null,this.features=2,this.noUnsafe=!1,this.pedantic=!1,this.lowMemoryLimit=0,this.exportRuntime=!1,this.stackSize=0,this.bundleMajorVersion=0,this.bundleMinorVersion=0,this.bundlePatchVersion=0,this.optimizeLevelHint=0,this.shrinkLevelHint=0}get isWasm64(){return this.target==a.Target.WASM64}get usizeType(){return this.target==a.Target.WASM64?_.Type.usize64:_.Type.usize32}get isizeType(){return this.target==a.Target.WASM64?_.Type.isize64:_.Type.isize32}get nativeSizeType(){return this.target==a.Target.WASM64?s.NativeType.I64:s.NativeType.I32}get willOptimize(){return this.optimizeLevelHint>0||this.shrinkLevelHint>0}hasFeature(e){return 0!=(this.features&e)}},function(e){e[e.NONE=0]="NONE",e[e.CONV_IMPLICIT=1]="CONV_IMPLICIT",e[e.CONV_EXPLICIT=2]="CONV_EXPLICIT",e[e.MUST_WRAP=4]="MUST_WRAP",e[e.WILL_DROP=8]="WILL_DROP",e[e.PREFER_STATIC=16]="PREFER_STATIC",e[e.IS_THIS=32]="IS_THIS"}(t.Constraints||(t.Constraints={})),function(e){e[e.NONE=0]="NONE",e[e.DATA=1]="DATA",e[e.STACK=2]="STACK",e[e.HEAP=4]="HEAP",e[e.RTTI=8]="RTTI",e[e.visitGlobals=16]="visitGlobals",e[e.visitMembers=32]="visitMembers",e[e.setArgumentsLength=64]="setArgumentsLength"}(t.RuntimeFeatures||(t.RuntimeFeatures={})),function(e){e.start="_start",e.argumentsLength="__argumentsLength",e.setArgumentsLength="__setArgumentsLength",e.memory="memory",e.table="table"}(y=t.ExportNames||(t.ExportNames={}));const T=["__new","__pin","__unpin","__collect"],g=["__rtti_base"];class f extends n.DiagnosticEmitter{constructor(e){super(e.diagnostics),this.currentParent=null,this.currentType=_.Type.void,this.memorySegments=[],this.stringSegments=new Map,this.functionTable=[],this.builtinArgumentsLength=0,this.runtimeFeatures=0,this.inlineStack=[],this.lazyFunctions=new Set,this.pendingClassInstanceOf=new Set,this.virtualCalls=new Set,this.pendingElements=new Set,this.doneModuleExports=new Set,this.f32ModInstance=null,this.f64ModInstance=null,this.f32PowInstance=null,this.f64PowInstance=null,this.i32PowInstance=null,this.i64PowInstance=null,this._reusableCallExpression=null,this.program=e;var t=e.options,r=s.Module.create(t.stackSize>0,t.nativeSizeType);this.module=r,t.memoryBase?(this.memoryOffset=i64_new(t.memoryBase),r.setLowMemoryUnused(!1)):!t.lowMemoryLimit&&t.optimizeLevelHint>=2?(this.memoryOffset=i64_new(1024),r.setLowMemoryUnused(!0)):(this.memoryOffset=i64_new(8),r.setLowMemoryUnused(!1));var n=0;t.hasFeature(1)&&(n|=s.FeatureFlags.SignExt),t.hasFeature(2)&&(n|=s.FeatureFlags.MutableGloabls),t.hasFeature(4)&&(n|=s.FeatureFlags.NontrappingFPToInt),t.hasFeature(8)&&(n|=s.FeatureFlags.BulkMemory),t.hasFeature(16)&&(n|=s.FeatureFlags.SIMD128),t.hasFeature(32)&&(n|=s.FeatureFlags.Atomics),t.hasFeature(64)&&(n|=s.FeatureFlags.ExceptionHandling),t.hasFeature(128)&&(n|=s.FeatureFlags.TailCall),t.hasFeature(256)&&(n|=s.FeatureFlags.ReferenceTypes),t.hasFeature(512)&&(n|=s.FeatureFlags.MultiValue),t.hasFeature(1024)&&(n|=s.FeatureFlags.GC),t.hasFeature(2048)&&(n|=s.FeatureFlags.Memory64),r.setFeatures(n);var a=e.makeNativeFunction(i.BuiltinNames.start,new _.Signature(e,[],_.Type.void));a.internalName=i.BuiltinNames.start,this.currentFlow=a.flow,this.currentBody=new Array,this.shadowStack=new m.ShadowStackPass(this)}get resolver(){return this.program.resolver}get options(){return this.program.options}static compile(e){return new f(e).compile()}compile(){var e=this.options,t=this.module,r=this.program,o=e.stackSize>0;this.program.initialize();var l=this.currentFlow.actualFunction;assert(l.internalName==i.BuiltinNames.start);var u=this.currentBody;assert(0==u.length),e.isWasm64?(t.addGlobal(i.BuiltinNames.data_end,s.NativeType.I64,!0,t.i64(0)),t.addGlobal(i.BuiltinNames.heap_base,s.NativeType.I64,!0,t.i64(0)),t.addGlobal(i.BuiltinNames.rtti_base,s.NativeType.I64,!0,t.i64(0))):(t.addGlobal(i.BuiltinNames.data_end,s.NativeType.I32,!0,t.i32(0)),t.addGlobal(i.BuiltinNames.heap_base,s.NativeType.I32,!0,t.i32(0)),t.addGlobal(i.BuiltinNames.rtti_base,s.NativeType.I32,!0,t.i32(0)));var c=r.filesByName;for(let e=Map_values(c),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);r.source.sourceKind==p.SourceKind.USER_ENTRY&&(this.compileFile(r),this.compileExports(r))}for(let e=Map_values(this.program.filesByName),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);r.source.sourceKind==p.SourceKind.USER_ENTRY&&this.ensureModuleExports(r)}if(this.options.exportRuntime){for(let e=0,i=T.length;e<i;++e){let i=T[e],n=r.requireFunction(i);this.compileFunction(n)&&!t.hasExport(i)&&t.addFunctionExport(n.internalName,i)}for(let e=0,i=g.length;e<i;++e){let i=g[e],n=r.requireGlobal(i);this.compileGlobal(n)&&!t.hasExport(i)&&t.addGlobalExport(n.internalName,i)}}var h=this.lazyFunctions;do{let e=new Array;for(let t=Set_values(h),r=0,i=t.length;r<i;++r){let i=unchecked(t[r]);e.push(i)}h.clear();for(let t=0,r=e.length;t<r;++t)this.compileFunction(unchecked(e[t]),!0)}while(h.size);for(let e=Set_values(this.pendingClassInstanceOf),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);i.compileClassInstanceOf(this,r)}var m=this.functionTable;for(let e=0,t=m.length;e<t;++e){let t=m[e];t.is(a.CommonFlags.VIRTUAL)?(assert(t.is(a.CommonFlags.INSTANCE)),m[e]=this.ensureVirtualStub(t),this.finalizeVirtualStub(t)):t.signature.requiredParameters<t.signature.parameterTypes.length&&(m[e]=this.ensureVarargsStub(t))}for(var f=this.virtualCalls;f.size;)for(let e=Set_values(f),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);this.finalizeVirtualStub(r),f.delete(r)}t.removeGlobal(i.BuiltinNames.rtti_base),8&this.runtimeFeatures&&i.compileRTTI(this),16&this.runtimeFeatures&&i.compileVisitGlobals(this),32&this.runtimeFeatures&&i.compileVisitMembers(this);var E=i64_align(this.memoryOffset,e.usizeType.byteSize);t.removeGlobal(i.BuiltinNames.data_end),(0!=(1&this.runtimeFeatures)||o)&&(e.isWasm64?t.addGlobal(i.BuiltinNames.data_end,s.NativeType.I64,!1,t.i64(i64_low(E),i64_high(E))):t.addGlobal(i.BuiltinNames.data_end,s.NativeType.I32,!1,t.i32(i64_low(E)))),t.removeGlobal(i.BuiltinNames.stack_pointer),(0!=(2&this.runtimeFeatures)||o)&&(E=i64_align(i64_add(E,i64_new(e.stackSize)),e.usizeType.byteSize),e.isWasm64?t.addGlobal(i.BuiltinNames.stack_pointer,s.NativeType.I64,!0,t.i64(i64_low(E),i64_high(E))):t.addGlobal(i.BuiltinNames.stack_pointer,s.NativeType.I32,!0,t.i32(i64_low(E)))),t.removeGlobal(i.BuiltinNames.heap_base),(0!=(4&this.runtimeFeatures)||o)&&(e.isWasm64?t.addGlobal(i.BuiltinNames.heap_base,s.NativeType.I64,!1,t.i64(i64_low(E),i64_high(E))):t.addGlobal(i.BuiltinNames.heap_base,s.NativeType.I32,!1,t.i32(i64_low(E)))),this.memoryOffset=E;var b=this.options.lowMemoryLimit;if(b){let e=i64_new(-16&b);i64_gt(E,e)&&this.error(n.DiagnosticCode.Low_memory_limit_exceeded_by_static_data_0_1,null,i64_to_string(E),i64_to_string(e))}var x=0;(this.options.memoryBase||this.memorySegments.length)&&(x=u32(i64_low(i64_shr_u(i64_align(E,65536),i64_new(16))))),e.initialMemory&&(e.initialMemory<x?this.error(n.DiagnosticCode.Module_requires_at_least_0_pages_of_initial_memory,null,x.toString()):x=e.initialMemory);var I=s.Module.UNLIMITED_MEMORY;e.maximumMemory&&(e.maximumMemory<x?this.error(n.DiagnosticCode.Module_requires_at_least_0_pages_of_maximum_memory,null,x.toString()):I=e.maximumMemory);var A=!1;e.sharedMemory&&(A=!0,e.maximumMemory||(this.error(n.DiagnosticCode.Shared_memory_requires_maximum_memory_to_be_defined,null),A=!1),e.hasFeature(32)||(this.error(n.DiagnosticCode.Shared_memory_requires_feature_threads_to_be_enabled,null),A=!1)),t.setMemory(x,I,this.memorySegments,e.target,e.exportMemory?y.memory:null,A),e.importMemory&&t.addMemoryImport("0","env","memory",A),e.importTable&&(t.addTableImport("0","env","table"),e.pedantic&&e.willOptimize&&this.pedantic(n.DiagnosticCode.Importing_the_table_disables_some_indirect_call_optimizations,null)),e.exportTable&&(t.addTableExport("0",y.table),e.pedantic&&e.willOptimize&&this.pedantic(n.DiagnosticCode.Exporting_the_table_disables_some_indirect_call_optimizations,null));var N=this.options.tableBase;N||(N=1);var S=new Array(m.length);for(let e=0,t=m.length;e<t;++e)S[e]=m[e].internalName;t.setFunctionTable(N+m.length,s.Module.UNLIMITED_TABLE,S,t.i32(N)),64&this.runtimeFeatures&&(t.addFunction(i.BuiltinNames.setArgumentsLength,s.NativeType.I32,s.NativeType.None,null,t.global_set(this.ensureArgumentsLength(),t.local_get(0,s.NativeType.I32))),t.addFunctionExport(i.BuiltinNames.setArgumentsLength,y.setArgumentsLength));var v=!u.length,C=r.isWasi||e.explicitStart;if(!v||C){let e=l.signature;!v&&C&&(t.addGlobal(i.BuiltinNames.started,s.NativeType.I32,!0,t.i32(0)),u.unshift(t.global_set(i.BuiltinNames.started,t.i32(1))),u.unshift(t.if(t.global_get(i.BuiltinNames.started,s.NativeType.I32),t.return())));let r=t.addFunction(l.internalName,e.nativeParams,e.nativeResults,_.typesToNativeTypes(l.additionalLocals),t.flatten(u));l.finalize(t,r),C?t.addFunctionExport(l.internalName,y.start):t.setStart(r)}return o&&this.shadowStack.walkModule(),null!=r.lookup("ASC_RTRACE")&&new d.RtraceMemory(this).walkModule(),t}ensureModuleExports(e){var t=e.exports;if(t)for(let e=Map_keys(t),r=0,i=e.length;r<i;++r){let i=unchecked(e[r]),n=assert(t.get(i));this.ensureModuleExport(i,n)}var r=e.exportsStar;if(r)for(let e=0,t=r.length;e<t;++e)this.ensureModuleExports(r[e])}ensureModuleExport(e,t,r=""){var i=this.module;switch(t.kind){case o.ElementKind.FUNCTION_PROTOTYPE:{let i=t,s=i.instances;if(null!==s&&s.size>0)for(let t=Map_values(s),i=0,n=t.length;i<n;++i){let n=unchecked(t[i]),s=e;if(n.is(a.CommonFlags.GENERIC)){let e=n.internalName;s+=e.substring(e.lastIndexOf("<"))}this.ensureModuleExport(s,n,r)}else i.is(a.CommonFlags.GENERIC)&&this.warning(n.DiagnosticCode.Exported_generic_function_or_class_has_no_concrete_instances,i.identifierNode.range);break}case o.ElementKind.CLASS_PROTOTYPE:{let i=t,s=i.instances;if(null!==s&&s.size>0)for(let t=Map_values(s),i=0,n=t.length;i<n;++i){let n=unchecked(t[i]),s=e;if(n.is(a.CommonFlags.GENERIC)){let e=n.internalName;s+=e.substring(e.lastIndexOf("<"))}this.ensureModuleExport(s,n,r)}else i.is(a.CommonFlags.GENERIC)&&this.warning(n.DiagnosticCode.Exported_generic_function_or_class_has_no_concrete_instances,i.identifierNode.range);break}case o.ElementKind.PROPERTY_PROTOTYPE:{let i=t.instance;i&&this.ensureModuleExport(e,i,r);break}case o.ElementKind.GLOBAL:{let s=t;if(s.is(a.CommonFlags.CONST)||s.is(a.CommonFlags.STATIC|a.CommonFlags.READONLY)||this.options.hasFeature(2)){if(s.is(a.CommonFlags.COMPILED)){let n=r+e;i.hasExport(n)||i.addGlobalExport(t.internalName,n)}}else this.error(n.DiagnosticCode.Cannot_export_a_mutable_global,s.identifierNode.range);break}case o.ElementKind.ENUMVALUE:{let s=t;if(s.isImmutable||this.options.hasFeature(2)){if(s.is(a.CommonFlags.COMPILED)){let n=r+e;i.hasExport(n)||i.addGlobalExport(t.internalName,n)}}else this.error(n.DiagnosticCode.Cannot_export_a_mutable_global,s.identifierNode.range);break}case o.ElementKind.FUNCTION:{let n=t;if(!n.hasDecorator(o.DecoratorFlags.BUILTIN)){let t=n.signature;if(t.requiredParameters<t.parameterTypes.length&&(n=this.ensureVarargsStub(n),this.runtimeFeatures|=64),n.is(a.CommonFlags.COMPILED)){let s=r+e;i.hasExport(s)||(i.addFunctionExport(n.internalName,s),t.hasManagedOperands&&this.shadowStack.noteExport(s,t.getManagedOperandIndices()))}}break}case o.ElementKind.PROPERTY:{let i=t,n=i.getterInstance;n&&this.ensureModuleExport(a.GETTER_PREFIX+e,n,r);let s=i.setterInstance;s&&this.ensureModuleExport(a.SETTER_PREFIX+e,s,r);break}case o.ElementKind.FIELD:{let n=t;if(t.is(a.CommonFlags.COMPILED)){let s=r+a.GETTER_PREFIX+e;if(this.compileFieldGetter(n)&&!i.hasExport(s)){i.addFunctionExport(n.internalGetterName,s);let e=n.internalGetterSignature;e.hasManagedOperands&&this.shadowStack.noteExport(s,e.getManagedOperandIndices())}if(!t.is(a.CommonFlags.READONLY)){let t=r+a.SETTER_PREFIX+e;if(this.compileFieldSetter(n)&&!i.hasExport(t)){i.addFunctionExport(n.internalSetterName,t);let e=n.internalSetterSignature;e.hasManagedOperands&&this.shadowStack.noteExport(t,e.getManagedOperandIndices())}}}break}case o.ElementKind.CLASS:{let i=t;if(!i.type.isUnmanaged){let n=this.module,a=i.internalName;this.doneModuleExports.has(t)||(n.addGlobal(a,s.NativeType.I32,!1,n.i32(i.id)),this.doneModuleExports.add(t)),n.addGlobalExport(a,r+e)}break}case o.ElementKind.ENUM:case o.ElementKind.INTERFACE_PROTOTYPE:case o.ElementKind.NAMESPACE:case o.ElementKind.TYPEDEFINITION:case o.ElementKind.INDEXSIGNATURE:break;default:assert(!1)}var l=t.members;if(l){let i=r+e+(t.kind==o.ElementKind.CLASS?a.INSTANCE_DELIMITER:a.STATIC_DELIMITER);if(t.kind==o.ElementKind.NAMESPACE){let e=t.is(a.CommonFlags.SCOPED);for(let t=Map_keys(l),r=0,n=t.length;r<n;++r){let n=unchecked(t[r]),s=assert(l.get(n));(e||s.is(a.CommonFlags.EXPORT))&&this.ensureModuleExport(n,s,i)}}else for(let e=Map_keys(l),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]),n=assert(l.get(r));n.is(a.CommonFlags.PRIVATE)||this.ensureModuleExport(r,n,i)}}}compileElement(e,t=!0){switch(e.kind){case o.ElementKind.GLOBAL:this.compileGlobal(e);break;case o.ElementKind.ENUM:this.compileEnum(e);break;case o.ElementKind.FUNCTION_PROTOTYPE:if(!e.is(a.CommonFlags.GENERIC)){let t=this.resolver.resolveFunction(e,null);t&&this.compileFunction(t)}break;case o.ElementKind.CLASS_PROTOTYPE:if(!e.is(a.CommonFlags.GENERIC)){let t=this.resolver.resolveClass(e,null);t&&this.compileClass(t)}break;case o.ElementKind.PROPERTY_PROTOTYPE:{let t=this.resolver.resolveProperty(e);t&&this.compileProperty(t);break}case o.ElementKind.INTERFACE_PROTOTYPE:case o.ElementKind.NAMESPACE:case o.ElementKind.TYPEDEFINITION:case o.ElementKind.ENUMVALUE:case o.ElementKind.INDEXSIGNATURE:break;default:assert(!1)}if(t){let t=e.members;if(t)for(let e=Map_values(t),r=0,i=e.length;r<i;++r){let t=unchecked(e[r]);this.compileElement(t)}}}compileExports(e){var t=e.exports;if(t)for(let e=Map_values(t),r=0,i=e.length;r<i;++r){let t=unchecked(e[r]);t.hasDecorator(o.DecoratorFlags.LAZY)||this.compileElement(t)}var r=e.exportsStar;if(r)for(let e=0,t=r.length;e<t;++e){let t=unchecked(r[e]);this.compileFile(t),this.compileExports(t)}}compileFileByPath(e,t){var r,i,s=this.program.filesByName;if(s.has(e))r=assert(s.get(e));else{if(!s.has(i=e+a.INDEX_SUFFIX))return void this.error(n.DiagnosticCode.File_0_not_found,t.range,e);r=assert(s.get(i))}this.compileFile(r)}compileFile(e){if(!e.is(a.CommonFlags.COMPILED)){e.set(a.CommonFlags.COMPILED);var t=e.startFunction,r=t.signature,i=this.currentBody,n=new Array;this.currentBody=n;var o=this.currentFlow,l=t.flow;this.currentFlow=l;for(let t=e.source.statements,r=0,i=t.length;r<i;++r)this.compileTopLevelStatement(t[r],n);if(this.currentFlow=o,this.currentBody=i,n.length){let e=this.module,a=t.localsByIndex,o=a.length,l=new Array(o);for(let e=0;e<o;++e)l[e]=a[e].type.toNativeType();e.addFunction(t.internalName,r.nativeParams,r.nativeResults,l,e.flatten(n)),i.push(e.call(t.internalName,null,s.NativeType.None))}}}compileGlobal(e){if(e.is(a.CommonFlags.COMPILED))return!e.is(a.CommonFlags.ERRORED);e.set(a.CommonFlags.COMPILED);var t=this.pendingElements;t.add(e);var r=this.module,l=0,u=e.typeNode,c=e.initializerNode;if(!e.is(a.CommonFlags.RESOLVED))if(u){let r=this.resolver.resolveType(u,e.parent);if(!r)return e.set(a.CommonFlags.ERRORED),t.delete(e),!1;if(r==_.Type.void)return this.error(n.DiagnosticCode.Type_expected,u.range),e.set(a.CommonFlags.ERRORED),t.delete(e),!1;e.setType(r),this.checkTypeSupported(e.type,u)}else{if(!c)return this.error(n.DiagnosticCode.Type_expected,e.identifierNode.range.atEnd),e.set(a.CommonFlags.ERRORED),t.delete(e),!1;{let r=this.currentFlow;if(e.hasDecorator(o.DecoratorFlags.LAZY)&&(this.currentFlow=e.file.startFunction.flow),l=this.compileExpression(c,_.Type.auto,20),this.currentFlow=r,this.currentType==_.Type.void)return this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,c.range,this.currentType.toString(),"<auto>"),e.set(a.CommonFlags.ERRORED),t.delete(e),!1;e.setType(this.currentType)}}if(e.is(a.CommonFlags.AMBIENT)&&e.hasDecorator(o.DecoratorFlags.BUILTIN)){let r=e.internalName;return r==i.BuiltinNames.data_end?this.runtimeFeatures|=1:r==i.BuiltinNames.stack_pointer?this.runtimeFeatures|=2:r==i.BuiltinNames.heap_base?this.runtimeFeatures|=4:r==i.BuiltinNames.rtti_base&&(this.runtimeFeatures|=8),t.delete(e),!0}var h=e.type,d=h.toNativeType(),m=e.is(a.CommonFlags.CONST)||e.is(a.CommonFlags.STATIC|a.CommonFlags.READONLY),y=e.hasDecorator(o.DecoratorFlags.INLINE);if(e.is(a.CommonFlags.AMBIENT))return m||this.options.hasFeature(2)?(e.set(a.CommonFlags.MODULE_IMPORT),E(e,e.declaration),r.addGlobalImport(e.internalName,b,x,d,!m),t.delete(e),!0):(this.error(n.DiagnosticCode.Feature_0_is_not_enabled,e.declaration.range,"mutable-globals"),e.set(a.CommonFlags.ERRORED),t.delete(e),!1);var T=!1;if(c){if(!l){let t=this.currentFlow;e.hasDecorator(o.DecoratorFlags.LAZY)&&(this.currentFlow=e.file.startFunction.flow),l=this.compileExpression(c,h,21),this.currentFlow=t}if(s.getExpressionId(l)!=s.ExpressionId.Const)if(m){if(s.getExpressionId(l)!=s.ExpressionId.Const){let e=r.runExpression(l,s.ExpressionRunnerFlags.PreserveSideeffects);e?l=e:T=!0}}else T=!0;if(T&&s.getExpressionId(l)==s.ExpressionId.GlobalGet){let e=assert(s.getGlobalGetName(l));if(!s.isGlobalMutable(r.getGlobal(e))){let t=this.program.elementsByName;if(t.has(e)){assert(t.get(e)).is(a.CommonFlags.AMBIENT)&&(T=!1)}}}if(y)if(T)this.warning(n.DiagnosticCode.Mutable_value_cannot_be_inlined,c.range);else{switch(assert(s.getExpressionId(l)==s.ExpressionId.Const),s.getExpressionType(l)){case s.NativeType.I32:e.constantValueKind=1,e.constantIntegerValue=i64_new(s.getConstValueI32(l),0);break;case s.NativeType.I64:e.constantValueKind=1,e.constantIntegerValue=i64_new(s.getConstValueI64Low(l),s.getConstValueI64High(l));break;case s.NativeType.F32:e.constantValueKind=2,e.constantFloatValue=s.getConstValueF32(l);break;case s.NativeType.F64:e.constantValueKind=2,e.constantFloatValue=s.getConstValueF64(l);break;default:return assert(!1),e.set(a.CommonFlags.ERRORED),t.delete(e),!1}e.set(a.CommonFlags.INLINED)}}else l=e.is(a.CommonFlags.INLINED)?this.compileInlineConstant(e,e.type,16):this.makeZero(h,e.declaration);var g=e.internalName;return T?(y&&this.error(n.DiagnosticCode.Decorator_0_is_not_valid_here,p.findDecorator(p.DecoratorKind.INLINE,e.decoratorNodes).range,"inline"),r.addGlobal(g,d,!0,this.makeZero(h,e.declaration)),this.currentBody.push(r.global_set(g,l))):y||r.addGlobal(g,d,!m,l),t.delete(e),!0}compileEnum(e){if(e.is(a.CommonFlags.COMPILED))return!e.is(a.CommonFlags.ERRORED);e.set(a.CommonFlags.COMPILED);var t=this.pendingElements;t.add(e);var r=this.module,i=this.currentParent;this.currentParent=e;var l=null,u=!1,c=e.is(a.CommonFlags.CONST)||e.hasDecorator(o.DecoratorFlags.INLINE),p=e.members;if(p)for(let t=Map_values(p),i=0,h=t.length;i<h;++i){let p=unchecked(t[i]);if(p.kind!=o.ElementKind.ENUMVALUE)continue;let h=!1,d=p,m=d.valueNode;d.set(a.CommonFlags.COMPILED);let y,T=this.currentFlow;if(e.hasDecorator(o.DecoratorFlags.LAZY)&&(this.currentFlow=e.file.startFunction.flow),m){if(y=this.compileExpression(m,_.Type.i32,1),s.getExpressionId(y)!=s.ExpressionId.Const){let t=r.runExpression(y,s.ExpressionRunnerFlags.PreserveSideeffects);t?y=t:(e.is(a.CommonFlags.CONST)&&this.error(n.DiagnosticCode.In_const_enum_declarations_member_initializer_must_be_constant_expression,m.range),h=!0)}}else if(null==l)y=r.i32(0);else if(u&&this.error(n.DiagnosticCode.Enum_member_must_have_initializer,d.identifierNode.range.atEnd),c){let e=i64_add(l.constantIntegerValue,i64_new(1));assert(!i64_high(e)),y=r.i32(i64_low(e))}else{y=r.binary(s.BinaryOp.AddI32,r.global_get(l.internalName,s.NativeType.I32),r.i32(1));let t=r.runExpression(y,s.ExpressionRunnerFlags.PreserveSideeffects);t?y=t:(e.is(a.CommonFlags.CONST)&&this.error(n.DiagnosticCode.In_const_enum_declarations_member_initializer_must_be_constant_expression,p.declaration.range),h=!0)}this.currentFlow=T,h?(r.addGlobal(d.internalName,s.NativeType.I32,!0,r.i32(0)),this.currentBody.push(this.makeGlobalAssignment(d,y,_.Type.i32,!1)),u=!0):(c?(d.setConstantIntegerValue(i64_new(s.getConstValueI32(y)),_.Type.i32),d.is(a.CommonFlags.MODULE_EXPORT)&&r.addGlobal(d.internalName,s.NativeType.I32,!1,y)):r.addGlobal(d.internalName,s.NativeType.I32,!1,y),d.isImmutable=!0,u=!1),l=d}return this.currentParent=i,t.delete(e),!0}compileFunction(e,t=!1){if(e.is(a.CommonFlags.COMPILED))return!e.is(a.CommonFlags.ERRORED);if(!t){if(e.hasDecorator(o.DecoratorFlags.BUILTIN))return!0;if(e.hasDecorator(o.DecoratorFlags.LAZY))return this.lazyFunctions.add(e),!0}e.set(a.CommonFlags.COMPILED);var r=this.pendingElements;r.add(e);var i,s=this.currentType,l=this.module,u=e.signature,c=e.prototype.bodyNode,h=e.declaration;if(assert(h.kind==p.NodeKind.FUNCTIONDECLARATION||h.kind==p.NodeKind.METHODDECLARATION),this.checkSignatureSupported(e.signature,h.signature),c){if(e.is(a.CommonFlags.AMBIENT)&&this.error(n.DiagnosticCode.An_implementation_cannot_be_declared_in_ambient_contexts,e.identifierNode.range),e.hasDecorator(o.DecoratorFlags.EXTERNAL)){let t=e.decoratorNodes,r=assert(p.findDecorator(p.DecoratorKind.EXTERNAL,t));this.error(n.DiagnosticCode.Decorator_0_is_not_valid_here,r.range,"external")}let t=this.currentFlow,r=e.flow;this.currentFlow=r;let s=new Array;this.compileFunctionBody(e,s)||s.push(l.unreachable()),this.currentFlow=t,i=l.addFunction(e.internalName,u.nativeParams,u.nativeResults,_.typesToNativeTypes(e.additionalLocals),l.flatten(s,e.signature.returnType.toNativeType()))}else e.is(a.CommonFlags.AMBIENT)?(e.set(a.CommonFlags.MODULE_IMPORT),E(e,h),l.addFunctionImport(e.internalName,b,x,u.nativeParams,u.nativeResults),i=l.getFunction(e.internalName)):e.is(a.CommonFlags.ABSTRACT)||e.parent.kind==o.ElementKind.INTERFACE?i=l.addFunction(e.internalName,u.nativeParams,u.nativeResults,null,l.unreachable()):(this.error(n.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,e.identifierNode.range),i=0,e.set(a.CommonFlags.ERRORED));return e.finalize(l,i),this.currentType=s,r.delete(e),!0}compileFunctionBody(e,t){var r=this.module,i=assert(e.prototype.bodyNode),l=e.signature.returnType,u=this.currentFlow,c=e.signature.thisType?assert(u.lookupLocal(a.CommonNames.this_)):null,h=t.length;if(i.kind==p.NodeKind.BLOCK)t=this.compileStatements(i.statements,!0,t);else{assert(i.kind==p.NodeKind.EXPRESSION),assert(e.prototype.arrowKind),assert(!e.isAny(a.CommonFlags.CONSTRUCTOR|a.CommonFlags.GET|a.CommonFlags.SET));let r=this.compileExpression(i.expression,l,1);u.canOverflow(r,l)||u.set(2),u.isNonnull(r,l)&&u.set(4),t?t.push(r):t=[r],u.is(256)||(u.canOverflow(r,l)||u.set(2),u.isNonnull(r,l)&&u.set(4),u.set(257))}if(e.is(a.CommonFlags.CONSTRUCTOR)){assert(e.is(a.CommonFlags.INSTANCE)),c=assert(c);let i=assert(e.parent);assert(i.kind==o.ElementKind.CLASS);let l=i;if(u.isAny(8256)||!u.is(256)){let i=new Array;i.push(this.makeConditionalAllocation(l,c.index)),this.makeFieldInitializationInConstructor(l,i);for(let e=t.length-1;e>=h;--e)t[e+1]=t[e];t[h]=r.flatten(i,s.NativeType.None),u.is(16384)&&this.options.pedantic&&this.pedantic(n.DiagnosticCode.Explicitly_returning_constructor_drops_this_allocation,e.identifierNode.range)}u.is(16384)&&!l.hasDecorator(o.DecoratorFlags.FINAL)&&this.error(n.DiagnosticCode.A_class_with_a_constructor_explicitly_returning_something_else_than_this_must_be_final,l.identifierNode.range),u.is(256)||(t.push(r.local_get(c.index,this.options.nativeSizeType)),u.set(261)),null===l.base||u.is(128)||this.error(n.DiagnosticCode.Constructors_for_derived_classes_must_contain_a_super_call,e.prototype.declaration.range)}else if(l!=_.Type.void&&!u.is(256))return this.error(n.DiagnosticCode.A_function_whose_declared_type_is_not_void_must_return_a_value,e.prototype.functionTypeNode.returnType.range),!1;return!0}compileClass(e){if(e.is(a.CommonFlags.COMPILED))return!0;e.set(a.CommonFlags.COMPILED);var t=e.prototype.members;if(t)for(let e=Map_values(t),r=0,i=e.length;r<i;++r){let t=unchecked(e[r]);switch(t.kind){case o.ElementKind.GLOBAL:this.compileGlobal(t);break;case o.ElementKind.FUNCTION_PROTOTYPE:{if(t.is(a.CommonFlags.GENERIC))break;let e=this.resolver.resolveFunction(t,null);if(!e)break;t=e}case o.ElementKind.FUNCTION:this.compileFunction(t);break;case o.ElementKind.PROPERTY_PROTOTYPE:{let e=this.resolver.resolveProperty(t);if(!e)break;t=e}case o.ElementKind.PROPERTY:this.compileProperty(t)}}this.ensureConstructor(e,e.identifierNode),this.checkFieldInitialization(e);var r=e.members;if(r)for(let e=Map_values(r),t=0,i=e.length;t<i;++t){let r=unchecked(e[t]);switch(r.kind){case o.ElementKind.FUNCTION_PROTOTYPE:{if(r.is(a.CommonFlags.GENERIC))break;let e=this.resolver.resolveFunction(r,null);if(!e)break;r=e}case o.ElementKind.FUNCTION:this.compileFunction(r);break;case o.ElementKind.FIELD:this.compileField(r);break;case o.ElementKind.PROPERTY_PROTOTYPE:{let e=this.resolver.resolveProperty(r);if(!e)break;r=e}case o.ElementKind.PROPERTY:this.compileProperty(r)}}return!0}compileField(e){return this.compileFieldGetter(e),this.compileFieldSetter(e),e.is(a.CommonFlags.COMPILED)}compileFieldGetter(e){if(e.getterRef)return!0;var t=this.module,r=e.type,i=r.toNativeType(),n=this.options.nativeSizeType;if(e.getterRef=t.addFunction(e.internalGetterName,n,i,null,t.load(r.byteSize,r.isSignedIntegerValue,t.local_get(0,n),i,e.memoryOffset)),e.setterRef)e.set(a.CommonFlags.COMPILED);else{let t=e.typeNode;t&&this.checkTypeSupported(e.type,t)}return!0}compileFieldSetter(e){if(e.setterRef)return!0;var t=e.type,r=this.options.nativeSizeType,i=t.toNativeType(),n=this.module,l=n.store(t.byteSize,n.local_get(0,r),n.local_get(1,i),i,e.memoryOffset);if(t.isManaged){let t=e.parent;if(assert(t.kind==o.ElementKind.CLASS),t.type.isManaged){let e=this.program.linkInstance;this.compileFunction(e),l=n.block(null,[l,n.call(e.internalName,[n.local_get(0,r),n.local_get(1,i),n.i32(0)],s.NativeType.None)],s.NativeType.None)}}if(e.setterRef=n.addFunction(e.internalSetterName,s.createType([r,i]),s.NativeType.None,null,l),e.getterRef)e.set(a.CommonFlags.COMPILED);else{let t=e.typeNode;t&&this.checkTypeSupported(e.type,t)}return!0}compileProperty(e){return this.compilePropertyGetter(e),this.compilePropertySetter(e),e.is(a.CommonFlags.COMPILED)}compilePropertyGetter(e){var t=e.getterInstance;if(t){let r=this.compileFunction(t),i=e.setterInstance;return!t.is(a.CommonFlags.COMPILED)||i&&!i.is(a.CommonFlags.COMPILED)||e.set(a.CommonFlags.COMPILED),r}return!1}compilePropertySetter(e){var t=e.setterInstance;if(t){let r=this.compileFunction(t),i=e.getterInstance;return null!==i&&i.is(a.CommonFlags.COMPILED)&&t.is(a.CommonFlags.COMPILED)&&e.set(a.CommonFlags.COMPILED),r}return!1}addAlignedMemorySegment(e,t=16){assert(h.isPowerOf2(t));var r=i64_align(this.memoryOffset,t),i=new s.MemorySegment(e,r);return this.memorySegments.push(i),this.memoryOffset=i64_add(r,i64_new(e.length)),i}addRuntimeMemorySegment(e){var t=this.program.computeBlockStart64(this.memoryOffset),r=new s.MemorySegment(e,t);return this.memorySegments.push(r),this.memoryOffset=i64_add(t,i64_new(e.length)),r}ensureStaticString(e){var t=this.ensureStaticStringPtr(e);return this.currentType=this.program.stringInstance.type,this.module.usize(t)}ensureStaticStringPtr(e){var t,r=this.program,i=r.totalOverhead,n=assert(r.stringInstance),s=this.stringSegments;if(s.has(e))t=assert(s.get(e));else{let r=e.length,a=n.createBuffer(r<<1);for(let t=0;t<r;++t)h.writeI16(e.charCodeAt(t),a,i+(t<<1));t=this.addRuntimeMemorySegment(a),s.set(e,t)}return i64_add(t.offset,i64_new(i))}writeStaticBuffer(e,t,r,i){var n=i.length,a=r.byteSize,o=r.toNativeType();switch(o){case s.NativeType.I32:switch(a){case 1:for(let r=0;r<n;++r){let n=i[r];assert(s.getExpressionType(n)==o),assert(s.getExpressionId(n)==s.ExpressionId.Const),h.writeI8(s.getConstValueI32(n),e,t),t+=1}break;case 2:for(let r=0;r<n;++r){let n=i[r];assert(s.getExpressionType(n)==o),assert(s.getExpressionId(n)==s.ExpressionId.Const),h.writeI16(s.getConstValueI32(n),e,t),t+=2}break;case 4:for(let r=0;r<n;++r){let n=i[r];assert(s.getExpressionType(n)==o),assert(s.getExpressionId(n)==s.ExpressionId.Const),h.writeI32(s.getConstValueI32(n),e,t),t+=4}break;default:assert(!1)}break;case s.NativeType.I64:for(let r=0;r<n;++r){let n=i[r];assert(s.getExpressionType(n)==o),assert(s.getExpressionId(n)==s.ExpressionId.Const),h.writeI64(i64_new(s.getConstValueI64Low(n),s.getConstValueI64High(n)),e,t),t+=8}break;case s.NativeType.F32:for(let r=0;r<n;++r){let n=i[r];assert(s.getExpressionType(n)==o),assert(s.getExpressionId(n)==s.ExpressionId.Const),h.writeF32(s.getConstValueF32(n),e,t),t+=4}break;case s.NativeType.F64:for(let r=0;r<n;++r){let n=i[r];assert(s.getExpressionType(n)==o),assert(s.getExpressionId(n)==s.ExpressionId.Const),h.writeF64(s.getConstValueF64(n),e,t),t+=8}break;default:assert(!1)}return t}addStaticBuffer(e,t,r=this.program.arrayBufferInstance.id){var i=this.program,n=i.arrayBufferInstance.createBuffer(t.length*e.byteSize);return this.program.OBJECTInstance.writeField("rtId",r,n,0),this.writeStaticBuffer(n,i.totalOverhead,e,t),this.addRuntimeMemorySegment(n)}addStaticArrayHeader(e,t,r=null){var i=this.program;r||(r=assert(this.resolver.resolveClass(this.program.arrayPrototype,[e])));var n=h.readI32(t.buffer,i.OBJECTInstance.offsetof("rtSize")),s=i32(n/e.byteSize),a=i64_add(t.offset,i64_new(i.totalOverhead)),o=r.createBuffer();return assert(r.writeField("buffer",a,o)),assert(r.writeField("dataStart",a,o)),assert(r.writeField("byteLength",n,o)),assert(r.writeField("length_",s,o)),this.addRuntimeMemorySegment(o)}ensureRuntimeFunction(e){assert(e.is(a.CommonFlags.COMPILED)&&!e.is(a.CommonFlags.STUB));var t=this.program,r=e.memorySegment;if(!r){let i=this.functionTable,n=this.options.tableBase;n||(n=1);let s=n+i.length;i.push(e);let a=assert(this.resolver.resolveClass(t.functionPrototype,[e.type])),o=a.createBuffer();assert(a.writeField("_index",s,o)),assert(a.writeField("_env",0,o)),e.memorySegment=r=this.addRuntimeMemorySegment(o)}return i64_add(r.offset,i64_new(t.totalOverhead))}compileTopLevelStatement(e,t){switch(e.kind){case p.NodeKind.CLASSDECLARATION:{let r=e.members;for(let e=0,i=r.length;e<i;++e)this.compileTopLevelStatement(r[e],t);break}case p.NodeKind.ENUMDECLARATION:{let t=this.program.getElementByDeclaration(e);t&&(assert(t.kind==o.ElementKind.ENUM),t.hasDecorator(o.DecoratorFlags.LAZY)||this.compileEnum(t));break}case p.NodeKind.NAMESPACEDECLARATION:{let r=e,i=this.program.getElementByDeclaration(r);if(i){let e=this.currentParent;this.currentParent=i;let n=r.members;for(let e=0,r=n.length;e<r;++e)this.compileTopLevelStatement(n[e],t);this.currentParent=e}break}case p.NodeKind.VARIABLE:{let t=e.declarations;for(let e=0,r=t.length;e<r;++e){let r=this.program.getElementByDeclaration(t[e]);r&&(assert(r.kind==o.ElementKind.GLOBAL),r.is(a.CommonFlags.AMBIENT)||r.hasDecorator(o.DecoratorFlags.LAZY)||this.compileGlobal(r))}break}case p.NodeKind.FIELDDECLARATION:{let t=this.program.getElementByDeclaration(e);null!==t&&t.kind==o.ElementKind.GLOBAL&&(t.hasDecorator(o.DecoratorFlags.LAZY)||this.compileGlobal(t));break}case p.NodeKind.EXPORT:{let t=e,r=t.internalPath;null!==r&&this.compileFileByPath(r,assert(t.path));break}case p.NodeKind.EXPORTDEFAULT:this.compileTopLevelStatement(e.declaration,t);break;case p.NodeKind.IMPORT:{let t=e;this.compileFileByPath(t.internalPath,t.path);break}case p.NodeKind.FUNCTIONDECLARATION:case p.NodeKind.METHODDECLARATION:case p.NodeKind.INTERFACEDECLARATION:case p.NodeKind.INDEXSIGNATURE:case p.NodeKind.TYPEDECLARATION:break;default:{let r=this.compileStatement(e);s.getExpressionId(r)!=s.ExpressionId.Nop&&t.push(r);break}}}compileStatement(e,t=!1){var r,i=this.module;switch(e.kind){case p.NodeKind.BLOCK:r=this.compileBlockStatement(e);break;case p.NodeKind.BREAK:r=this.compileBreakStatement(e);break;case p.NodeKind.CONTINUE:r=this.compileContinueStatement(e);break;case p.NodeKind.DO:r=this.compileDoStatement(e);break;case p.NodeKind.EMPTY:r=this.compileEmptyStatement(e);break;case p.NodeKind.EXPRESSION:r=this.compileExpressionStatement(e);break;case p.NodeKind.FOR:r=this.compileForStatement(e);break;case p.NodeKind.FOROF:r=this.compileForOfStatement(e);break;case p.NodeKind.IF:r=this.compileIfStatement(e);break;case p.NodeKind.RETURN:r=this.compileReturnStatement(e,t);break;case p.NodeKind.SWITCH:r=this.compileSwitchStatement(e);break;case p.NodeKind.THROW:r=this.compileThrowStatement(e);break;case p.NodeKind.TRY:r=this.compileTryStatement(e);break;case p.NodeKind.VARIABLE:(r=this.compileVariableStatement(e))||(r=i.nop());break;case p.NodeKind.VOID:r=this.compileVoidStatement(e);break;case p.NodeKind.WHILE:r=this.compileWhileStatement(e);break;case p.NodeKind.TYPEDECLARATION:this.error(n.DiagnosticCode.Not_implemented_0,e.range,"Inner type alias"),r=i.unreachable();break;default:assert(!1),r=i.unreachable()}return this.options.sourceMap&&this.addDebugLocation(r,e.range),r}compileStatements(e,t=!1,r=null){var i=e.length;r||((r=new Array(i)).length=0);var n=this.module,a=this.currentFlow;for(let o=0;o<i;++o){let l=this.compileStatement(e[o],t&&o==i-1);switch(s.getExpressionId(l)){case s.ExpressionId.Block:if(!s.getBlockName(l)){for(let e=0,t=s.getBlockChildCount(l);e<t;++e)r.push(s.getBlockChildAt(l,e));break}default:r.push(l);case s.ExpressionId.Nop:}if(a.isAny(272)){s.needsExplicitUnreachable(l)&&r.push(n.unreachable());break}}return r}compileBlockStatement(e){var t=e.statements,r=this.currentFlow,i=r.fork();this.currentFlow=i;var n=this.compileStatements(t);return i.freeScopedLocals(),r.inherit(i),this.currentFlow=r,this.module.flatten(n)}compileBreakStatement(e){var t=this.module,r=e.label;if(r)return this.error(n.DiagnosticCode.Not_implemented_0,r.range,"Break label"),t.unreachable();var i=this.currentFlow,s=i.breakLabel;return null==s?(this.error(n.DiagnosticCode.A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement,e.range),t.unreachable()):(i.freeScopedLocals(),i.set(16),t.br(s))}compileContinueStatement(e){var t=this.module,r=e.label;if(r)return this.error(n.DiagnosticCode.Not_implemented_0,r.range,"Continue label"),t.unreachable();var i=this.currentFlow,s=i.continueLabel;return null==s?(this.error(n.DiagnosticCode.A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement,e.range),t.unreachable()):(i.set(288),i.freeScopedLocals(),t.br(s))}compileDoStatement(e){return this.doCompileDoStatement(e,null)}doCompileDoStatement(e,t){var r=this.module,i=this.currentFlow,n=i.pushBreakLabel(),a=i.fork(!0);t&&a.unifyLocalFlags(t);var o=a.fork();this.currentFlow=a;var u="do-break|"+n;a.breakLabel=u;var c="do-continue|"+n;a.continueLabel=c;var h=a.fork();this.currentFlow=h;var d=new Array,m=e.statement;if(m.kind==p.NodeKind.BLOCK?this.compileStatements(m.statements,!1,d):d.push(this.compileStatement(m)),h.isAny(272))d.push(r.unreachable()),a.inherit(h);else{let t=a.fork();this.currentFlow=t;let n=this.makeIsTrueish(this.compileExpression(e.condition,_.Type.i32),this.currentType,e.condition),u=this.evaluateCondition(n);if(2==u)d.push(r.drop(n)),a.inherit(h);else if(1!=u||h.isAny(2064)){let u=t.getTempLocal(_.Type.bool);if(d.push(r.local_set(u.index,n,!1)),d.push(r.br(c,r.local_get(u.index,s.NativeType.I32))),t.freeTempLocal(u),a.inherit(t),l.Flow.hasIncompatibleLocalStates(o,a))return i.popBreakLabel(),this.currentFlow=i,this.doCompileDoStatement(e,a)}else d.push(r.drop(n)),d.push(r.br(c)),a.set(256)}assert(!a.hasScopedLocals),i.inherit(a),i.popBreakLabel(),this.currentFlow=i;var y=r.block(u,[r.loop(c,r.flatten(d))]);return i.is(256)&&(y=r.block(null,[y,r.unreachable()])),y}compileEmptyStatement(e){return this.module.nop()}compileExpressionStatement(e){return this.compileExpression(e.expression,_.Type.void,1)}compileForStatement(e){return this.doCompileForStatement(e,null)}doCompileForStatement(e,t){var r=this.module,i=this.currentFlow,n=i.pushBreakLabel(),a=new Array,o=i.fork(!0);this.currentFlow=o;var u="for-break"+n;o.breakLabel=u;var c="for-continue|"+n;o.continueLabel=c;var h="for-loop|"+n,d=e.initializer;d&&(assert(d.kind==p.NodeKind.EXPRESSION||d.kind==p.NodeKind.VARIABLE),a.push(this.compileStatement(d))),t&&o.unifyLocalFlags(t);var m,y,T=o.fork(),g=o.fork();this.currentFlow=g;var f=e.condition;if(f){if(m=this.makeIsTrueish(this.compileExpression(f,_.Type.bool),this.currentType,f),2==(y=this.evaluateCondition(m)))return a.push(r.drop(m)),g.freeScopedLocals(),o.inherit(g),o.freeScopedLocals(),i.inherit(o),i.popBreakLabel(),this.currentFlow=i,r.flatten(a)}else m=r.i32(1),y=1;var E=o.getTempLocal(_.Type.bool),b=new Array;b.push(r.local_set(E.index,m,!1)),g.freeScopedLocals(),o.inherit(g),this.currentFlow=o;var x=o.fork();x.inheritNonnullIfTrue(m),this.currentFlow=x;var I=new Array,A=e.statement;A.kind==p.NodeKind.BLOCK?this.compileStatements(A.statements,!1,I):I.push(this.compileStatement(A)),x.isAny(272)&&I.push(r.unreachable()),1==y?o.inherit(x):o.inheritBranch(x),x.freeScopedLocals();var N=new Array;if(N.push(r.block(c,I)),!x.is(256)||x.isAny(4128)){let t=e.incrementor;if(t){let e=o.fork();this.currentFlow=e,N.push(this.compileExpression(t,_.Type.void,9)),e.freeScopedLocals(),o.inherit(e),this.currentFlow=o}if(N.push(r.br(h)),l.Flow.hasIncompatibleLocalStates(T,o))return assert(!x.hasScopedLocals),o.freeScopedLocals(),i.popBreakLabel(),this.currentFlow=i,this.doCompileForStatement(e,o)}return b.push(r.if(r.local_get(E.index,s.NativeType.I32),r.flatten(N))),a.push(r.block(u,[r.loop(h,r.flatten(b))])),o.freeTempLocal(E),this.currentFlow=o,o.freeScopedLocals(),i.inherit(o),i.popBreakLabel(),i.is(256)&&a.push(r.unreachable()),this.currentFlow=i,r.flatten(a)}compileForOfStatement(e){return this.error(n.DiagnosticCode.Not_implemented_0,e.range,"Iterators"),this.module.unreachable()}compileIfStatement(e){var t=this.module,r=e.ifTrue,i=e.ifFalse,n=this.makeIsTrueish(this.compileExpression(e.condition,_.Type.bool),this.currentType,e.condition);switch(this.evaluateCondition(n)){case 1:return t.block(null,[t.drop(n),this.compileStatement(r)]);case 2:return i?t.block(null,[t.drop(n),this.compileStatement(i)]):t.drop(n)}var s=this.currentFlow,a=new Array,o=s.fork();if(this.currentFlow=o,o.inheritNonnullIfTrue(n),r.kind==p.NodeKind.BLOCK?this.compileStatements(r.statements,!1,a):a.push(this.compileStatement(r)),o.isAny(272)&&a.push(t.unreachable()),o.freeScopedLocals(),this.currentFlow=s,i){let e=new Array,r=s.fork();return this.currentFlow=r,r.inheritNonnullIfFalse(n),i.kind==p.NodeKind.BLOCK?this.compileStatements(i.statements,!1,e):e.push(this.compileStatement(i)),r.isAny(272)&&e.push(t.unreachable()),r.freeScopedLocals(),this.currentFlow=s,s.inheritMutual(o,r),t.if(n,t.flatten(a),t.flatten(e))}return s.inheritBranch(o),s.inheritNonnullIfFalse(n,o.isAny(272)?null:o),t.if(n,t.flatten(a))}compileReturnStatement(e,t){var r=this.module,i=0,s=this.currentFlow,o=s.returnType,l=e.value;if(l){if(o==_.Type.void)return this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,l.range,this.currentType.toString(),o.toString()),this.currentType=_.Type.void,r.unreachable();let e=1;s.actualFunction.is(a.CommonFlags.MODULE_EXPORT)&&(e|=4),i=this.compileExpression(l,o,e),s.canOverflow(i,o)||s.set(2),s.isNonnull(i,o)&&s.set(4),s.actualFunction.is(a.CommonFlags.CONSTRUCTOR)&&l.kind!=p.NodeKind.THIS&&s.set(16384)}else if(o!=_.Type.void)return this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,e.range,"void",o.toString()),this.currentType=o,r.unreachable();return s.freeScopedLocals(),s.set(257),s.isInline?t&&0!=i?i:r.br(assert(s.inlineReturnLabel),0,i):t&&0!=i?i:r.return(i)}compileSwitchStatement(e){var t=this.module,r=e.cases,i=r.length;if(!i)return this.compileExpression(e.condition,_.Type.void,1);var n=this.currentFlow,a=n.pushBreakLabel(),o=n.getTempLocal(_.Type.u32),l=o.index,u=new Array(1+i);u[0]=t.local_set(l,this.compileExpression(e.condition,_.Type.u32,1),!1);var c=1,p=-1;for(let e=0;e<i;++e){let i=r[e].label;i?u[c++]=t.br("case"+e.toString()+"|"+a,t.binary(s.BinaryOp.EqI32,t.local_get(l,s.NativeType.I32),this.compileExpression(i,_.Type.u32,1))):p=e}n.freeTempLocal(o),u[c]=t.br((p>=0?"case"+p.toString():"break")+"|"+a);var h=t.block("case0|"+a,u,s.NativeType.None),d=511,m=0;for(let e=0;e<i;++e){let o=r[e].statements,l=o.length,u=n.fork();this.currentFlow=u;let c="break|"+a;u.breakLabel=c;let p=e==i-1,_=p?c:"case"+(e+1).toString()+"|"+a,y=new Array(1+l);y[0]=h;let T=1,g=!1;for(let e=0;e<l;++e){let t=this.compileStatement(o[e]);if(s.getExpressionId(t)!=s.ExpressionId.Nop&&(y[T++]=t),u.isAny(272)){u.is(256)&&(g=!0);break}}y.length=T,(g||p||u.isAny(2064))&&(d&=u.flags),m|=15872&u.flags,u.unset(2064),u.freeScopedLocals(),this.currentFlow=n,h=t.block(_,y,s.NativeType.None)}return n.popBreakLabel(),p>=0&&(n.flags|=-17&d),n.flags|=-2049&m,h}compileThrowStatement(e){var t=this.currentFlow;t.set(264);var r=new Array,i=e.value,n=null;if(i.kind==p.NodeKind.NEW){let e=i.args;e.length&&(n=e[0])}return r.push(this.makeAbort(n,e)),t.freeScopedLocals(),this.module.flatten(r)}compileTryStatement(e){return this.error(n.DiagnosticCode.Not_implemented_0,e.range,"Exceptions"),this.module.unreachable()}compileVariableStatement(e){var t=this.module,r=e.declarations,i=r.length,u=this.currentFlow,c=new Array,p=this.resolver;for(let e=0;e<i;++e){let i=r[e],d=i.name.text,m=null,y=0,T=i.type,g=i.initializer;if(T){if(m=p.resolveType(T,u.actualFunction,h.uniqueMap(u.contextualTypeArguments)),!m)continue;if(this.checkTypeSupported(m,T),g){let e=this.pendingElements,t=u.addScopedDummyLocal(d,m);e.add(t),y=this.compileExpression(g,m,1),e.delete(t),u.freeScopedDummyLocal(d)}}else{if(!g){this.error(n.DiagnosticCode.Type_expected,i.name.range.atEnd);continue}{let e=this.pendingElements,t=u.addScopedDummyLocal(d,_.Type.auto);if(e.add(t),y=this.compileExpression(g,_.Type.auto),e.delete(t),u.freeScopedDummyLocal(d),this.currentType==_.Type.void){this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,i.range,this.currentType.toString(),"<auto>");continue}m=this.currentType}}let f=i.is(a.CommonFlags.CONST),E=!1;if(f)if(y){let e=t.runExpression(y,s.ExpressionRunnerFlags.PreserveSideeffects);if(e){y=e;let t=null;switch(s.getExpressionType(y)){case s.NativeType.I32:t=new o.Local(d,-1,m,u.parentFunction),t.setConstantIntegerValue(i64_new(s.getConstValueI32(y),0),m);break;case s.NativeType.I64:t=new o.Local(d,-1,m,u.parentFunction),t.setConstantIntegerValue(i64_new(s.getConstValueI64Low(y),s.getConstValueI64High(y)),m);break;case s.NativeType.F32:t=new o.Local(d,-1,m,u.parentFunction),t.setConstantFloatValue(s.getConstValueF32(y),m);break;case s.NativeType.F64:t=new o.Local(d,-1,m,u.parentFunction),t.setConstantFloatValue(s.getConstValueF64(y),m)}if(t){let e=u.scopedLocals;if(e){if(e.has(d)){let t=assert(e.get(d));return this.errorRelated(n.DiagnosticCode.Duplicate_identifier_0,i.name.range,t.declaration.name.range,d),this.module.unreachable()}}else u.scopedLocals=e=new Map;e.set(d,t),E=!0}}}else this.error(n.DiagnosticCode._const_declarations_must_be_initialized,i.range);if(!E){let e;if(i.isAny(a.CommonFlags.LET|a.CommonFlags.CONST)||u.isInline){let t=u.getScopedLocal(d);t?(t.declaration.range.source.isNative?this.error(n.DiagnosticCode.Duplicate_identifier_0,i.name.range,d):this.errorRelated(n.DiagnosticCode.Duplicate_identifier_0,i.name.range,t.declaration.name.range,d),e=t):e=u.addScopedLocal(d,m),f&&u.setLocalFlag(e.index,l.LocalFlags.CONSTANT)}else{let t=u.lookupLocal(d);if(t){this.errorRelated(n.DiagnosticCode.Duplicate_identifier_0,i.name.range,t.declaration.name.range,d);continue}e=u.parentFunction.addLocal(m,d,i),f&&u.setLocalFlag(e.index,l.LocalFlags.CONSTANT)}y?c.push(this.makeLocalAssignment(e,y,m,!1)):e.type.isShortIntegerValue&&u.setLocalFlag(e.index,l.LocalFlags.WRAPPED)}}return this.currentType=_.Type.void,0==c.length?0:t.flatten(c)}compileVoidStatement(e){return this.compileExpression(e.expression,_.Type.void,10)}compileWhileStatement(e){return this.doCompileWhileStatement(e,null)}doCompileWhileStatement(e,t){var r=this.module,i=this.currentFlow,n=i.pushBreakLabel(),a=new Array,o=i.fork(!0);t&&o.unifyLocalFlags(t);var u=o.fork();this.currentFlow=o;var c="while-break|"+n;o.breakLabel=c;var h="while-continue|"+n;o.continueLabel=h;var d=o.fork();this.currentFlow=d;var m=this.makeIsTrueish(this.compileExpression(e.condition,_.Type.bool),this.currentType,e.condition),y=this.evaluateCondition(m);if(2==y)return a.push(r.drop(m)),assert(!o.hasScopedLocals),i.popBreakLabel(),this.currentFlow=i,r.flatten(a);var T=o.getTempLocal(_.Type.bool);a.push(r.local_set(T.index,m,!1)),d.freeScopedLocals(),o.inherit(d),this.currentFlow=o;var g=o.fork();g.inheritNonnullIfTrue(m),this.currentFlow=g;var f=new Array,E=e.statement;if(E.kind==p.NodeKind.BLOCK?this.compileStatements(E.statements,!1,f):f.push(this.compileStatement(E)),g.is(256))f.push(r.unreachable()),1==y?o.inherit(g):o.inheritBranch(g);else if(1!=y||g.isAny(2064)){let t=g.is(16);if(t?f.push(r.unreachable()):f.push(r.br(h)),1==y?o.inherit(g):o.inheritBranch(g),!t&&l.Flow.hasIncompatibleLocalStates(u,o))return o.freeTempLocal(T),i.popBreakLabel(),this.currentFlow=i,this.doCompileWhileStatement(e,o)}else f.push(r.br(h)),o.set(256);a.push(r.if(r.local_get(T.index,s.NativeType.I32),r.flatten(f))),o.freeTempLocal(T),this.currentFlow=o,assert(!o.hasScopedLocals),i.inherit(o),i.popBreakLabel(),this.currentFlow=i;var b=r.block(c,[r.loop(h,r.flatten(a))]);return 1==y&&i.is(256)&&(b=r.block(null,[b,r.unreachable()])),b}compileInlineConstant(e,t,r){assert(e.is(a.CommonFlags.INLINED|a.CommonFlags.RESOLVED));var i=e.type;switch(!(3&r)&&i.isIntegerValue&&t.isIntegerValue&&i.size<t.size?(this.currentType=t).kind:(this.currentType=i).kind){case 0:case 1:{let t=i.computeSmallIntegerShift(_.Type.i32);return this.module.i32(1==e.constantValueKind?i64_low(e.constantIntegerValue)<<t>>t:0)}case 5:case 6:case 10:{let t=e.type.computeSmallIntegerMask(_.Type.i32);return this.module.i32(1==e.constantValueKind?i64_low(e.constantIntegerValue)&t:0)}case 2:case 7:return this.module.i32(1==e.constantValueKind?i64_low(e.constantIntegerValue):0);case 4:case 9:if(!e.program.options.isWasm64)return this.module.i32(1==e.constantValueKind?i64_low(e.constantIntegerValue):0);case 3:case 8:return 1==e.constantValueKind?this.module.i64(i64_low(e.constantIntegerValue),i64_high(e.constantIntegerValue)):this.module.i64(0);case 12:if(!e.hasDecorator(o.DecoratorFlags.BUILTIN)||t!=_.Type.f32)return this.module.f64(e.constantFloatValue);this.currentType=_.Type.f32;case 11:return this.module.f32(e.constantFloatValue);default:return assert(!1),this.module.unreachable()}}compileExpression(e,t,r=0){for(;e.kind==p.NodeKind.PARENTHESIZED;)e=e.expression;var i;switch(this.currentType=t,t==_.Type.void&&(r|=8),e.kind){case p.NodeKind.ASSERTION:i=this.compileAssertionExpression(e,t,r);break;case p.NodeKind.BINARY:i=this.compileBinaryExpression(e,t,r);break;case p.NodeKind.CALL:i=this.compileCallExpression(e,t,r);break;case p.NodeKind.COMMA:i=this.compileCommaExpression(e,t,r);break;case p.NodeKind.ELEMENTACCESS:i=this.compileElementAccessExpression(e,t,r);break;case p.NodeKind.FUNCTION:i=this.compileFunctionExpression(e,t,r);break;case p.NodeKind.IDENTIFIER:case p.NodeKind.FALSE:case p.NodeKind.NULL:case p.NodeKind.THIS:case p.NodeKind.SUPER:case p.NodeKind.TRUE:i=this.compileIdentifierExpression(e,t,r);break;case p.NodeKind.INSTANCEOF:i=this.compileInstanceOfExpression(e,t,r);break;case p.NodeKind.LITERAL:i=this.compileLiteralExpression(e,t,r);break;case p.NodeKind.NEW:i=this.compileNewExpression(e,t,r);break;case p.NodeKind.PROPERTYACCESS:i=this.compilePropertyAccessExpression(e,t,r);break;case p.NodeKind.TERNARY:i=this.compileTernaryExpression(e,t,r);break;case p.NodeKind.UNARYPOSTFIX:i=this.compileUnaryPostfixExpression(e,t,r);break;case p.NodeKind.UNARYPREFIX:i=this.compileUnaryPrefixExpression(e,t,r);break;case p.NodeKind.COMPILED:{let t=e;i=t.expr,this.currentType=t.type;break}default:assert(!1),i=this.module.unreachable()}var n=this.currentType,s=0!=(4&r);return n!=t.nonNullableType&&(2&r?(i=this.convertExpression(i,n,t,!0,e),this.currentType=t):1&r&&(i=this.convertExpression(i,n,t,!1,e),this.currentType=t)),s&&(i=this.ensureSmallIntegerWrap(i,n)),this.options.sourceMap&&this.addDebugLocation(i,e.range),i}convertExpression(e,t,r,i,a){var o=this.module;if(20==t.kind)return assert(20!=r.kind),this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,a.range,t.toString(),r.toString()),o.unreachable();if(20==r.kind)return o.drop(e);if(t.isReference||r.isReference)return this.currentFlow.isNonnull(e,t)?t=t.nonNullableType:i&&t.isNullableReference&&!r.isNullableReference&&(this.options.noAssert||(e=this.makeRuntimeNonNullCheck(e,t,a)),t=t.nonNullableType),t.isAssignableTo(r)?(assert(r.isExternalReference||t.kind==r.kind),this.currentType=r,e):i&&r.nonNullableType.isAssignableTo(t)?r.isExternalReference?(this.error(n.DiagnosticCode.Not_implemented_0,a.range,"ref.cast"),this.currentType=r,o.unreachable()):(assert(t.kind==r.kind),this.options.noAssert||(e=this.makeRuntimeUpcastCheck(e,t,r,a)),this.currentType=r,e):(this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,a.range,t.toString(),r.toString()),this.currentType=r,o.unreachable());if(assert(!t.isReference&&!r.isReference),t.isAssignableTo(r)||i||this.error(n.DiagnosticCode.Conversion_from_type_0_to_1_requires_an_explicit_cast,a.range,t.toString(),r.toString()),t.isFloatValue)if(r.isFloatValue)11==t.kind?12==r.kind&&(e=o.unary(s.UnaryOp.PromoteF32,e)):11==r.kind&&(e=o.unary(s.UnaryOp.DemoteF64,e));else if(r.isIntegerValue)if(11==t.kind)if(r.isBooleanValue)e=this.makeIsTrueish(e,_.Type.f32,a);else if(r.isSignedIntegerValue){let t=this.options.hasFeature(4);e=r.isLongIntegerValue?o.unary(t?s.UnaryOp.TruncF32ToI64Sat:s.UnaryOp.TruncF32ToI64,e):o.unary(t?s.UnaryOp.TruncF32ToI32Sat:s.UnaryOp.TruncF32ToI32,e)}else{let t=this.options.hasFeature(4);e=r.isLongIntegerValue?o.unary(t?s.UnaryOp.TruncF32ToU64Sat:s.UnaryOp.TruncF32ToU64,e):o.unary(t?s.UnaryOp.TruncF32ToU32Sat:s.UnaryOp.TruncF32ToU32,e)}else if(r.isBooleanValue)e=this.makeIsTrueish(e,_.Type.f64,a);else if(r.isSignedIntegerValue){let t=this.options.hasFeature(4);e=r.isLongIntegerValue?o.unary(t?s.UnaryOp.TruncF64ToI64Sat:s.UnaryOp.TruncF64ToI64,e):o.unary(t?s.UnaryOp.TruncF64ToI32Sat:s.UnaryOp.TruncF64ToI32,e)}else{let t=this.options.hasFeature(4);e=r.isLongIntegerValue?o.unary(t?s.UnaryOp.TruncF64ToU64Sat:s.UnaryOp.TruncF64ToU64,e):o.unary(t?s.UnaryOp.TruncF64ToU32Sat:s.UnaryOp.TruncF64ToU32,e)}else assert(0==r.flags,"void type expected"),e=o.drop(e);else t.isIntegerValue&&r.isFloatValue?e=11==r.kind?t.isLongIntegerValue?o.unary(t.isSignedIntegerValue?s.UnaryOp.ConvertI64ToF32:s.UnaryOp.ConvertU64ToF32,e):o.unary(t.isSignedIntegerValue?s.UnaryOp.ConvertI32ToF32:s.UnaryOp.ConvertU32ToF32,e):t.isLongIntegerValue?o.unary(t.isSignedIntegerValue?s.UnaryOp.ConvertI64ToF64:s.UnaryOp.ConvertU64ToF64,e):o.unary(t.isSignedIntegerValue?s.UnaryOp.ConvertI32ToF64:s.UnaryOp.ConvertU32ToF64,e):t.isLongIntegerValue?r.isBooleanValue?e=o.binary(s.BinaryOp.NeI64,e,o.i64(0)):r.isLongIntegerValue||(e=o.unary(s.UnaryOp.WrapI64,e)):r.isLongIntegerValue?e=o.unary(t.isSignedIntegerValue?s.UnaryOp.ExtendI32:s.UnaryOp.ExtendU32,this.ensureSmallIntegerWrap(e,t)):t.isShortIntegerValue?t.size<r.size&&(e=this.ensureSmallIntegerWrap(e,t)):i||this.options.isWasm64||!t.isVaryingIntegerValue||r.isVaryingIntegerValue||this.warning(n.DiagnosticCode.Conversion_from_type_0_to_1_will_require_an_explicit_cast_when_switching_between_32_64_bit,a.range,t.toString(),r.toString());return this.currentType=r,e}compileAssertionExpression(e,t,r){var i=-4&r;switch(e.assertionKind){case p.AssertionKind.PREFIX:case p.AssertionKind.AS:{let t=this.currentFlow,r=this.resolver.resolveType(assert(e.toType),t.actualFunction,h.uniqueMap(t.contextualTypeArguments));return r?this.compileExpression(e.expression,r,2|i):this.module.unreachable()}case p.AssertionKind.NONNULL:{assert(!e.toType);let r=this.compileExpression(e.expression,t.exceptVoid,i),s=this.currentType;return this.currentFlow.isNonnull(r,s)?this.info(n.DiagnosticCode.Expression_is_never_null,e.expression.range):this.options.noAssert||(r=this.makeRuntimeNonNullCheck(r,s,e)),this.currentType=s.nonNullableType,r}case p.AssertionKind.CONST:return this.error(n.DiagnosticCode.Not_implemented_0,e.range,"Const assertion"),this.module.unreachable();default:assert(!1)}return this.module.unreachable()}compileBinaryExpression(e,t,r){var i,s,a,u,p,h,d=this.module,m=e.left,y=e.right,T=!1,g=e.operator;switch(g){case c.Token.LESSTHAN:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.LT);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!0))||!p.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"<",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p,h=this.makeLt(i,a,p),this.currentType=_.Type.bool;break}case c.Token.GREATERTHAN:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.GT);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!0))||!p.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,">",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p,h=this.makeGt(i,a,p),this.currentType=_.Type.bool;break}case c.Token.LESSTHAN_EQUALS:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.LE);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!0))||!p.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"<=",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p,h=this.makeLe(i,a,p),this.currentType=_.Type.bool;break}case c.Token.GREATERTHAN_EQUALS:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.GE);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!0))||!p.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,">=",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p,h=this.makeGe(i,a,p),this.currentType=_.Type.bool;break}case c.Token.EQUALS_EQUALS_EQUALS:case c.Token.EQUALS_EQUALS:if(i=this.compileExpression(m,t),s=this.currentType,g==c.Token.EQUALS_EQUALS){let t=s.getClassOrWrapper(this.program);if(t){let r=t.lookupOverload(o.OperatorKind.EQ);if(r){h=this.compileBinaryOverload(r,m,i,y,e);break}}}if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1)))return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,c.operatorTokenToString(e.operator),s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p,h=this.makeEq(i,a,p,e),this.currentType=_.Type.bool;break;case c.Token.EXCLAMATION_EQUALS_EQUALS:case c.Token.EXCLAMATION_EQUALS:if(i=this.compileExpression(m,t),s=this.currentType,g==c.Token.EXCLAMATION_EQUALS){let t=s.getClass();if(t){let r=t.lookupOverload(o.OperatorKind.NE);if(r){h=this.compileBinaryOverload(r,m,i,y,e);break}}}if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1)))return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,c.operatorTokenToString(e.operator),s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p,h=this.makeNe(i,a,p,e),this.currentType=_.Type.bool;break;case c.Token.EQUALS:return this.compileAssignment(m,y,t);case c.Token.PLUS_EQUALS:T=!0;case c.Token.PLUS:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.ADD);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(T){if(!s.isNumericValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"+",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=p=this.currentType}else{if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1))||!p.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"+",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p}h=this.makeAdd(i,a,p);break}case c.Token.MINUS_EQUALS:T=!0;case c.Token.MINUS:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.SUB);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(T){if(!s.isNumericValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"-",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=p=this.currentType}else{if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1))||!s.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"-",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p}h=this.makeSub(i,a,p);break}case c.Token.ASTERISK_EQUALS:T=!0;case c.Token.ASTERISK:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.MUL);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(T){if(!s.isNumericValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"*",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=p=this.currentType}else{if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1))||!p.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"*",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p}h=this.makeMul(i,a,p);break}case c.Token.ASTERISK_ASTERISK_EQUALS:T=!0;case c.Token.ASTERISK_ASTERISK:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.POW);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(T){if(!s.isNumericValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"**",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=p=this.currentType}else{if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1))||!p.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"**",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p}h=this.makePow(i,a,p,e);break}case c.Token.SLASH_EQUALS:T=!0;case c.Token.SLASH:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.DIV);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(T){if(!s.isNumericValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"/",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=p=this.currentType}else{if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1))||!p.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"/",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p}h=this.makeDiv(i,a,p);break}case c.Token.PERCENT_EQUALS:T=!0;case c.Token.PERCENT:{i=this.compileExpression(m,t);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.REM);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(T){if(!s.isNumericValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"%",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=p=this.currentType}else{if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1))||!p.isNumericValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"%",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p}h=this.makeRem(i,a,p,e);break}case c.Token.LESSTHAN_LESSTHAN_EQUALS:T=!0;case c.Token.LESSTHAN_LESSTHAN:{i=this.compileExpression(m,t.intType);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.BITWISE_SHL);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(!s.isIntegerValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"<<",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=this.currentType,h=this.makeShl(i,a,u);break}case c.Token.GREATERTHAN_GREATERTHAN_EQUALS:T=!0;case c.Token.GREATERTHAN_GREATERTHAN:{i=this.compileExpression(m,t.intType);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.BITWISE_SHR);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(!s.isIntegerValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,">>",s.toString()),this.module.unreachable();a=this.compileExpression(y,s,1),u=this.currentType,h=this.makeShr(i,a,u);break}case c.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:T=!0;case c.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:{i=this.compileExpression(m,t.intType);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.BITWISE_SHR_U);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(!s.isIntegerValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,">>>",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=this.currentType,h=this.makeShru(i,a,u);break}case c.Token.AMPERSAND_EQUALS:T=!0;case c.Token.AMPERSAND:{i=this.compileExpression(m,t.intType);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.BITWISE_AND);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(T){if(!s.isIntegerValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"&",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=p=this.currentType}else{if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1))||!p.isIntegerValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"&",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p}h=this.makeAnd(i,a,p);break}case c.Token.BAR_EQUALS:T=!0;case c.Token.BAR:{i=this.compileExpression(m,t.intType);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.BITWISE_OR);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(T){if(!s.isIntegerValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"|",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=p=this.currentType}else{if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1))||!p.isIntegerValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"|",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p}h=this.makeOr(i,a,p);break}case c.Token.CARET_EQUALS:T=!0;case c.Token.CARET:{i=this.compileExpression(m,t.intType);let r=(s=this.currentType).getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.BITWISE_XOR);if(t){h=this.compileBinaryOverload(t,m,i,y,e);break}}if(T){if(!s.isIntegerValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"^",s.toString()),d.unreachable();a=this.compileExpression(y,s,1),u=p=this.currentType}else{if(a=this.compileExpression(y,s),u=this.currentType,!(p=_.Type.commonDenominator(s,u,!1))||!p.isIntegerValue)return this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"^",s.toString(),u.toString()),this.currentType=t,d.unreachable();i=this.convertExpression(i,s,p,!1,m),s=p,a=this.convertExpression(a,u,p,!1,y),u=p}h=this.makeXor(i,a,p);break}case c.Token.AMPERSAND_AMPERSAND:{let e=this.currentFlow,n=4&r;i=this.compileExpression(m,t.exceptVoid,n),s=this.currentType;let o=e.fork();if(this.currentFlow=o,o.inheritNonnullIfTrue(i),t==_.Type.bool||t==_.Type.void)a=this.compileExpression(y,s,n),u=this.currentType,o.freeScopedLocals(),this.currentFlow=e,h=d.if(this.makeIsTrueish(i,s,m),this.makeIsTrueish(a,u,y),d.i32(0)),this.currentType=_.Type.bool;else{if(a=this.compileExpression(y,s,1|n),u=this.currentType,o.freeScopedLocals(),this.currentFlow=e,h=d.cloneExpression(i,!0,0))h=d.if(this.makeIsTrueish(i,this.currentType,m),a,h);else{let t=e.getTempLocal(s);e.canOverflow(i,s)||e.setLocalFlag(t.index,l.LocalFlags.WRAPPED),e.isNonnull(i,s)&&e.setLocalFlag(t.index,l.LocalFlags.NONNULL),h=d.if(this.makeIsTrueish(d.local_tee(t.index,i,s.isManaged),s,m),a,d.local_get(t.index,s.toNativeType())),e.freeTempLocal(t)}this.currentType=s}break}case c.Token.BAR_BAR:{let e=this.currentFlow,n=4&r;i=this.compileExpression(m,t.exceptVoid,n),s=this.currentType;let o=e.fork();if(this.currentFlow=o,o.inheritNonnullIfFalse(i),t==_.Type.bool||t==_.Type.void)a=this.compileExpression(y,s,n),u=this.currentType,o.freeScopedLocals(),this.currentFlow=e,h=d.if(this.makeIsTrueish(i,s,m),d.i32(1),this.makeIsTrueish(a,u,y)),this.currentType=_.Type.bool;else{if(a=this.compileExpression(y,s,1|n),u=this.currentType,o.freeScopedLocals(),this.currentFlow=e,h=d.cloneExpression(i,!0,0))h=d.if(this.makeIsTrueish(i,s,m),h,a);else{let t=e.getTempLocal(s);e.canOverflow(i,s)||e.setLocalFlag(t.index,l.LocalFlags.WRAPPED),e.isNonnull(i,s)&&e.setLocalFlag(t.index,l.LocalFlags.NONNULL),h=d.if(this.makeIsTrueish(d.local_tee(t.index,i,s.isManaged),s,m),d.local_get(t.index,s.toNativeType()),a),e.freeTempLocal(t)}this.currentType=s}break}default:assert(!1),h=this.module.unreachable()}if(!T)return h;var f=this.resolver,E=f.lookupExpression(m,this.currentFlow);if(!E)return d.unreachable();var b=f.getTypeOfElement(E);return b||(b=_.Type.void),this.currentType.isStrictlyAssignableTo(b)?this.makeAssignment(E,h,this.currentType,y,f.currentThisExpression,f.currentElementExpression,t!=_.Type.void):(this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,e.range,this.currentType.toString(),b.toString()),d.unreachable())}makeLt(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 2:return i.binary(s.BinaryOp.LtI32,e,t);case 3:return i.binary(s.BinaryOp.LtI64,e,t);case 4:return i.binary(this.options.isWasm64?s.BinaryOp.LtI64:s.BinaryOp.LtI32,e,t);case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 7:return i.binary(s.BinaryOp.LtU32,e,t);case 9:return i.binary(this.options.isWasm64?s.BinaryOp.LtU64:s.BinaryOp.LtU32,e,t);case 8:return i.binary(s.BinaryOp.LtU64,e,t);case 11:return i.binary(s.BinaryOp.LtF32,e,t);case 12:return i.binary(s.BinaryOp.LtF64,e,t)}return assert(!1),i.unreachable()}makeGt(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 2:return i.binary(s.BinaryOp.GtI32,e,t);case 4:return i.binary(this.options.isWasm64?s.BinaryOp.GtI64:s.BinaryOp.GtI32,e,t);case 3:return i.binary(s.BinaryOp.GtI64,e,t);case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 7:return i.binary(s.BinaryOp.GtU32,e,t);case 9:return i.binary(this.options.isWasm64?s.BinaryOp.GtU64:s.BinaryOp.GtU32,e,t);case 8:return i.binary(s.BinaryOp.GtU64,e,t);case 11:return i.binary(s.BinaryOp.GtF32,e,t);case 12:return i.binary(s.BinaryOp.GtF64,e,t)}return assert(!1),i.unreachable()}makeLe(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 2:return i.binary(s.BinaryOp.LeI32,e,t);case 4:return i.binary(this.options.isWasm64?s.BinaryOp.LeI64:s.BinaryOp.LeI32,e,t);case 3:return i.binary(s.BinaryOp.LeI64,e,t);case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 7:return i.binary(s.BinaryOp.LeU32,e,t);case 9:return i.binary(this.options.isWasm64?s.BinaryOp.LeU64:s.BinaryOp.LeU32,e,t);case 8:return i.binary(s.BinaryOp.LeU64,e,t);case 11:return i.binary(s.BinaryOp.LeF32,e,t);case 12:return i.binary(s.BinaryOp.LeF64,e,t)}return assert(!1),i.unreachable()}makeGe(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 2:return i.binary(s.BinaryOp.GeI32,e,t);case 4:return i.binary(this.options.isWasm64?s.BinaryOp.GeI64:s.BinaryOp.GeI32,e,t);case 3:return i.binary(s.BinaryOp.GeI64,e,t);case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 7:return i.binary(s.BinaryOp.GeU32,e,t);case 9:return i.binary(this.options.isWasm64?s.BinaryOp.GeU64:s.BinaryOp.GeU32,e,t);case 8:return i.binary(s.BinaryOp.GeU64,e,t);case 11:return i.binary(s.BinaryOp.GeF32,e,t);case 12:return i.binary(s.BinaryOp.GeF64,e,t)}return assert(!1),i.unreachable()}makeEq(e,t,r,i){var a=this.module;switch(r.kind){case 0:case 1:case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 2:case 7:return a.binary(s.BinaryOp.EqI32,e,t);case 4:case 9:return a.binary(this.options.isWasm64?s.BinaryOp.EqI64:s.BinaryOp.EqI32,e,t);case 3:case 8:return a.binary(s.BinaryOp.EqI64,e,t);case 11:return a.binary(s.BinaryOp.EqF32,e,t);case 12:return a.binary(s.BinaryOp.EqF64,e,t);case 13:return a.unary(s.UnaryOp.AllTrueI8x16,a.binary(s.BinaryOp.EqI8x16,e,t));case 17:case 18:case 19:return a.ref_eq(e,t);case 14:case 15:case 16:return this.error(n.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,i.range,"ref.eq",r.toString()),a.unreachable()}return assert(!1),a.unreachable()}makeNe(e,t,r,i){var a=this.module;switch(r.kind){case 0:case 1:case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 2:case 7:return a.binary(s.BinaryOp.NeI32,e,t);case 9:case 4:return a.binary(this.options.isWasm64?s.BinaryOp.NeI64:s.BinaryOp.NeI32,e,t);case 3:case 8:return a.binary(s.BinaryOp.NeI64,e,t);case 11:return a.binary(s.BinaryOp.NeF32,e,t);case 12:return a.binary(s.BinaryOp.NeF64,e,t);case 13:return a.unary(s.UnaryOp.AnyTrueI8x16,a.binary(s.BinaryOp.NeI8x16,e,t));case 17:case 18:case 19:return a.unary(s.UnaryOp.EqzI32,a.ref_eq(e,t));case 14:case 15:case 16:return this.error(n.DiagnosticCode.Operation_0_cannot_be_applied_to_type_1,i.range,"ref.eq",r.toString()),a.unreachable()}return assert(!1),a.unreachable()}makeAdd(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:case 5:case 6:case 10:case 2:case 7:return i.binary(s.BinaryOp.AddI32,e,t);case 9:case 4:return i.binary(this.options.isWasm64?s.BinaryOp.AddI64:s.BinaryOp.AddI32,e,t);case 3:case 8:return i.binary(s.BinaryOp.AddI64,e,t);case 11:return i.binary(s.BinaryOp.AddF32,e,t);case 12:return i.binary(s.BinaryOp.AddF64,e,t)}return assert(!1),i.unreachable()}makeSub(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:case 5:case 6:case 10:case 2:case 7:return i.binary(s.BinaryOp.SubI32,e,t);case 9:case 4:return i.binary(this.options.isWasm64?s.BinaryOp.SubI64:s.BinaryOp.SubI32,e,t);case 3:case 8:return i.binary(s.BinaryOp.SubI64,e,t);case 11:return i.binary(s.BinaryOp.SubF32,e,t);case 12:return i.binary(s.BinaryOp.SubF64,e,t)}return assert(!1),i.unreachable()}makeMul(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:case 5:case 6:case 10:case 2:case 7:return i.binary(s.BinaryOp.MulI32,e,t);case 9:case 4:return i.binary(this.options.isWasm64?s.BinaryOp.MulI64:s.BinaryOp.MulI32,e,t);case 3:case 8:return i.binary(s.BinaryOp.MulI64,e,t);case 11:return i.binary(s.BinaryOp.MulF32,e,t);case 12:return i.binary(s.BinaryOp.MulF64,e,t)}return assert(!1),i.unreachable()}makePow(e,t,r,i){let l=this.module;switch(r.kind){case 10:return l.select(l.i32(1),l.binary(s.BinaryOp.EqI32,t,l.i32(0)),e);case 0:case 5:case 1:case 6:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 2:case 7:{let s=this.i32PowInstance;if(!s){let e=this.program.lookup(a.CommonNames.ipow32);if(!e)return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"ipow32"),l.unreachable();assert(e.kind==o.ElementKind.FUNCTION_PROTOTYPE),this.i32PowInstance=s=this.resolver.resolveFunction(e,null)}if(!s||!this.compileFunction(s))return l.unreachable();let u=this.makeCallDirect(s,[e,t],i);return r.size<32&&(u=this.ensureSmallIntegerWrap(u,r)),u}case 3:case 8:{let r=this.i64PowInstance;if(!r){let e=this.program.lookup(a.CommonNames.ipow64);if(!e)return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"ipow64"),l.unreachable();assert(e.kind==o.ElementKind.FUNCTION_PROTOTYPE),this.i64PowInstance=r=this.resolver.resolveFunction(e,null)}return r&&this.compileFunction(r)?this.makeCallDirect(r,[e,t],i):l.unreachable()}case 4:case 9:{let r=this.options.isWasm64,s=r?this.i64PowInstance:this.i32PowInstance;if(!s){let e=this.program.lookup(r?a.CommonNames.ipow64:a.CommonNames.ipow32);if(!e)return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,r?"ipow64":"ipow32"),l.unreachable();assert(e.kind==o.ElementKind.FUNCTION_PROTOTYPE),s=this.resolver.resolveFunction(e,null),r?this.i64PowInstance=s:this.i32PowInstance=s}return s&&this.compileFunction(s)?this.makeCallDirect(s,[e,t],i):l.unreachable()}case 11:{let r=this.f32PowInstance;if(!r){let e=this.program.lookup(a.CommonNames.Mathf);if(!e)return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"Mathf"),l.unreachable();let t=e.members;if(!t||!t.has(a.CommonNames.pow))return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"Mathf.pow"),l.unreachable();let s=assert(t.get(a.CommonNames.pow));assert(s.kind==o.ElementKind.FUNCTION_PROTOTYPE),this.f32PowInstance=r=this.resolver.resolveFunction(s,null)}return r&&this.compileFunction(r)?this.makeCallDirect(r,[e,t],i):l.unreachable()}case 12:{let r=this.f64PowInstance;if(!r){let e=this.program.lookup(a.CommonNames.Math);if(!e)return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"Math"),l.unreachable();let t=e.members;if(!t||!t.has(a.CommonNames.pow))return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"Math.pow"),l.unreachable();let s=assert(t.get(a.CommonNames.pow));assert(s.kind==o.ElementKind.FUNCTION_PROTOTYPE),this.f64PowInstance=r=this.resolver.resolveFunction(s,null)}return r&&this.compileFunction(r)?this.makeCallDirect(r,[e,t],i):l.unreachable()}}return assert(!1),l.unreachable()}makeDiv(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 2:return i.binary(s.BinaryOp.DivI32,e,t);case 4:return i.binary(this.options.isWasm64?s.BinaryOp.DivI64:s.BinaryOp.DivI32,e,t);case 3:return i.binary(s.BinaryOp.DivI64,e,t);case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 7:return i.binary(s.BinaryOp.DivU32,e,t);case 9:return i.binary(this.options.isWasm64?s.BinaryOp.DivU64:s.BinaryOp.DivU32,e,t);case 8:return i.binary(s.BinaryOp.DivU64,e,t);case 11:return i.binary(s.BinaryOp.DivF32,e,t);case 12:return i.binary(s.BinaryOp.DivF64,e,t)}return assert(!1),i.unreachable()}makeRem(e,t,r,i){var l=this.module;switch(r.kind){case 0:case 1:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 2:return l.binary(s.BinaryOp.RemI32,e,t);case 4:return l.binary(this.options.isWasm64?s.BinaryOp.RemI64:s.BinaryOp.RemI32,e,t);case 3:return l.binary(s.BinaryOp.RemI64,e,t);case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,r),t=this.ensureSmallIntegerWrap(t,r);case 7:return l.binary(s.BinaryOp.RemU32,e,t);case 9:return l.binary(this.options.isWasm64?s.BinaryOp.RemU64:s.BinaryOp.RemU32,e,t);case 8:return l.binary(s.BinaryOp.RemU64,e,t);case 11:{let r=this.f32ModInstance;if(!r){let e=this.program.lookup(a.CommonNames.Mathf);if(!e)return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"Mathf"),l.unreachable();let t=e.members;if(!t||!t.has(a.CommonNames.mod))return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"Mathf.mod"),l.unreachable();let s=assert(t.get(a.CommonNames.mod));assert(s.kind==o.ElementKind.FUNCTION_PROTOTYPE),this.f32ModInstance=r=this.resolver.resolveFunction(s,null)}return r&&this.compileFunction(r)?this.makeCallDirect(r,[e,t],i):l.unreachable()}case 12:{let r=this.f64ModInstance;if(!r){let e=this.program.lookup(a.CommonNames.Math);if(!e)return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"Math"),l.unreachable();let t=e.members;if(!t||!t.has(a.CommonNames.mod))return this.error(n.DiagnosticCode.Cannot_find_name_0,i.range,"Math.mod"),l.unreachable();let s=assert(t.get(a.CommonNames.mod));assert(s.kind==o.ElementKind.FUNCTION_PROTOTYPE),this.f64ModInstance=r=this.resolver.resolveFunction(s,null)}return r&&this.compileFunction(r)?this.makeCallDirect(r,[e,t],i):l.unreachable()}}return assert(!1),l.unreachable()}makeShl(e,t,r){var i=this.module;switch(r.kind){case 10:return e;case 0:case 1:case 5:case 6:return i.binary(s.BinaryOp.ShlI32,e,i.binary(s.BinaryOp.AndI32,t,i.i32(r.size-1)));case 2:case 7:return i.binary(s.BinaryOp.ShlI32,e,t);case 3:case 8:return i.binary(s.BinaryOp.ShlI64,e,t);case 9:case 4:return i.binary(this.options.isWasm64?s.BinaryOp.ShlI64:s.BinaryOp.ShlI32,e,t)}return assert(!1),i.unreachable()}makeShr(e,t,r){var i=this.module;switch(r.kind){case 10:return e;case 0:case 1:return i.binary(s.BinaryOp.ShrI32,this.ensureSmallIntegerWrap(e,r),i.binary(s.BinaryOp.AndI32,t,i.i32(r.size-1)));case 5:case 6:return i.binary(s.BinaryOp.ShrU32,this.ensureSmallIntegerWrap(e,r),i.binary(s.BinaryOp.AndI32,t,i.i32(r.size-1)));case 2:return i.binary(s.BinaryOp.ShrI32,e,t);case 3:return i.binary(s.BinaryOp.ShrI64,e,t);case 4:return i.binary(this.options.isWasm64?s.BinaryOp.ShrI64:s.BinaryOp.ShrI32,e,t);case 7:return i.binary(s.BinaryOp.ShrU32,e,t);case 8:return i.binary(s.BinaryOp.ShrU64,e,t);case 9:return i.binary(this.options.isWasm64?s.BinaryOp.ShrU64:s.BinaryOp.ShrU32,e,t)}return assert(!1),i.unreachable()}makeShru(e,t,r){var i=this.module;switch(r.kind){case 10:return e;case 0:case 1:case 5:case 6:return i.binary(s.BinaryOp.ShrU32,this.ensureSmallIntegerWrap(e,r),i.binary(s.BinaryOp.AndI32,t,i.i32(r.size-1)));case 2:case 7:return i.binary(s.BinaryOp.ShrU32,e,t);case 3:case 8:return i.binary(s.BinaryOp.ShrU64,e,t);case 9:case 4:return i.binary(this.options.isWasm64?s.BinaryOp.ShrU64:s.BinaryOp.ShrU32,e,t)}return assert(!1),i.unreachable()}makeAnd(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:case 2:case 5:case 6:case 10:case 7:return i.binary(s.BinaryOp.AndI32,e,t);case 3:case 8:return i.binary(s.BinaryOp.AndI64,e,t);case 9:case 4:return i.binary(this.options.isWasm64?s.BinaryOp.AndI64:s.BinaryOp.AndI32,e,t)}return assert(!1),i.unreachable()}makeOr(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:case 5:case 6:case 10:return i.binary(s.BinaryOp.OrI32,e,t);case 2:case 7:return i.binary(s.BinaryOp.OrI32,e,t);case 3:case 8:return i.binary(s.BinaryOp.OrI64,e,t);case 9:case 4:return i.binary(this.options.isWasm64?s.BinaryOp.OrI64:s.BinaryOp.OrI32,e,t)}return assert(!1),i.unreachable()}makeXor(e,t,r){var i=this.module;switch(r.kind){case 0:case 1:case 5:case 6:case 10:return i.binary(s.BinaryOp.XorI32,e,t);case 2:case 7:return i.binary(s.BinaryOp.XorI32,e,t);case 3:case 8:return i.binary(s.BinaryOp.XorI64,e,t);case 4:case 9:return i.binary(this.options.isWasm64?s.BinaryOp.XorI64:s.BinaryOp.XorI32,e,t)}return assert(!1),i.unreachable()}compileUnaryOverload(e,t,r,i){return this.makeCallDirect(e,[r],i,!1)}compileBinaryOverload(e,t,r,i,n){var s;if(e.is(a.CommonFlags.INSTANCE)){let t=assert(e.parent);assert(t.kind==o.ElementKind.CLASS),s=e.signature.parameterTypes[0]}else s=e.signature.parameterTypes[1];var l=this.compileExpression(i,s,1);return this.makeCallDirect(e,[r,l],n)}compileAssignment(e,t,r){var i=this.program.resolver,s=this.currentFlow,a=i.lookupExpression(e,s);if(!a)return this.module.unreachable();var l,u=i.currentThisExpression,c=i.currentElementExpression;switch(a.kind){case o.ElementKind.GLOBAL:if(!this.compileGlobal(a))return this.module.unreachable();case o.ElementKind.LOCAL:case o.ElementKind.FIELD:if(this.pendingElements.has(a))return this.error(n.DiagnosticCode.Variable_0_used_before_its_declaration,e.range,a.internalName),this.module.unreachable();l=a.type,a.hasDecorator(o.DecoratorFlags.UNSAFE)&&this.checkUnsafe(e);break;case o.ElementKind.PROPERTY_PROTOTYPE:{let e=a,t=i.resolveProperty(e);if(!t)return this.module.unreachable();a=t}case o.ElementKind.PROPERTY:{let t=a,r=t.setterInstance;if(!r)return this.error(n.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,t.internalName),this.module.unreachable();assert(1==r.signature.parameterTypes.length),l=r.signature.parameterTypes[0],r.hasDecorator(o.DecoratorFlags.UNSAFE)&&this.checkUnsafe(e);break}case o.ElementKind.INDEXSIGNATURE:{let t=a.parent;assert(t.kind==o.ElementKind.CLASS);let r=t,i=s.is(32768),u=r.lookupOverload(o.OperatorKind.INDEXED_SET,i);if(!u){return r.lookupOverload(o.OperatorKind.INDEXED_GET,i)?this.error(n.DiagnosticCode.Index_signature_in_type_0_only_permits_reading,e.range,r.internalName):this.error(n.DiagnosticCode.Index_signature_is_missing_in_type_0,e.range,r.internalName),this.module.unreachable()}assert(2==u.signature.parameterTypes.length),l=u.signature.parameterTypes[1],u.hasDecorator(o.DecoratorFlags.UNSAFE)&&this.checkUnsafe(e),!i&&this.options.pedantic&&this.pedantic(n.DiagnosticCode.Indexed_access_may_involve_bounds_checking,e.range);break}default:return assert(!1),this.module.unreachable()}assert(l!=_.Type.void);var p=this.compileExpression(t,l),h=this.currentType;return this.makeAssignment(a,this.convertExpression(p,h,l,!1,t),h,t,u,c,r!=_.Type.void)}makeAssignment(e,t,r,i,s,u,c){var h=this.module,d=this.currentFlow;switch(e.kind){case o.ElementKind.LOCAL:{let s=e;return d.isLocalFlag(s.index,l.LocalFlags.CONSTANT,!0)?(this.error(n.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,i.range,e.internalName),this.currentType=c?s.type:_.Type.void,h.unreachable()):this.makeLocalAssignment(s,t,r,c)}case o.ElementKind.GLOBAL:{let s=e;return this.compileGlobal(s)?e.isAny(a.CommonFlags.CONST|a.CommonFlags.READONLY)?(this.error(n.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,i.range,e.internalName),this.currentType=c?s.type:_.Type.void,h.unreachable()):this.makeGlobalAssignment(s,t,r,c):h.unreachable()}case o.ElementKind.FIELD:{let u=e,_=u.initializerNode,m=d.actualFunction.is(a.CommonFlags.CONSTRUCTOR);if(u.is(a.CommonFlags.READONLY)&&(!m||null!==_))return this.error(n.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,i.range,u.internalName),h.unreachable();s=assert(s),m&&s.kind==p.NodeKind.THIS&&d.setThisFieldFlag(u,l.FieldFlags.INITIALIZED);let y=u.parent;return assert(y.kind==o.ElementKind.CLASS),this.makeFieldAssignment(u,t,r,this.compileExpression(s,y.type,33),c)}case o.ElementKind.PROPERTY:{let r=e,o=r.setterInstance;if(!o)return this.error(n.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,i.range,e.internalName),h.unreachable();if(assert(1==o.signature.parameterTypes.length),r.is(a.CommonFlags.INSTANCE)){let r=assert(o.signature.thisType),n=this.compileExpression(assert(s),r,33);if(!c)return this.makeCallDirect(o,[n,t],i);let a=assert(e.getterInstance);assert(a.signature.thisType==r);let l=a.signature.returnType,u=l.toNativeType(),p=d.getTempLocal(l),_=h.block(null,[this.makeCallDirect(o,[h.local_tee(p.index,n,l.isManaged),t],i),this.makeCallDirect(a,[h.local_get(p.index,u)],i)],u);return d.freeTempLocal(p),_}{if(!c)return this.makeCallDirect(o,[t],i);let r=assert(e.getterInstance);return h.block(null,[this.makeCallDirect(o,[t],i),this.makeCallDirect(r,null,i)],r.signature.returnType.toNativeType())}}case o.ElementKind.INDEXSIGNATURE:{let r=e.parent;assert(r.kind==o.ElementKind.CLASS);let a=r;assert(a.kind==o.ElementKind.CLASS);let l=d.is(32768),p=a.lookupOverload(o.OperatorKind.INDEXED_GET,l);if(!p)return this.error(n.DiagnosticCode.Index_signature_is_missing_in_type_0,i.range,a.internalName),h.unreachable();let m=a.lookupOverload(o.OperatorKind.INDEXED_SET,l);if(!m)return this.error(n.DiagnosticCode.Index_signature_in_type_0_only_permits_reading,i.range,a.internalName),this.currentType=c?p.signature.returnType:_.Type.void,h.unreachable();assert(2==m.signature.parameterTypes.length);let y=a.type,T=this.compileExpression(assert(s),y,33),g=this.compileExpression(assert(u),_.Type.i32,1),f=this.currentType;if(c){let e=d.getTempLocal(y),r=d.getTempLocal(f),n=p.signature.returnType,s=h.block(null,[this.makeCallDirect(m,[h.local_tee(e.index,T,y.isManaged),h.local_tee(r.index,g,f.isManaged),t],i),this.makeCallDirect(p,[h.local_get(e.index,e.type.toNativeType()),h.local_get(r.index,r.type.toNativeType())],i)],n.toNativeType());return d.freeTempLocal(r),d.freeTempLocal(e),s}return this.makeCallDirect(m,[T,g,t],i)}}return assert(!1),h.unreachable()}makeLocalAssignment(e,t,r,i){var n=this.module,s=this.currentFlow,a=e.type;assert(a!=_.Type.void);var o=e.index;return a.isNullableReference&&(!r.isNullableReference||s.isNonnull(t,a)?s.setLocalFlag(o,l.LocalFlags.NONNULL):s.unsetLocalFlag(o,l.LocalFlags.NONNULL)),s.setLocalFlag(o,l.LocalFlags.INITIALIZED),a.isShortIntegerValue&&(s.canOverflow(t,a)?s.unsetLocalFlag(o,l.LocalFlags.WRAPPED):s.setLocalFlag(o,l.LocalFlags.WRAPPED)),i?(this.currentType=a,n.local_tee(o,t,a.isManaged)):(this.currentType=_.Type.void,n.local_set(o,t,a.isManaged))}makeGlobalAssignment(e,t,r,i){var n=this.module,s=e.type;assert(s!=_.Type.void);var a=s.toNativeType();return t=this.ensureSmallIntegerWrap(t,s),i?(this.currentType=s,n.block(null,[n.global_set(e.internalName,t),n.global_get(e.internalName,a)],a)):(this.currentType=_.Type.void,n.global_set(e.internalName,t))}makeFieldAssignment(e,t,r,i,n){var l=this.module,u=this.currentFlow,c=e.type,p=c.toNativeType();assert(e.parent.kind==o.ElementKind.CLASS);var h=e.parent.type;if(!e.is(a.CommonFlags.COMPILED)){e.set(a.CommonFlags.COMPILED);let t=e.typeNode;t&&this.checkTypeSupported(e.type,t)}if(n){this.compileField(e);let r=u.getTempLocal(h),n=l.block(null,[l.call(e.internalSetterName,[l.local_tee(r.index,i,h.isManaged),t],s.NativeType.None),l.call(e.internalGetterName,[l.local_get(r.index,h.toNativeType())],p)],p);return u.freeTempLocal(r),this.currentType=c,n}{this.compileFieldSetter(e);let r=l.call(e.internalSetterName,[i,t],s.NativeType.None);return this.currentType=_.Type.void,r}}compileCallExpression(e,t,r){var i=this.module,s=this.currentFlow;if(e.expression.kind==p.NodeKind.SUPER){let t=this.currentFlow,r=t.actualFunction;if(!r.is(a.CommonFlags.CONSTRUCTOR))return this.error(n.DiagnosticCode.Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors,e.range),i.unreachable();let s=assert(r.parent);assert(s.kind==o.ElementKind.CLASS);let l=s,u=l.base;if(!u)return this.error(n.DiagnosticCode._super_can_only_be_referenced_in_a_derived_class,e.expression.range),i.unreachable();let c=assert(t.lookupLocal(a.CommonNames.this_)),p=this.options.nativeSizeType,h=this.ensureConstructor(u,e);this.checkFieldInitialization(u,e);let d=this.compileCallDirect(h,e.args,e,i.local_get(c.index,p));return t.isAny(8256)?(this.error(n.DiagnosticCode._super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class,e.range),i.unreachable()):(t.set(192),this.currentType=_.Type.void,i.local_set(c.index,d,l.type.isManaged))}var l=this.resolver.lookupExpression(e.expression,s);if(!l)return i.unreachable();var u,c,h=this.resolver.currentThisExpression;switch(l.kind){case o.ElementKind.FUNCTION_PROTOTYPE:{let r=l;if(r.hasDecorator(o.DecoratorFlags.BUILTIN))return this.compileCallExpressionBuiltin(r,e,t);let i=this.resolver.maybeInferCall(e,r,s);if(!i)return this.module.unreachable();l=i}case o.ElementKind.FUNCTION:{let t=l,i=0;return t.is(a.CommonFlags.INSTANCE)&&(i=this.compileExpression(assert(h),assert(t.signature.thisType),33)),this.compileCallDirect(t,e.args,e,i,r)}case o.ElementKind.LOCAL:{let t=l;if(u=t.type.signatureReference){if(t.is(a.CommonFlags.INLINED)){let e=t.constantIntegerValue;this.options.isWasm64?c=i.i64(i64_low(e),i64_high(e)):(assert(!i64_high(e)),c=i.i32(i64_low(e)))}else c=i.local_get(t.index,this.options.nativeSizeType);break}return this.error(n.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,e.range,t.type.toString()),i.unreachable()}case o.ElementKind.GLOBAL:{let t=l;if(u=t.type.signatureReference){c=i.global_get(t.internalName,t.type.toNativeType());break}return this.error(n.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,e.range,t.type.toString()),i.unreachable()}case o.ElementKind.FIELD:{let t=l,r=t.type;if(u=r.signatureReference){let e=t.parent;assert(e.kind==o.ElementKind.CLASS);let r=this.options.usizeType;c=i.load(r.byteSize,!1,this.compileExpression(assert(h),e.type,33),r.toNativeType(),t.memoryOffset);break}return this.error(n.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,e.range,r.toString()),i.unreachable()}case o.ElementKind.PROPERTY_PROTOTYPE:{let e=this.resolver.resolveProperty(l);if(!e)return i.unreachable();l=e}case o.ElementKind.PROPERTY:{let t=l,r=assert(t.getterInstance),s=0;if(t.is(a.CommonFlags.INSTANCE)&&(s=this.compileExpression(assert(h),assert(r.signature.thisType),33)),c=this.compileCallDirect(r,[],e.expression,s),!(u=this.currentType.signatureReference))return this.error(n.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,e.range,this.currentType.toString()),i.unreachable();break}case o.ElementKind.CLASS:{let t=l.getTypeArgumentsTo(this.program.functionPrototype);if(null!==t&&t.length>0){let r=t[0];u=r.getSignature(),c=this.compileExpression(e.expression,r,1);break}}default:{let t=this.resolver.getTypeOfElement(l);return t?this.error(n.DiagnosticCode.Type_0_has_no_call_signatures,e.range,t.toString()):this.error(n.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),i.unreachable()}}return this.compileCallIndirect(assert(u),c,e.args,e,0,t==_.Type.void)}compileCallExpressionLike(e,t,r,i,n,s=0){var a=this._reusableCallExpression;return a?(a.expression=e,a.typeArguments=t,a.args=r,a.range=i):this._reusableCallExpression=a=p.Node.createCallExpression(e,t,r,i),this.compileCallExpression(a,n,s)}compileCallExpressionBuiltin(e,t,r){e.hasDecorator(o.DecoratorFlags.UNSAFE)&&this.checkUnsafe(t);var s=null,l=e.typeParameterNodes,u=t.typeArguments;t.typeArguments&&(e.is(a.CommonFlags.GENERIC)||this.error(n.DiagnosticCode.Type_0_is_not_generic,t.range,e.internalName),s=this.resolver.resolveTypeArguments(assert(l),u,this.currentFlow.actualFunction.parent,h.uniqueMap(this.currentFlow.contextualTypeArguments),t));var c=t.expression,_=new i.BuiltinContext(this,e,s,t.args,c.kind==p.NodeKind.PROPERTYACCESS?c.expression:null,r,t,!1),d=e.internalName;if(i.builtins.has(d)){return assert(i.builtins.get(d))(_)}var m=e.parent;if(m.kind==o.ElementKind.CLASS){if(m.prototype==this.program.functionPrototype){let t=e.name;if(i.function_builtins.has(t)){return assert(i.function_builtins.get(t))(_)}}}return assert(!1),this.module.unreachable()}checkCallSignature(e,t,r,i){if(r!=(null!=e.thisType))return this.error(n.DiagnosticCode.The_this_types_of_each_signature_are_incompatible,i.range),!1;var s=e.hasRest;if(s)return this.error(n.DiagnosticCode.Not_implemented_0,i.range,"Rest parameters"),!1;var a=e.requiredParameters,o=e.parameterTypes.length;return t<a?(this.error(a<o?n.DiagnosticCode.Expected_at_least_0_arguments_but_got_1:n.DiagnosticCode.Expected_0_arguments_but_got_1,i.range,a.toString(),t.toString()),!1):!(t>o&&!s)||(this.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,i.range,o.toString(),t.toString()),!1)}checkUnsafe(e,t=null){this.options.noUnsafe&&!e.range.source.isLibrary&&(t?this.errorRelated(n.DiagnosticCode.Operation_is_unsafe,e.range,t.range):this.error(n.DiagnosticCode.Operation_is_unsafe,e.range))}compileCallDirect(e,t,r,i=0,s=0){var l=t.length,u=e.signature;if(!this.checkCallSignature(u,l,0!=i,r))return this.currentType=u.returnType,this.module.unreachable();e.hasDecorator(o.DecoratorFlags.UNSAFE)&&this.checkUnsafe(r);let c=this.currentFlow.actualFunction;if(c.is(a.CommonFlags.CONSTRUCTOR)&&r.isAccessOnThis){let e=c.parent;assert(e.kind==o.ElementKind.CLASS),this.checkFieldInitialization(e,r)}if(e.hasDecorator(o.DecoratorFlags.INLINE)&&(!e.is(a.CommonFlags.VIRTUAL)||r.isAccessOnSuper)){assert(!e.is(a.CommonFlags.STUB));let o=this.inlineStack;if(!o.includes(e)){o.push(e);let r=u.parameterTypes;assert(l<=r.length);let n=new Array(l);for(let e=0;e<l;++e)n[e]=this.compileExpression(t[e],r[e],1);let a=this.makeCallInline(e,n,i,0!=(8&s));return o.pop(),a}this.warning(n.DiagnosticCode.Function_0_cannot_be_inlined_into_itself,r.range,e.internalName)}var p=i?l+1:l,_=new Array(p),h=0;i&&(_[0]=i,h=1);var d=u.parameterTypes;for(let e=0;e<l;++e,++h){let r=d[e],i=this.compileExpression(t[e],r,1);_[h]=i}return assert(h==p),this.makeCallDirect(e,_,r,0!=(8&s))}makeCallInline(e,t,r=0,i=!1){var n=this.module,s=t?t.length:0,u=e.signature.parameterTypes,c=u.length,p=this.currentFlow,_=l.Flow.createInline(p.parentFunction,e),h=[],d=new Set;for(let r=s-1;r>=0;--r){let i=t[r],s=u[r],a=_.addScopedLocal(e.getParameterName(r),s,d);l.findUsedLocals(i,d),p.canOverflow(i,s)||_.setLocalFlag(a.index,l.LocalFlags.WRAPPED),_.isNonnull(i,s)&&_.setLocalFlag(a.index,l.LocalFlags.NONNULL),h.unshift(n.local_set(a.index,i,s.isManaged))}if(r){let t=assert(e.parent);assert(t.kind==o.ElementKind.CLASS);let i=t,s=assert(e.signature.thisType),l=_.addScopedLocal(a.CommonNames.this_,s,d);h.unshift(n.local_set(l.index,r,s.isManaged));let u=i.base;u&&_.addScopedAlias(a.CommonNames.super_,u.type,l.index)}else assert(!e.signature.thisType);this.currentFlow=_;for(let t=s;t<c;++t){let r=u[t],i=this.compileExpression(assert(e.prototype.functionTypeNode.parameters[t].initializer),r,1),n=_.addScopedLocal(e.getParameterName(t),r);h.push(this.makeLocalAssignment(n,i,r,!1))}if(this.compileFunctionBody(e,h),e.is(a.CommonFlags.CONSTRUCTOR)){let t=e.parent;assert(t.kind==o.ElementKind.CLASS),this.checkFieldInitializationInFlow(t,_)}_.freeScopedLocals();var m=_.returnType;return this.currentFlow=p,this.currentType=m,n.block(_.inlineReturnLabel,h,m.toNativeType())}ensureArgumentsLength(){var e=i.BuiltinNames.argumentsLength;if(!this.builtinArgumentsLength){let t=this.module;this.builtinArgumentsLength=t.addGlobal(e,s.NativeType.I32,!0,t.i32(0))}return e}ensureVarargsStub(e){var t=e.varargsStub;if(t)return t;var r=e.signature,i=r.parameterTypes,o=e.prototype.functionTypeNode.parameters,l=r.returnType,u=e.is(a.CommonFlags.INSTANCE),c=r.requiredParameters,p=c,h=i.length,d=h;u&&(++p,++d);var m=assert(d-p),y=new Array(p),T=0,g=new Array,f=this.module,E=r.thisType;E&&(y[0]=f.local_get(0,E.toNativeType()),T=1);for(let e=0;e<c;++e,++T){let t=i[e];y[T]=f.local_get(T,t.toNativeType())}assert(T==p),(t=e.newStub("varargs")).signature.requiredParameters=h,e.varargsStub=t;var b=this.currentFlow,x=t.flow;this.currentFlow=x;var I=m+1,A=new Array(I),N="of"+m.toString();for(let e=0;e<I;++e){let t=e.toString()+N;A[e]=t}var S=this.ensureArgumentsLength(),v=f.block(A[0],[f.block("outOfRange",[f.switch(A,"outOfRange",c?f.binary(s.BinaryOp.SubI32,f.global_get(S,s.NativeType.I32),f.i32(c)):f.global_get(S,s.NativeType.I32))]),f.unreachable()]);for(let e=0;e<m;++e,++T){let t,r=i[c+e],s=o[c+e],a=s.initializer;a?(t=this.compileExpression(a,r,1),t=f.local_set(T,t,r.isManaged)):(this.error(n.DiagnosticCode.Optional_parameter_must_have_an_initializer,s.range),t=f.unreachable()),v=f.block(A[e+1],[v,t]),y[T]=f.local_get(T,r.toNativeType())}assert(T==d),g.push(v),g.push(f.call(e.internalName,y,l.toNativeType())),x.freeScopedLocals(),this.currentFlow=b;var C=f.addFunction(t.internalName,t.signature.nativeParams,t.signature.nativeResults,_.typesToNativeTypes(t.additionalLocals),f.flatten(g,l.toNativeType()));return t.set(a.CommonFlags.COMPILED),t.finalize(f,C),t}ensureVirtualStub(e){var t=e.virtualStub;if(t)return t;t=e.newStub("virtual"),e.virtualStub=t;var r=this.module;return t.ref=r.addFunction(t.internalName,t.signature.nativeParams,t.signature.nativeResults,null,r.unreachable()),this.virtualCalls.add(e),t}finalizeVirtualStub(e){var t=this.ensureVirtualStub(e);if(!t.is(a.CommonFlags.COMPILED)){var r,i=assert(e.prototype.overloads),l=this.module,u=this.options.usizeType.toNativeType(),c=e.signature.parameterTypes,p=e.signature.returnType,h=c.length,d=1+c.length,m=new s.SwitchBuilder(this.module,l.load(4,!1,l.binary(u==s.NativeType.I64?s.BinaryOp.SubI64:s.BinaryOp.SubI32,l.local_get(0,u),u==s.NativeType.I64?l.i64(8):l.i32(8)),s.NativeType.I32));for(let t=Set_values(i),r=0,s=t.length;r<s;++r){let i=t[r];assert(!i.isBound);let s,d=i.parent,y=d.kind==o.ElementKind.PROPERTY_PROTOTYPE;if(y){let e=d.parent;assert(e.kind==o.ElementKind.CLASS_PROTOTYPE),s=e.instances}else assert(d.kind==o.ElementKind.CLASS_PROTOTYPE),s=d.instances;if(s)for(let t=Map_values(s),r=0,T=t.length;r<T;++r){let s,T=t[r];if(y){let t=assert(T.members.get(d.name));assert(t.kind==o.ElementKind.PROPERTY_PROTOTYPE);let r=this.resolver.resolveProperty(t);if(!r)continue;e.is(a.CommonFlags.GET)?s=r.getterInstance:(assert(e.is(a.CommonFlags.SET)),s=r.setterInstance)}else{let t=assert(T.members.get(i.name));assert(t.kind==o.ElementKind.FUNCTION_PROTOTYPE),s=this.resolver.resolveFunction(t,e.typeArguments)}if(!s||!this.compileFunction(s))continue;let g=s.type,f=e.type;if(!g.isAssignableTo(f)){this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,s.identifierNode.range,g.toString(),f.toString());continue}let E=s.signature,b=E.parameterTypes,x=b.length,I=new Array(1+x);I[0]=l.local_get(0,u);for(let e=1;e<=h;++e)I[e]=l.local_get(e,c[e-1].toNativeType());let A=!1;for(let e=h;e<x;++e)I[1+e]=this.makeZero(b[e],s.declaration),A=!0;let N=A?this.ensureVarargsStub(s).internalName:s.internalName,S=E.returnType.toNativeType(),v=new Array;A&&v.push(l.global_set(this.ensureArgumentsLength(),l.i32(h))),p==_.Type.void?(v.push(l.call(N,I,S)),v.push(l.return())):v.push(l.return(l.call(N,I,S))),m.addCase(T.id,v);let C=T.getAllExtendees(y?d.name:e.prototype.name);for(let e=Set_values(C),t=0,r=e.length;t<r;++t){let r=e[t];m.addCase(r.id,v)}}}if(e.prototype.bodyNode){let t=new Array(h);t[0]=l.local_get(0,u);for(let e=0,r=c.length;e<r;++e)t[1+e]=l.local_get(1+e,c[e].toNativeType());r=l.call(e.internalName,t,p.toNativeType())}else r=l.unreachable();t.ref&&l.removeFunction(t.internalName),t.ref=l.addFunction(t.internalName,t.signature.nativeParams,t.signature.nativeResults,[s.NativeType.I32],l.block(null,[m.render(d),r],p.toNativeType())),t.set(a.CommonFlags.COMPILED)}}operandsTostack(e,t){if(this.options.stackSize){var r=this.module,i=0,n=e.thisType;if(n){if(n.isManaged){let e=t[0],n=r.runExpression(e,s.ExpressionRunnerFlags.Default);s.isConstZero(n)||(t[i]=r.tostack(e))}++i}var a=0,o=e.parameterTypes;for(assert(o.length>=t.length-i);i<t.length;){if(o[a].isManaged){let e=t[i],n=r.runExpression(e,s.ExpressionRunnerFlags.Default);s.isConstZero(n)||(t[i]=r.tostack(e))}++i,++a}}}makeCallDirect(e,t,r,i=!1){if(e.hasDecorator(o.DecoratorFlags.INLINE))if(e.is(a.CommonFlags.VIRTUAL))this.warning(n.DiagnosticCode.Function_0_is_virtual_and_will_not_be_inlined,r.range,e.internalName);else{assert(!e.is(a.CommonFlags.STUB));let s=this.inlineStack;if(!s.includes(e)){let r;if(s.push(e),e.is(a.CommonFlags.INSTANCE)){let n=assert(t);assert(n.length),r=this.makeCallInline(e,n.slice(1),n[0],i)}else r=this.makeCallInline(e,t,0,i);return s.pop(),r}this.warning(n.DiagnosticCode.Function_0_cannot_be_inlined_into_itself,r.range,e.internalName)}var l=this.module,c=t?t.length:0,p=c,h=e.signature.requiredParameters,d=e.signature.parameterTypes,m=d.length,y=m;if(e.is(a.CommonFlags.INSTANCE)&&(++h,++y,--p),assert(c>=h),!this.compileFunction(e))return l.unreachable();var T=e.signature.returnType;if(c<y){t||((t=new Array(y)).length=0);let r=e.prototype.functionTypeNode.parameters;assert(r.length==d.length);let n=!0;for(let i=p;i<m;++i){let s=r[i].initializer;if(s){if(s.compilesToConst){t.push(this.compileExpression(s,d[i],1));continue}let r=this.resolver.lookupExpression(s,e.flow,d[i],u.ReportMode.SWALLOW);if(r&&r.kind==o.ElementKind.GLOBAL){let e=r;if(this.compileGlobal(e)){e.is(a.CommonFlags.INLINED)?t.push(this.compileInlineConstant(e,d[i],1)):t.push(this.convertExpression(l.global_get(e.internalName,e.type.toNativeType()),e.type,d[i],!1,s));continue}}}t.push(this.makeZero(d[i],e.declaration)),n=!1}if(!n&&!e.is(a.CommonFlags.MODULE_IMPORT)){let r=e;if(e=this.ensureVarargsStub(e),!this.compileFunction(e))return l.unreachable();e.flow.flags=r.flow.flags;let n=T.toNativeType(),a=t[y-1];assert(!(s.getSideEffects(a)&s.SideEffects.WritesGlobal));let o=d[m-1];t[y-1]=l.block(null,[l.global_set(this.ensureArgumentsLength(),l.i32(p)),a],o.toNativeType()),this.operandsTostack(e.signature,t);let u=l.call(e.internalName,t,n);return T!=_.Type.void&&i?(u=l.drop(u),this.currentType=_.Type.void):this.currentType=T,u}}e.is(a.CommonFlags.VIRTUAL)&&!r.isAccessOnSuper&&(e=this.ensureVirtualStub(e)),t&&this.operandsTostack(e.signature,t);var g=l.call(e.internalName,t,T.toNativeType());return this.currentType=T,g}compileCallIndirect(e,t,r,i,n=0,s=!1){var a=r.length;if(!this.checkCallSignature(e,a,0!=n,i))return this.module.unreachable();var o=n?a+1:a,l=new Array(o),u=0;n&&(l[0]=n,u=1);var c=e.parameterTypes;for(let e=0;e<a;++e,++u)l[u]=this.compileExpression(r[e],c[e],1);return assert(u==o),this.makeCallIndirect(e,t,i,l,s)}makeCallIndirect(e,t,r,i=null,n=!1){var a=this.module,o=i?i.length:0,u=o,c=e.requiredParameters,p=e.parameterTypes,_=e.returnType,h=p.length,d=h;if(e.thisType&&(++c,++d,--u),assert(o>=c),o<d){i||((i=new Array(d)).length=0);let t=e.parameterTypes;for(let e=u;e<h;++e)i.push(this.makeZero(t[e],r))}var m=this.ensureArgumentsLength(),y=this.options.nativeSizeType;if(s.getSideEffects(t)&s.SideEffects.WritesGlobal){let e=this.currentFlow,r=e.getTempLocal(this.options.usizeType,l.findUsedLocals(t));t=a.block(null,[a.local_set(r.index,t,!0),a.global_set(m,a.i32(u)),a.local_get(r.index,y)],y),e.freeTempLocal(r)}else t=a.block(null,[a.global_set(m,a.i32(u)),t],y);i&&this.operandsTostack(e,i);var T=a.call_indirect(a.load(4,!1,t,s.NativeType.I32),i,e.nativeParams,e.nativeResults);return this.currentType=_,T}compileCommaExpression(e,t,r){var i=e.expressions,n=i.length,s=new Array(n--);for(let e=0;e<n;++e)s[e]=this.compileExpression(i[e],_.Type.void,9);return s[n]=this.compileExpression(i[n],t,r),this.module.flatten(s,this.currentType.toNativeType())}compileElementAccessExpression(e,t,r){var i=this.module,s=e.expression,a=this.resolver.resolveExpression(s,this.currentFlow);if(a){let t=a.getClassOrWrapper(this.program);if(t){let i=this.currentFlow.is(32768),a=t.lookupOverload(o.OperatorKind.INDEXED_GET,i);if(a){let t=assert(a.signature.thisType),o=this.compileExpression(s,t,1);return!i&&this.options.pedantic&&this.pedantic(n.DiagnosticCode.Indexed_access_may_involve_bounds_checking,e.range),this.compileCallDirect(a,[e.elementExpression],e,o,r)}}this.error(n.DiagnosticCode.Index_signature_is_missing_in_type_0,e.expression.range,a.toString())}return i.unreachable()}compileFunctionExpression(e,t,r){var i=e.declaration.clone();assert(!i.typeParameters);var s,a=this.currentFlow,u=a.actualFunction,c=i.name.text.length>0,d=!c||t!=_.Type.void,m=new o.FunctionPrototype(d?(c?i.name.text+"|":"anonymous|")+(u.nextAnonymousId++).toString():i.name.text,u,i,o.DecoratorFlags.NONE),y=h.uniqueMap(a.contextualTypeArguments),T=this.module,g=t.signatureReference;if(g){let t=m.functionTypeNode,r=t.parameters,i=r.length,l=g.parameterTypes,c=l.length;if(i>c)return this.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,e.range,c.toString(),i.toString()),T.unreachable();for(let e=0;e<i;++e){let t=r[e];if(!p.isTypeOmitted(t.type)){let r=this.resolver.resolveType(t.type,u.parent,y);if(!r)return T.unreachable();if(!l[e].isStrictlyAssignableTo(r))return this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,t.range,l[e].toString(),r.toString()),T.unreachable()}}let h=g.returnType;if(!p.isTypeOmitted(t.returnType)){let e=this.resolver.resolveType(t.returnType,u.parent,y);if(!e)return T.unreachable();if(h==_.Type.void?e!=_.Type.void:!e.isStrictlyAssignableTo(h))return this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,t.returnType.range,e.toString(),h.toString()),T.unreachable()}let d=g.thisType,f=t.explicitThisType;if(f){if(!d)return this.error(n.DiagnosticCode._this_cannot_be_referenced_in_current_location,f.range),T.unreachable();let e=this.resolver.resolveType(f,u.parent,y);if(!e)return T.unreachable();if(!d.isStrictlyAssignableTo(e))return this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,f.range,d.toString(),e.toString()),T.unreachable()}let E=new _.Signature(this.program,l,h,d);E.requiredParameters=c,(s=new o.Function(m.name,m,null,E,y)).flow.outer=a;let b=this.compileFunction(s);if(this.currentType=g.type,!b)return T.unreachable()}else{if(!(s=this.resolver.resolveFunction(m,null,y)))return this.module.unreachable();s.flow.outer=a;let e=this.compileFunction(s);if(this.currentType=s.signature.type,!e)return T.unreachable()}var f=this.ensureRuntimeFunction(s),E=this.options.isWasm64?T.i64(i64_low(f),i64_high(f)):T.i32(i64_low(f));if(!d){let e=s.name,t=a.getScopedLocal(e);if(t)t.declaration.range.source.isNative?this.error(n.DiagnosticCode.Duplicate_identifier_0,i.name.range,e):this.errorRelated(n.DiagnosticCode.Duplicate_identifier_0,i.name.range,t.declaration.name.range,e);else{let e=s.type,t=a.addScopedLocal(s.name,e);a.setLocalFlag(t.index,l.LocalFlags.CONSTANT),E=T.local_tee(t.index,E,e.isManaged)}}return E}maybeCompileEnclosingSource(e){var t=e.range.source.internalPath,r=this.program.filesByName;assert(r.has(t)),assert(r.get(t)).is(a.CommonFlags.COMPILED)||this.compileFileByPath(t,e)}compileIdentifierExpression(e,t,r){var i=this.module,u=this.currentFlow,c=u.actualFunction;switch(e.kind){case p.NodeKind.NULL:{let r=this.options;if(t.isReference){let n=t.getClass();if(n)return this.currentType=n.type.asNullable(),r.isWasm64?i.i64(0):i.i32(0);let s=t.getSignature();return s?(this.currentType=s.type.asNullable(),r.isWasm64?i.i64(0):i.i32(0)):this.makeZero(t,e)}return this.currentType=r.usizeType,this.warning(n.DiagnosticCode.Expression_resolves_to_unusual_type_0,e.range,this.currentType.toString()),r.isWasm64?i.i64(0):i.i32(0)}case p.NodeKind.TRUE:return this.currentType=_.Type.bool,i.i32(1);case p.NodeKind.FALSE:return this.currentType=_.Type.bool,i.i32(0);case p.NodeKind.THIS:{let t=c.signature.thisType;if(!t)return this.error(n.DiagnosticCode._this_cannot_be_referenced_in_current_location,e.range),this.currentType=this.options.usizeType,i.unreachable();if(c.is(a.CommonFlags.CONSTRUCTOR)&&!(32&r)){let t=c.parent;assert(t.kind==o.ElementKind.CLASS),this.checkFieldInitialization(t,e)}let s=assert(u.lookupLocal(a.CommonNames.this_));return u.set(64),this.currentType=t,i.local_get(s.index,t.toNativeType())}case p.NodeKind.SUPER:{let t=this.currentFlow,r=t.actualFunction;if(r.is(a.CommonFlags.CONSTRUCTOR)&&(t.is(128)||this.error(n.DiagnosticCode._super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class,e.range)),t.isInline){let e=t.lookupLocal(a.CommonNames.this_);if(e){let t=assert(e.type.getClass()).base;if(t)return this.currentType=t.type,i.local_get(e.index,t.type.toNativeType())}}if(r.is(a.CommonFlags.INSTANCE)){let e=assert(r.parent);assert(e.kind==o.ElementKind.CLASS);let t=e.base;if(t){let e=t.type;return this.currentType=e,i.local_get(0,e.toNativeType())}}return this.error(n.DiagnosticCode._super_can_only_be_referenced_in_a_derived_class,e.range),this.currentType=this.options.usizeType,i.unreachable()}}this.maybeCompileEnclosingSource(e);var d=this.currentParent;d||(d=c);var m=this.resolver.lookupIdentifierExpression(e,u,d);if(!m)return this.currentType==_.Type.void&&(this.currentType=_.Type.i32),i.unreachable();switch(m.kind){case o.ElementKind.LOCAL:{let s=m,o=s.type;if(assert(o!=_.Type.void),this.pendingElements.has(s))return this.error(n.DiagnosticCode.Variable_0_used_before_its_declaration,e.range,s.internalName),this.currentType=o,i.unreachable();if(s.is(a.CommonFlags.INLINED))return this.compileInlineConstant(s,t,r);let c=s.index;return assert(c>=0),o.isNullableReference&&u.isLocalFlag(c,l.LocalFlags.NONNULL,!1)&&(o=o.nonNullableType),this.currentType=o,m.parent!=u.parentFunction?(this.error(n.DiagnosticCode.Not_implemented_0,e.range,"Closures"),i.unreachable()):i.local_get(c,o.toNativeType())}case o.ElementKind.GLOBAL:{let s=m;if(!this.compileGlobal(s))return i.unreachable();let o=s.type;return this.pendingElements.has(s)?(this.error(n.DiagnosticCode.Variable_0_used_before_its_declaration,e.range,s.internalName),this.currentType=o,i.unreachable()):(assert(o!=_.Type.void),s.is(a.CommonFlags.INLINED)?this.compileInlineConstant(s,t,r):(this.currentType=o,i.global_get(s.internalName,o.toNativeType())))}case o.ElementKind.ENUMVALUE:{let t=m;return m.is(a.CommonFlags.COMPILED)?(this.currentType=_.Type.i32,t.is(a.CommonFlags.INLINED)?(assert(1==t.constantValueKind),i.i32(i64_low(t.constantIntegerValue))):i.global_get(t.internalName,s.NativeType.I32)):(this.error(n.DiagnosticCode.A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums,e.range),this.currentType=_.Type.i32,i.unreachable())}case o.ElementKind.FUNCTION_PROTOTYPE:{let r=m,a=r.typeParameterNodes;if(null!==a&&0!=a.length)return this.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,e.range,a.length.toString(),"0"),i.unreachable();let o=this.resolver.resolveFunction(r,null,h.uniqueMap(u.contextualTypeArguments));if(!o||!this.compileFunction(o))return i.unreachable();if(t.isExternalReference)return this.currentType=_.Type.funcref,i.ref_func(o.internalName,s.NativeType.Funcref);let l=this.ensureRuntimeFunction(o);return this.currentType=o.signature.type,this.options.isWasm64?i.i64(i64_low(l),i64_high(l)):i.i32(i64_low(l))}}return this.error(n.DiagnosticCode.Expression_refers_to_a_static_element_that_does_not_compile_to_a_value_at_runtime,e.range),this.module.unreachable()}compileInstanceOfExpression(e,t,r){var i=this.currentFlow,n=e.isType;if(n.kind==p.NodeKind.NAMEDTYPE){let t=n;if(!t.isNullable&&!t.hasTypeArguments){let r=this.resolver.resolveTypeName(t.name,i.actualFunction,u.ReportMode.SWALLOW);if(null!==r&&r.kind==o.ElementKind.CLASS_PROTOTYPE){let t=r;if(t.is(a.CommonFlags.GENERIC))return this.makeInstanceofClass(e,t)}}}var s=this.resolver.resolveType(e.isType,i.actualFunction,h.uniqueMap(i.contextualTypeArguments));return s?this.makeInstanceofType(e,s):(this.currentType=_.Type.bool,this.module.unreachable())}makeInstanceofType(e,t){var r=this.module,i=this.currentFlow,a=this.compileExpression(e.expression,t),o=this.currentType;if(this.currentType=_.Type.bool,t.isValue)return r.maybeDropCondition(a,r.i32(o==t?1:0));if(o.isValue)return r.maybeDropCondition(a,r.i32(0));var l=o.toNativeType();if(o.isNullableReference&&!t.isNullableReference){if(o.nonNullableType.isAssignableTo(t))return r.binary(l==s.NativeType.I64?s.BinaryOp.NeI64:s.BinaryOp.NeI32,a,this.makeZero(o,e.expression));if(t.isAssignableTo(o)){let u=this.program;if(!o.isUnmanaged&&!t.isUnmanaged){let c=i.getTempLocal(o),p=assert(u.instanceofInstance);this.compileFunction(p);let _=r.if(r.unary(l==s.NativeType.I64?s.UnaryOp.EqzI64:s.UnaryOp.EqzI32,r.local_tee(c.index,a,o.isManaged)),r.i32(0),this.makeCallDirect(p,[r.local_get(c.index,l),r.i32(t.classReference.id)],e));return i.freeTempLocal(c),this.options.pedantic&&this.pedantic(n.DiagnosticCode.Expression_compiles_to_a_dynamic_check_at_runtime,e.range),_}this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"instanceof",o.toString(),t.toString())}}else{if(o.isAssignableTo(t))return r.maybeDropCondition(a,r.i32(1));if(t.isAssignableTo(o)){let u=this.program;if(!o.isUnmanaged&&!t.isUnmanaged){let n=i.getTempLocal(o),c=assert(u.instanceofInstance);this.compileFunction(c);let p=r.if(r.unary(l==s.NativeType.I64?s.UnaryOp.EqzI64:s.UnaryOp.EqzI32,r.local_tee(n.index,a,o.isManaged)),r.i32(0),this.makeCallDirect(c,[r.local_get(n.index,l),r.i32(t.classReference.id)],e));return i.freeTempLocal(n),p}this.error(n.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"instanceof",o.toString(),t.toString())}}return r.maybeDropCondition(a,r.i32(0))}makeInstanceofClass(e,t){var r=this.module,i=this.compileExpression(e.expression,_.Type.auto),n=this.currentType,a=n.toNativeType();this.currentType=_.Type.bool;var o=n.getClass();if(o){if(o.extends(t))return n.isNullableReference?r.binary(a==s.NativeType.I64?s.BinaryOp.NeI64:s.BinaryOp.NeI32,i,this.makeZero(n,e.expression)):r.maybeDropCondition(i,r.i32(1));if(t.extends(o.prototype))return this.pendingClassInstanceOf.add(t),r.call(t.internalName+"~instanceof",[i],s.NativeType.I32)}return r.maybeDropCondition(i,r.i32(0))}compileLiteralExpression(e,t,r,i=!1){var s=this.module;switch(e.literalKind){case p.LiteralKind.ARRAY:return assert(!i),this.compileArrayLiteral(e,t,r);case p.LiteralKind.FLOAT:{let r=e.value;return i&&(r=-r),t==_.Type.f32?s.f32(r):(this.currentType=_.Type.f64,s.f64(r))}case p.LiteralKind.INTEGER:{let r=e.value;i&&(r=i64_sub(i64_new(0),r));let n=this.resolver.determineIntegerLiteralType(r,t);switch(this.currentType=n,n.kind){case 4:if(!this.options.isWasm64)return s.i32(i64_low(r));case 3:return s.i64(i64_low(r),i64_high(r));case 9:if(!this.options.isWasm64)return s.i32(i64_low(r));case 8:return s.i64(i64_low(r),i64_high(r));case 11:return s.f32(i64_to_f32(r));case 12:return s.f64(i64_to_f64(r));default:return s.i32(i64_low(r))}}case p.LiteralKind.STRING:return assert(!i),this.compileStringLiteral(e,r);case p.LiteralKind.TEMPLATE:return assert(!i),this.compileTemplateLiteral(e,r);case p.LiteralKind.OBJECT:return assert(!i),this.compileObjectLiteral(e,t);case p.LiteralKind.REGEXP:return this.error(n.DiagnosticCode.Not_implemented_0,e.range,"Regular expressions"),this.currentType=t,s.unreachable()}return assert(!1),s.unreachable()}compileStringLiteral(e,t){return this.ensureStaticString(e.value)}compileTemplateLiteral(e,t){var r=e.tag,i=e.parts,s=i.length,a=e.expressions;if(assert(s-1==a.length),null===r&&1==s)return this.ensureStaticString(i[0]);var l=this.module,c=this.program.stringInstance.type;if(null===r){let t=new Array(2*s-1);t[0]=this.ensureStaticString(i[0]);for(let e=1;e<s;++e)t[2*e-1]=l.usize(0),t[2*e]=this.ensureStaticString(i[e]);let r=assert(this.resolver.resolveClass(this.program.staticArrayPrototype,[c])),n=this.addStaticBuffer(c,t,r.id),u=i64_add(n.offset,i64_new(this.program.totalOverhead)),p=assert(r.getMethod("join")),_=assert(r.lookupOverload(o.OperatorKind.INDEXED_SET,!0)),h=new Array;for(let e=0,t=s-1;e<t;++e){let t=a[e];h.push(this.makeCallDirect(_,[l.usize(u),l.i32(2*e+1),this.makeToString(this.compileExpression(t,c),this.currentType,t)],t))}return h.push(this.makeCallDirect(p,[l.usize(u),this.ensureStaticString("")],e)),l.flatten(h,c.toNativeType())}var d=this.program.templateStringsArrayInstance,m=d,y=this.resolver.lookupExpression(r,this.currentFlow,_.Type.auto,u.ReportMode.SWALLOW);if(y)switch(y.kind){case o.ElementKind.FUNCTION_PROTOTYPE:{let e=this.resolver.resolveFunction(y,null,h.uniqueMap(),u.ReportMode.SWALLOW);if(!e)break;y=e}case o.ElementKind.FUNCTION:{let e=y.signature.parameterTypes;if(e.length){let t=e[0].getClass();null===t||t.extends(d.prototype)||(m=assert(this.resolver.resolveClass(this.program.arrayPrototype,[c])))}break}}var T=e.rawParts;assert(T.length==s);var g,f=new Array(s);for(let e=0;e<s;++e)f[e]=this.ensureStaticString(i[e]);if(m==d){var E=new Array(s);for(let e=0;e<s;++e)E[e]=this.ensureStaticString(T[e]);g=this.addStaticArrayHeader(c,this.addStaticBuffer(this.options.usizeType,f),m);var b=this.addStaticArrayHeader(c,this.addStaticBuffer(this.options.usizeType,E));m.writeField("raw",i64_add(b.offset,i64_new(this.program.totalOverhead)),g.buffer)}else g=this.addStaticArrayHeader(c,this.addStaticBuffer(this.options.usizeType,f),m);var x=a.slice();return x.unshift(p.Node.createCompiledExpression(l.usize(i64_add(g.offset,i64_new(this.program.totalOverhead))),m.type,this.program.nativeRange)),this.error(n.DiagnosticCode.Not_implemented_0,e.range,"Tagged template literals"),this.compileCallExpressionLike(r,null,x,e.range,c)}compileArrayLiteral(e,t,r){var i=this.module,a=this.currentFlow,l=this.program;let u=t.getClass();if(null!==u&&u.extends(l.staticArrayPrototype))return this.compileStaticArrayLiteral(e,t,r);var c=this.resolver.lookupExpression(e,a,this.currentType);if(!c)return i.unreachable();assert(c.kind==o.ElementKind.CLASS);var _=c,h=_.type,d=_.getTypeArgumentsTo(l.arrayPrototype)[0],m=assert(l.arrayBufferInstance),y=a.getTempLocal(this.options.usizeType),T=a.getTempLocal(m.type),g=e.elementExpressions,f=g.length,E=new Array(f),b=!d.isExternalReference;for(let e=0;e<f;++e){let t=g[e];if(t.kind!=p.NodeKind.OMITTED){let r=this.compileExpression(t,d,1),n=i.runExpression(r,s.ExpressionRunnerFlags.PreserveSideeffects);n?r=n:b=!1,E[e]=r}else E[e]=this.makeZero(d,t)}if(b){a.freeTempLocal(y),a.freeTempLocal(T);let t=l.totalOverhead,n=this.addStaticBuffer(d,E),s=i64_add(n.offset,i64_new(t));if(16&r){let e=this.addStaticArrayHeader(d,n),r=i64_add(e.offset,i64_new(t));return this.currentType=h,l.options.isWasm64?this.module.i64(i64_low(r),i64_high(r)):this.module.i32(i64_low(r))}{let t=this.makeCallDirect(l.newArrayInstance,[i.i32(f),l.options.isWasm64?i.i64(d.alignLog2):i.i32(d.alignLog2),i.i32(_.id),l.options.isWasm64?i.i64(i64_low(s),i64_high(s)):i.i32(i64_low(s))],e);return this.currentType=h,t}}var x=_.lookupOverload(o.OperatorKind.INDEXED_SET,!0);if(!x)return a.freeTempLocal(y),a.freeTempLocal(T),this.error(n.DiagnosticCode.Index_signature_in_type_0_only_permits_reading,e.range,_.internalName),this.currentType=h,i.unreachable();var I=h.toNativeType(),A=new Array;A.push(i.local_set(y.index,this.makeCallDirect(l.newArrayInstance,[i.i32(f),l.options.isWasm64?i.i64(d.alignLog2):i.i32(d.alignLog2),i.i32(_.id),l.options.isWasm64?i.i64(0):i.i32(0)],e),h.isManaged));var N=assert(_.lookupInSelf("dataStart"));assert(N.kind==o.ElementKind.FIELD),A.push(i.local_set(T.index,i.load(h.byteSize,!1,i.local_get(y.index,I),I,N.memoryOffset),!0));for(let e=0;e<f;++e)A.push(i.call(x.internalName,[i.local_get(y.index,I),i.i32(e),E[e]],s.NativeType.None));return A.push(i.local_get(y.index,I)),a.freeTempLocal(y),a.freeTempLocal(T),f&&this.compileFunction(x),this.currentType=h,i.flatten(A,I)}compileStaticArrayLiteral(e,t,r){var i=this.module,a=this.currentFlow,l=this.program,u=assert(t.getClass()),c=u.type,_=assert(u.getTypeArgumentsTo(l.staticArrayPrototype))[0],h=a.getTempLocal(this.options.usizeType),d=e.elementExpressions,m=d.length,y=new Array(m),T=!_.isExternalReference;for(let e=0;e<m;++e){let t=d[e];if(t.kind!=p.NodeKind.OMITTED){let r=this.compileExpression(t,_,1),n=i.runExpression(r,s.ExpressionRunnerFlags.PreserveSideeffects);n?r=n:T=!1,y[e]=r}else y[e]=this.makeZero(_,t)}var g=this.options.isWasm64,f=y.length<<_.alignLog2;if(T){a.freeTempLocal(h);let t=this.addStaticBuffer(_,y,u.id),n=i64_add(t.offset,i64_new(l.totalOverhead));if(16&r){let e=this.options.isWasm64?i.i64(i64_low(n),i64_high(n)):i.i32(i64_low(n));return this.currentType=c,e}{let t=this.makeCallDirect(l.newBufferInstance,[g?i.i64(f):i.i32(f),i.i32(u.id),g?i.i64(i64_low(n),i64_high(n)):i.i32(i64_low(n))],e);return this.currentType=c,t}}var E=u.lookupOverload(o.OperatorKind.INDEXED_SET,!0);if(!E)return a.freeTempLocal(h),this.error(n.DiagnosticCode.Index_signature_in_type_0_only_permits_reading,e.range,u.internalName),this.currentType=c,i.unreachable();var b=c.toNativeType(),x=new Array;x.push(i.local_set(h.index,this.makeCallDirect(l.newBufferInstance,[g?i.i64(f):i.i32(f),i.i32(u.id)],e),c.isManaged));for(let e=0;e<m;++e)x.push(i.call(E.internalName,[i.local_get(h.index,b),i.i32(e),y[e]],s.NativeType.None));return x.push(i.local_get(h.index,b)),a.freeTempLocal(h),m&&this.compileFunction(E),this.currentType=c,i.flatten(x,b)}compileObjectLiteral(e,t){var r=this.module,i=t.getClass();if(!i)return this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,e.range,"<object>",t.toString()),r.unreachable();var l=i.type;if(this.currentType=l.nonNullableType,i.is(a.CommonFlags.ABSTRACT))return this.error(n.DiagnosticCode.Cannot_create_an_instance_of_an_abstract_class,e.range),r.unreachable();var u=i.prototype.constructorPrototype;if(u)return this.errorRelated(n.DiagnosticCode.Class_0_cannot_declare_a_constructor_when_instantiated_from_an_object_literal,e.range,u.identifierNode.range,l.toString()),r.unreachable();var c=l.isManaged;c||this.checkUnsafe(e,p.findDecorator(p.DecoratorKind.UNMANAGED,i.decoratorNodes));var _=e.names,h=_.length,d=e.values,m=i.members,y=!1,T=new Array,g=this.currentFlow,f=g.getTempLocal(l),E=l.toNativeType();assert(h==d.length);var b=new Set;if(m)for(let e=Map_keys(m),t=0,r=e.length;t<r;++t){let r=e[t],i=assert(m.get(r));null!==i&&i.kind==o.ElementKind.FIELD&&b.add(i)}for(let e=0;e<h;++e){let t,i=_[e].text;if(!m||!m.has(i)||(t=assert(m.get(i))).kind!=o.ElementKind.FIELD){this.error(n.DiagnosticCode.Property_0_does_not_exist_on_type_1,_[e].range,i,l.toString()),y=!0;continue}if(t.is(a.CommonFlags.PRIVATE)){this.error(n.DiagnosticCode.Property_0_is_private_and_only_accessible_within_class_1,_[e].range,i,l.toString()),y=!0;continue}if(t.is(a.CommonFlags.PROTECTED)){this.error(n.DiagnosticCode.Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses,_[e].range,i,l.toString()),y=!0;continue}let u=t,c=u.type,p=this.compileExpression(d[e],c,1);T.push(r.call(u.internalSetterName,[r.local_get(f.index,E),p],s.NativeType.None)),this.compileFieldSetter(u),b.delete(u)}if(this.currentType=l.nonNullableType,y)return r.unreachable();for(let t=Set_values(b),i=0,a=t.length;i<a;++i){let a=t[i],o=a.type;if(!a.initializerNode)if(!o.isReference||o.isNullableReference){switch(o.kind){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:T.push(r.call(a.internalSetterName,[r.local_get(f.index,E),this.makeZero(o,e)],s.NativeType.None)),this.compileFieldSetter(a);continue}this.error(n.DiagnosticCode.Property_0_is_missing_in_type_1_but_required_in_type_2,e.range,a.name,"<object>",l.toString()),y=!0}else this.error(n.DiagnosticCode.Property_0_is_missing_in_type_1_but_required_in_type_2,e.range,a.name,"<object>",l.toString()),y=!0}if(y)return r.unreachable();var x=this.ensureConstructor(i,e);return T.unshift(r.local_set(f.index,this.compileInstantiate(x,[],0,e),l.isManaged)),T.push(r.local_get(f.index,E)),c||g.freeTempLocal(f),this.currentType=l.nonNullableType,r.flatten(T,E)}compileNewExpression(e,t,r){var i=this.module,s=this.currentFlow,l=this.resolver.resolveTypeName(e.typeName,s.actualFunction);if(!l)return i.unreachable();if(l.kind!=o.ElementKind.CLASS_PROTOTYPE)return this.error(n.DiagnosticCode.This_expression_is_not_constructable,e.typeName.range),this.module.unreachable();if(l.is(a.CommonFlags.ABSTRACT))return this.error(n.DiagnosticCode.Cannot_create_an_instance_of_an_abstract_class,e.typeName.range),this.module.unreachable();var u,c=l,p=null,d=e.typeArguments;if(!(p=!d&&null!==(u=t.classReference)&&u.prototype==c&&u.is(a.CommonFlags.GENERIC)?this.resolver.resolveClass(c,u.typeArguments,h.uniqueMap(s.contextualTypeArguments)):this.resolver.resolveClassInclTypeArguments(c,d,s.actualFunction.parent,h.uniqueMap(s.contextualTypeArguments),e)))return i.unreachable();t==_.Type.void&&(r|=8);var m=this.ensureConstructor(p,e);return m.hasDecorator(o.DecoratorFlags.INLINE)||this.checkFieldInitialization(p,e),this.compileInstantiate(m,e.args,r,e)}ensureConstructor(e,t){var r=e.constructorInstance;if(r){if(r.is(a.CommonFlags.COMPILED))return r;r.hasDecorator(o.DecoratorFlags.INLINE)||this.compileFunction(r)}else{let i=e.base,n=h.uniqueMap(e.contextualTypeArguments);if(i){let s=this.ensureConstructor(i,t);this.checkFieldInitialization(i,t),r=new o.Function(a.CommonNames.constructor,new o.FunctionPrototype(a.CommonNames.constructor,e,s.declaration.clone()),null,s.signature,n)}else r=new o.Function(a.CommonNames.constructor,new o.FunctionPrototype(a.CommonNames.constructor,e,this.program.makeNativeFunctionDeclaration(a.CommonNames.constructor,a.CommonFlags.INSTANCE|a.CommonFlags.CONSTRUCTOR)),null,new _.Signature(this.program,null,e.type,e.type),n);r.set(a.CommonFlags.COMPILED),r.prototype.setResolvedInstance("",r),e.is(a.CommonFlags.MODULE_EXPORT)&&r.set(a.CommonFlags.MODULE_EXPORT),e.constructorInstance=r;let s=e.members;s||(e.members=s=new Map),s.set("constructor",r.prototype);let l=this.currentFlow,u=r.flow;this.currentFlow=u;let c=r.signature,p=this.module,d=this.options.nativeSizeType,m=new Array;if(m.push(this.makeConditionalAllocation(e,0)),i){let e=c.parameterTypes,r=e.length,n=new Array(1+r);n[0]=p.local_get(0,d);for(let t=1;t<=r;++t)n[t]=p.local_get(t,e[t-1].toNativeType());m.push(p.local_set(0,this.makeCallDirect(assert(i.constructorInstance),n,t,!1),i.type.isManaged))}this.makeFieldInitializationInConstructor(e,m),m.push(p.local_get(0,d)),u.freeScopedLocals(),this.currentFlow=l;let y=r.localsByIndex,T=new Array,g=1+c.parameterTypes.length,f=y.length;if(f>g)for(let e=g;e<f;++e)T.push(y[e].type.toNativeType());let E=p.addFunction(r.internalName,c.nativeParams,c.nativeResults,T,p.flatten(m,d));r.finalize(p,E)}return r}checkFieldInitialization(e,t=null){if(!e.didCheckFieldInitialization){e.didCheckFieldInitialization=!0;var r=assert(e.constructorInstance);this.checkFieldInitializationInFlow(e,r.flow,t)}}checkFieldInitializationInFlow(e,t,r=null){var i=e.members;if(i)for(let s=Map_values(i),u=0,c=s.length;u<c;++u){let i=s[u];if(i.kind==o.ElementKind.FIELD&&i.parent==e){let e=i;e.initializerNode||t.isThisFieldFlag(e,l.FieldFlags.INITIALIZED)?e.is(a.CommonFlags.DEFINITELY_ASSIGNED)&&(e.type.isReference?this.warning(n.DiagnosticCode.Property_0_is_always_assigned_before_being_used,e.identifierNode.range,e.internalName):this.pedantic(n.DiagnosticCode.Unnecessary_definite_assignment,e.identifierNode.range)):e.is(a.CommonFlags.DEFINITELY_ASSIGNED)||(r?this.errorRelated(n.DiagnosticCode.Property_0_has_no_initializer_and_is_not_assigned_in_the_constructor_before_this_is_used_or_returned,e.declaration.name.range,r.range,e.internalName):this.error(n.DiagnosticCode.Property_0_has_no_initializer_and_is_not_assigned_in_the_constructor_before_this_is_used_or_returned,e.declaration.name.range,e.internalName))}}}compileInstantiate(e,t,r,i){assert(e.is(a.CommonFlags.CONSTRUCTOR));var n=e.parent;assert(n.kind==o.ElementKind.CLASS);var l=n;(l.type.isUnmanaged||e.hasDecorator(o.DecoratorFlags.UNSAFE))&&this.checkUnsafe(i);var u=this.compileCallDirect(e,t,i,this.makeZero(this.options.usizeType,i),r);return s.getExpressionType(u)!=s.NativeType.None&&(this.currentType=l.type),u}compilePropertyAccessExpression(e,t,r){var i=this.module,u=this.currentFlow;this.maybeCompileEnclosingSource(e);var c=this.resolver,h=c.lookupExpression(e,u,t);if(!h)return i.unreachable();var d=c.currentThisExpression;switch(h.hasDecorator(o.DecoratorFlags.UNSAFE)&&this.checkUnsafe(e),h.kind){case o.ElementKind.GLOBAL:{let s=h;if(!this.compileGlobal(s))return i.unreachable();let o=s.type;return assert(o!=_.Type.void),this.pendingElements.has(s)?(this.error(n.DiagnosticCode.Variable_0_used_before_its_declaration,e.range,s.internalName),this.currentType=o,i.unreachable()):s.is(a.CommonFlags.INLINED)?this.compileInlineConstant(s,t,r):(this.currentType=o,i.global_get(s.internalName,o.toNativeType()))}case o.ElementKind.ENUMVALUE:{let e=h,n=assert(e.parent);assert(n.kind==o.ElementKind.ENUM);let l=n;return this.compileEnum(l)?(this.currentType=_.Type.i32,e.is(a.CommonFlags.INLINED)?(assert(1==e.constantValueKind),this.compileInlineConstant(e,t,r)):(assert(e.type==_.Type.i32),i.global_get(e.internalName,s.NativeType.I32))):(this.currentType=_.Type.i32,this.module.unreachable())}case o.ElementKind.FIELD:{let t=h,r=t.type;assert(t.memoryOffset>=0);let s=t.parent;assert(s.kind==o.ElementKind.CLASS),d=assert(d);let c=this.compileExpression(d,s.type,33),_=this.currentType;if(!u.actualFunction.is(a.CommonFlags.CONSTRUCTOR)||d.kind!=p.NodeKind.THIS||u.isThisFieldFlag(t,l.FieldFlags.INITIALIZED)||t.is(a.CommonFlags.DEFINITELY_ASSIGNED)||this.errorRelated(n.DiagnosticCode.Property_0_is_used_before_being_assigned,e.range,t.identifierNode.range,t.internalName),_.isNullableReference&&(u.isNonnull(c,_)||this.error(n.DiagnosticCode.Object_is_possibly_null,d.range)),!t.is(a.CommonFlags.COMPILED)){t.set(a.CommonFlags.COMPILED);let e=t.typeNode;e&&this.checkTypeSupported(t.type,e)}this.currentType=r;let m=i.load(r.byteSize,r.isSignedIntegerValue,c,r.toNativeType(),t.memoryOffset);return t.is(a.CommonFlags.DEFINITELY_ASSIGNED)&&r.isReference&&!r.isNullableReference&&(m=this.makeRuntimeNonNullCheck(m,r,e)),m}case o.ElementKind.PROPERTY_PROTOTYPE:{let e=h,t=this.resolver.resolveProperty(e);if(!t)return i.unreachable();h=t}case o.ElementKind.PROPERTY:{let t=h.getterInstance;if(!t)return i.unreachable();let r=0;return t.is(a.CommonFlags.INSTANCE)&&(r=this.compileExpression(assert(d),assert(t.signature.thisType),33)),this.compileCallDirect(t,[],e,r)}case o.ElementKind.FUNCTION_PROTOTYPE:{let e=h,t=this.resolver.resolveFunction(e,null);if(!t)return i.unreachable();if(!this.compileFunction(t))return i.unreachable();this.currentType=t.type;let r=this.ensureRuntimeFunction(t);return this.options.isWasm64?i.i64(i64_low(r),i64_high(r)):i.i32(i64_low(r))}}return this.error(n.DiagnosticCode.Expression_refers_to_a_static_element_that_does_not_compile_to_a_value_at_runtime,e.range),this.module.unreachable()}compileTernaryExpression(e,t,r){var i=this.module,s=e.ifThen,a=e.ifElse,o=this.makeIsTrueish(this.compileExpression(e.condition,_.Type.bool),this.currentType,e.condition),l=this.evaluateCondition(o);if(1==l)return i.maybeDropCondition(o,this.compileExpression(s,t));if(2==l)return i.maybeDropCondition(o,this.compileExpression(a,t));var u=this.currentFlow,c=u.fork();c.inheritNonnullIfTrue(o),this.currentFlow=c;var p=this.compileExpression(s,t),h=this.currentType,d=u.fork();d.inheritNonnullIfFalse(o),this.currentFlow=d;var m=this.compileExpression(a,t==_.Type.auto?h:t),y=this.currentType,T=_.Type.commonDenominator(h,y,!1);return T?(p=this.convertExpression(p,h,T,!1,s),h=T,m=this.convertExpression(m,y,T,!1,a),y=T,this.currentType=T,c.freeScopedLocals(),d.freeScopedLocals(),this.currentFlow=u,u.inheritMutual(c,d),i.if(o,p,m)):(this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,a.range,y.toString(),h.toString()),this.currentType=t,i.unreachable())}compileUnaryPostfixExpression(e,t,r){var i=this.module,l=this.currentFlow,u=this.compileExpression(e.operand,t.exceptVoid,0);if(s.getExpressionId(u)==s.ExpressionId.Unreachable)return u;var p,h=null;switch(t!=_.Type.void&&(h=l.getTempLocal(this.currentType),u=i.local_tee(h.index,u,this.currentType.isManaged)),e.operator){case c.Token.PLUS_PLUS:{let t=this.currentType.getClassOrWrapper(this.program);if(t){let r=t.lookupOverload(o.OperatorKind.POSTFIX_INC);if(r){let t=r.is(a.CommonFlags.INSTANCE);if(null===h||t||(u=s.getLocalSetValue(u),l.freeTempLocal(h),h=null),p=this.compileUnaryOverload(r,e.operand,u,e),t)break;return p}}if(!this.currentType.isValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"++",this.currentType.toString()),h&&l.freeTempLocal(h),i.unreachable();switch(this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:p=i.binary(s.BinaryOp.AddI32,u,i.i32(1));break;case 9:case 4:{let e=this.options;p=i.binary(e.isWasm64?s.BinaryOp.AddI64:s.BinaryOp.AddI32,u,this.makeOne(this.currentType));break}case 3:case 8:p=i.binary(s.BinaryOp.AddI64,u,i.i64(1));break;case 11:p=i.binary(s.BinaryOp.AddF32,u,i.f32(1));break;case 12:p=i.binary(s.BinaryOp.AddF64,u,i.f64(1));break;default:return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"++",this.currentType.toString()),i.unreachable()}break}case c.Token.MINUS_MINUS:{let t=this.currentType.getClassOrWrapper(this.program);if(t){let r=t.lookupOverload(o.OperatorKind.POSTFIX_DEC);if(r){let t=r.is(a.CommonFlags.INSTANCE);if(null===h||t||(u=s.getLocalSetValue(u),l.freeTempLocal(h),h=null),p=this.compileUnaryOverload(r,e.operand,u,e),r.is(a.CommonFlags.INSTANCE))break;return p}}if(!this.currentType.isValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"--",this.currentType.toString()),h&&l.freeTempLocal(h),i.unreachable();switch(this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:p=i.binary(s.BinaryOp.SubI32,u,i.i32(1));break;case 9:case 4:{let e=this.options;p=i.binary(e.isWasm64?s.BinaryOp.SubI64:s.BinaryOp.SubI32,u,this.makeOne(this.currentType));break}case 3:case 8:p=i.binary(s.BinaryOp.SubI64,u,i.i64(1));break;case 11:p=i.binary(s.BinaryOp.SubF32,u,i.f32(1));break;case 12:p=i.binary(s.BinaryOp.SubF64,u,i.f64(1));break;default:return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"--",this.currentType.toString()),i.unreachable()}break}default:return assert(!1),i.unreachable()}var d=this.resolver,m=d.lookupExpression(e.operand,l);if(!m)return h&&l.freeTempLocal(h),i.unreachable();if(!h)return this.makeAssignment(m,p,this.currentType,e.operand,d.currentThisExpression,d.currentElementExpression,!1);var y=this.makeAssignment(m,p,this.currentType,e.operand,d.currentThisExpression,d.currentElementExpression,!1);this.currentType=h.type,l.freeTempLocal(h);var T=h.type.toNativeType();return i.block(null,[y,i.local_get(h.index,T)],T)}compileUnaryPrefixExpression(e,t,r){var i,l=this.module,u=!1;switch(e.operator){case c.Token.PLUS:{i=this.compileExpression(e.operand,t.exceptVoid,0);let r=this.currentType.getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.PLUS);if(t)return this.compileUnaryOverload(t,e.operand,i,e)}if(!this.currentType.isValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"+",this.currentType.toString()),l.unreachable();break}case c.Token.MINUS:{let r=e.operand;if(r.isNumericLiteral){i=this.compileLiteralExpression(r,t,0,!0),this.options.sourceMap&&this.addDebugLocation(i,e.range);break}i=this.compileExpression(e.operand,t.exceptVoid,0);let a=this.currentType.getClassOrWrapper(this.program);if(a){let t=a.lookupOverload(o.OperatorKind.MINUS);if(t)return this.compileUnaryOverload(t,e.operand,i,e)}if(!this.currentType.isValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"-",this.currentType.toString()),l.unreachable();switch(this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:i=l.binary(s.BinaryOp.SubI32,l.i32(0),i);break;case 9:case 4:i=l.binary(this.options.isWasm64?s.BinaryOp.SubI64:s.BinaryOp.SubI32,this.makeZero(this.currentType,e.operand),i);break;case 3:case 8:i=l.binary(s.BinaryOp.SubI64,l.i64(0),i);break;case 11:i=l.unary(s.UnaryOp.NegF32,i);break;case 12:i=l.unary(s.UnaryOp.NegF64,i);break;default:this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"-",this.currentType.toString()),i=l.unreachable()}break}case c.Token.PLUS_PLUS:{u=!0,i=this.compileExpression(e.operand,t.exceptVoid,0);let r=this.currentType.getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.PREFIX_INC);if(t){if(i=this.compileUnaryOverload(t,e.operand,i,e),t.is(a.CommonFlags.INSTANCE))break;return i}}if(!this.currentType.isValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"++",this.currentType.toString()),l.unreachable();switch(this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:i=l.binary(s.BinaryOp.AddI32,i,this.module.i32(1));break;case 9:case 4:i=l.binary(this.options.isWasm64?s.BinaryOp.AddI64:s.BinaryOp.AddI32,i,this.makeOne(this.currentType));break;case 3:case 8:i=l.binary(s.BinaryOp.AddI64,i,l.i64(1));break;case 11:i=l.binary(s.BinaryOp.AddF32,i,l.f32(1));break;case 12:i=l.binary(s.BinaryOp.AddF64,i,l.f64(1));break;default:this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"++",this.currentType.toString()),i=l.unreachable()}break}case c.Token.MINUS_MINUS:{u=!0,i=this.compileExpression(e.operand,t.exceptVoid,0);let r=this.currentType.getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.PREFIX_DEC);if(t){if(i=this.compileUnaryOverload(t,e.operand,i,e),t.is(a.CommonFlags.INSTANCE))break;return i}}if(!this.currentType.isValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"--",this.currentType.toString()),l.unreachable();switch(this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:i=l.binary(s.BinaryOp.SubI32,i,l.i32(1));break;case 9:case 4:i=l.binary(this.options.isWasm64?s.BinaryOp.SubI64:s.BinaryOp.SubI32,i,this.makeOne(this.currentType));break;case 3:case 8:i=l.binary(s.BinaryOp.SubI64,i,l.i64(1));break;case 11:i=l.binary(s.BinaryOp.SubF32,i,l.f32(1));break;case 12:i=l.binary(s.BinaryOp.SubF64,i,l.f64(1));break;default:this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"--",this.currentType.toString()),i=l.unreachable()}break}case c.Token.EXCLAMATION:{i=this.compileExpression(e.operand,t.exceptVoid,0);let r=this.currentType.getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.NOT);if(t)return this.compileUnaryOverload(t,e.operand,i,e)}i=l.unary(s.UnaryOp.EqzI32,this.makeIsTrueish(i,this.currentType,e.operand)),this.currentType=_.Type.bool;break}case c.Token.TILDE:{i=this.compileExpression(e.operand,t==_.Type.void?_.Type.i32:t.isFloatValue?_.Type.i64:t,0);let r=this.currentType.getClassOrWrapper(this.program);if(r){let t=r.lookupOverload(o.OperatorKind.BITWISE_NOT);if(t)return this.compileUnaryOverload(t,e.operand,i,e)}if(!this.currentType.isValue)return this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"~",this.currentType.toString()),l.unreachable();switch(i=this.convertExpression(i,this.currentType,this.currentType.intType,!1,e.operand),this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:i=l.binary(s.BinaryOp.XorI32,i,l.i32(-1));break;case 9:case 4:i=l.binary(this.options.isWasm64?s.BinaryOp.XorI64:s.BinaryOp.XorI32,i,this.makeNegOne(this.currentType));break;case 3:case 8:i=l.binary(s.BinaryOp.XorI64,i,l.i64(-1,-1));break;default:this.error(n.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"~",this.currentType.toString()),i=l.unreachable()}break}case c.Token.TYPEOF:return this.compileTypeof(e,t,r);default:return assert(!1),l.unreachable()}if(!u)return i;var p=this.resolver,h=p.lookupExpression(e.operand,this.currentFlow);return h?this.makeAssignment(h,i,this.currentType,e.operand,p.currentThisExpression,p.currentElementExpression,t!=_.Type.void):l.unreachable()}compileTypeof(e,t,r){var i,n=e.operand,s=0,a=this.program.stringInstance;if(n.kind==p.NodeKind.NULL)i="object";else{let e=this.resolver.lookupExpression(n,this.currentFlow,_.Type.auto,u.ReportMode.SWALLOW);if(e)switch(e.kind){case o.ElementKind.CLASS_PROTOTYPE:case o.ElementKind.NAMESPACE:case o.ElementKind.ENUM:i="object";break;case o.ElementKind.FUNCTION_PROTOTYPE:i="function";break;default:{s=this.compileExpression(n,_.Type.auto);let e=this.currentType;if(s=this.convertExpression(s,e,_.Type.void,!0,n),e.isReference){if(e.getSignature())i="function";else{let t=e.getClass();i=t?t.prototype===a.prototype?"string":"object":"externref"}}else i=e==_.Type.bool?"boolean":e.isNumericValue?"number":"undefined";break}}else{switch(n.kind){case p.NodeKind.IDENTIFIER:break;case p.NodeKind.PROPERTYACCESS:case p.NodeKind.ELEMENTACCESS:if(n.kind,p.NodeKind.PROPERTYACCESS,n=n.expression,!this.resolver.resolveExpression(n,this.currentFlow,_.Type.auto,u.ReportMode.REPORT))return this.currentType=a.type,this.module.unreachable();default:s=this.compileExpression(n,_.Type.auto),s=this.convertExpression(s,this.currentType,_.Type.void,!0,n)}i="undefined"}}return this.currentType=a.type,s?this.module.block(null,[s,this.ensureStaticString(i)],this.options.nativeSizeType):this.ensureStaticString(i)}ensureSmallIntegerWrap(e,t){var r=this.module,i=this.currentFlow;switch(t.kind){case 0:i.canOverflow(e,t)&&(e=this.options.hasFeature(1)?r.unary(s.UnaryOp.ExtendI8ToI32,e):r.binary(s.BinaryOp.ShrI32,r.binary(s.BinaryOp.ShlI32,e,r.i32(24)),r.i32(24)));break;case 1:i.canOverflow(e,t)&&(e=this.options.hasFeature(1)?r.unary(s.UnaryOp.ExtendI16ToI32,e):r.binary(s.BinaryOp.ShrI32,r.binary(s.BinaryOp.ShlI32,e,r.i32(16)),r.i32(16)));break;case 5:i.canOverflow(e,t)&&(e=r.binary(s.BinaryOp.AndI32,e,r.i32(255)));break;case 6:i.canOverflow(e,t)&&(e=r.binary(s.BinaryOp.AndI32,e,r.i32(65535)));break;case 10:i.canOverflow(e,t)&&(e=r.binary(s.BinaryOp.NeI32,e,r.i32(0)))}return e}addDebugLocation(e,t){var r=this.currentFlow.parentFunction,i=t.source;i.debugInfoIndex<0&&(i.debugInfoIndex=this.module.addDebugInfoFile(i.normalizedPath)),t.debugInfoRef=e,r.debugLocations.push(t)}checkFeatureEnabled(e,t){return!!this.options.hasFeature(e)||(this.error(n.DiagnosticCode.Feature_0_is_not_enabled,t.range,a.featureToString(e)),!1)}checkTypeSupported(e,t){switch(e.kind){case 13:return this.checkFeatureEnabled(16,t);case 14:case 15:return this.checkFeatureEnabled(256,t);case 16:case 17:case 18:case 19:return this.checkFeatureEnabled(256,t)&&this.checkFeatureEnabled(1024,t)}let r=e.getClass();if(r)do{let e=r.typeArguments;if(e)for(let r=0,i=e.length;r<i;++r)if(!this.checkTypeSupported(e[r],t))return!1;r=r.base}while(r);else{let r=e.getSignature();if(r){let e=r.thisType;if(e&&!this.checkTypeSupported(e,t))return!1;let i=r.parameterTypes;for(let e=0,r=i.length;e<r;++e)if(!this.checkTypeSupported(i[e],t))return!1;let n=r.returnType;if(!this.checkTypeSupported(n,t))return!1}}return!0}checkSignatureSupported(e,t){var r=!0,i=t.explicitThisType;i&&(this.checkTypeSupported(assert(e.thisType),i)||(r=!1));var n=e.parameterTypes,s=t.parameters;for(let e=0,i=n.length;e<i;++e){let i;i=s.length>e?s[e]:t,this.checkTypeSupported(n[e],i)||(r=!1)}return this.checkTypeSupported(e.returnType,t.returnType)||(r=!1),r}evaluateCondition(e){var t=this.module.runExpression(e,s.ExpressionRunnerFlags.Default);return t?s.getConstValueI32(t)?1:2:0}makeZero(e,t){var r=this.module;switch(e.kind){default:assert(!1);case 0:case 1:case 2:case 5:case 6:case 7:case 10:return r.i32(0);case 4:case 9:if(64!=e.size)return r.i32(0);case 3:case 8:return r.i64(0);case 11:return r.f32(0);case 12:return r.f64(0);case 13:return r.v128(h.v128_zero);case 14:case 15:case 16:case 17:case 19:return r.ref_null(e.toNativeType());case 18:return r.i31_new(r.i32(0))}}makeOne(e){var t=this.module;switch(e.kind){default:assert(!1);case 0:case 1:case 2:case 5:case 6:case 7:case 10:return t.i32(1);case 4:case 9:if(64!=e.size)return t.i32(1);case 3:case 8:return t.i64(1);case 11:return t.f32(1);case 12:return t.f64(1);case 18:return t.i31_new(t.i32(1))}}makeNegOne(e){var t=this.module;switch(e.kind){default:assert(!1);case 0:case 1:case 2:case 5:case 6:case 7:return t.i32(-1);case 4:case 9:if(64!=e.size)return t.i32(-1);case 3:case 8:return t.i64(-1,-1);case 11:return t.f32(-1);case 12:return t.f64(-1)}}makeIsTrueish(e,t,r){var i=this.module;switch(t.kind){case 0:case 1:case 5:case 6:e=this.ensureSmallIntegerWrap(e,t);case 10:case 2:case 7:return e;case 3:case 8:return i.binary(s.BinaryOp.NeI64,e,i.i64(0));case 9:case 4:return 64==t.size?i.binary(s.BinaryOp.NeI64,e,i.i64(0)):e;case 11:return i.binary(s.BinaryOp.LeU32,i.binary(s.BinaryOp.SubI32,i.binary(s.BinaryOp.ShlI32,i.unary(s.UnaryOp.ReinterpretF32,e),i.i32(1)),i.i32(2)),i.i32(4278190078));case 12:return i.binary(s.BinaryOp.LeU64,i.binary(s.BinaryOp.SubI64,i.binary(s.BinaryOp.ShlI64,i.unary(s.UnaryOp.ReinterpretF64,e),i.i64(1)),i.i64(2)),i.i64(4294967294,4292870143));case 14:case 15:case 16:case 17:case 19:case 18:return i.unary(s.UnaryOp.EqzI32,i.ref_is(s.RefIsOp.RefIsNull,e));default:return assert(!1),i.i32(0)}}makeToString(e,t,r){var i=this.program.stringInstance.type;if(t==i)return e;var s=t.getClassOrWrapper(this.program);if(s){let a=s.getMethod("toString");if(a){let s=a.signature;if(!this.checkCallSignature(s,0,!0,r))return this.currentType=i,this.module.unreachable();if(!t.isStrictlyAssignableTo(assert(s.thisType)))return this.errorRelated(n.DiagnosticCode.The_this_types_of_each_signature_are_incompatible,r.range,a.identifierAndSignatureRange),this.currentType=i,this.module.unreachable();let o=s.returnType;return o.isStrictlyAssignableTo(i)?this.makeCallDirect(a,[e],r):(this.errorRelated(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,r.range,a.identifierAndSignatureRange,o.toString(),i.toString()),this.currentType=i,this.module.unreachable())}}return this.error(n.DiagnosticCode.Type_0_is_not_assignable_to_type_1,r.range,t.toString(),i.toString()),this.currentType=i,this.module.unreachable()}makeAllocation(e){var t=this.program;assert(e.program==t);var r=this.module,i=this.options;if(this.currentType=e.type,e.hasDecorator(o.DecoratorFlags.UNMANAGED)){let n=t.allocInstance;return this.compileFunction(n),r.call(n.internalName,[i.isWasm64?r.i64(e.nextMemoryOffset):r.i32(e.nextMemoryOffset)],i.nativeSizeType)}{let n=t.newInstance;return this.compileFunction(n),r.call(n.internalName,[i.isWasm64?r.i64(e.nextMemoryOffset):r.i32(e.nextMemoryOffset),r.i32(e.id)],i.nativeSizeType)}}makeConditionalAllocation(e,t){var r=this.module,i=e.type.toNativeType();return assert(i==this.options.nativeSizeType),r.if(r.unary(i==s.NativeType.I64?s.UnaryOp.EqzI64:s.UnaryOp.EqzI32,r.local_get(t,i)),r.local_set(t,this.makeAllocation(e),e.type.isManaged))}makeFieldInitializationInConstructor(e,t=[]){var r=e.members;if(!r)return t;var i=this.module,n=this.currentFlow,l=n.isInline,u=l?n.lookupLocal(a.CommonNames.this_).index:0,c=this.options.nativeSizeType;for(let p=Map_values(r),_=0,h=p.length;_<h;++_){let r=unchecked(p[_]);if(r.kind!=o.ElementKind.FIELD||r.parent!=e)continue;let h=r;assert(!h.isAny(a.CommonFlags.CONST));let d,m=h.type,y=m.toNativeType(),T=h.prototype,g=T.initializerNode,f=T.parameterIndex,E=h.typeNode;E&&this.checkTypeSupported(m,E),d=f>=0?i.local_get(l?n.lookupLocal(h.name).index:1+f,y):g?this.compileExpression(g,m,1):this.makeZero(m,T.declaration),this.compileFieldSetter(h),t.push(i.call(h.internalSetterName,[i.local_get(u,c),d],s.NativeType.None))}return t}makeAbort(e,t){var r=this.program,i=r.abortInstance;if(!i||!this.compileFunction(i))return this.module.unreachable();var n,s=r.stringInstance;return n=null!==e?this.compileExpression(e,s.type,1):this.makeZero(s.type,t),this.makeStaticAbort(n,t)}makeStaticAbort(e,t){var r=this.program,i=this.module,n=r.abortInstance;if(!n||!this.compileFunction(n))return i.unreachable();var a=this.ensureStaticString(t.range.source.normalizedPath),o=t.range,l=o.source;return i.block(null,[i.call(n.internalName,[e,a,i.i32(l.lineAt(o.start)),i.i32(l.columnAt())],s.NativeType.None),i.unreachable()])}makeRuntimeNonNullCheck(e,t,r){var i=this.module,n=this.currentFlow,s=n.getTempLocal(t);return n.canOverflow(e,t)||n.setLocalFlag(s.index,l.LocalFlags.WRAPPED),n.setLocalFlag(s.index,l.LocalFlags.NONNULL),e=i.if(i.local_tee(s.index,e,t.isManaged),i.local_get(s.index,t.toNativeType()),this.makeStaticAbort(this.ensureStaticString("unexpected null"),r)),n.freeTempLocal(s),this.currentType=t.nonNullableType,e}makeRuntimeUpcastCheck(e,t,r,i){assert(r.isReference&&r.nonNullableType.isAssignableTo(t));var n=this.module,a=this.currentFlow,o=a.getTempLocal(t),l=this.program.instanceofInstance;return assert(this.compileFunction(l)),e=n.if(n.call(l.internalName,[n.local_tee(o.index,e,t.isManaged),n.i32(r.classReference.id)],s.NativeType.I32),n.local_get(o.index,t.toNativeType()),this.makeStaticAbort(this.ensureStaticString("unexpected upcast"),i)),a.freeTempLocal(o),this.currentType=r,e}}function E(e,t){if(b=t.range.source.simplePath,x=o.mangleInternalName(e.name,e.parent,e.is(a.CommonFlags.INSTANCE),!0),e.hasDecorator(o.DecoratorFlags.EXTERNAL)){var r=e.program,i=assert(p.findDecorator(p.DecoratorKind.EXTERNAL,t.decorators)),s=i.args;if(null!==s&&s.length>0){let e=s[0];e.isLiteralKind(p.LiteralKind.STRING)?(x=e.value,s.length>=2&&(e=s[1],e.isLiteralKind(p.LiteralKind.STRING)?(b=x,x=e.value,s.length>2&&r.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,i.range,"2",s.length.toString())):r.error(n.DiagnosticCode.String_literal_expected,e.range))):r.error(n.DiagnosticCode.String_literal_expected,e.range)}else r.error(n.DiagnosticCode.Expected_at_least_0_arguments_but_got_1,i.range,"1","0")}}var b,x;t.Compiler=f},317:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TSDBuilder=t.IDLBuilder=t.ExportsWalker=void 0;const i=r(200),n=r(974),s=r(60),a=r(910);class o{constructor(e,t=!1){this.seen=new Map,this.program=e,this.includePrivate=t}walk(){for(let e=Map_values(this.program.filesByName),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);r.source.sourceKind==s.SourceKind.USER_ENTRY&&this.visitFile(r)}}visitFile(e){var t=e.exports;if(t)for(let e=Map_keys(t),r=0,i=e.length;r<i;++r){let i=unchecked(e[r]),n=assert(t.get(i));this.visitElement(i,n)}var r=e.exportsStar;if(r)for(let e=0,t=r.length;e<t;++e){let t=unchecked(r[e]);this.visitFile(t)}}visitElement(e,t){if(!t.is(i.CommonFlags.PRIVATE)||this.includePrivate){var r=this.seen;if(t.is(i.CommonFlags.INSTANCE)||!r.has(t))switch(r.set(t,e),t.kind){case n.ElementKind.GLOBAL:t.is(i.CommonFlags.COMPILED)&&this.visitGlobal(e,t);break;case n.ElementKind.ENUM:t.is(i.CommonFlags.COMPILED)&&this.visitEnum(e,t);break;case n.ElementKind.ENUMVALUE:break;case n.ElementKind.FUNCTION_PROTOTYPE:this.visitFunctionInstances(e,t);break;case n.ElementKind.CLASS_PROTOTYPE:this.visitClassInstances(e,t);break;case n.ElementKind.FIELD:{let r=t;r.is(i.CommonFlags.COMPILED)&&this.visitField(e,r);break}case n.ElementKind.PROPERTY_PROTOTYPE:{let e=t.instance;if(!e)break;t=e}case n.ElementKind.PROPERTY:{let r=t,i=r.getterInstance;i&&this.visitFunction(e,i);let n=r.setterInstance;n&&this.visitFunction(e,n);break}case n.ElementKind.NAMESPACE:c(t)&&this.visitNamespace(e,t);break;case n.ElementKind.TYPEDEFINITION:break;default:assert(!1)}else this.visitAlias(e,t,assert(r.get(t)))}}visitFunctionInstances(e,t){var r=t.instances;if(r)for(let t=Map_values(r),n=0,s=t.length;n<s;++n){let r=unchecked(t[n]);r.is(i.CommonFlags.COMPILED)&&this.visitFunction(e,r)}}visitClassInstances(e,t){var r=t.instances;if(r)for(let t=Map_values(r),n=0,s=t.length;n<s;++n){let r=unchecked(t[n]);r.is(i.CommonFlags.COMPILED)&&this.visitClass(e,r)}}}t.ExportsWalker=o;class l extends o{constructor(e,t=!1){super(e,t),this.sb=[],this.indentLevel=0}static build(e){return new l(e).build()}visitGlobal(e,t){var r=this.sb,n=t.is(i.CommonFlags.INLINED);if(a.indent(r,this.indentLevel),n&&r.push("const "),r.push(this.typeToString(t.type)),r.push(" "),r.push(e),n)switch(t.constantValueKind){case 1:r.push(" = "),r.push(i64_to_string(t.constantIntegerValue));break;case 2:r.push(" = "),r.push(t.constantFloatValue.toString());break;default:assert(!1)}r.push(";\n")}visitEnum(e,t){var r=this.sb;a.indent(r,this.indentLevel++),r.push("interface "),r.push(e),r.push(" {\n");var s=t.members;if(s){for(let e=Map_keys(s),t=0,o=e.length;t<o;++t){let o=unchecked(e[t]),l=assert(s.get(o));if(l.kind==n.ElementKind.ENUMVALUE){let e=l,t=e.is(i.CommonFlags.INLINED);a.indent(r,this.indentLevel),t?r.push("const "):r.push("readonly "),r.push("unsigned long "),r.push(o),t&&(r.push(" = "),assert(1==e.constantValueKind),r.push(i64_low(e.constantIntegerValue).toString())),r.push(";\n")}}for(let e=Map_values(s),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);r.kind!=n.ElementKind.ENUMVALUE&&this.visitElement(r.name,r)}}a.indent(r,--this.indentLevel),r.push("}\n")}visitFunction(e,t){var r=this.sb,i=t.signature;a.indent(r,this.indentLevel),r.push(this.typeToString(i.returnType)),r.push(" "),r.push(e),r.push("(");var n=i.parameterTypes,s=n.length;for(let e=0;e<s;++e)e&&r.push(", "),r.push(this.typeToString(n[e])),r.push(" "),r.push(t.getParameterName(e));r.push(");\n");var o=t.members;if(null!==o&&o.size>0){a.indent(r,this.indentLevel),r.push("interface "),r.push(t.name),r.push(" {\n");for(let e=Map_values(o),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);this.visitElement(r.name,r)}a.indent(r,--this.indentLevel),r.push("}\n")}}visitClass(e,t){var r=this.sb;a.indent(r,this.indentLevel++),r.push("interface "),r.push(e),r.push(" {\n"),a.indent(r,--this.indentLevel),r.push("}\n")}visitInterface(e,t){this.visitClass(e,t)}visitField(e,t){}visitNamespace(e,t){var r=this.sb;a.indent(r,this.indentLevel++),r.push("interface "),r.push(e),r.push(" {\n");var i=t.members;if(i)for(let e=Map_values(i),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);this.visitElement(r.name,r)}a.indent(r,--this.indentLevel),r.push("}\n")}visitAlias(e,t,r){}typeToString(e){switch(e.kind){case 0:return"byte";case 1:return"short";case 2:return"long";case 3:return"long long";case 4:return this.program.options.isWasm64?"long long":"long";case 5:return"octet";case 6:return"unsigned short";case 7:return"unsigned long";case 8:return"unsigned long long";case 9:return this.program.options.isWasm64?"unsigned long long":"unsigned long";case 10:return"boolean";case 11:return"unrestricted float";case 12:return"unrestricted double";case 20:return"void";default:return assert(!1),""}}build(){var e=this.sb;return e.push("interface ASModule {\n"),++this.indentLevel,this.walk(),--this.indentLevel,e.push("}\n"),e.join("")}}t.IDLBuilder=l;class u extends o{constructor(e,t=!1){super(e,t),this.sb=[],this.indentLevel=0}static build(e){return new u(e).build()}visitGlobal(e,t){var r=this.sb,n=t.is(i.CommonFlags.INLINED);a.indent(r,this.indentLevel),t.is(i.CommonFlags.STATIC)?n?r.push("static readonly "):r.push("static "):n?r.push("export const "):r.push("export var "),r.push(e),r.push(": "),r.push(this.typeToString(t.type)),r.push(";\n"),this.visitNamespace(e,t)}visitEnum(e,t){var r=this.sb;a.indent(r,this.indentLevel++),r.push("export "),t.is(i.CommonFlags.CONST)&&r.push("const "),r.push("enum "),r.push(e),r.push(" {\n");var s=t.members,o=0;if(s){o=s.size;for(let e=Map_keys(s),t=0,l=e.length;t<l;++t){let l=unchecked(e[t]),u=assert(s.get(l));if(u.kind==n.ElementKind.ENUMVALUE){let e=u;a.indent(r,this.indentLevel),r.push(l),u.is(i.CommonFlags.INLINED)&&(r.push(" = "),assert(1==e.constantValueKind),r.push(i64_low(e.constantIntegerValue).toString())),r.push(",\n"),--o}}}a.indent(r,--this.indentLevel),r.push("}\n"),o&&this.visitNamespace(e,t)}visitFunction(e,t){if(!t.isAny(i.CommonFlags.PRIVATE|i.CommonFlags.SET)){var r=this.sb,n=t.signature;if(a.indent(r,this.indentLevel),t.is(i.CommonFlags.PROTECTED)&&r.push("protected "),t.is(i.CommonFlags.STATIC)&&r.push("static "),t.is(i.CommonFlags.GET))return r.push("get "),r.push(e),r.push("(): "),r.push(this.typeToString(n.returnType)),void r.push(";\n");t.isAny(i.CommonFlags.STATIC|i.CommonFlags.INSTANCE)||r.push("export function "),r.push(e),r.push("(");var s=n.parameterTypes,o=s.length,l=n.requiredParameters;for(let e=0;e<o;++e)e&&r.push(", "),r.push(t.getParameterName(e)),e>=l&&r.push("?"),r.push(": "),r.push(this.typeToString(s[e]));t.isAny(i.CommonFlags.CONSTRUCTOR|i.CommonFlags.SET)?r.push(")"):(r.push("): "),r.push(this.typeToString(n.returnType))),r.push(";\n"),this.visitNamespace(e,t)}}visitClass(e,t){var r=this.sb,s=t.kind==n.ElementKind.INTERFACE;a.indent(r,this.indentLevel++),s?r.push("export interface "):(r.push("export "),t.is(i.CommonFlags.ABSTRACT)&&r.push("abstract "),r.push("class ")),r.push(e);var o=t.base;if(null!==o&&o.is(i.CommonFlags.COMPILED|i.CommonFlags.MODULE_EXPORT)){r.push(" extends ");let e=assert(t.prototype.extendsNode);r.push(e.name.identifier.text)}r.push(" {\n"),s||(a.indent(r,this.indentLevel),r.push("static wrap(ptr: usize): "),r.push(e),r.push(";\n"),a.indent(r,this.indentLevel),r.push("valueOf(): usize;\n"));var l=t.prototype.members;if(l)for(let e=Map_values(l),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);this.visitElement(r.name,r)}var u=t.members;if(u)for(let e=Map_values(u),r=0,i=e.length;r<i;++r){let i=unchecked(e[r]);i.parent==t&&this.visitElement(i.name,i)}a.indent(r,--this.indentLevel),r.push("}\n")}visitInterface(e,t){this.visitClass(e,t)}visitField(e,t){if(!t.is(i.CommonFlags.PRIVATE)){var r=this.sb;a.indent(r,this.indentLevel),t.is(i.CommonFlags.PROTECTED)&&r.push("protected "),t.is(i.CommonFlags.STATIC)&&r.push("static "),t.is(i.CommonFlags.READONLY)&&r.push("readonly "),r.push(e),r.push(": "),r.push(this.typeToString(t.type)),r.push(";\n")}}visitNamespace(e,t){var r=t.members;if(null!==r&&r.size>0){let t=this.sb;a.indent(t,this.indentLevel++),t.push("export namespace "),t.push(e),t.push(" {\n");for(let e=Map_values(r),t=0,i=e.length;t<i;++t){let r=unchecked(e[t]);this.visitElement(r.name,r)}a.indent(t,--this.indentLevel),t.push("}\n")}}visitAlias(e,t,r){var i=this.sb;a.indent(i,this.indentLevel),i.push("export const "),i.push(e),i.push(": typeof "),i.push(r),i.push(";\n")}typeToString(e){switch(e.kind){case 0:return"i8";case 1:return"i16";case 2:return"i32";case 3:return"i64";case 4:return"isize";case 5:return"u8";case 6:return"u16";case 7:return"u32";case 8:return"u64";case 9:return"usize";case 10:return"bool";case 11:return"f32";case 12:return"f64";case 13:return"v128";case 20:return"void";case 14:return"funcref";case 15:return"externref";case 16:return"anyref";case 17:return"eqref";case 18:return"i31ref";case 19:return"dataref";default:return assert(!1),"any"}}build(){var e=this.sb,t=this.program.options.isWasm64;return e.push("declare module ASModule {\n"),e.push("  type i8 = number;\n"),e.push("  type i16 = number;\n"),e.push("  type i32 = number;\n"),e.push("  type i64 = bigint;\n"),t?e.push("  type isize = bigint;\n"):e.push("  type isize = number;\n"),e.push("  type u8 = number;\n"),e.push("  type u16 = number;\n"),e.push("  type u32 = number;\n"),e.push("  type u64 = bigint;\n"),t?e.push("  type usize = bigint;\n"):e.push("  type usize = number;\n"),e.push("  type f32 = number;\n"),e.push("  type f64 = number;\n"),e.push("  type bool = boolean | number;\n"),++this.indentLevel,this.walk(),--this.indentLevel,e.push("}\n"),e.push("export default ASModule;\n"),this.sb.join("")}}function c(e){var t=e.members;if(t)for(let e=Map_values(t),r=0,s=e.length;r<s;++r){let t=unchecked(e[r]);switch(t.kind){case n.ElementKind.FUNCTION_PROTOTYPE:{let e=t.instances;if(e)for(let t=Map_values(e),r=0,n=t.length;r<n;++r){if(unchecked(t[r]).is(i.CommonFlags.COMPILED))return!0}break}case n.ElementKind.CLASS_PROTOTYPE:{let e=t.instances;if(e)for(let t=Map_values(e),r=0,n=t.length;r<n;++r){if(unchecked(t[r]).is(i.CommonFlags.COMPILED))return!0}break}default:if(t.is(i.CommonFlags.COMPILED)||c(t))return!0}}return!1}t.TSDBuilder=u},252:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.diagnosticCodeToString=t.DiagnosticCode=void 0,function(e){e[e.Not_implemented_0=100]="Not_implemented_0",e[e.Operation_is_unsafe=101]="Operation_is_unsafe",e[e.User_defined_0=102]="User_defined_0",e[e.Feature_0_is_not_enabled=103]="Feature_0_is_not_enabled",e[e.Low_memory_limit_exceeded_by_static_data_0_1=104]="Low_memory_limit_exceeded_by_static_data_0_1",e[e.Module_requires_at_least_0_pages_of_initial_memory=105]="Module_requires_at_least_0_pages_of_initial_memory",e[e.Module_requires_at_least_0_pages_of_maximum_memory=106]="Module_requires_at_least_0_pages_of_maximum_memory",e[e.Shared_memory_requires_maximum_memory_to_be_defined=107]="Shared_memory_requires_maximum_memory_to_be_defined",e[e.Shared_memory_requires_feature_threads_to_be_enabled=108]="Shared_memory_requires_feature_threads_to_be_enabled",e[e.Conversion_from_type_0_to_1_requires_an_explicit_cast=200]="Conversion_from_type_0_to_1_requires_an_explicit_cast",e[e.Conversion_from_type_0_to_1_will_require_an_explicit_cast_when_switching_between_32_64_bit=201]="Conversion_from_type_0_to_1_will_require_an_explicit_cast_when_switching_between_32_64_bit",e[e.Type_0_cannot_be_changed_to_type_1=202]="Type_0_cannot_be_changed_to_type_1",e[e.Operation_0_cannot_be_applied_to_type_1=203]="Operation_0_cannot_be_applied_to_type_1",e[e.Type_0_cannot_be_nullable=204]="Type_0_cannot_be_nullable",e[e.Cannot_export_a_mutable_global=205]="Cannot_export_a_mutable_global",e[e.Mutable_value_cannot_be_inlined=206]="Mutable_value_cannot_be_inlined",e[e.Unmanaged_classes_cannot_extend_managed_classes_and_vice_versa=207]="Unmanaged_classes_cannot_extend_managed_classes_and_vice_versa",e[e.Unmanaged_classes_cannot_implement_interfaces=208]="Unmanaged_classes_cannot_implement_interfaces",e[e.Invalid_regular_expression_flags=209]="Invalid_regular_expression_flags",e[e.Expression_is_never_null=210]="Expression_is_never_null",e[e.Class_0_is_final_and_cannot_be_extended=211]="Class_0_is_final_and_cannot_be_extended",e[e.Decorator_0_is_not_valid_here=212]="Decorator_0_is_not_valid_here",e[e.Duplicate_decorator=213]="Duplicate_decorator",e[e.Type_0_is_illegal_in_this_context=214]="Type_0_is_illegal_in_this_context",e[e.Optional_parameter_must_have_an_initializer=215]="Optional_parameter_must_have_an_initializer",e[e.Class_0_cannot_declare_a_constructor_when_instantiated_from_an_object_literal=216]="Class_0_cannot_declare_a_constructor_when_instantiated_from_an_object_literal",e[e.Function_0_cannot_be_inlined_into_itself=217]="Function_0_cannot_be_inlined_into_itself",e[e.Cannot_access_method_0_without_calling_it_as_it_requires_this_to_be_set=218]="Cannot_access_method_0_without_calling_it_as_it_requires_this_to_be_set",e[e.Optional_properties_are_not_supported=219]="Optional_properties_are_not_supported",e[e.Expression_must_be_a_compile_time_constant=220]="Expression_must_be_a_compile_time_constant",e[e.Type_0_is_not_a_function_index_or_function_reference=221]="Type_0_is_not_a_function_index_or_function_reference",e[e._0_must_be_a_value_between_1_and_2_inclusive=222]="_0_must_be_a_value_between_1_and_2_inclusive",e[e._0_must_be_a_power_of_two=223]="_0_must_be_a_power_of_two",e[e._0_is_not_a_valid_operator=224]="_0_is_not_a_valid_operator",e[e.Expression_cannot_be_represented_by_a_type=225]="Expression_cannot_be_represented_by_a_type",e[e.Expression_resolves_to_unusual_type_0=226]="Expression_resolves_to_unusual_type_0",e[e.Array_literal_expected=227]="Array_literal_expected",e[e.Function_0_is_virtual_and_will_not_be_inlined=228]="Function_0_is_virtual_and_will_not_be_inlined",e[e.Property_0_only_has_a_setter_and_is_missing_a_getter=229]="Property_0_only_has_a_setter_and_is_missing_a_getter",e[e._0_keyword_cannot_be_used_here=230]="_0_keyword_cannot_be_used_here",e[e.A_class_with_a_constructor_explicitly_returning_something_else_than_this_must_be_final=231]="A_class_with_a_constructor_explicitly_returning_something_else_than_this_must_be_final",e[e.Exported_generic_function_or_class_has_no_concrete_instances=232]="Exported_generic_function_or_class_has_no_concrete_instances",e[e.Property_0_is_always_assigned_before_being_used=233]="Property_0_is_always_assigned_before_being_used",e[e.Expression_refers_to_a_static_element_that_does_not_compile_to_a_value_at_runtime=234]="Expression_refers_to_a_static_element_that_does_not_compile_to_a_value_at_runtime",e[e.Importing_the_table_disables_some_indirect_call_optimizations=901]="Importing_the_table_disables_some_indirect_call_optimizations",e[e.Exporting_the_table_disables_some_indirect_call_optimizations=902]="Exporting_the_table_disables_some_indirect_call_optimizations",e[e.Expression_compiles_to_a_dynamic_check_at_runtime=903]="Expression_compiles_to_a_dynamic_check_at_runtime",e[e.Indexed_access_may_involve_bounds_checking=904]="Indexed_access_may_involve_bounds_checking",e[e.Explicitly_returning_constructor_drops_this_allocation=905]="Explicitly_returning_constructor_drops_this_allocation",e[e.Unnecessary_definite_assignment=906]="Unnecessary_definite_assignment",e[e.Unterminated_string_literal=1002]="Unterminated_string_literal",e[e.Identifier_expected=1003]="Identifier_expected",e[e._0_expected=1005]="_0_expected",e[e.A_file_cannot_have_a_reference_to_itself=1006]="A_file_cannot_have_a_reference_to_itself",e[e.Trailing_comma_not_allowed=1009]="Trailing_comma_not_allowed",e[e.Unexpected_token=1012]="Unexpected_token",e[e.A_rest_parameter_must_be_last_in_a_parameter_list=1014]="A_rest_parameter_must_be_last_in_a_parameter_list",e[e.Parameter_cannot_have_question_mark_and_initializer=1015]="Parameter_cannot_have_question_mark_and_initializer",e[e.A_required_parameter_cannot_follow_an_optional_parameter=1016]="A_required_parameter_cannot_follow_an_optional_parameter",e[e.Statements_are_not_allowed_in_ambient_contexts=1036]="Statements_are_not_allowed_in_ambient_contexts",e[e.Initializers_are_not_allowed_in_ambient_contexts=1039]="Initializers_are_not_allowed_in_ambient_contexts",e[e._0_modifier_cannot_be_used_here=1042]="_0_modifier_cannot_be_used_here",e[e.A_rest_parameter_cannot_be_optional=1047]="A_rest_parameter_cannot_be_optional",e[e.A_rest_parameter_cannot_have_an_initializer=1048]="A_rest_parameter_cannot_have_an_initializer",e[e.A_set_accessor_must_have_exactly_one_parameter=1049]="A_set_accessor_must_have_exactly_one_parameter",e[e.A_set_accessor_parameter_cannot_have_an_initializer=1052]="A_set_accessor_parameter_cannot_have_an_initializer",e[e.A_get_accessor_cannot_have_parameters=1054]="A_get_accessor_cannot_have_parameters",e[e.Enum_member_must_have_initializer=1061]="Enum_member_must_have_initializer",e[e.Type_parameters_cannot_appear_on_a_constructor_declaration=1092]="Type_parameters_cannot_appear_on_a_constructor_declaration",e[e.Type_annotation_cannot_appear_on_a_constructor_declaration=1093]="Type_annotation_cannot_appear_on_a_constructor_declaration",e[e.An_accessor_cannot_have_type_parameters=1094]="An_accessor_cannot_have_type_parameters",e[e.A_set_accessor_cannot_have_a_return_type_annotation=1095]="A_set_accessor_cannot_have_a_return_type_annotation",e[e.Type_parameter_list_cannot_be_empty=1098]="Type_parameter_list_cannot_be_empty",e[e.Type_argument_list_cannot_be_empty=1099]="Type_argument_list_cannot_be_empty",e[e.A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement=1104]="A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement",e[e.A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement=1105]="A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement",e[e.A_return_statement_can_only_be_used_within_a_function_body=1108]="A_return_statement_can_only_be_used_within_a_function_body",e[e.Expression_expected=1109]="Expression_expected",e[e.Type_expected=1110]="Type_expected",e[e.A_default_clause_cannot_appear_more_than_once_in_a_switch_statement=1113]="A_default_clause_cannot_appear_more_than_once_in_a_switch_statement",e[e.Duplicate_label_0=1114]="Duplicate_label_0",e[e.An_export_assignment_cannot_have_modifiers=1120]="An_export_assignment_cannot_have_modifiers",e[e.Octal_literals_are_not_allowed_in_strict_mode=1121]="Octal_literals_are_not_allowed_in_strict_mode",e[e.Digit_expected=1124]="Digit_expected",e[e.Hexadecimal_digit_expected=1125]="Hexadecimal_digit_expected",e[e.Unexpected_end_of_text=1126]="Unexpected_end_of_text",e[e.Invalid_character=1127]="Invalid_character",e[e._case_or_default_expected=1130]="_case_or_default_expected",e[e._super_must_be_followed_by_an_argument_list_or_member_access=1034]="_super_must_be_followed_by_an_argument_list_or_member_access",e[e.A_declare_modifier_cannot_be_used_in_an_already_ambient_context=1038]="A_declare_modifier_cannot_be_used_in_an_already_ambient_context",e[e.Type_argument_expected=1140]="Type_argument_expected",e[e.String_literal_expected=1141]="String_literal_expected",e[e.Line_break_not_permitted_here=1142]="Line_break_not_permitted_here",e[e.Declaration_expected=1146]="Declaration_expected",e[e._const_declarations_must_be_initialized=1155]="_const_declarations_must_be_initialized",e[e.Unterminated_regular_expression_literal=1161]="Unterminated_regular_expression_literal",e[e.Interface_declaration_cannot_have_implements_clause=1176]="Interface_declaration_cannot_have_implements_clause",e[e.Binary_digit_expected=1177]="Binary_digit_expected",e[e.Octal_digit_expected=1178]="Octal_digit_expected",e[e.An_implementation_cannot_be_declared_in_ambient_contexts=1183]="An_implementation_cannot_be_declared_in_ambient_contexts",e[e.The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer=1190]="The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer",e[e.An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive=1198]="An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive",e[e.Unterminated_Unicode_escape_sequence=1199]="Unterminated_Unicode_escape_sequence",e[e.Decorators_are_not_valid_here=1206]="Decorators_are_not_valid_here",e[e._abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration=1242]="_abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration",e[e.Method_0_cannot_have_an_implementation_because_it_is_marked_abstract=1245]="Method_0_cannot_have_an_implementation_because_it_is_marked_abstract",e[e.A_definite_assignment_assertion_is_not_permitted_in_this_context=1255]="A_definite_assignment_assertion_is_not_permitted_in_this_context",e[e.A_class_may_only_extend_another_class=1311]="A_class_may_only_extend_another_class",e[e.A_parameter_property_cannot_be_declared_using_a_rest_parameter=1317]="A_parameter_property_cannot_be_declared_using_a_rest_parameter",e[e.An_identifier_or_keyword_cannot_immediately_follow_a_numeric_literal=1351]="An_identifier_or_keyword_cannot_immediately_follow_a_numeric_literal",e[e.Duplicate_identifier_0=2300]="Duplicate_identifier_0",e[e.Cannot_find_name_0=2304]="Cannot_find_name_0",e[e.Module_0_has_no_exported_member_1=2305]="Module_0_has_no_exported_member_1",e[e.An_interface_can_only_extend_an_interface=2312]="An_interface_can_only_extend_an_interface",e[e.Generic_type_0_requires_1_type_argument_s=2314]="Generic_type_0_requires_1_type_argument_s",e[e.Type_0_is_not_generic=2315]="Type_0_is_not_generic",e[e.Type_0_is_not_assignable_to_type_1=2322]="Type_0_is_not_assignable_to_type_1",e[e.Index_signature_is_missing_in_type_0=2329]="Index_signature_is_missing_in_type_0",e[e._this_cannot_be_referenced_in_current_location=2332]="_this_cannot_be_referenced_in_current_location",e[e._super_can_only_be_referenced_in_a_derived_class=2335]="_super_can_only_be_referenced_in_a_derived_class",e[e.Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors=2337]="Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors",e[e.Property_0_does_not_exist_on_type_1=2339]="Property_0_does_not_exist_on_type_1",e[e.Property_0_is_private_and_only_accessible_within_class_1=2341]="Property_0_is_private_and_only_accessible_within_class_1",e[e.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures=2349]="Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures",e[e.This_expression_is_not_constructable=2351]="This_expression_is_not_constructable",e[e.A_function_whose_declared_type_is_not_void_must_return_a_value=2355]="A_function_whose_declared_type_is_not_void_must_return_a_value",e[e.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access=2357]="The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access",e[e.The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access=2364]="The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access",e[e.Operator_0_cannot_be_applied_to_types_1_and_2=2365]="Operator_0_cannot_be_applied_to_types_1_and_2",e[e.A_super_call_must_be_the_first_statement_in_the_constructor=2376]="A_super_call_must_be_the_first_statement_in_the_constructor",e[e.Constructors_for_derived_classes_must_contain_a_super_call=2377]="Constructors_for_derived_classes_must_contain_a_super_call",e[e.Getter_and_setter_accessors_do_not_agree_in_visibility=2379]="Getter_and_setter_accessors_do_not_agree_in_visibility",e[e._get_and_set_accessor_must_have_the_same_type=2380]="_get_and_set_accessor_must_have_the_same_type",e[e.Overload_signatures_must_all_be_public_private_or_protected=2385]="Overload_signatures_must_all_be_public_private_or_protected",e[e.Constructor_implementation_is_missing=2390]="Constructor_implementation_is_missing",e[e.Function_implementation_is_missing_or_not_immediately_following_the_declaration=2391]="Function_implementation_is_missing_or_not_immediately_following_the_declaration",e[e.Multiple_constructor_implementations_are_not_allowed=2392]="Multiple_constructor_implementations_are_not_allowed",e[e.Duplicate_function_implementation=2393]="Duplicate_function_implementation",e[e.This_overload_signature_is_not_compatible_with_its_implementation_signature=2394]="This_overload_signature_is_not_compatible_with_its_implementation_signature",e[e.Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local=2395]="Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local",e[e.A_class_can_only_implement_an_interface=2422]="A_class_can_only_implement_an_interface",e[e.A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged=2434]="A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged",e[e.Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses=2445]="Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses",e[e.Variable_0_used_before_its_declaration=2448]="Variable_0_used_before_its_declaration",e[e.The_type_argument_for_type_parameter_0_cannot_be_inferred_from_the_usage_Consider_specifying_the_type_arguments_explicitly=2453]="The_type_argument_for_type_parameter_0_cannot_be_inferred_from_the_usage_Consider_specifying_the_type_arguments_explicitly",e[e.Type_0_has_no_property_1=2460]="Type_0_has_no_property_1",e[e.The_0_operator_cannot_be_applied_to_type_1=2469]="The_0_operator_cannot_be_applied_to_type_1",e[e.In_const_enum_declarations_member_initializer_must_be_constant_expression=2474]="In_const_enum_declarations_member_initializer_must_be_constant_expression",e[e.Export_declaration_conflicts_with_exported_declaration_of_0=2484]="Export_declaration_conflicts_with_exported_declaration_of_0",e[e._0_is_referenced_directly_or_indirectly_in_its_own_base_expression=2506]="_0_is_referenced_directly_or_indirectly_in_its_own_base_expression",e[e.Cannot_create_an_instance_of_an_abstract_class=2511]="Cannot_create_an_instance_of_an_abstract_class",e[e.Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_2=2515]="Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_2",e[e.Object_is_possibly_null=2531]="Object_is_possibly_null",e[e.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property=2540]="Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property",e[e.The_target_of_an_assignment_must_be_a_variable_or_a_property_access=2541]="The_target_of_an_assignment_must_be_a_variable_or_a_property_access",e[e.Index_signature_in_type_0_only_permits_reading=2542]="Index_signature_in_type_0_only_permits_reading",e[e.Expected_0_arguments_but_got_1=2554]="Expected_0_arguments_but_got_1",e[e.Expected_at_least_0_arguments_but_got_1=2555]="Expected_at_least_0_arguments_but_got_1",e[e.Expected_0_type_arguments_but_got_1=2558]="Expected_0_type_arguments_but_got_1",e[e.Property_0_has_no_initializer_and_is_not_assigned_in_the_constructor_before_this_is_used_or_returned=2564]="Property_0_has_no_initializer_and_is_not_assigned_in_the_constructor_before_this_is_used_or_returned",e[e.Property_0_is_used_before_being_assigned=2565]="Property_0_is_used_before_being_assigned",e[e.A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums=2651]="A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums",e[e.Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration=2673]="Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration",e[e.Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration=2674]="Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration",e[e.The_this_types_of_each_signature_are_incompatible=2685]="The_this_types_of_each_signature_are_incompatible",e[e.Namespace_0_has_no_exported_member_1=2694]="Namespace_0_has_no_exported_member_1",e[e.Required_type_parameters_may_not_follow_optional_type_parameters=2706]="Required_type_parameters_may_not_follow_optional_type_parameters",e[e.Duplicate_property_0=2718]="Duplicate_property_0",e[e.Property_0_is_missing_in_type_1_but_required_in_type_2=2741]="Property_0_is_missing_in_type_1_but_required_in_type_2",e[e.Type_0_has_no_call_signatures=2757]="Type_0_has_no_call_signatures",e[e.File_0_not_found=6054]="File_0_not_found",e[e.Numeric_separators_are_not_allowed_here=6188]="Numeric_separators_are_not_allowed_here",e[e.Multiple_consecutive_numeric_separators_are_not_permitted=6189]="Multiple_consecutive_numeric_separators_are_not_permitted",e[e._super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class=17009]="_super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class",e[e._super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class=17011]="_super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class"}(t.DiagnosticCode||(t.DiagnosticCode={})),t.diagnosticCodeToString=function(e){switch(e){case 100:return"Not implemented: {0}";case 101:return"Operation is unsafe.";case 102:return"User-defined: {0}";case 103:return"Feature '{0}' is not enabled.";case 104:return"Low memory limit exceeded by static data: {0} > {1}";case 105:return"Module requires at least '{0}' pages of initial memory.";case 106:return"Module requires at least '{0}' pages of maximum memory.";case 107:return"Shared memory requires maximum memory to be defined.";case 108:return"Shared memory requires feature 'threads' to be enabled.";case 200:return"Conversion from type '{0}' to '{1}' requires an explicit cast.";case 201:return"Conversion from type '{0}' to '{1}' will require an explicit cast when switching between 32/64-bit.";case 202:return"Type '{0}' cannot be changed to type '{1}'.";case 203:return"Operation '{0}' cannot be applied to type '{1}'.";case 204:return"Type '{0}' cannot be nullable.";case 205:return"Cannot export a mutable global.";case 206:return"Mutable value cannot be inlined.";case 207:return"Unmanaged classes cannot extend managed classes and vice-versa.";case 208:return"Unmanaged classes cannot implement interfaces.";case 209:return"Invalid regular expression flags.";case 210:return"Expression is never 'null'.";case 211:return"Class '{0}' is final and cannot be extended.";case 212:return"Decorator '{0}' is not valid here.";case 213:return"Duplicate decorator.";case 214:return"Type '{0}' is illegal in this context.";case 215:return"Optional parameter must have an initializer.";case 216:return"Class '{0}' cannot declare a constructor when instantiated from an object literal.";case 217:return"Function '{0}' cannot be inlined into itself.";case 218:return"Cannot access method '{0}' without calling it as it requires 'this' to be set.";case 219:return"Optional properties are not supported.";case 220:return"Expression must be a compile-time constant.";case 221:return"Type '{0}' is not a function index or function reference.";case 222:return"'{0}' must be a value between '{1}' and '{2}' inclusive.";case 223:return"'{0}' must be a power of two.";case 224:return"'{0}' is not a valid operator.";case 225:return"Expression cannot be represented by a type.";case 226:return"Expression resolves to unusual type '{0}'.";case 227:return"Array literal expected.";case 228:return"Function '{0}' is virtual and will not be inlined.";case 229:return"Property '{0}' only has a setter and is missing a getter.";case 230:return"'{0}' keyword cannot be used here.";case 231:return"A class with a constructor explicitly returning something else than 'this' must be '@final'.";case 232:return"Exported generic function or class has no concrete instances.";case 233:return"Property '{0}' is always assigned before being used.";case 234:return"Expression refers to a static element that does not compile to a value at runtime.";case 901:return"Importing the table disables some indirect call optimizations.";case 902:return"Exporting the table disables some indirect call optimizations.";case 903:return"Expression compiles to a dynamic check at runtime.";case 904:return"Indexed access may involve bounds checking.";case 905:return"Explicitly returning constructor drops 'this' allocation.";case 906:return"Unnecessary definite assignment.";case 1002:return"Unterminated string literal.";case 1003:return"Identifier expected.";case 1005:return"'{0}' expected.";case 1006:return"A file cannot have a reference to itself.";case 1009:return"Trailing comma not allowed.";case 1012:return"Unexpected token.";case 1014:return"A rest parameter must be last in a parameter list.";case 1015:return"Parameter cannot have question mark and initializer.";case 1016:return"A required parameter cannot follow an optional parameter.";case 1036:return"Statements are not allowed in ambient contexts.";case 1039:return"Initializers are not allowed in ambient contexts.";case 1042:return"'{0}' modifier cannot be used here.";case 1047:return"A rest parameter cannot be optional.";case 1048:return"A rest parameter cannot have an initializer.";case 1049:return"A 'set' accessor must have exactly one parameter.";case 1052:return"A 'set' accessor parameter cannot have an initializer.";case 1054:return"A 'get' accessor cannot have parameters.";case 1061:return"Enum member must have initializer.";case 1092:return"Type parameters cannot appear on a constructor declaration.";case 1093:return"Type annotation cannot appear on a constructor declaration.";case 1094:return"An accessor cannot have type parameters.";case 1095:return"A 'set' accessor cannot have a return type annotation.";case 1098:return"Type parameter list cannot be empty.";case 1099:return"Type argument list cannot be empty.";case 1104:return"A 'continue' statement can only be used within an enclosing iteration statement.";case 1105:return"A 'break' statement can only be used within an enclosing iteration or switch statement.";case 1108:return"A 'return' statement can only be used within a function body.";case 1109:return"Expression expected.";case 1110:return"Type expected.";case 1113:return"A 'default' clause cannot appear more than once in a 'switch' statement.";case 1114:return"Duplicate label '{0}'.";case 1120:return"An export assignment cannot have modifiers.";case 1121:return"Octal literals are not allowed in strict mode.";case 1124:return"Digit expected.";case 1125:return"Hexadecimal digit expected.";case 1126:return"Unexpected end of text.";case 1127:return"Invalid character.";case 1130:return"'case' or 'default' expected.";case 1034:return"'super' must be followed by an argument list or member access.";case 1038:return"A 'declare' modifier cannot be used in an already ambient context.";case 1140:return"Type argument expected.";case 1141:return"String literal expected.";case 1142:return"Line break not permitted here.";case 1146:return"Declaration expected.";case 1155:return"'const' declarations must be initialized.";case 1161:return"Unterminated regular expression literal.";case 1176:return"Interface declaration cannot have 'implements' clause.";case 1177:return"Binary digit expected.";case 1178:return"Octal digit expected.";case 1183:return"An implementation cannot be declared in ambient contexts.";case 1190:return"The variable declaration of a 'for...of' statement cannot have an initializer.";case 1198:return"An extended Unicode escape value must be between 0x0 and 0x10FFFF inclusive.";case 1199:return"Unterminated Unicode escape sequence.";case 1206:return"Decorators are not valid here.";case 1242:return"'abstract' modifier can only appear on a class, method, or property declaration.";case 1245:return"Method '{0}' cannot have an implementation because it is marked abstract.";case 1255:return"A definite assignment assertion '!' is not permitted in this context.";case 1311:return"A class may only extend another class.";case 1317:return"A parameter property cannot be declared using a rest parameter.";case 1351:return"An identifier or keyword cannot immediately follow a numeric literal.";case 2300:return"Duplicate identifier '{0}'.";case 2304:return"Cannot find name '{0}'.";case 2305:return"Module '{0}' has no exported member '{1}'.";case 2312:return"An interface can only extend an interface.";case 2314:return"Generic type '{0}' requires {1} type argument(s).";case 2315:return"Type '{0}' is not generic.";case 2322:return"Type '{0}' is not assignable to type '{1}'.";case 2329:return"Index signature is missing in type '{0}'.";case 2332:return"'this' cannot be referenced in current location.";case 2335:return"'super' can only be referenced in a derived class.";case 2337:return"Super calls are not permitted outside constructors or in nested functions inside constructors.";case 2339:return"Property '{0}' does not exist on type '{1}'.";case 2341:return"Property '{0}' is private and only accessible within class '{1}'.";case 2349:return"Cannot invoke an expression whose type lacks a call signature. Type '{0}' has no compatible call signatures.";case 2351:return"This expression is not constructable.";case 2355:return"A function whose declared type is not 'void' must return a value.";case 2357:return"The operand of an increment or decrement operator must be a variable or a property access.";case 2364:return"The left-hand side of an assignment expression must be a variable or a property access.";case 2365:return"Operator '{0}' cannot be applied to types '{1}' and '{2}'.";case 2376:return"A 'super' call must be the first statement in the constructor.";case 2377:return"Constructors for derived classes must contain a 'super' call.";case 2379:return"Getter and setter accessors do not agree in visibility.";case 2380:return"'get' and 'set' accessor must have the same type.";case 2385:return"Overload signatures must all be public, private or protected.";case 2390:return"Constructor implementation is missing.";case 2391:return"Function implementation is missing or not immediately following the declaration.";case 2392:return"Multiple constructor implementations are not allowed.";case 2393:return"Duplicate function implementation.";case 2394:return"This overload signature is not compatible with its implementation signature.";case 2395:return"Individual declarations in merged declaration '{0}' must be all exported or all local.";case 2422:return"A class can only implement an interface.";case 2434:return"A namespace declaration cannot be located prior to a class or function with which it is merged.";case 2445:return"Property '{0}' is protected and only accessible within class '{1}' and its subclasses.";case 2448:return"Variable '{0}' used before its declaration.";case 2453:return"The type argument for type parameter '{0}' cannot be inferred from the usage. Consider specifying the type arguments explicitly.";case 2460:return"Type '{0}' has no property '{1}'.";case 2469:return"The '{0}' operator cannot be applied to type '{1}'.";case 2474:return"In 'const' enum declarations member initializer must be constant expression.";case 2484:return"Export declaration conflicts with exported declaration of '{0}'.";case 2506:return"'{0}' is referenced directly or indirectly in its own base expression.";case 2511:return"Cannot create an instance of an abstract class.";case 2515:return"Non-abstract class '{0}' does not implement inherited abstract member '{1}' from '{2}'.";case 2531:return"Object is possibly 'null'.";case 2540:return"Cannot assign to '{0}' because it is a constant or a read-only property.";case 2541:return"The target of an assignment must be a variable or a property access.";case 2542:return"Index signature in type '{0}' only permits reading.";case 2554:return"Expected {0} arguments, but got {1}.";case 2555:return"Expected at least {0} arguments, but got {1}.";case 2558:return"Expected {0} type arguments, but got {1}.";case 2564:return"Property '{0}' has no initializer and is not assigned in the constructor before 'this' is used or returned.";case 2565:return"Property '{0}' is used before being assigned.";case 2651:return"A member initializer in a enum declaration cannot reference members declared after it, including members defined in other enums.";case 2673:return"Constructor of class '{0}' is private and only accessible within the class declaration.";case 2674:return"Constructor of class '{0}' is protected and only accessible within the class declaration.";case 2685:return"The 'this' types of each signature are incompatible.";case 2694:return"Namespace '{0}' has no exported member '{1}'.";case 2706:return"Required type parameters may not follow optional type parameters.";case 2718:return"Duplicate property '{0}'.";case 2741:return"Property '{0}' is missing in type '{1}' but required in type '{2}'.";case 2757:return"Type '{0}' has no call signatures.";case 6054:return"File '{0}' not found.";case 6188:return"Numeric separators are not allowed here.";case 6189:return"Multiple consecutive numeric separators are not permitted.";case 17009:return"'super' must be called before accessing 'this' in the constructor of a derived class.";case 17011:return"'super' must be called before accessing a property of 'super' in the constructor of a derived class.";default:return""}}},256:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticEmitter=t.formatDiagnosticMessage=t.DiagnosticMessage=t.diagnosticCategoryToColor=t.diagnosticCategoryToString=t.DiagnosticCategory=t.diagnosticCodeToString=t.DiagnosticCode=void 0;const i=r(252),n=r(910);var s,a=r(252);function o(e){switch(e){case s.PEDANTIC:return"PEDANTIC";case s.INFO:return"INFO";case s.WARNING:return"WARNING";case s.ERROR:return"ERROR";default:return assert(!1),""}}function l(e){switch(e){case s.PEDANTIC:return n.COLOR_MAGENTA;case s.INFO:return n.COLOR_CYAN;case s.WARNING:return n.COLOR_YELLOW;case s.ERROR:return n.COLOR_RED;default:return assert(!1),""}}Object.defineProperty(t,"DiagnosticCode",{enumerable:!0,get:function(){return a.DiagnosticCode}}),Object.defineProperty(t,"diagnosticCodeToString",{enumerable:!0,get:function(){return a.diagnosticCodeToString}}),function(e){e[e.PEDANTIC=0]="PEDANTIC",e[e.INFO=1]="INFO",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR"}(s=t.DiagnosticCategory||(t.DiagnosticCategory={})),t.diagnosticCategoryToString=o,t.diagnosticCategoryToColor=l;class u{constructor(e,t,r){this.range=null,this.relatedRange=null,this.code=e,this.category=t,this.message=r}static create(e,t,r=null,n=null,s=null){var a=i.diagnosticCodeToString(e);return null!==r&&(a=a.replace("{0}",r)),null!==n&&(a=a.replace("{1}",n)),null!==s&&(a=a.replace("{2}",s)),new u(e,t,a)}equals(e){if(this.code!=e.code)return!1;var t=this.range,r=e.range;if(t){if(!r||!t.equals(r))return!1}else if(r)return!1;var i=this.relatedRange,n=e.relatedRange;if(i){if(!n||!i.equals(n))return!1}else if(r)return!1;return this.message==e.message}withRange(e){return this.range=e,this}withRelatedRange(e){return this.relatedRange=e,this}toString(){var e=this.range;if(e){let t=e.source;return o(this.category)+" "+this.code.toString()+': "'+this.message+'" in '+t.normalizedPath+"("+t.lineAt(e.start).toString()+","+t.columnAt().toString()+"+"+(e.end-e.start).toString()+")"}return o(this.category)+" "+this.code.toString()+": "+this.message}}function c(e){for(var t=e.source.text,r=t.length,i=e.start,s=e.end;i>0&&!n.isLineBreak(t.charCodeAt(i-1));)i--;for(;s<r&&!n.isLineBreak(t.charCodeAt(s));)s++;for(var a=["\n ",t.substring(i,s),"\n "];i<e.start;)a.push(" "),i++;if(n.isColorsEnabled()&&a.push(n.COLOR_RED),e.start==e.end)a.push("^");else for(;i++<e.end;){if(n.isLineBreak(t.charCodeAt(i))){a.push(i==e.start+1?"^":"~");break}a.push("~")}return n.isColorsEnabled()&&a.push(n.COLOR_RESET),a.join("")}t.DiagnosticMessage=u,t.formatDiagnosticMessage=function(e,t=!1,r=!1){var i=n.setColorsEnabled(t),s=[];n.isColorsEnabled()&&s.push(l(e.category)),s.push(o(e.category)),n.isColorsEnabled()&&s.push(n.COLOR_RESET),s.push(e.code<1e3?" AS":" TS"),s.push(e.code.toString()),s.push(": "),s.push(e.message);var a=e.range;if(a){let t=a.source;r&&(s.push("\n"),s.push(c(a))),s.push("\n"),s.push(" in "),s.push(t.normalizedPath),s.push("("),s.push(t.lineAt(a.start).toString()),s.push(","),s.push(t.columnAt().toString()),s.push(")");let i=e.relatedRange;if(i){let e=i.source;r&&(s.push("\n"),s.push(c(i))),s.push("\n"),s.push(" in "),s.push(e.normalizedPath),s.push("("),s.push(e.lineAt(i.start).toString()),s.push(","),s.push(e.columnAt().toString()),s.push(")")}}return n.setColorsEnabled(i),s.join("")};t.DiagnosticEmitter=class{constructor(e=null){this.seen=new Map,e||(e=[]),this.diagnostics=e}emitDiagnostic(e,t,r,i,n=null,s=null,a=null){var o=u.create(e,t,n,s,a);if(r&&(o=o.withRange(r)),i&&(o.relatedRange=i),r){let e=this.seen;if(e.has(r.source)){let t=assert(e.get(r.source));if(t.has(r.start)){let e=assert(t.get(r.start));for(let t=0,r=e.length;t<r;++t)if(e[t].equals(o))return;e.push(o)}else t.set(r.start,[o])}else{let t=new Map;t.set(r.start,[o]),e.set(r.source,t)}}this.diagnostics.push(o)}pedantic(e,t,r=null,i=null,n=null){this.emitDiagnostic(e,s.PEDANTIC,t,null,r,i,n)}pedanticRelated(e,t,r,i=null,n=null,a=null){this.emitDiagnostic(e,s.PEDANTIC,t,r,i,n,a)}info(e,t,r=null,i=null,n=null){this.emitDiagnostic(e,s.INFO,t,null,r,i,n)}infoRelated(e,t,r,i=null,n=null,a=null){this.emitDiagnostic(e,s.INFO,t,r,i,n,a)}warning(e,t,r=null,i=null,n=null){this.emitDiagnostic(e,s.WARNING,t,null,r,i,n)}warningRelated(e,t,r,i=null,n=null,a=null){this.emitDiagnostic(e,s.WARNING,t,r,i,n,a)}error(e,t,r=null,i=null,n=null){this.emitDiagnostic(e,s.ERROR,t,null,r,i,n)}errorRelated(e,t,r,i=null,n=null,a=null){this.emitDiagnostic(e,s.ERROR,t,r,i,n,a)}}},393:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ASTBuilder=void 0;const i=r(60),n=r(411),s=r(910),a=r(200);class o{constructor(){this.sb=[],this.indentLevel=0}static build(e){var t=new o;return t.visitNode(e),t.finish()}visitNode(e){switch(e.kind){case i.NodeKind.SOURCE:this.visitSource(e);break;case i.NodeKind.NAMEDTYPE:this.visitNamedTypeNode(e);break;case i.NodeKind.FUNCTIONTYPE:this.visitFunctionTypeNode(e);break;case i.NodeKind.TYPEPARAMETER:this.visitTypeParameter(e);break;case i.NodeKind.FALSE:case i.NodeKind.NULL:case i.NodeKind.SUPER:case i.NodeKind.THIS:case i.NodeKind.TRUE:case i.NodeKind.CONSTRUCTOR:case i.NodeKind.IDENTIFIER:this.visitIdentifierExpression(e);break;case i.NodeKind.ASSERTION:this.visitAssertionExpression(e);break;case i.NodeKind.BINARY:this.visitBinaryExpression(e);break;case i.NodeKind.CALL:this.visitCallExpression(e);break;case i.NodeKind.CLASS:this.visitClassExpression(e);break;case i.NodeKind.COMMA:this.visitCommaExpression(e);break;case i.NodeKind.ELEMENTACCESS:this.visitElementAccessExpression(e);break;case i.NodeKind.FUNCTION:this.visitFunctionExpression(e);break;case i.NodeKind.INSTANCEOF:this.visitInstanceOfExpression(e);break;case i.NodeKind.LITERAL:this.visitLiteralExpression(e);break;case i.NodeKind.NEW:this.visitNewExpression(e);break;case i.NodeKind.PARENTHESIZED:this.visitParenthesizedExpression(e);break;case i.NodeKind.PROPERTYACCESS:this.visitPropertyAccessExpression(e);break;case i.NodeKind.TERNARY:this.visitTernaryExpression(e);break;case i.NodeKind.UNARYPOSTFIX:this.visitUnaryPostfixExpression(e);break;case i.NodeKind.UNARYPREFIX:this.visitUnaryPrefixExpression(e);break;case i.NodeKind.BLOCK:this.visitBlockStatement(e);break;case i.NodeKind.BREAK:this.visitBreakStatement(e);break;case i.NodeKind.CONTINUE:this.visitContinueStatement(e);break;case i.NodeKind.DO:this.visitDoStatement(e);break;case i.NodeKind.EMPTY:this.visitEmptyStatement(e);break;case i.NodeKind.EXPORT:this.visitExportStatement(e);break;case i.NodeKind.EXPORTDEFAULT:this.visitExportDefaultStatement(e);break;case i.NodeKind.EXPORTIMPORT:this.visitExportImportStatement(e);break;case i.NodeKind.EXPRESSION:this.visitExpressionStatement(e);break;case i.NodeKind.FOR:this.visitForStatement(e);break;case i.NodeKind.FOROF:this.visitForOfStatement(e);break;case i.NodeKind.IF:this.visitIfStatement(e);break;case i.NodeKind.IMPORT:this.visitImportStatement(e);break;case i.NodeKind.RETURN:this.visitReturnStatement(e);break;case i.NodeKind.SWITCH:this.visitSwitchStatement(e);break;case i.NodeKind.THROW:this.visitThrowStatement(e);break;case i.NodeKind.TRY:this.visitTryStatement(e);break;case i.NodeKind.VARIABLE:this.visitVariableStatement(e);break;case i.NodeKind.WHILE:this.visitWhileStatement(e);break;case i.NodeKind.CLASSDECLARATION:this.visitClassDeclaration(e);break;case i.NodeKind.ENUMDECLARATION:this.visitEnumDeclaration(e);break;case i.NodeKind.ENUMVALUEDECLARATION:this.visitEnumValueDeclaration(e);break;case i.NodeKind.FIELDDECLARATION:this.visitFieldDeclaration(e);break;case i.NodeKind.FUNCTIONDECLARATION:this.visitFunctionDeclaration(e);break;case i.NodeKind.IMPORTDECLARATION:this.visitImportDeclaration(e);break;case i.NodeKind.INTERFACEDECLARATION:this.visitInterfaceDeclaration(e);break;case i.NodeKind.METHODDECLARATION:this.visitMethodDeclaration(e);break;case i.NodeKind.NAMESPACEDECLARATION:this.visitNamespaceDeclaration(e);break;case i.NodeKind.TYPEDECLARATION:this.visitTypeDeclaration(e);break;case i.NodeKind.VARIABLEDECLARATION:this.visitVariableDeclaration(e);break;case i.NodeKind.DECORATOR:this.serializeDecorator(e);break;case i.NodeKind.EXPORTMEMBER:this.visitExportMember(e);break;case i.NodeKind.PARAMETER:this.serializeParameter(e);break;case i.NodeKind.SWITCHCASE:this.visitSwitchCase(e);break;case i.NodeKind.INDEXSIGNATURE:this.visitIndexSignature(e);break;default:assert(!1)}}visitSource(e){var t=e.statements;for(let e=0,r=t.length;e<r;++e)this.visitNodeAndTerminate(t[e])}visitTypeNode(e){switch(e.kind){case i.NodeKind.NAMEDTYPE:this.visitNamedTypeNode(e);break;case i.NodeKind.FUNCTIONTYPE:this.visitFunctionTypeNode(e);break;default:assert(!1)}}visitTypeName(e){this.visitIdentifierExpression(e.identifier);for(var t=this.sb,r=e.next;r;)t.push("."),this.visitIdentifierExpression(r.identifier),r=r.next}visitNamedTypeNode(e){this.visitTypeName(e.name);var t=e.typeArguments;if(t){let r=t.length,i=this.sb;if(r){i.push("<"),this.visitTypeNode(t[0]);for(let e=1;e<r;++e)i.push(", "),this.visitTypeNode(t[e]);i.push(">")}e.isNullable&&i.push(" | null")}}visitFunctionTypeNode(e){var t=e.isNullable,r=this.sb;r.push(t?"((":"(");var i=e.explicitThisType;i&&(r.push("this: "),this.visitTypeNode(i));var n=e.parameters,s=n.length;if(s){i&&r.push(", "),this.serializeParameter(n[0]);for(let e=1;e<s;++e)r.push(", "),this.serializeParameter(n[e])}var a=e.returnType;a?(r.push(") => "),this.visitTypeNode(a)):r.push(") => void"),t&&r.push(") | null")}visitTypeParameter(e){this.visitIdentifierExpression(e.name);var t=e.extendsType;t&&(this.sb.push(" extends "),this.visitTypeNode(t));var r=e.defaultType;r&&(this.sb.push("="),this.visitTypeNode(r))}visitIdentifierExpression(e){e.isQuoted?this.visitStringLiteral(e.text):this.sb.push(e.text)}visitArrayLiteralExpression(e){var t=this.sb;t.push("[");var r=e.elementExpressions,i=r.length;if(i){let e=r[0];e&&this.visitNode(e);for(let n=1;n<i;++n)e=r[n],t.push(", "),e&&this.visitNode(e)}t.push("]")}visitObjectLiteralExpression(e){var t=this.sb,r=e.names,i=e.values,n=r.length;if(assert(n==i.length),n){t.push("{\n"),s.indent(t,++this.indentLevel),this.visitNode(r[0]),t.push(": "),this.visitNode(i[0]);for(let e=1;e<n;++e){t.push(",\n"),s.indent(t,this.indentLevel);let n=r[e],a=i[e];n===a?this.visitNode(n):(this.visitNode(n),t.push(": "),this.visitNode(a))}t.push("\n"),s.indent(t,--this.indentLevel),t.push("}")}else t.push("{}")}visitAssertionExpression(e){var t=this.sb;switch(e.assertionKind){case i.AssertionKind.PREFIX:t.push("<"),this.visitTypeNode(assert(e.toType)),t.push(">"),this.visitNode(e.expression);break;case i.AssertionKind.AS:this.visitNode(e.expression),t.push(" as "),this.visitTypeNode(assert(e.toType));break;case i.AssertionKind.NONNULL:this.visitNode(e.expression),t.push("!");break;case i.AssertionKind.CONST:this.visitNode(e.expression),t.push(" as const");break;default:assert(!1)}}visitBinaryExpression(e){var t=this.sb;this.visitNode(e.left),t.push(" "),t.push(n.operatorTokenToString(e.operator)),t.push(" "),this.visitNode(e.right)}visitCallExpression(e){this.visitNode(e.expression),this.visitArguments(e.typeArguments,e.args)}visitArguments(e,t){var r=this.sb;if(e){let t=e.length;if(t){r.push("<"),this.visitTypeNode(e[0]);for(let i=1;i<t;++i)r.push(", "),this.visitTypeNode(e[i]);r.push(">(")}}else r.push("(");var i=t.length;if(i){this.visitNode(t[0]);for(let e=1;e<i;++e)r.push(", "),this.visitNode(t[e])}r.push(")")}visitClassExpression(e){var t=e.declaration;this.visitClassDeclaration(t)}visitCommaExpression(e){var t=e.expressions,r=assert(t.length);this.visitNode(t[0]);var i=this.sb;for(let e=1;e<r;++e)i.push(","),this.visitNode(t[e])}visitElementAccessExpression(e){var t=this.sb;this.visitNode(e.expression),t.push("["),this.visitNode(e.elementExpression),t.push("]")}visitFunctionExpression(e){var t=e.declaration;t.arrowKind?assert(0==t.name.text.length):t.name.text.length?this.sb.push("function "):this.sb.push("function"),this.visitFunctionCommon(t)}visitLiteralExpression(e){switch(e.literalKind){case i.LiteralKind.FLOAT:this.visitFloatLiteralExpression(e);break;case i.LiteralKind.INTEGER:this.visitIntegerLiteralExpression(e);break;case i.LiteralKind.STRING:this.visitStringLiteralExpression(e);break;case i.LiteralKind.TEMPLATE:this.visitTemplateLiteralExpression(e);break;case i.LiteralKind.REGEXP:this.visitRegexpLiteralExpression(e);break;case i.LiteralKind.ARRAY:this.visitArrayLiteralExpression(e);break;case i.LiteralKind.OBJECT:this.visitObjectLiteralExpression(e);break;default:assert(!1)}}visitFloatLiteralExpression(e){this.sb.push(e.value.toString())}visitInstanceOfExpression(e){this.visitNode(e.expression),this.sb.push(" instanceof "),this.visitTypeNode(e.isType)}visitIntegerLiteralExpression(e){this.sb.push(i64_to_string(e.value))}visitStringLiteral(e){var t=this.sb;t.push('"'),this.visitRawString(e,34),t.push('"')}visitRawString(e,t){var r=this.sb,i=0,n=0;for(let s=e.length;n<s;)switch(e.charCodeAt(n)){case 0:n>i&&r.push(e.substring(i,i=n+1)),r.push("\\0"),i=++n;break;case 8:n>i&&r.push(e.substring(i,n)),i=++n,r.push("\\b");break;case 9:n>i&&r.push(e.substring(i,n)),i=++n,r.push("\\t");break;case 10:n>i&&r.push(e.substring(i,n)),i=++n,r.push("\\n");break;case 11:n>i&&r.push(e.substring(i,n)),i=++n,r.push("\\v");break;case 12:n>i&&r.push(e.substring(i,n)),i=++n,r.push("\\f");break;case 13:n>i&&r.push(e.substring(i,n)),r.push("\\r"),i=++n;break;case 34:34==t?(n>i&&r.push(e.substring(i,n)),r.push('\\"'),i=++n):++n;break;case 39:39==t?(n>i&&r.push(e.substring(i,n)),r.push("\\'"),i=++n):++n;break;case 92:n>i&&r.push(e.substring(i,n)),r.push("\\\\"),i=++n;break;case 96:96==t?(n>i&&r.push(e.substring(i,n)),r.push("\\`"),i=++n):++n;break;default:++n}n>i&&r.push(e.substring(i,n))}visitStringLiteralExpression(e){this.visitStringLiteral(e.value)}visitTemplateLiteralExpression(e){var t=this.sb,r=e.tag,i=e.parts,n=e.expressions;r&&this.visitNode(r),t.push("`"),this.visitRawString(i[0],96),assert(i.length==n.length+1);for(let e=0,r=n.length;e<r;++e)t.push("${"),this.visitNode(n[e]),t.push("}"),this.visitRawString(i[e+1],96);t.push("`")}visitRegexpLiteralExpression(e){var t=this.sb;t.push("/"),t.push(e.pattern),t.push("/"),t.push(e.patternFlags)}visitNewExpression(e){this.sb.push("new "),this.visitTypeName(e.typeName),this.visitArguments(e.typeArguments,e.args)}visitParenthesizedExpression(e){var t=this.sb;t.push("("),this.visitNode(e.expression),t.push(")")}visitPropertyAccessExpression(e){this.visitNode(e.expression),this.sb.push("."),this.visitIdentifierExpression(e.property)}visitTernaryExpression(e){var t=this.sb;this.visitNode(e.condition),t.push(" ? "),this.visitNode(e.ifThen),t.push(" : "),this.visitNode(e.ifElse)}visitUnaryExpression(e){switch(e.kind){case i.NodeKind.UNARYPOSTFIX:this.visitUnaryPostfixExpression(e);break;case i.NodeKind.UNARYPREFIX:this.visitUnaryPrefixExpression(e);break;default:assert(!1)}}visitUnaryPostfixExpression(e){this.visitNode(e.operand),this.sb.push(n.operatorTokenToString(e.operator))}visitUnaryPrefixExpression(e){this.sb.push(n.operatorTokenToString(e.operator)),this.visitNode(e.operand)}visitNodeAndTerminate(e){this.visitNode(e);var t=this.sb;if(t.length&&e.kind!=i.NodeKind.VARIABLE&&e.kind!=i.NodeKind.EXPRESSION){let e=t[t.length-1],r=e.length-1;r>=0&&(125==e.charCodeAt(r)||59==e.charCodeAt(r))?t.push("\n"):t.push(";\n")}else t.push(";\n")}visitBlockStatement(e){var t=this.sb,r=e.statements,i=r.length;if(i){t.push("{\n");let e=++this.indentLevel;for(let n=0;n<i;++n)s.indent(t,e),this.visitNodeAndTerminate(r[n]);s.indent(t,--this.indentLevel),t.push("}")}else t.push("{}")}visitBreakStatement(e){var t=e.label;t?(this.sb.push("break "),this.visitIdentifierExpression(t)):this.sb.push("break")}visitContinueStatement(e){var t=e.label;t?(this.sb.push("continue "),this.visitIdentifierExpression(t)):this.sb.push("continue")}visitClassDeclaration(e,t=!1){var r=e.decorators;if(r)for(let e=0,t=r.length;e<t;++e)this.serializeDecorator(r[e]);var n=this.sb;t?n.push("export default "):this.serializeExternalModifiers(e),e.is(a.CommonFlags.ABSTRACT)&&n.push("abstract "),e.name.text.length?(n.push("class "),this.visitIdentifierExpression(e.name)):n.push("class");var o=e.typeParameters;if(null!=o&&o.length>0){n.push("<"),this.visitTypeParameter(o[0]);for(let e=1,t=o.length;e<t;++e)n.push(", "),this.visitTypeParameter(o[e]);n.push(">")}var l=e.extendsType;l&&(n.push(" extends "),this.visitTypeNode(l));var u=e.implementsTypes;if(u){let e=u.length;if(e){n.push(" implements "),this.visitTypeNode(u[0]);for(let t=1;t<e;++t)n.push(", "),this.visitTypeNode(u[t])}}var c=e.indexSignature,p=e.members,_=p.length;if(null!==c||_){n.push(" {\n");let e=++this.indentLevel;c&&(s.indent(n,e),this.visitNodeAndTerminate(c));for(let t=0,r=p.length;t<r;++t){let r=p[t];(r.kind!=i.NodeKind.FIELDDECLARATION||r.parameterIndex<0)&&(s.indent(n,e),this.visitNodeAndTerminate(r))}s.indent(n,--this.indentLevel),n.push("}")}else n.push(" {}")}visitDoStatement(e){var t=this.sb;t.push("do "),this.visitNode(e.statement),e.statement.kind==i.NodeKind.BLOCK?t.push(" while ("):(t.push(";\n"),s.indent(t,this.indentLevel),t.push("while (")),this.visitNode(e.condition),t.push(")")}visitEmptyStatement(e){}visitEnumDeclaration(e,t=!1){var r=this.sb;t?r.push("export default "):this.serializeExternalModifiers(e),e.is(a.CommonFlags.CONST)&&r.push("const "),r.push("enum "),this.visitIdentifierExpression(e.name);var i=e.values.length;if(i){r.push(" {\n");let t=++this.indentLevel;s.indent(r,t),this.visitEnumValueDeclaration(e.values[0]);for(let n=1;n<i;++n)r.push(",\n"),s.indent(r,t),this.visitEnumValueDeclaration(e.values[n]);r.push("\n"),s.indent(r,--this.indentLevel),r.push("}")}else r.push(" {}")}visitEnumValueDeclaration(e){this.visitIdentifierExpression(e.name);var t=e.initializer;t&&(this.sb.push(" = "),this.visitNode(t))}visitExportImportStatement(e){var t=this.sb;t.push("export import "),this.visitIdentifierExpression(e.externalName),t.push(" = "),this.visitIdentifierExpression(e.name)}visitExportMember(e){this.visitIdentifierExpression(e.localName),e.exportedName.text!=e.localName.text&&(this.sb.push(" as "),this.visitIdentifierExpression(e.exportedName))}visitExportStatement(e){var t=this.sb;e.isDeclare&&t.push("declare ");var r=e.members;if(null!=r&&r.length>0){let e=r.length;t.push("export {\n");let i=++this.indentLevel;s.indent(t,i),this.visitExportMember(r[0]);for(let n=1;n<e;++n)t.push(",\n"),s.indent(t,i),this.visitExportMember(r[n]);--this.indentLevel,t.push("\n}")}else t.push("export {}");var i=e.path;i&&(t.push(" from "),this.visitStringLiteralExpression(i)),t.push(";")}visitExportDefaultStatement(e){var t=e.declaration;switch(t.kind){case i.NodeKind.ENUMDECLARATION:this.visitEnumDeclaration(t,!0);break;case i.NodeKind.FUNCTIONDECLARATION:this.visitFunctionDeclaration(t,!0);break;case i.NodeKind.CLASSDECLARATION:this.visitClassDeclaration(t,!0);break;case i.NodeKind.INTERFACEDECLARATION:this.visitInterfaceDeclaration(t,!0);break;case i.NodeKind.NAMESPACEDECLARATION:this.visitNamespaceDeclaration(t,!0);break;default:assert(!1)}}visitExpressionStatement(e){this.visitNode(e.expression)}visitFieldDeclaration(e){var t=e.decorators;if(t)for(let e=0,r=t.length;e<r;++e)this.serializeDecorator(t[e]);this.serializeAccessModifiers(e),this.visitIdentifierExpression(e.name);var r=this.sb;e.flags&a.CommonFlags.DEFINITELY_ASSIGNED&&r.push("!");var i=e.type;i&&(r.push(": "),this.visitTypeNode(i));var n=e.initializer;n&&(r.push(" = "),this.visitNode(n))}visitForStatement(e){var t=this.sb;t.push("for (");var r=e.initializer;r&&this.visitNode(r);var i=e.condition;i?(t.push("; "),this.visitNode(i)):t.push(";");var n=e.incrementor;n?(t.push("; "),this.visitNode(n)):t.push(";"),t.push(") "),this.visitNode(e.statement)}visitForOfStatement(e){var t=this.sb;t.push("for ("),this.visitNode(e.variable),t.push(" of "),this.visitNode(e.iterable),t.push(") "),this.visitNode(e.statement)}visitFunctionDeclaration(e,t=!1){var r=this.sb,i=e.decorators;if(i)for(let e=0,t=i.length;e<t;++e)this.serializeDecorator(i[e]);t?r.push("export default "):(this.serializeExternalModifiers(e),this.serializeAccessModifiers(e)),e.name.text.length?r.push("function "):r.push("function"),this.visitFunctionCommon(e)}visitFunctionCommon(e){var t=this.sb;this.visitIdentifierExpression(e.name);var r=e.signature,n=e.typeParameters;if(n){let e=n.length;if(e){t.push("<"),this.visitTypeParameter(n[0]);for(let r=1;r<e;++r)t.push(", "),this.visitTypeParameter(n[r]);t.push(">")}}if(2==e.arrowKind){let e=r.parameters;assert(1==e.length),assert(!r.explicitThisType),this.serializeParameter(e[0])}else{t.push("(");let e=r.parameters,i=e.length,n=r.explicitThisType;if(n&&(t.push("this: "),this.visitTypeNode(n)),i){n&&t.push(", "),this.serializeParameter(e[0]);for(let r=1;r<i;++r)t.push(", "),this.serializeParameter(e[r])}}var s=e.body,o=r.returnType;e.arrowKind?s?(2==e.arrowKind?assert(i.isTypeOmitted(o)):i.isTypeOmitted(o)?t.push(")"):(t.push("): "),this.visitTypeNode(o)),t.push(" => "),this.visitNode(s)):(assert(!i.isTypeOmitted(o)),t.push(" => "),this.visitTypeNode(o)):(i.isTypeOmitted(o)||e.isAny(a.CommonFlags.CONSTRUCTOR|a.CommonFlags.SET)?t.push(")"):(t.push("): "),this.visitTypeNode(o)),s&&(t.push(" "),this.visitNode(s)))}visitIfStatement(e){var t=this.sb;t.push("if ("),this.visitNode(e.condition),t.push(") ");var r=e.ifTrue;this.visitNode(r),r.kind!=i.NodeKind.BLOCK&&t.push(";\n");var n=e.ifFalse;n&&(r.kind==i.NodeKind.BLOCK?t.push(" else "):t.push("else "),this.visitNode(n))}visitImportDeclaration(e){var t=e.foreignName,r=e.name;this.visitIdentifierExpression(t),t.text!=r.text&&(this.sb.push(" as "),this.visitIdentifierExpression(r))}visitImportStatement(e){var t=this.sb;t.push("import ");var r=e.declarations,i=e.namespaceName;if(r){let e=r.length;if(e){t.push("{\n");let i=++this.indentLevel;s.indent(t,i),this.visitImportDeclaration(r[0]);for(let n=1;n<e;++n)t.push(",\n"),s.indent(t,i),this.visitImportDeclaration(r[n]);--this.indentLevel,t.push("\n} from ")}else t.push("{} from ")}else i&&(t.push("* as "),this.visitIdentifierExpression(i),t.push(" from "));this.visitStringLiteralExpression(e.path)}visitIndexSignature(e){var t=this.sb;t.push("[key: "),this.visitTypeNode(e.keyType),t.push("]: "),this.visitTypeNode(e.valueType)}visitInterfaceDeclaration(e,t=!1){var r=e.decorators;if(r)for(let e=0,t=r.length;e<t;++e)this.serializeDecorator(r[e]);var i=this.sb;t?i.push("export default "):this.serializeExternalModifiers(e),i.push("interface "),this.visitIdentifierExpression(e.name);var n=e.typeParameters;if(null!=n&&n.length>0){i.push("<"),this.visitTypeParameter(n[0]);for(let e=1,t=n.length;e<t;++e)i.push(", "),this.visitTypeParameter(n[e]);i.push(">")}var a=e.extendsType;a&&(i.push(" extends "),this.visitTypeNode(a)),i.push(" {\n");var o=++this.indentLevel,l=e.members;for(let e=0,t=l.length;e<t;++e)s.indent(i,o),this.visitNodeAndTerminate(l[e]);--this.indentLevel,i.push("}")}visitMethodDeclaration(e){var t=e.decorators;if(t)for(let e=0,r=t.length;e<r;++e)this.serializeDecorator(t[e]);this.serializeAccessModifiers(e),e.is(a.CommonFlags.GET)?this.sb.push("get "):e.is(a.CommonFlags.SET)&&this.sb.push("set "),this.visitFunctionCommon(e)}visitNamespaceDeclaration(e,t=!1){var r=e.decorators;if(r)for(let e=0,t=r.length;e<t;++e)this.serializeDecorator(r[e]);var i=this.sb;t?i.push("export default "):this.serializeExternalModifiers(e),i.push("namespace "),this.visitIdentifierExpression(e.name);var n=e.members;if(n.length){i.push(" {\n");let e=++this.indentLevel;for(let t=0,r=n.length;t<r;++t)s.indent(i,e),this.visitNodeAndTerminate(n[t]);s.indent(i,--this.indentLevel),i.push("}")}else i.push(" {}")}visitReturnStatement(e){var t=e.value;t?(this.sb.push("return "),this.visitNode(t)):this.sb.push("return")}visitSwitchCase(e){var t=this.sb,r=e.label;r?(t.push("case "),this.visitNode(r),t.push(":\n")):t.push("default:\n");var i=e.statements,n=i.length;if(n){let e=++this.indentLevel;s.indent(t,e),this.visitNodeAndTerminate(i[0]);for(let r=1;r<n;++r)s.indent(t,e),this.visitNodeAndTerminate(i[r]);--this.indentLevel}}visitSwitchStatement(e){var t=this.sb;t.push("switch ("),this.visitNode(e.condition),t.push(") {\n");var r=++this.indentLevel,i=e.cases;for(let e=0,n=i.length;e<n;++e)s.indent(t,r),this.visitSwitchCase(i[e]),t.push("\n");--this.indentLevel,t.push("}")}visitThrowStatement(e){this.sb.push("throw "),this.visitNode(e.value)}visitTryStatement(e){var t=this.sb;t.push("try {\n");var r=++this.indentLevel,i=e.statements;for(let e=0,n=i.length;e<n;++e)s.indent(t,r),this.visitNodeAndTerminate(i[e]);var n=e.catchVariable;if(n){s.indent(t,r-1),t.push("} catch ("),this.visitIdentifierExpression(n),t.push(") {\n");let i=e.catchStatements;if(i)for(let e=0,n=i.length;e<n;++e)s.indent(t,r),this.visitNodeAndTerminate(i[e])}var a=e.finallyStatements;if(a){s.indent(t,r-1),t.push("} finally {\n");for(let e=0,i=a.length;e<i;++e)s.indent(t,r),this.visitNodeAndTerminate(a[e])}s.indent(t,r-1),t.push("}")}visitTypeDeclaration(e){var t=e.decorators;if(t)for(let e=0,r=t.length;e<r;++e)this.serializeDecorator(t[e]);var r=this.sb;this.serializeExternalModifiers(e),r.push("type "),this.visitIdentifierExpression(e.name);var i=e.typeParameters;if(i){let e=i.length;if(e){r.push("<");for(let t=0;t<e;++t)this.visitTypeParameter(i[t]);r.push(">")}}r.push(" = "),this.visitTypeNode(e.type)}visitVariableDeclaration(e){this.visitIdentifierExpression(e.name);var t=e.type,r=this.sb;e.flags&a.CommonFlags.DEFINITELY_ASSIGNED&&r.push("!"),t&&(r.push(": "),this.visitTypeNode(t));var i=e.initializer;i&&(r.push(" = "),this.visitNode(i))}visitVariableStatement(e){var t=e.decorators;if(t)for(let e=0,r=t.length;e<r;++e)this.serializeDecorator(t[e]);var r=this.sb,i=e.declarations,n=assert(i.length),s=i[0];this.serializeExternalModifiers(s),r.push(s.is(a.CommonFlags.CONST)?"const ":s.is(a.CommonFlags.LET)?"let ":"var "),this.visitVariableDeclaration(e.declarations[0]);for(let t=1;t<n;++t)r.push(", "),this.visitVariableDeclaration(e.declarations[t])}visitWhileStatement(e){var t=this.sb;t.push("while ("),this.visitNode(e.condition),e.statement.kind==i.NodeKind.EMPTY?t.push(")"):(t.push(") "),this.visitNode(e.statement))}serializeDecorator(e){var t=this.sb;t.push("@"),this.visitNode(e.name);var r=e.args;if(r){t.push("(");let e=r.length;if(e){this.visitNode(r[0]);for(let i=1;i<e;++i)t.push(", "),this.visitNode(r[i])}t.push(")\n")}else t.push("\n");s.indent(t,this.indentLevel)}serializeParameter(e){var t=this.sb,r=e.parameterKind,n=e.implicitFieldDeclaration;n&&this.serializeAccessModifiers(n),r==i.ParameterKind.REST&&t.push("..."),this.visitIdentifierExpression(e.name);var s=e.type,a=e.initializer;s&&(r!=i.ParameterKind.OPTIONAL||a||t.push("?"),i.isTypeOmitted(s)||(t.push(": "),this.visitTypeNode(s))),a&&(t.push(" = "),this.visitNode(a))}serializeExternalModifiers(e){var t=this.sb;e.is(a.CommonFlags.EXPORT)?t.push("export "):e.is(a.CommonFlags.IMPORT)?t.push("import "):e.is(a.CommonFlags.DECLARE)&&t.push("declare ")}serializeAccessModifiers(e){var t=this.sb;e.is(a.CommonFlags.PUBLIC)?t.push("public "):e.is(a.CommonFlags.PRIVATE)?t.push("private "):e.is(a.CommonFlags.PROTECTED)&&t.push("protected "),e.is(a.CommonFlags.STATIC)?t.push("static "):e.is(a.CommonFlags.ABSTRACT)&&t.push("abstract "),e.is(a.CommonFlags.READONLY)&&t.push("readonly ")}finish(){var e=this.sb.join("");return this.sb=[],e}}t.ASTBuilder=o},154:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findUsedLocals=t.Flow=t.ConditionKind=t.FieldFlags=t.LocalFlags=t.FlowFlags=void 0;const i=r(699),n=r(974),s=r(656),a=r(200),o=r(256),l=r(910);var u,c;!function(e){e[e.NONE=0]="NONE",e[e.RETURNS=1]="RETURNS",e[e.RETURNS_WRAPPED=2]="RETURNS_WRAPPED",e[e.RETURNS_NONNULL=4]="RETURNS_NONNULL",e[e.THROWS=8]="THROWS",e[e.BREAKS=16]="BREAKS",e[e.CONTINUES=32]="CONTINUES",e[e.ACCESSES_THIS=64]="ACCESSES_THIS",e[e.CALLS_SUPER=128]="CALLS_SUPER",e[e.TERMINATES=256]="TERMINATES",e[e.CONDITIONALLY_RETURNS=512]="CONDITIONALLY_RETURNS",e[e.CONDITIONALLY_THROWS=1024]="CONDITIONALLY_THROWS",e[e.CONDITIONALLY_BREAKS=2048]="CONDITIONALLY_BREAKS",e[e.CONDITIONALLY_CONTINUES=4096]="CONDITIONALLY_CONTINUES",e[e.CONDITIONALLY_ACCESSES_THIS=8192]="CONDITIONALLY_ACCESSES_THIS",e[e.MAY_RETURN_NONTHIS=16384]="MAY_RETURN_NONTHIS",e[e.UNCHECKED_CONTEXT=32768]="UNCHECKED_CONTEXT",e[e.ANY_CATEGORICAL=511]="ANY_CATEGORICAL",e[e.ANY_CONDITIONAL=15872]="ANY_CONDITIONAL"}(t.FlowFlags||(t.FlowFlags={})),function(e){e[e.NONE=0]="NONE",e[e.CONSTANT=1]="CONSTANT",e[e.WRAPPED=2]="WRAPPED",e[e.NONNULL=4]="NONNULL",e[e.INITIALIZED=8]="INITIALIZED"}(u=t.LocalFlags||(t.LocalFlags={})),function(e){e[e.NONE=0]="NONE",e[e.INITIALIZED=1]="INITIALIZED"}(c=t.FieldFlags||(t.FieldFlags={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.TRUE=1]="TRUE",e[e.FALSE=2]="FALSE"}(t.ConditionKind||(t.ConditionKind={}));class p{constructor(e){this.parentFunction=e,this.parent=null,this.outer=null,this.flags=0,this.continueLabel=null,this.breakLabel=null,this.scopedLocals=null,this.localFlags=[],this.thisFieldFlags=null,this.inlineFunction=null,this.inlineReturnLabel=null}static createParent(e){var t=new p(e);return e.is(a.CommonFlags.CONSTRUCTOR)&&t.initThisFieldFlags(),t}static createInline(e,t){var r=new p(e);return r.inlineFunction=t,r.inlineReturnLabel=t.internalName+"|inlined."+(t.nextInlineId++).toString(),t.is(a.CommonFlags.CONSTRUCTOR)&&r.initThisFieldFlags(),r}get isInline(){return null!==this.inlineFunction}get actualFunction(){var e=this.inlineFunction;return e||this.parentFunction}get returnType(){return this.actualFunction.signature.returnType}get contextualTypeArguments(){return this.actualFunction.contextualTypeArguments}is(e){return(this.flags&e)==e}isAny(e){return 0!=(this.flags&e)}set(e){this.flags|=e}unset(e){this.flags&=~e}fork(e=!1){var t=new p(this.parentFunction);if(t.parent=this,t.outer=this.outer,e?t.flags=-6193&this.flags:(t.flags=this.flags,t.continueLabel=this.continueLabel,t.breakLabel=this.breakLabel),t.localFlags=this.localFlags.slice(),this.actualFunction.is(a.CommonFlags.CONSTRUCTOR)){let e=assert(this.thisFieldFlags);t.thisFieldFlags=l.uniqueMap(e)}else assert(!this.thisFieldFlags);return t.inlineFunction=this.inlineFunction,t.inlineReturnLabel=this.inlineReturnLabel,t}getTempLocal(e,t=null){var r,i,n=this.parentFunction;switch(e.toNativeType()){case s.NativeType.I32:r=n.tempI32s;break;case s.NativeType.I64:r=n.tempI64s;break;case s.NativeType.F32:r=n.tempF32s;break;case s.NativeType.F64:r=n.tempF64s;break;case s.NativeType.V128:r=n.tempV128s;break;case s.NativeType.Funcref:r=n.tempFuncrefs;break;case s.NativeType.Externref:r=n.tempExternrefs;break;case s.NativeType.Anyref:r=n.tempAnyrefs;break;case s.NativeType.Eqref:r=n.tempEqrefs;break;case s.NativeType.I31ref:r=n.tempI31refs;break;case s.NativeType.Dataref:r=n.tempDatarefs;break;default:throw new Error("concrete type expected")}if(t){if(null!==r&&r.length>0)for(let n=0,s=r.length;n<s;++n)if(!t.has(r[n].index)){i=r[n];let t=r.length-1;for(;n<t;)unchecked(r[n]=r[1+n++]);return r.length=t,i.type=e,i.flags=a.CommonFlags.NONE,this.unsetLocalFlag(i.index,-1),i}i=n.addLocal(e)}else null!==r&&r.length>0?((i=assert(r.pop())).type=e,i.flags=a.CommonFlags.NONE):i=n.addLocal(e);return this.unsetLocalFlag(i.index,-1),i}freeTempLocal(e){if(!e.is(a.CommonFlags.INLINED)){assert(e.index>=0);var t,r=this.parentFunction;switch(assert(null!=e.type),e.resetTemporaryName(),e.type.toNativeType()){case s.NativeType.I32:{let e=r.tempI32s;e?t=e:r.tempI32s=t=[];break}case s.NativeType.I64:{let e=r.tempI64s;e?t=e:r.tempI64s=t=[];break}case s.NativeType.F32:{let e=r.tempF32s;e?t=e:r.tempF32s=t=[];break}case s.NativeType.F64:{let e=r.tempF64s;e?t=e:r.tempF64s=t=[];break}case s.NativeType.V128:{let e=r.tempV128s;e?t=e:r.tempV128s=t=[];break}case s.NativeType.Funcref:{let e=r.tempFuncrefs;e?t=e:r.tempFuncrefs=t=[];break}case s.NativeType.Externref:{let e=r.tempExternrefs;e?t=e:r.tempExternrefs=t=[];break}case s.NativeType.Anyref:{let e=r.tempAnyrefs;e?t=e:r.tempAnyrefs=t=[];break}case s.NativeType.Eqref:{let e=r.tempEqrefs;e?t=e:r.tempEqrefs=t=[];break}case s.NativeType.I31ref:{let e=r.tempI31refs;e?t=e:r.tempI31refs=t=[];break}case s.NativeType.Dataref:{let e=r.tempDatarefs;e?t=e:r.tempDatarefs=t=[];break}default:throw new Error("concrete type expected")}assert(e.index>=0),t.push(e)}}getScopedLocal(e){var t=this.scopedLocals;return null!==t&&t.has(e)?assert(t.get(e)):null}addScopedLocal(e,t,r=null){var i=this.getTempLocal(t,r);i.setTemporaryName(e);var n=this.scopedLocals;return n?assert(!n.has(e)):this.scopedLocals=n=new Map,i.set(a.CommonFlags.SCOPED),n.set(e,i),i}addScopedDummyLocal(e,t){var r=new n.Local(e,-1,t,this.parentFunction),i=this.scopedLocals;return i?assert(!i.has(e)):this.scopedLocals=i=new Map,r.set(a.CommonFlags.SCOPED),i.set(e,r),r}addScopedAlias(e,t,r,i=null){var s=this.scopedLocals;if(s){if(s.has(e)){let t=assert(s.get(e));return i&&(t.declaration.range.source.isNative?this.parentFunction.program.error(o.DiagnosticCode.Duplicate_identifier_0,i.range,e):this.parentFunction.program.errorRelated(o.DiagnosticCode.Duplicate_identifier_0,i.range,t.declaration.name.range,e)),t}}else this.scopedLocals=s=new Map;assert(r<this.parentFunction.localsByIndex.length);var a=new n.Local(e,r,t,this.parentFunction);return s.set(e,a),a}get hasScopedLocals(){var e=this.scopedLocals;if(e)for(let t=Map_values(e),r=0,i=t.length;r<i;++r){if(unchecked(t[r]).is(a.CommonFlags.SCOPED))return!0}return!1}freeScopedDummyLocal(e){var t=assert(this.scopedLocals);assert(t.has(e));let r=assert(t.get(e));assert(-1==r.index),t.delete(e)}freeScopedLocals(){var e=this.scopedLocals;if(e){for(let t=Map_values(e),r=0,i=t.length;r<i;++r){let e=unchecked(t[r]);e.is(a.CommonFlags.SCOPED)&&this.freeTempLocal(e)}this.scopedLocals=null}}lookupLocal(e){var t=this;do{let r=t.scopedLocals;if(null!==r&&r.has(e))return assert(r.get(e));t=t.parent}while(t);var r=this.parentFunction.localsByName;return r.has(e)?assert(r.get(e)):null}lookup(e){var t=this.lookupLocal(e);return t||this.actualFunction.lookup(e)}isLocalFlag(e,t,r=!0){if(e<0)return r;var i=this.localFlags;return e<i.length&&(unchecked(i[e])&t)==t}isAnyLocalFlag(e,t,r=!0){if(e<0)return r;var i=this.localFlags;return e<i.length&&0!=(unchecked(i[e])&t)}setLocalFlag(e,t){if(!(e<0)){var r=this.localFlags,i=e<r.length?unchecked(r[e]):0;r[e]=i|t}}unsetLocalFlag(e,t){if(!(e<0)){var r=this.localFlags,i=e<r.length?unchecked(r[e]):0;r[e]=i&~t}}initThisFieldFlags(){var e=this.actualFunction;assert(e.is(a.CommonFlags.CONSTRUCTOR));var t=e.parent;assert(t.kind==n.ElementKind.CLASS);var r=t;this.thisFieldFlags=new Map;var i=r.members;if(i)for(let e=Map_values(i),t=0,s=e.length;t<s;++t){let i=e[t];if(i.kind==n.ElementKind.FIELD){let e=i;(e.parent!=r||null!==e.initializerNode||-1!=e.prototype.parameterIndex||e.type.isAny(640))&&this.setThisFieldFlag(e,c.INITIALIZED)}}}isThisFieldFlag(e,t){var r=this.thisFieldFlags;return!(null==r||!r.has(e))&&(changetype(r.get(e))&t)==t}setThisFieldFlag(e,t){var r=this.thisFieldFlags;if(r)if(assert(this.actualFunction.is(a.CommonFlags.CONSTRUCTOR)),r.has(e)){let i=changetype(r.get(e));r.set(e,i|t)}else r.set(e,t);else assert(!this.actualFunction.is(a.CommonFlags.CONSTRUCTOR))}pushBreakLabel(){var e=this.parentFunction,t=e.nextBreakId++,r=e.breakStack;r?r.push(t):e.breakStack=[t];var i=t.toString();return e.breakLabel=i,i}popBreakLabel(){var e=this.parentFunction,t=assert(e.breakStack),r=assert(t.length);t.pop(),r>1?e.breakLabel=t[r-2].toString():(e.breakLabel=null,e.breakStack=null)}inherit(e){assert(e.parentFunction==this.parentFunction),assert(e.parent==this);var t=e.flags;this.breakLabel!=e.breakLabel&&(2064&t&&(t&=-257),t&=-2065),this.continueLabel!=e.continueLabel&&(t&=-4129),this.flags=this.flags|t,this.localFlags=e.localFlags,this.thisFieldFlags=e.thisFieldFlags}inheritBranch(e,t=0){switch(assert(e.parentFunction==this.parentFunction),t){case 1:this.inherit(e);case 2:return}var r=this.flags,i=e.flags,n=0;n|=1&r?1:1&i?512:512&(r|i),n|=r&i&2,n|=r&i&4,n|=8&r?8:8&i?1024:1024&(r|i),16&r?n|=16:e.breakLabel==this.breakLabel?n|=16&i?2048:2048&(r|i):n|=2048&r,32&r?n|=32:e.continueLabel===this.continueLabel?n|=32&i?4096:4096&(r|i):n|=4096&r,64&r?n|=64&i?64:8192:64&i&&(n|=8192),n|=16384&(r|i),n|=r&i&128,256&r&&(n|=256),this.flags=n|32768&r;var s=this.localFlags,a=s.length,o=e.localFlags,l=o.length,c=max(a,l);for(let e=0;e<c;++e){let t=e<a?s[e]:0,r=e<l?o[e]:0;s[e]=t&r&(u.CONSTANT|u.WRAPPED|u.NONNULL|u.INITIALIZED)}}inheritMutual(e,t){assert(e.parentFunction==t.parentFunction),assert(e.parentFunction==this.parentFunction);var r=e.flags,i=t.flags,n=0;n|=1&r?1&i?1:512:1&i?512:512&(r|i),2&r&&2&i&&(n|=2),4&r&&4&i&&(n|=4),n|=8&r?8&i?8:1024:8&i?1024:1024&(r|i),n|=16&r?16&i?16:2048:16&i?2048:2048&(r|i),n|=32&r?32&i?32:4096:32&i?4096:4096&(r|i),n|=64&r?64&i?64:8192:64&i?8192:8192&(r|i),n|=16384&(r|i),128&r&&128&i&&(n|=128),256&r&&256&i&&(n|=256),this.flags=n|32768&this.flags;var s=this.localFlags;if(256&r){if(!(256&i)){let e=t.localFlags;for(let t=0,r=e.length;t<r;++t)s[t]=e[t]}}else if(256&i){let t=e.localFlags;for(let e=0,r=t.length;e<r;++e)s[e]=t[e]}else{let r=e.localFlags,i=r.length,n=t.localFlags,a=n.length,o=max(i,a);for(let e=0;e<o;++e){let t=e<i?r[e]:0,o=e<a?n[e]:0;s[e]=t&o&(u.CONSTANT|u.WRAPPED|u.NONNULL|u.INITIALIZED)}}var a=e.thisFieldFlags;if(a){let e=new Map,r=assert(t.thisFieldFlags);for(let t=Map_keys(a),i=0,n=t.length;i<n;++i){let n=t[i];0!=(changetype(a.get(n))&c.INITIALIZED)&&r.has(n)&&changetype(r.get(n))&c.INITIALIZED&&e.set(n,c.INITIALIZED)}this.thisFieldFlags=e}else assert(!t.thisFieldFlags)}static hasIncompatibleLocalStates(e,t){var r=e.localFlags.length,i=t.localFlags.length,n=e.parentFunction;assert(n===t.parentFunction);var s=n.localsByIndex;assert(s===t.parentFunction.localsByIndex);for(let n=0,a=min(r,i);n<a;++n){let r=s[n].type;if(r.isShortIntegerValue&&e.isLocalFlag(n,u.WRAPPED)&&!t.isLocalFlag(n,u.WRAPPED))return!0;if(r.isNullableReference&&e.isLocalFlag(n,u.NONNULL)&&!t.isLocalFlag(n,u.NONNULL))return!0}return!1}unifyLocalFlags(e){var t=this.localFlags.length,r=e.localFlags.length;for(let i=0,n=min(t,r);i<n;++i)this.isLocalFlag(i,u.WRAPPED)!=e.isLocalFlag(i,u.WRAPPED)&&this.unsetLocalFlag(i,u.WRAPPED),this.isLocalFlag(i,u.NONNULL)!=e.isLocalFlag(i,u.NONNULL)&&this.unsetLocalFlag(i,u.NONNULL)}isNonnull(e,t){if(!t.isNullableReference)return!0;switch(s.getExpressionId(e)){case s.ExpressionId.LocalSet:{if(!s.isLocalTee(e))break;let t=this.parentFunction.localsByIndex[s.getLocalSetIndex(e)];return!t.type.isNullableReference||this.isLocalFlag(t.index,u.NONNULL,!1)}case s.ExpressionId.LocalGet:{let t=this.parentFunction.localsByIndex[s.getLocalGetIndex(e)];return!t.type.isNullableReference||this.isLocalFlag(t.index,u.NONNULL,!1)}}return!1}inheritNonnullIfTrue(e,t=null){switch(s.getExpressionId(e)){case s.ExpressionId.LocalSet:{if(!s.isLocalTee(e))break;let r=this.parentFunction.localsByIndex[s.getLocalSetIndex(e)];t&&!t.isLocalFlag(r.index,u.NONNULL)||this.setLocalFlag(r.index,u.NONNULL),this.inheritNonnullIfTrue(s.getLocalSetValue(e),t);break}case s.ExpressionId.LocalGet:{let r=this.parentFunction.localsByIndex[s.getLocalGetIndex(e)];t&&!t.isLocalFlag(r.index,u.NONNULL)||this.setLocalFlag(r.index,u.NONNULL);break}case s.ExpressionId.If:{let r=s.getIfFalse(e);if(!r)break;s.getExpressionId(r)==s.ExpressionId.Const&&(s.getExpressionType(r)==s.NativeType.I32&&0==s.getConstValueI32(r)||s.getExpressionType(r)==s.NativeType.I64&&0==s.getConstValueI64Low(r)&&0==s.getConstValueI64High(r))&&(this.inheritNonnullIfTrue(s.getIfCondition(e),t),this.inheritNonnullIfTrue(s.getIfTrue(e),t));break}case s.ExpressionId.Unary:switch(s.getUnaryOp(e)){case s.UnaryOp.EqzI32:case s.UnaryOp.EqzI64:this.inheritNonnullIfFalse(s.getUnaryValue(e),t)}break;case s.ExpressionId.Binary:switch(s.getBinaryOp(e)){case s.BinaryOp.EqI32:{let r=s.getBinaryLeft(e),i=s.getBinaryRight(e);s.getExpressionId(r)==s.ExpressionId.Const&&0!=s.getConstValueI32(r)?this.inheritNonnullIfTrue(i,t):s.getExpressionId(i)==s.ExpressionId.Const&&0!=s.getConstValueI32(i)&&this.inheritNonnullIfTrue(r,t);break}case s.BinaryOp.EqI64:{let r=s.getBinaryLeft(e),i=s.getBinaryRight(e);s.getExpressionId(r)!=s.ExpressionId.Const||0==s.getConstValueI64Low(r)&&0==s.getConstValueI64High(r)?s.getExpressionId(i)==s.ExpressionId.Const&&0!=s.getConstValueI64Low(i)&&0!=s.getConstValueI64High(i)&&this.inheritNonnullIfTrue(r,t):this.inheritNonnullIfTrue(i,t);break}case s.BinaryOp.NeI32:{let r=s.getBinaryLeft(e),i=s.getBinaryRight(e);s.getExpressionId(r)==s.ExpressionId.Const&&0==s.getConstValueI32(r)?this.inheritNonnullIfTrue(i,t):s.getExpressionId(i)==s.ExpressionId.Const&&0==s.getConstValueI32(i)&&this.inheritNonnullIfTrue(r,t);break}case s.BinaryOp.NeI64:{let r=s.getBinaryLeft(e),i=s.getBinaryRight(e);s.getExpressionId(r)==s.ExpressionId.Const&&0==s.getConstValueI64Low(r)&&0==s.getConstValueI64High(r)?this.inheritNonnullIfTrue(i,t):s.getExpressionId(i)==s.ExpressionId.Const&&0==s.getConstValueI64Low(i)&&0==s.getConstValueI64High(i)&&this.inheritNonnullIfTrue(r,t);break}}}}inheritNonnullIfFalse(e,t=null){switch(s.getExpressionId(e)){case s.ExpressionId.Unary:switch(s.getUnaryOp(e)){case s.UnaryOp.EqzI32:case s.UnaryOp.EqzI64:this.inheritNonnullIfTrue(s.getUnaryValue(e),t)}break;case s.ExpressionId.If:{let r=s.getIfTrue(e);if(s.getExpressionId(r)==s.ExpressionId.Const){if(!s.getIfFalse(e))break;let i=s.getExpressionType(r);(i==s.NativeType.I32&&0!=s.getConstValueI32(r)||i==s.NativeType.I64&&(0!=s.getConstValueI64Low(r)||0!=s.getConstValueI64High(r)))&&(this.inheritNonnullIfFalse(s.getIfCondition(e),t),this.inheritNonnullIfFalse(s.getIfFalse(e),t))}break}case s.ExpressionId.Binary:switch(s.getBinaryOp(e)){case s.BinaryOp.EqI32:{let r=s.getBinaryLeft(e),i=s.getBinaryRight(e);s.getExpressionId(r)==s.ExpressionId.Const&&0==s.getConstValueI32(r)?this.inheritNonnullIfTrue(i,t):s.getExpressionId(i)==s.ExpressionId.Const&&0==s.getConstValueI32(i)&&this.inheritNonnullIfTrue(r,t);break}case s.BinaryOp.EqI64:{let r=s.getBinaryLeft(e),i=s.getBinaryRight(e);s.getExpressionId(r)==s.ExpressionId.Const&&0==s.getConstValueI64Low(r)&&0==s.getConstValueI64High(r)?this.inheritNonnullIfTrue(i,t):s.getExpressionId(i)==s.ExpressionId.Const&&0==s.getConstValueI64Low(i)&&0==s.getConstValueI64High(i)&&this.inheritNonnullIfTrue(r,t);break}case s.BinaryOp.NeI32:{let r=s.getBinaryLeft(e),i=s.getBinaryRight(e);s.getExpressionId(r)==s.ExpressionId.Const&&0!=s.getConstValueI32(r)?this.inheritNonnullIfTrue(i,t):s.getExpressionId(i)==s.ExpressionId.Const&&0!=s.getConstValueI32(i)&&this.inheritNonnullIfTrue(r,t);break}case s.BinaryOp.NeI64:{let r=s.getBinaryLeft(e),i=s.getBinaryRight(e);s.getExpressionId(r)!=s.ExpressionId.Const||0==s.getConstValueI64Low(r)&&0==s.getConstValueI64High(r)?s.getExpressionId(i)!=s.ExpressionId.Const||0==s.getConstValueI64Low(i)&&0==s.getConstValueI64High(i)||this.inheritNonnullIfTrue(r,t):this.inheritNonnullIfTrue(i,t);break}}}}canOverflow(e,t){if(assert(t!=i.Type.void),!t.isShortIntegerValue)return!1;var r;switch(s.getExpressionId(e)){case s.ExpressionId.LocalGet:{let r=this.parentFunction.localsByIndex[s.getLocalGetIndex(e)];return!this.isLocalFlag(r.index,u.WRAPPED,!0)||_(r.type,t)}case s.ExpressionId.LocalSet:return assert(s.isLocalTee(e)),this.canOverflow(s.getLocalSetValue(e),t);case s.ExpressionId.GlobalGet:{let r=assert(this.parentFunction.program.elementsByName.get(assert(s.getGlobalGetName(e))));return assert(r.kind==n.ElementKind.GLOBAL),_(r.type,t)}case s.ExpressionId.Binary:switch(s.getBinaryOp(e)){case s.BinaryOp.EqI32:case s.BinaryOp.EqI64:case s.BinaryOp.EqF32:case s.BinaryOp.EqF64:case s.BinaryOp.NeI32:case s.BinaryOp.NeI64:case s.BinaryOp.NeF32:case s.BinaryOp.NeF64:case s.BinaryOp.LtI32:case s.BinaryOp.LtU32:case s.BinaryOp.LtI64:case s.BinaryOp.LtU64:case s.BinaryOp.LtF32:case s.BinaryOp.LtF64:case s.BinaryOp.LeI32:case s.BinaryOp.LeU32:case s.BinaryOp.LeI64:case s.BinaryOp.LeU64:case s.BinaryOp.LeF32:case s.BinaryOp.LeF64:case s.BinaryOp.GtI32:case s.BinaryOp.GtU32:case s.BinaryOp.GtI64:case s.BinaryOp.GtU64:case s.BinaryOp.GtF32:case s.BinaryOp.GtF64:case s.BinaryOp.GeI32:case s.BinaryOp.GeU32:case s.BinaryOp.GeI64:case s.BinaryOp.GeU64:case s.BinaryOp.GeF32:case s.BinaryOp.GeF64:return!1;case s.BinaryOp.MulI32:return!(s.getExpressionId(r=s.getBinaryLeft(e))==s.ExpressionId.Const&&(0==s.getConstValueI32(r)||1==s.getConstValueI32(r)&&!this.canOverflow(s.getBinaryRight(e),t))||s.getExpressionId(r=s.getBinaryRight(e))==s.ExpressionId.Const&&(0==s.getConstValueI32(r)||1==s.getConstValueI32(r)&&!this.canOverflow(s.getBinaryLeft(e),t)));case s.BinaryOp.AndI32:return!(s.getExpressionId(r=s.getBinaryLeft(e))==s.ExpressionId.Const&&s.getConstValueI32(r)<=t.computeSmallIntegerMask(i.Type.i32)||!this.canOverflow(r,t)||s.getExpressionId(r=s.getBinaryRight(e))==s.ExpressionId.Const&&s.getConstValueI32(r)<=t.computeSmallIntegerMask(i.Type.i32)||!this.canOverflow(r,t));case s.BinaryOp.ShlI32:{let i=32-t.size;return s.getExpressionId(r=s.getBinaryRight(e))!=s.ExpressionId.Const||s.getConstValueI32(r)<i}case s.BinaryOp.ShrI32:{let i=32-t.size;return this.canOverflow(s.getBinaryLeft(e),t)&&(s.getExpressionId(r=s.getBinaryRight(e))!=s.ExpressionId.Const||s.getConstValueI32(r)<i)}case s.BinaryOp.ShrU32:{let i=32-t.size;return t.isSignedIntegerValue?!(s.getExpressionId(r=s.getBinaryRight(e))==s.ExpressionId.Const&&s.getConstValueI32(r)>i):this.canOverflow(s.getBinaryLeft(e),t)&&!(s.getExpressionId(r=s.getBinaryRight(e))==s.ExpressionId.Const&&s.getConstValueI32(r)>=i)}case s.BinaryOp.DivU32:case s.BinaryOp.RemI32:case s.BinaryOp.RemU32:return this.canOverflow(s.getBinaryLeft(e),t)||this.canOverflow(s.getBinaryRight(e),t)}break;case s.ExpressionId.Unary:switch(s.getUnaryOp(e)){case s.UnaryOp.EqzI32:case s.UnaryOp.EqzI64:return!1;case s.UnaryOp.ClzI32:case s.UnaryOp.CtzI32:case s.UnaryOp.PopcntI32:return t.size<7}break;case s.ExpressionId.Const:{let r=0;switch(s.getExpressionType(e)){case s.NativeType.I32:r=s.getConstValueI32(e);break;case s.NativeType.I64:r=s.getConstValueI64Low(e);break;case s.NativeType.F32:r=i32(s.getConstValueF32(e));break;case s.NativeType.F64:r=i32(s.getConstValueF64(e));break;default:assert(!1)}switch(t.kind){case 0:return r<i8.MIN_VALUE||r>i8.MAX_VALUE;case 1:return r<i16.MIN_VALUE||r>i16.MAX_VALUE;case 5:return r<0||r>u8.MAX_VALUE;case 6:return r<0||r>u16.MAX_VALUE;case 10:return 0!=(-2&r)}break}case s.ExpressionId.Load:{let r,n=s.isLoadSigned(e);switch(s.getLoadBytes(e)){case 1:r=n?i.Type.i8:i.Type.u8;break;case 2:r=n?i.Type.i16:i.Type.u16;break;default:r=n?i.Type.i32:i.Type.u32}return _(r,t)}case s.ExpressionId.Block:if(!s.getBlockName(e)){let r=assert(s.getBlockChildCount(e)),i=s.getBlockChildAt(e,r-1);return this.canOverflow(i,t)}break;case s.ExpressionId.If:return this.canOverflow(s.getIfTrue(e),t)||this.canOverflow(assert(s.getIfFalse(e)),t);case s.ExpressionId.Select:return this.canOverflow(s.getSelectThen(e),t)||this.canOverflow(s.getSelectElse(e),t);case s.ExpressionId.Call:{let r=this.parentFunction.program.instancesByName,i=assert(s.getCallTarget(e));if(r.has(i)){let e=assert(r.get(i));assert(e.kind==n.ElementKind.FUNCTION);let s=e,a=s.signature.returnType;return!s.flow.is(2)||_(a,t)}return!1}case s.ExpressionId.Unreachable:return!1}return!0}toString(){for(var e=0,t=this.parent;t;)t=t.parent,++e;var r=new Array;return this.is(1)&&r.push("RETURNS"),this.is(2)&&r.push("RETURNS_WRAPPED"),this.is(4)&&r.push("RETURNS_NONNULL"),this.is(8)&&r.push("THROWS"),this.is(16)&&r.push("BREAKS"),this.is(32)&&r.push("CONTINUES"),this.is(64)&&r.push("ACCESSES_THIS"),this.is(128)&&r.push("CALLS_SUPER"),this.is(256)&&r.push("TERMINATES"),this.is(512)&&r.push("CONDITIONALLY_RETURNS"),this.is(1024)&&r.push("CONDITIONALLY_THROWS"),this.is(2048)&&r.push("CONDITIONALLY_BREAKS"),this.is(4096)&&r.push("CONDITIONALLY_CONTINUES"),this.is(8192)&&r.push("CONDITIONALLY_ACCESSES_THIS"),this.is(16384)&&r.push("MAY_RETURN_NONTHIS"),"Flow("+this.actualFunction.toString()+")["+e.toString()+"] "+r.join(" ")}}function _(e,t){return t.isShortIntegerValue&&(!e.isIntegerValue||e.size>t.size||e.isSignedIntegerValue!=t.isSignedIntegerValue)}t.Flow=p;var h=r(416);Object.defineProperty(t,"findUsedLocals",{enumerable:!0,get:function(){return h.findUsedLocals}})},308:(e,t,r)=>{"use strict";r(352),r(292),r(620),r(875),r(710)},780:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.buildIDL=t.compile=t.initializeProgram=t.getDependee=t.nextFile=t.parse=t.isError=t.isWarning=t.isInfo=t.formatDiagnostic=t.getSource=t.nextDiagnostic=t.newProgram=t.setPedantic=t.setOptimizeLevelHints=t.disableFeature=t.enableFeature=t.FEATURE_MEMORY64=t.FEATURE_GC=t.FEATURE_MULTI_VALUE=t.FEATURE_REFERENCE_TYPES=t.FEATURE_TAIL_CALLS=t.FEATURE_EXCEPTION_HANDLING=t.FEATURE_THREADS=t.FEATURE_SIMD=t.FEATURE_BULK_MEMORY=t.FEATURE_NONTRAPPING_F2I=t.FEATURE_MUTABLE_GLOBALS=t.FEATURE_SIGN_EXTENSION=t.setBundleVersion=t.setStackSize=t.DEFAULT_STACK_SIZE=t.setExportRuntime=t.setLowMemoryLimit=t.setNoUnsafe=t.setExplicitStart=t.setGlobalAlias=t.setTableBase=t.setMemoryBase=t.setSourceMap=t.setExportTable=t.setImportTable=t.setSharedMemory=t.setMaximumMemory=t.setInitialMemory=t.setImportMemory=t.setExportMemory=t.setNoAssert=t.setTarget=t.newOptions=void 0,t.util=t.buildTSD=void 0;const s=r(220),a=r(317),o=r(256);Object.defineProperty(t,"formatDiagnostic",{enumerable:!0,get:function(){return o.formatDiagnosticMessage}});const l=r(974);t.newOptions=function(){return new s.Options},t.setTarget=function(e,t){e.target=t},t.setNoAssert=function(e,t){e.noAssert=t},t.setExportMemory=function(e,t){e.exportMemory=t},t.setImportMemory=function(e,t){e.importMemory=t},t.setInitialMemory=function(e,t){e.initialMemory=t},t.setMaximumMemory=function(e,t){e.maximumMemory=t},t.setSharedMemory=function(e,t){e.sharedMemory=t},t.setImportTable=function(e,t){e.importTable=t},t.setExportTable=function(e,t){e.exportTable=t},t.setSourceMap=function(e,t){e.sourceMap=t},t.setMemoryBase=function(e,t){e.memoryBase=t},t.setTableBase=function(e,t){e.tableBase=t},t.setGlobalAlias=function(e,t,r){var i=e.globalAliases;i||(e.globalAliases=i=new Map),i.set(t,r)},t.setExplicitStart=function(e,t){e.explicitStart=t},t.setNoUnsafe=function(e,t){e.noUnsafe=t},t.setLowMemoryLimit=function(e,t){e.lowMemoryLimit=t},t.setExportRuntime=function(e,t){e.exportRuntime=t},t.DEFAULT_STACK_SIZE=16384,t.setStackSize=function(e,t){e.stackSize=t},t.setBundleVersion=function(e,t,r,i){e.bundleMajorVersion=t,e.bundleMinorVersion=r,e.bundlePatchVersion=i},t.FEATURE_SIGN_EXTENSION=1,t.FEATURE_MUTABLE_GLOBALS=2,t.FEATURE_NONTRAPPING_F2I=4,t.FEATURE_BULK_MEMORY=8,t.FEATURE_SIMD=16,t.FEATURE_THREADS=32,t.FEATURE_EXCEPTION_HANDLING=64,t.FEATURE_TAIL_CALLS=128,t.FEATURE_REFERENCE_TYPES=256,t.FEATURE_MULTI_VALUE=512,t.FEATURE_GC=1024,t.FEATURE_MEMORY64=2048,t.enableFeature=function(e,t){e.features|=t},t.disableFeature=function(e,t){e.features&=~t},t.setOptimizeLevelHints=function(e,t,r){e.optimizeLevelHint=t,e.shrinkLevelHint=r},t.setPedantic=function(e,t){e.pedantic=t},t.newProgram=function(e){return new l.Program(e)},t.nextDiagnostic=function(e){return e.diagnosticsOffset<e.diagnostics.length?e.diagnostics[e.diagnosticsOffset++]:null},t.getSource=function(e,t){return e.getSource(t)},t.isInfo=function(e){return e.category==o.DiagnosticCategory.INFO},t.isWarning=function(e){return e.category==o.DiagnosticCategory.WARNING},t.isError=function(e){return e.category==o.DiagnosticCategory.ERROR},t.parse=function(e,t,r,i=!1){e.parser.parseFile(t,r,i)},t.nextFile=function(e){return e.parser.nextFile()},t.getDependee=function(e,t){return e.parser.getDependee(t)},t.initializeProgram=function(e){e.initialize()},t.compile=function(e){return e.parser.finish(),new s.Compiler(e).compile()},t.buildIDL=function(e){return a.IDLBuilder.build(e)},t.buildTSD=function(e){return a.TSDBuilder.build(e)},n(r(60),t),n(r(200),t),n(r(220),t),n(r(317),t),n(r(256),t),n(r(154),t),n(r(656),t),n(r(215),t),n(r(974),t),n(r(742),t),n(r(411),t),n(r(699),t),n(r(393),t);const u=r(910);t.util=u,n(r(910),t)},656:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBlockChildCount=t.getBlockName=t.getStoreValue=t.getStorePtr=t.getStoreOffset=t.getStoreBytes=t.isLoadSigned=t.getLoadPtr=t.getLoadOffset=t.getLoadBytes=t.getUnaryValue=t.getUnaryOp=t.getBinaryRight=t.getBinaryLeft=t.getBinaryOp=t.getGlobalGetName=t.isLocalTee=t.getLocalSetValue=t.getLocalSetIndex=t.getLocalGetIndex=t.isConstZero=t.getConstValueF64=t.getConstValueF32=t.getConstValueI64High=t.getConstValueI64Low=t.getConstValueI32=t.getExpressionType=t.getExpressionId=t.expandType=t.createType=t.Module=t.MemorySegment=t.ExpressionRunnerFlags=t.BrOnOp=t.RefAsOp=t.RefIsOp=t.SIMDWidenOp=t.SIMDLoadStoreLaneOp=t.SIMDLoadOp=t.SIMDTernaryOp=t.SIMDShiftOp=t.SIMDReplaceOp=t.SIMDExtractOp=t.AtomicRMWOp=t.BinaryOp=t.UnaryOp=t.ExternalKind=t.ExpressionId=t.FeatureFlags=t.NativeType=void 0,t.needsExplicitUnreachable=t.BinaryModule=t.readString=t.allocPtrArray=t.hasSideEffects=t.getSideEffects=t.SideEffects=t.SwitchBuilder=t.Relooper=t.getEventResults=t.getEventParams=t.getEventAttribute=t.getEventName=t.getGlobalInit=t.isGlobalMutable=t.getGlobalType=t.getGlobalName=t.getFunctionVars=t.getFunctionResults=t.getFunctionParams=t.getFunctionName=t.getFunctionBody=t.getMemoryGrowDelta=t.getCallOperandAt=t.getCallOperandCount=t.getCallTarget=t.getReturnValue=t.getDropValue=t.getSelectCondition=t.getSelectElse=t.getSelectThen=t.getBreakCondition=t.getBreakName=t.getLoopBody=t.getLoopName=t.getIfFalse=t.getIfTrue=t.getIfCondition=t.getBlockChildAt=void 0;const i=r(346),n=r(200),s=r(292);var a,o,l,u,c,p;!function(e){e.None=0,e.Unreachable=1,e.I32=2,e.I64=3,e.F32=4,e.F64=5,e.V128=6,e.Funcref=7,e.Externref=8,e.Anyref=9,e.Eqref=10,e.I31ref=11,e.Dataref=12,e.Auto=-1}(a=t.NativeType||(t.NativeType={})),function(e){e[e.MVP=0]="MVP",e[e.Atomics=1]="Atomics",e[e.MutableGloabls=2]="MutableGloabls",e[e.NontrappingFPToInt=4]="NontrappingFPToInt",e[e.SIMD128=8]="SIMD128",e[e.BulkMemory=16]="BulkMemory",e[e.SignExt=32]="SignExt",e[e.ExceptionHandling=64]="ExceptionHandling",e[e.TailCall=128]="TailCall",e[e.ReferenceTypes=256]="ReferenceTypes",e[e.MultiValue=512]="MultiValue",e[e.GC=1024]="GC",e[e.Memory64=2048]="Memory64",e[e.TypedFunctionReferences=4096]="TypedFunctionReferences",e[e.All=8191]="All"}(o=t.FeatureFlags||(t.FeatureFlags={})),function(e){e[e.Invalid=0]="Invalid",e[e.Block=1]="Block",e[e.If=2]="If",e[e.Loop=3]="Loop",e[e.Break=4]="Break",e[e.Switch=5]="Switch",e[e.Call=6]="Call",e[e.CallIndirect=7]="CallIndirect",e[e.LocalGet=8]="LocalGet",e[e.LocalSet=9]="LocalSet",e[e.GlobalGet=10]="GlobalGet",e[e.GlobalSet=11]="GlobalSet",e[e.Load=12]="Load",e[e.Store=13]="Store",e[e.Const=14]="Const",e[e.Unary=15]="Unary",e[e.Binary=16]="Binary",e[e.Select=17]="Select",e[e.Drop=18]="Drop",e[e.Return=19]="Return",e[e.MemorySize=20]="MemorySize",e[e.MemoryGrow=21]="MemoryGrow",e[e.Nop=22]="Nop",e[e.Unreachable=24]="Unreachable",e[e.AtomicRMW=25]="AtomicRMW",e[e.AtomicCmpxchg=26]="AtomicCmpxchg",e[e.AtomicWait=27]="AtomicWait",e[e.AtomicNotify=28]="AtomicNotify",e[e.AtomicFence=29]="AtomicFence",e[e.SIMDExtract=30]="SIMDExtract",e[e.SIMDReplace=31]="SIMDReplace",e[e.SIMDShuffle=32]="SIMDShuffle",e[e.SIMDTernary=33]="SIMDTernary",e[e.SIMDShift=34]="SIMDShift",e[e.SIMDLoad=35]="SIMDLoad",e[e.SIMDLoadStoreLane=36]="SIMDLoadStoreLane",e[e.SIMDWiden=37]="SIMDWiden",e[e.MemoryInit=38]="MemoryInit",e[e.DataDrop=39]="DataDrop",e[e.MemoryCopy=40]="MemoryCopy",e[e.MemoryFill=41]="MemoryFill",e[e.Pop=42]="Pop",e[e.RefNull=43]="RefNull",e[e.RefIs=44]="RefIs",e[e.RefFunc=45]="RefFunc",e[e.RefEq=46]="RefEq",e[e.Try=47]="Try",e[e.Throw=48]="Throw",e[e.Rethrow=49]="Rethrow",e[e.TupleMake=50]="TupleMake",e[e.TupleExtract=51]="TupleExtract",e[e.I31New=52]="I31New",e[e.I31Get=53]="I31Get",e[e.CallRef=54]="CallRef",e[e.RefTest=55]="RefTest",e[e.RefCast=56]="RefCast",e[e.BrOn=57]="BrOn",e[e.RttCanon=58]="RttCanon",e[e.RttSub=59]="RttSub",e[e.StructNew=60]="StructNew",e[e.StructGet=61]="StructGet",e[e.StructSet=62]="StructSet",e[e.ArrayNew=63]="ArrayNew",e[e.ArrayGet=64]="ArrayGet",e[e.ArraySet=65]="ArraySet",e[e.ArrayLen=66]="ArrayLen",e[e.RefAs=67]="RefAs"}(l=t.ExpressionId||(t.ExpressionId={})),function(e){e[e.Function=0]="Function",e[e.Table=1]="Table",e[e.Memory=2]="Memory",e[e.Global=3]="Global",e[e.Event=4]="Event"}(t.ExternalKind||(t.ExternalKind={})),function(e){e[e.ClzI32=0]="ClzI32",e[e.ClzI64=1]="ClzI64",e[e.CtzI32=2]="CtzI32",e[e.CtzI64=3]="CtzI64",e[e.PopcntI32=4]="PopcntI32",e[e.PopcntI64=5]="PopcntI64",e[e.NegF32=6]="NegF32",e[e.NegF64=7]="NegF64",e[e.AbsF32=8]="AbsF32",e[e.AbsF64=9]="AbsF64",e[e.CeilF32=10]="CeilF32",e[e.CeilF64=11]="CeilF64",e[e.FloorF32=12]="FloorF32",e[e.FloorF64=13]="FloorF64",e[e.TruncF32=14]="TruncF32",e[e.TruncF64=15]="TruncF64",e[e.NearestF32=16]="NearestF32",e[e.NearestF64=17]="NearestF64",e[e.SqrtF32=18]="SqrtF32",e[e.SqrtF64=19]="SqrtF64",e[e.EqzI32=20]="EqzI32",e[e.EqzI64=21]="EqzI64",e[e.ExtendI32=22]="ExtendI32",e[e.ExtendU32=23]="ExtendU32",e[e.WrapI64=24]="WrapI64",e[e.TruncF32ToI32=25]="TruncF32ToI32",e[e.TruncF32ToI64=26]="TruncF32ToI64",e[e.TruncF32ToU32=27]="TruncF32ToU32",e[e.TruncF32ToU64=28]="TruncF32ToU64",e[e.TruncF64ToI32=29]="TruncF64ToI32",e[e.TruncF64ToI64=30]="TruncF64ToI64",e[e.TruncF64ToU32=31]="TruncF64ToU32",e[e.TruncF64ToU64=32]="TruncF64ToU64",e[e.ReinterpretF32=33]="ReinterpretF32",e[e.ReinterpretF64=34]="ReinterpretF64",e[e.ConvertI32ToF32=35]="ConvertI32ToF32",e[e.ConvertI32ToF64=36]="ConvertI32ToF64",e[e.ConvertU32ToF32=37]="ConvertU32ToF32",e[e.ConvertU32ToF64=38]="ConvertU32ToF64",e[e.ConvertI64ToF32=39]="ConvertI64ToF32",e[e.ConvertI64ToF64=40]="ConvertI64ToF64",e[e.ConvertU64ToF32=41]="ConvertU64ToF32",e[e.ConvertU64ToF64=42]="ConvertU64ToF64",e[e.PromoteF32=43]="PromoteF32",e[e.DemoteF64=44]="DemoteF64",e[e.ReinterpretI32=45]="ReinterpretI32",e[e.ReinterpretI64=46]="ReinterpretI64",e[e.ExtendI8ToI32=47]="ExtendI8ToI32",e[e.ExtendI16ToI32=48]="ExtendI16ToI32",e[e.ExtendI8ToI64=49]="ExtendI8ToI64",e[e.ExtendI16ToI64=50]="ExtendI16ToI64",e[e.ExtendI32ToI64=51]="ExtendI32ToI64",e[e.TruncF32ToI32Sat=52]="TruncF32ToI32Sat",e[e.TruncF32ToU32Sat=53]="TruncF32ToU32Sat",e[e.TruncF64ToI32Sat=54]="TruncF64ToI32Sat",e[e.TruncF64ToU32Sat=55]="TruncF64ToU32Sat",e[e.TruncF32ToI64Sat=56]="TruncF32ToI64Sat",e[e.TruncF32ToU64Sat=57]="TruncF32ToU64Sat",e[e.TruncF64ToI64Sat=58]="TruncF64ToI64Sat",e[e.TruncF64ToU64Sat=59]="TruncF64ToU64Sat",e[e.SplatI8x16=60]="SplatI8x16",e[e.SplatI16x8=61]="SplatI16x8",e[e.SplatI32x4=62]="SplatI32x4",e[e.SplatI64x2=63]="SplatI64x2",e[e.SplatF32x4=64]="SplatF32x4",e[e.SplatF64x2=65]="SplatF64x2",e[e.NotV128=66]="NotV128",e[e.AbsI8x16=67]="AbsI8x16",e[e.NegI8x16=68]="NegI8x16",e[e.AnyTrueI8x16=69]="AnyTrueI8x16",e[e.AllTrueI8x16=70]="AllTrueI8x16",e[e.BitmaskI8x16=71]="BitmaskI8x16",e[e.PopcntI8x16=72]="PopcntI8x16",e[e.AbsI16x8=73]="AbsI16x8",e[e.NegI16x8=74]="NegI16x8",e[e.AnyTrueI16x8=75]="AnyTrueI16x8",e[e.AllTrueI16x8=76]="AllTrueI16x8",e[e.BitmaskI16x8=77]="BitmaskI16x8",e[e.AbsI32x4=78]="AbsI32x4",e[e.NegI32x4=79]="NegI32x4",e[e.AnyTrueI32x4=80]="AnyTrueI32x4",e[e.AllTrueI32x4=81]="AllTrueI32x4",e[e.BitmaskI32x4=82]="BitmaskI32x4",e[e.NegI64x2=83]="NegI64x2",e[e.AllTrueI64x2=81]="AllTrueI64x2",e[e.BitmaskI64x2=84]="BitmaskI64x2",e[e.AbsF32x4=85]="AbsF32x4",e[e.NegF32x4=86]="NegF32x4",e[e.SqrtF32x4=87]="SqrtF32x4",e[e.CeilF32x4=88]="CeilF32x4",e[e.FloorF32x4=89]="FloorF32x4",e[e.TruncF32x4=90]="TruncF32x4",e[e.NearestF32x4=91]="NearestF32x4",e[e.AbsF64x2=92]="AbsF64x2",e[e.NegF64x2=93]="NegF64x2",e[e.SqrtF64x2=94]="SqrtF64x2",e[e.CeilF64x2=95]="CeilF64x2",e[e.FloorF64x2=96]="FloorF64x2",e[e.TruncF64x2=97]="TruncF64x2",e[e.NearestF64x2=98]="NearestF64x2",e[e.ExtAddPairwiseI8x16ToI16x8=99]="ExtAddPairwiseI8x16ToI16x8",e[e.ExtAddPairwiseU8x16ToU16x8=100]="ExtAddPairwiseU8x16ToU16x8",e[e.ExtAddPairwiseI16x8ToI32x4=101]="ExtAddPairwiseI16x8ToI32x4",e[e.ExtAddPairwiseU16x8ToU32x4=102]="ExtAddPairwiseU16x8ToU32x4",e[e.TruncSatF32x4ToI32x4=103]="TruncSatF32x4ToI32x4",e[e.TruncSatF32x4ToU32x4=104]="TruncSatF32x4ToU32x4",e[e.TruncSatF64x2ToI64x2=105]="TruncSatF64x2ToI64x2",e[e.TruncSatF64x2ToU64x2=106]="TruncSatF64x2ToU64x2",e[e.ConvertI32x4ToF32x4=107]="ConvertI32x4ToF32x4",e[e.ConvertU32x4ToF32x4=108]="ConvertU32x4ToF32x4",e[e.ConvertI64x2ToF64x2=109]="ConvertI64x2ToF64x2",e[e.ConvertU64x2ToF64x2=110]="ConvertU64x2ToF64x2",e[e.ExtendLowI8x16ToI16x8=111]="ExtendLowI8x16ToI16x8",e[e.ExtendHighI8x16ToI16x8=112]="ExtendHighI8x16ToI16x8",e[e.ExtendLowU8x16ToU16x8=113]="ExtendLowU8x16ToU16x8",e[e.ExtendHighU8x16ToU16x8=114]="ExtendHighU8x16ToU16x8",e[e.ExtendLowI16x8ToI32x4=115]="ExtendLowI16x8ToI32x4",e[e.ExtendHighI16x8ToI32x4=116]="ExtendHighI16x8ToI32x4",e[e.ExtendLowU16x8ToU32x4=117]="ExtendLowU16x8ToU32x4",e[e.ExtendHighU16x8ToU32x4=118]="ExtendHighU16x8ToU32x4",e[e.ExtendLowI32x4ToI64x2=119]="ExtendLowI32x4ToI64x2",e[e.ExtendHighI32x4ToI64x2=120]="ExtendHighI32x4ToI64x2",e[e.ExtendLowU32x4ToU64x2=121]="ExtendLowU32x4ToU64x2",e[e.ExtendHighU32x4ToU64x2=122]="ExtendHighU32x4ToU64x2",e[e.ConvertLowI32x4ToF64x2=123]="ConvertLowI32x4ToF64x2",e[e.ConvertLowU32x4ToF64x2=124]="ConvertLowU32x4ToF64x2",e[e.TruncSatZeroF64x2ToI32x4=125]="TruncSatZeroF64x2ToI32x4",e[e.TruncSatZeroF64x2ToU32x4=126]="TruncSatZeroF64x2ToU32x4",e[e.DemoteZeroF64x2ToF32x4=127]="DemoteZeroF64x2ToF32x4",e[e.PromoteLowF32x4ToF64x2=128]="PromoteLowF32x4ToF64x2",e[e._last=128]="_last",e[e.ClzSize=129]="ClzSize",e[e.CtzSize=130]="CtzSize",e[e.PopcntSize=131]="PopcntSize",e[e.EqzSize=132]="EqzSize"}(u=t.UnaryOp||(t.UnaryOp={})),function(e){e[e.AddI32=0]="AddI32",e[e.SubI32=1]="SubI32",e[e.MulI32=2]="MulI32",e[e.DivI32=3]="DivI32",e[e.DivU32=4]="DivU32",e[e.RemI32=5]="RemI32",e[e.RemU32=6]="RemU32",e[e.AndI32=7]="AndI32",e[e.OrI32=8]="OrI32",e[e.XorI32=9]="XorI32",e[e.ShlI32=10]="ShlI32",e[e.ShrI32=11]="ShrI32",e[e.ShrU32=12]="ShrU32",e[e.RotlI32=13]="RotlI32",e[e.RotrI32=14]="RotrI32",e[e.EqI32=15]="EqI32",e[e.NeI32=16]="NeI32",e[e.LtI32=17]="LtI32",e[e.LtU32=18]="LtU32",e[e.LeI32=19]="LeI32",e[e.LeU32=20]="LeU32",e[e.GtI32=21]="GtI32",e[e.GtU32=22]="GtU32",e[e.GeI32=23]="GeI32",e[e.GeU32=24]="GeU32",e[e.AddI64=25]="AddI64",e[e.SubI64=26]="SubI64",e[e.MulI64=27]="MulI64",e[e.DivI64=28]="DivI64",e[e.DivU64=29]="DivU64",e[e.RemI64=30]="RemI64",e[e.RemU64=31]="RemU64",e[e.AndI64=32]="AndI64",e[e.OrI64=33]="OrI64",e[e.XorI64=34]="XorI64",e[e.ShlI64=35]="ShlI64",e[e.ShrI64=36]="ShrI64",e[e.ShrU64=37]="ShrU64",e[e.RotlI64=38]="RotlI64",e[e.RotrI64=39]="RotrI64",e[e.EqI64=40]="EqI64",e[e.NeI64=41]="NeI64",e[e.LtI64=42]="LtI64",e[e.LtU64=43]="LtU64",e[e.LeI64=44]="LeI64",e[e.LeU64=45]="LeU64",e[e.GtI64=46]="GtI64",e[e.GtU64=47]="GtU64",e[e.GeI64=48]="GeI64",e[e.GeU64=49]="GeU64",e[e.AddF32=50]="AddF32",e[e.SubF32=51]="SubF32",e[e.MulF32=52]="MulF32",e[e.DivF32=53]="DivF32",e[e.CopysignF32=54]="CopysignF32",e[e.MinF32=55]="MinF32",e[e.MaxF32=56]="MaxF32",e[e.EqF32=57]="EqF32",e[e.NeF32=58]="NeF32",e[e.LtF32=59]="LtF32",e[e.LeF32=60]="LeF32",e[e.GtF32=61]="GtF32",e[e.GeF32=62]="GeF32",e[e.AddF64=63]="AddF64",e[e.SubF64=64]="SubF64",e[e.MulF64=65]="MulF64",e[e.DivF64=66]="DivF64",e[e.CopysignF64=67]="CopysignF64",e[e.MinF64=68]="MinF64",e[e.MaxF64=69]="MaxF64",e[e.EqF64=70]="EqF64",e[e.NeF64=71]="NeF64",e[e.LtF64=72]="LtF64",e[e.LeF64=73]="LeF64",e[e.GtF64=74]="GtF64",e[e.GeF64=75]="GeF64",e[e.EqI8x16=76]="EqI8x16",e[e.NeI8x16=77]="NeI8x16",e[e.LtI8x16=78]="LtI8x16",e[e.LtU8x16=79]="LtU8x16",e[e.GtI8x16=80]="GtI8x16",e[e.GtU8x16=81]="GtU8x16",e[e.LeI8x16=82]="LeI8x16",e[e.LeU8x16=83]="LeU8x16",e[e.GeI8x16=84]="GeI8x16",e[e.GeU8x16=85]="GeU8x16",e[e.EqI16x8=86]="EqI16x8",e[e.NeI16x8=87]="NeI16x8",e[e.LtI16x8=88]="LtI16x8",e[e.LtU16x8=89]="LtU16x8",e[e.GtI16x8=90]="GtI16x8",e[e.GtU16x8=91]="GtU16x8",e[e.LeI16x8=92]="LeI16x8",e[e.LeU16x8=93]="LeU16x8",e[e.GeI16x8=94]="GeI16x8",e[e.GeU16x8=95]="GeU16x8",e[e.EqI32x4=96]="EqI32x4",e[e.NeI32x4=97]="NeI32x4",e[e.LtI32x4=98]="LtI32x4",e[e.LtU32x4=99]="LtU32x4",e[e.GtI32x4=100]="GtI32x4",e[e.GtU32x4=101]="GtU32x4",e[e.LeI32x4=102]="LeI32x4",e[e.LeU32x4=103]="LeU32x4",e[e.GeI32x4=104]="GeI32x4",e[e.GeU32x4=105]="GeU32x4",e[e.EqI64x2=96]="EqI64x2",e[e.NeI64x2=97]="NeI64x2",e[e.LtI64x2=98]="LtI64x2",e[e.LtU64x2=99]="LtU64x2",e[e.GtI64x2=100]="GtI64x2",e[e.GtU64x2=101]="GtU64x2",e[e.LeI64x2=102]="LeI64x2",e[e.LeU64x2=103]="LeU64x2",e[e.GeI64x2=104]="GeI64x2",e[e.GeU64x2=105]="GeU64x2",e[e.EqF32x4=107]="EqF32x4",e[e.NeF32x4=108]="NeF32x4",e[e.LtF32x4=109]="LtF32x4",e[e.GtF32x4=110]="GtF32x4",e[e.LeF32x4=111]="LeF32x4",e[e.GeF32x4=112]="GeF32x4",e[e.EqF64x2=113]="EqF64x2",e[e.NeF64x2=114]="NeF64x2",e[e.LtF64x2=115]="LtF64x2",e[e.GtF64x2=116]="GtF64x2",e[e.LeF64x2=117]="LeF64x2",e[e.GeF64x2=118]="GeF64x2",e[e.AndV128=119]="AndV128",e[e.OrV128=120]="OrV128",e[e.XorV128=121]="XorV128",e[e.AndNotV128=122]="AndNotV128",e[e.AddI8x16=123]="AddI8x16",e[e.AddSatI8x16=124]="AddSatI8x16",e[e.AddSatU8x16=125]="AddSatU8x16",e[e.SubI8x16=126]="SubI8x16",e[e.SubSatI8x16=127]="SubSatI8x16",e[e.SubSatU8x16=128]="SubSatU8x16",e[e.MulI8x16=129]="MulI8x16",e[e.MinI8x16=130]="MinI8x16",e[e.MinU8x16=131]="MinU8x16",e[e.MaxI8x16=132]="MaxI8x16",e[e.MaxU8x16=133]="MaxU8x16",e[e.AvgrU8x16=134]="AvgrU8x16",e[e.AddI16x8=135]="AddI16x8",e[e.AddSatI16x8=136]="AddSatI16x8",e[e.AddSatU16x8=137]="AddSatU16x8",e[e.SubI16x8=138]="SubI16x8",e[e.SubSatI16x8=139]="SubSatI16x8",e[e.SubSatU16x8=140]="SubSatU16x8",e[e.MulI16x8=141]="MulI16x8",e[e.MinI16x8=142]="MinI16x8",e[e.MinU16x8=143]="MinU16x8",e[e.MaxI16x8=144]="MaxI16x8",e[e.MaxU16x8=145]="MaxU16x8",e[e.AvgrU16x8=146]="AvgrU16x8",e[e.Q15MulrSatI16x8=147]="Q15MulrSatI16x8",e[e.ExtMulLowI16x8=148]="ExtMulLowI16x8",e[e.ExtMulHighI16x8=149]="ExtMulHighI16x8",e[e.ExtMulLowU16x8=150]="ExtMulLowU16x8",e[e.ExtMulHighU16x8=151]="ExtMulHighU16x8",e[e.AddI32x4=152]="AddI32x4",e[e.SubI32x4=153]="SubI32x4",e[e.MulI32x4=154]="MulI32x4",e[e.MinI32x4=155]="MinI32x4",e[e.MinU32x4=156]="MinU32x4",e[e.MaxI32x4=157]="MaxI32x4",e[e.MaxU32x4=158]="MaxU32x4",e[e.DotI16x8=159]="DotI16x8",e[e.AddI64x2=164]="AddI64x2",e[e.SubI64x2=165]="SubI64x2",e[e.MulI64x2=166]="MulI64x2",e[e.ExtMulLowI64x2=167]="ExtMulLowI64x2",e[e.ExtMulHighI64x2=168]="ExtMulHighI64x2",e[e.ExtMulLowU64x2=169]="ExtMulLowU64x2",e[e.ExtMulHighU64x2=170]="ExtMulHighU64x2",e[e.AddF32x4=171]="AddF32x4",e[e.SubF32x4=172]="SubF32x4",e[e.MulF32x4=173]="MulF32x4",e[e.DivF32x4=174]="DivF32x4",e[e.MinF32x4=175]="MinF32x4",e[e.MaxF32x4=176]="MaxF32x4",e[e.PminF32x4=177]="PminF32x4",e[e.PmaxF32x4=178]="PmaxF32x4",e[e.AddF64x2=179]="AddF64x2",e[e.SubF64x2=180]="SubF64x2",e[e.MulF64x2=181]="MulF64x2",e[e.DivF64x2=182]="DivF64x2",e[e.MinF64x2=183]="MinF64x2",e[e.MaxF64x2=184]="MaxF64x2",e[e.PminF64x2=185]="PminF64x2",e[e.PmaxF64x2=186]="PmaxF64x2",e[e.NarrowI16x8ToI8x16=187]="NarrowI16x8ToI8x16",e[e.NarrowU16x8ToU8x16=188]="NarrowU16x8ToU8x16",e[e.NarrowI32x4ToI16x8=189]="NarrowI32x4ToI16x8",e[e.NarrowU32x4ToU16x8=190]="NarrowU32x4ToU16x8",e[e.SwizzleV8x16=191]="SwizzleV8x16",e[e._last=191]="_last",e[e.AddSize=192]="AddSize",e[e.SubSize=193]="SubSize",e[e.MulSize=194]="MulSize",e[e.DivISize=195]="DivISize",e[e.DivUSize=196]="DivUSize",e[e.RemISize=197]="RemISize",e[e.RemUSize=198]="RemUSize",e[e.AndSize=199]="AndSize",e[e.OrSize=200]="OrSize",e[e.XorSize=201]="XorSize",e[e.ShlSize=202]="ShlSize",e[e.ShrISize=203]="ShrISize",e[e.ShrUSize=204]="ShrUSize",e[e.RotlSize=205]="RotlSize",e[e.RotrSize=206]="RotrSize",e[e.EqSize=207]="EqSize",e[e.NeSize=208]="NeSize",e[e.LtISize=209]="LtISize",e[e.LtUSize=210]="LtUSize",e[e.LeISize=211]="LeISize",e[e.LeUSize=212]="LeUSize",e[e.GtISize=213]="GtISize",e[e.GtUSize=214]="GtUSize",e[e.GeISize=215]="GeISize",e[e.GeUSize=216]="GeUSize"}(c=t.BinaryOp||(t.BinaryOp={})),function(e){e[e.Add=0]="Add",e[e.Sub=1]="Sub",e[e.And=2]="And",e[e.Or=3]="Or",e[e.Xor=4]="Xor",e[e.Xchg=5]="Xchg"}(t.AtomicRMWOp||(t.AtomicRMWOp={})),function(e){e[e.ExtractLaneI8x16=0]="ExtractLaneI8x16",e[e.ExtractLaneU8x16=1]="ExtractLaneU8x16",e[e.ExtractLaneI16x8=2]="ExtractLaneI16x8",e[e.ExtractLaneU16x8=3]="ExtractLaneU16x8",e[e.ExtractLaneI32x4=4]="ExtractLaneI32x4",e[e.ExtractLaneI64x2=5]="ExtractLaneI64x2",e[e.ExtractLaneF32x4=6]="ExtractLaneF32x4",e[e.ExtractLaneF64x2=7]="ExtractLaneF64x2"}(t.SIMDExtractOp||(t.SIMDExtractOp={})),function(e){e[e.ReplaceLaneI8x16=0]="ReplaceLaneI8x16",e[e.ReplaceLaneI16x8=1]="ReplaceLaneI16x8",e[e.ReplaceLaneI32x4=2]="ReplaceLaneI32x4",e[e.ReplaceLaneI64x2=3]="ReplaceLaneI64x2",e[e.ReplaceLaneF32x4=4]="ReplaceLaneF32x4",e[e.ReplaceLaneF64x2=5]="ReplaceLaneF64x2"}(t.SIMDReplaceOp||(t.SIMDReplaceOp={})),function(e){e[e.ShlI8x16=0]="ShlI8x16",e[e.ShrI8x16=1]="ShrI8x16",e[e.ShrU8x16=2]="ShrU8x16",e[e.ShlI16x8=3]="ShlI16x8",e[e.ShrI16x8=4]="ShrI16x8",e[e.ShrU16x8=5]="ShrU16x8",e[e.ShlI32x4=6]="ShlI32x4",e[e.ShrI32x4=7]="ShrI32x4",e[e.ShrU32x4=8]="ShrU32x4",e[e.ShlI64x2=9]="ShlI64x2",e[e.ShrI64x2=10]="ShrI64x2",e[e.ShrU64x2=11]="ShrU64x2"}(t.SIMDShiftOp||(t.SIMDShiftOp={})),function(e){e[e.Bitselect=0]="Bitselect",e[e.QFMAF32x4=1]="QFMAF32x4",e[e.QFMSF32x4=2]="QFMSF32x4",e[e.QFMAF64x2=3]="QFMAF64x2",e[e.QFMSF64x2=4]="QFMSF64x2",e[e.SignSelectV8x16=5]="SignSelectV8x16",e[e.SignSelectV16x8=6]="SignSelectV16x8",e[e.SignSelectV32x4=7]="SignSelectV32x4",e[e.SignSelectV64x2=8]="SignSelectV64x2"}(t.SIMDTernaryOp||(t.SIMDTernaryOp={})),function(e){e[e.LoadSplatV8x16=0]="LoadSplatV8x16",e[e.LoadSplatV16x8=1]="LoadSplatV16x8",e[e.LoadSplatV32x4=2]="LoadSplatV32x4",e[e.LoadSplatV64x2=3]="LoadSplatV64x2",e[e.LoadI8ToI16x8=4]="LoadI8ToI16x8",e[e.LoadU8ToU16x8=5]="LoadU8ToU16x8",e[e.LoadI16ToI32x4=6]="LoadI16ToI32x4",e[e.LoadU16ToU32x4=7]="LoadU16ToU32x4",e[e.LoadI32ToI64x2=8]="LoadI32ToI64x2",e[e.LoadU32ToU64x2=9]="LoadU32ToU64x2",e[e.Load32Zero=10]="Load32Zero",e[e.Load64Zero=11]="Load64Zero"}(t.SIMDLoadOp||(t.SIMDLoadOp={})),function(e){e[e.LoadLaneV8x16=0]="LoadLaneV8x16",e[e.LoadLaneV16x8=1]="LoadLaneV16x8",e[e.LoadLaneV32x4=2]="LoadLaneV32x4",e[e.LoadLaneV64x2=3]="LoadLaneV64x2",e[e.StoreLaneV8x16=4]="StoreLaneV8x16",e[e.StoreLaneV16x8=5]="StoreLaneV16x8",e[e.StoreLaneV32x4=6]="StoreLaneV32x4",e[e.StoreLaneV64x2=7]="StoreLaneV64x2"}(t.SIMDLoadStoreLaneOp||(t.SIMDLoadStoreLaneOp={})),function(e){e[e.WidenSVecI8x16ToVecI32x4=0]="WidenSVecI8x16ToVecI32x4",e[e.WidenUVecI8x16ToVecI32x4=1]="WidenUVecI8x16ToVecI32x4"}(t.SIMDWidenOp||(t.SIMDWidenOp={})),function(e){e[e.RefIsNull=0]="RefIsNull",e[e.RefIsFunc=1]="RefIsFunc",e[e.RefIsData=2]="RefIsData",e[e.RefIsI31=3]="RefIsI31"}(t.RefIsOp||(t.RefIsOp={})),function(e){e[e.RefAsNonNull=0]="RefAsNonNull",e[e.RefAsFunc=1]="RefAsFunc",e[e.RefAsData=2]="RefAsData",e[e.RefAsI31=3]="RefAsI31"}(t.RefAsOp||(t.RefAsOp={})),function(e){e[e.BrOnNull=0]="BrOnNull",e[e.BrOnCast=1]="BrOnCast",e[e.BrOnFunc=2]="BrOnFunc",e[e.BrOnData=3]="BrOnData",e[e.BrOnI31=4]="BrOnI31"}(t.BrOnOp||(t.BrOnOp={})),function(e){e[e.Default=0]="Default",e[e.PreserveSideeffects=1]="PreserveSideeffects",e[e.TraverseCalls=2]="TraverseCalls"}(t.ExpressionRunnerFlags||(t.ExpressionRunnerFlags={}));t.MemorySegment=class{constructor(e,t){this.buffer=e,this.offset=t}};class _{constructor(e,t,r){this.ref=e,this.useShadowStack=t,this.sizeType=r,this.hasTemporaryFunction=!1,this.cachedStringsToPointers=new Map,this.cachedPointersToStrings=new Map,assert(r==a.I32||r==a.I64),this.lit=s._malloc(s._BinaryenSizeofLiteral())}static create(e,t){return new _(s._BinaryenModuleCreate(),e,t)}static createFrom(e,t,r){var i=I(e),n=new _(s._BinaryenModuleRead(i,e.length),t,r);return s._free(changetype(i)),n}i32(e){var t=this.lit;return s._BinaryenLiteralInt32(t,e),s._BinaryenConst(this.ref,t)}i64(e,t=0){var r=this.lit;return s._BinaryenLiteralInt64(r,e,t),s._BinaryenConst(this.ref,r)}usize(e){return i64_is(e)?this.sizeType==a.I64?this.i64(i64_low(e),i64_high(e)):(assert(i64_is_u32(e)),this.i32(i64_low(e))):this.sizeType==a.I64?this.i64(i32(e)):this.i32(i32(e))}f32(e){var t=this.lit;return s._BinaryenLiteralFloat32(t,e),s._BinaryenConst(this.ref,t)}f64(e){var t=this.lit;return s._BinaryenLiteralFloat64(t,e),s._BinaryenConst(this.ref,t)}v128(e){assert(16==e.length);var t=this.lit;for(let r=0;r<16;++r)s.__i32_store8(t+r,e[r]);return s._BinaryenLiteralVec128(t,t),s._BinaryenConst(this.ref,t)}ref_null(e){return s._BinaryenRefNull(this.ref,e)}ref_eq(e,t){return s._BinaryenRefEq(this.ref,e,t)}unary(e,t){if(e>u._last){let r=this.sizeType==a.I64;switch(e){case u.ClzSize:return this.unary(r?u.ClzI64:u.ClzI32,t);case u.CtzSize:return this.unary(r?u.CtzI64:u.CtzI32,t);case u.PopcntSize:return this.unary(r?u.PopcntI64:u.PopcntI32,t);case u.EqzSize:return this.unary(r?u.EqzI64:u.EqzI32,t)}assert(!1)}return s._BinaryenUnary(this.ref,e,t)}binary(e,t,r){if(e>c._last){let i=this.sizeType==a.I64;switch(e){case c.AddSize:return this.binary(i?c.AddI64:c.AddI32,t,r);case c.SubSize:return this.binary(i?c.SubI64:c.SubI32,t,r);case c.MulSize:return this.binary(i?c.MulI64:c.MulI32,t,r);case c.DivISize:return this.binary(i?c.DivI64:c.DivI32,t,r);case c.DivUSize:return this.binary(i?c.DivU64:c.DivU32,t,r);case c.RemISize:return this.binary(i?c.RemI64:c.RemI32,t,r);case c.RemUSize:return this.binary(i?c.RemU64:c.RemU32,t,r);case c.AndSize:return this.binary(i?c.AndI64:c.AndI32,t,r);case c.OrSize:return this.binary(i?c.OrI64:c.OrI32,t,r);case c.XorSize:return this.binary(i?c.XorI64:c.XorI32,t,r);case c.ShlSize:return this.binary(i?c.ShlI64:c.ShlI32,t,r);case c.ShrISize:return this.binary(i?c.ShrI64:c.ShrI32,t,r);case c.ShrUSize:return this.binary(i?c.ShrU64:c.ShrU32,t,r);case c.RotlSize:return this.binary(i?c.RotlI64:c.RotlI32,t,r);case c.RotrSize:return this.binary(i?c.RotrI64:c.RotrI32,t,r);case c.EqSize:return this.binary(i?c.EqI64:c.EqI32,t,r);case c.NeSize:return this.binary(i?c.NeI64:c.NeI32,t,r);case c.LtISize:return this.binary(i?c.LtI64:c.LtI32,t,r);case c.LtUSize:return this.binary(i?c.LtU64:c.LtU32,t,r);case c.LeISize:return this.binary(i?c.LeI64:c.LeI32,t,r);case c.LeUSize:return this.binary(i?c.LeU64:c.LeU32,t,r);case c.GtISize:return this.binary(i?c.GtI64:c.GtI32,t,r);case c.GtUSize:return this.binary(i?c.GtU64:c.GtU32,t,r);case c.GeISize:return this.binary(i?c.GeI64:c.GeI32,t,r);case c.GeUSize:return this.binary(i?c.GeU64:c.GeU32,t,r)}assert(!1)}return s._BinaryenBinary(this.ref,e,t,r)}memory_size(){return s._BinaryenMemorySize(this.ref)}memory_grow(e){return s._BinaryenMemoryGrow(this.ref,e)}local_get(e,t){return s._BinaryenLocalGet(this.ref,e,t)}tostack(e){if(this.useShadowStack){let t=s._BinaryenExpressionGetType(e);return assert(t==a.I32||t==a.Unreachable),this.call(i.BuiltinNames.tostack,[e],t)}return e}local_tee(e,t,r,i=a.Auto){return i==a.Auto&&(i=s._BinaryenExpressionGetType(t)),r&&this.useShadowStack&&(t=this.tostack(t)),s._BinaryenLocalTee(this.ref,e,t,i)}global_get(e,t){var r=this.allocStringCached(e);return s._BinaryenGlobalGet(this.ref,r,t)}load(e,t,r,i,n=0,a=e){return s._BinaryenLoad(this.ref,e,t,n,a,i,r)}store(e,t,r,i,n=0,a=e){return s._BinaryenStore(this.ref,e,n,a,t,r,i)}atomic_load(e,t,r,i=0){return s._BinaryenAtomicLoad(this.ref,e,i,r,t)}atomic_store(e,t,r,i,n=0){return s._BinaryenAtomicStore(this.ref,e,n,t,r,i)}atomic_rmw(e,t,r,i,n,a){return s._BinaryenAtomicRMW(this.ref,e,t,r,i,n,a)}atomic_cmpxchg(e,t,r,i,n,a){return s._BinaryenAtomicCmpxchg(this.ref,e,t,r,i,n,a)}atomic_wait(e,t,r,i){return s._BinaryenAtomicWait(this.ref,e,t,r,i)}atomic_notify(e,t){return s._BinaryenAtomicNotify(this.ref,e,t)}atomic_fence(){return s._BinaryenAtomicFence(this.ref)}local_set(e,t,r){return r&&this.useShadowStack&&(t=this.tostack(t)),s._BinaryenLocalSet(this.ref,e,t)}global_set(e,t){var r=this.allocStringCached(e);return s._BinaryenGlobalSet(this.ref,r,t)}block(e,t,r=a.None){var i=this.allocStringCached(e),n=A(t),o=s._BinaryenBlock(this.ref,i,n,t.length,r);return s._free(n),o}flatten(e,t=a.None){var r=e.length;if(0==r)return this.nop();if(1==r){let r=e[0];switch(d(r)){case l.Return:case l.Throw:case l.Unreachable:return r}let i=m(r);return assert(i==a.Unreachable||i==t),r}return this.block(null,e,t)}br(e,t=0,r=0){var i=this.allocStringCached(e);return s._BinaryenBreak(this.ref,i,t,r)}drop(e){return s._BinaryenDrop(this.ref,e)}maybeDropCondition(e,t){return 0!=(x(e)&~(p.ReadsLocal|p.ReadsGlobal))?this.block(null,[this.drop(e),t],m(t)):t}loop(e,t){var r=this.allocStringCached(e);return s._BinaryenLoop(this.ref,r,t)}if(e,t,r=0){return s._BinaryenIf(this.ref,e,t,r)}nop(){return s._BinaryenNop(this.ref)}return(e=0){return s._BinaryenReturn(this.ref,e)}select(e,t,r,i=a.Auto){return i==a.Auto&&(i=s._BinaryenExpressionGetType(e),assert(i==s._BinaryenExpressionGetType(t))),s._BinaryenSelect(this.ref,r,e,t,i)}switch(e,t,r,i=0){var n=e.length,a=new Array(n);for(let t=0;t<n;++t)a[t]=this.allocStringCached(e[t]);var o=A(a),l=this.allocStringCached(t),u=s._BinaryenSwitch(this.ref,o,n,l,r,i);return s._free(o),u}call(e,t,r,i=!1){var n=this.allocStringCached(e),a=A(t),o=i?s._BinaryenReturnCall(this.ref,n,a,t?t.length:0,r):s._BinaryenCall(this.ref,n,a,t?t.length:0,r);return s._free(a),o}return_call(e,t,r){return this.call(e,t,r,!0)}call_indirect(e,t,r,i,n=!1){var a=this.allocStringCached("0"),o=A(t),l=n?s._BinaryenReturnCallIndirect(this.ref,a,e,o,t?t.length:0,r,i):s._BinaryenCallIndirect(this.ref,a,e,o,t?t.length:0,r,i);return s._free(o),l}return_call_indirect(e,t,r,i){return this.call_indirect(e,t,r,i,!0)}unreachable(){return s._BinaryenUnreachable(this.ref)}memory_copy(e,t,r){return s._BinaryenMemoryCopy(this.ref,e,t,r)}memory_fill(e,t,r){return s._BinaryenMemoryFill(this.ref,e,t,r)}throw(e,t){var r=this.allocStringCached(e),i=A(t),n=s._BinaryenThrow(this.ref,r,i,t.length);return s._free(i),n}rethrow(e){var t=this.allocStringCached(e);return s._BinaryenRethrow(this.ref,t)}pop(e){return s._BinaryenPop(this.ref,e)}tuple_make(e){var t=A(e),r=s._BinaryenTupleMake(this.ref,t,e.length);return s._free(t),r}tuple_extract(e,t){return s._BinaryenTupleExtract(this.ref,e,t)}simd_extract(e,t,r){return s._BinaryenSIMDExtract(this.ref,e,t,r)}simd_replace(e,t,r,i){return s._BinaryenSIMDReplace(this.ref,e,t,r,i)}simd_shuffle(e,t,r){assert(16==r.length);var i=I(r),n=s._BinaryenSIMDShuffle(this.ref,e,t,i);return s._free(i),n}simd_ternary(e,t,r,i){return s._BinaryenSIMDTernary(this.ref,e,t,r,i)}simd_shift(e,t,r){return s._BinaryenSIMDShift(this.ref,e,t,r)}simd_load(e,t,r,i){return s._BinaryenSIMDLoad(this.ref,e,r,i,t)}ref_is(e,t){return s._BinaryenRefIs(this.ref,e,t)}ref_as(e,t){return s._BinaryenRefAs(this.ref,e,t)}ref_func(e,t){var r=this.allocStringCached(e);return s._BinaryenRefFunc(this.ref,r,t)}i31_new(e){return s._BinaryenI31New(this.ref,e)}i31_get(e,t){return s._BinaryenI31Get(this.ref,e,t)}addGlobal(e,t,r,i){var n=this.allocStringCached(e);return s._BinaryenAddGlobal(this.ref,n,t,r,i)}getGlobal(e){var t=this.allocStringCached(e);return s._BinaryenGetGlobal(this.ref,t)}removeGlobal(e){var t=this.allocStringCached(e);s._BinaryenRemoveGlobal(this.ref,t)}addEvent(e,t,r,i){var n=this.allocStringCached(e);return s._BinaryenAddEvent(this.ref,n,t,r,i)}getEvent(e){var t=this.allocStringCached(e);return s._BinaryenGetEvent(this.ref,t)}removeEvent(e){var t=this.allocStringCached(e);s._BinaryenRemoveEvent(this.ref,t)}addFunction(e,t,r,i,n){var a=this.allocStringCached(e),o=A(i),l=s._BinaryenAddFunction(this.ref,a,t,r,o,i?i.length:0,n);return s._free(o),l}getFunction(e){var t=this.allocStringCached(e);return s._BinaryenGetFunction(this.ref,t)}removeFunction(e){var t=this.allocStringCached(e);s._BinaryenRemoveFunction(this.ref,t)}hasFunction(e){var t=this.allocStringCached(e);return 0!=s._BinaryenGetFunction(this.ref,t)}addTemporaryFunction(e,t,r){this.hasTemporaryFunction=assert(!this.hasTemporaryFunction);var i=this.allocStringCached(""),n=A(t),a=s._BinaryenAddFunction(this.ref,i,h(t),e,0,0,r);return s._free(n),a}removeTemporaryFunction(){this.hasTemporaryFunction=!assert(this.hasTemporaryFunction);var e=this.allocStringCached("");s._BinaryenRemoveFunction(this.ref,e)}setStart(e){s._BinaryenSetStart(this.ref,e)}addFunctionExport(e,t){var r=this.allocStringCached(e),i=this.allocStringCached(t);return s._BinaryenAddFunctionExport(this.ref,r,i)}addTableExport(e,t){var r=this.allocStringCached(e),i=this.allocStringCached(t);return s._BinaryenAddTableExport(this.ref,r,i)}addMemoryExport(e,t){var r=this.allocStringCached(e),i=this.allocStringCached(t);return s._BinaryenAddMemoryExport(this.ref,r,i)}addGlobalExport(e,t){var r=this.allocStringCached(e),i=this.allocStringCached(t);return s._BinaryenAddGlobalExport(this.ref,r,i)}addEventExport(e,t){var r=this.allocStringCached(e),i=this.allocStringCached(t);return s._BinaryenAddEventExport(this.ref,r,i)}removeExport(e){var t=this.allocStringCached(e);s._BinaryenRemoveExport(this.ref,t)}hasExport(e){var t=this.allocStringCached(e);return 0!=s._BinaryenGetExport(this.ref,t)}addFunctionImport(e,t,r,i,n){var a=this.allocStringCached(e),o=this.allocStringCached(t),l=this.allocStringCached(r);s._BinaryenAddFunctionImport(this.ref,a,o,l,i,n)}addTableImport(e,t,r){var i=this.allocStringCached(e),n=this.allocStringCached(t),a=this.allocStringCached(r);s._BinaryenAddTableImport(this.ref,i,n,a)}addMemoryImport(e,t,r,i=!1){var n=this.allocStringCached(e),a=this.allocStringCached(t),o=this.allocStringCached(r);s._BinaryenAddMemoryImport(this.ref,n,a,o,i)}addGlobalImport(e,t,r,i,n=!1){var a=this.allocStringCached(e),o=this.allocStringCached(t),l=this.allocStringCached(r);s._BinaryenAddGlobalImport(this.ref,a,o,l,i,n)}addEventImport(e,t,r,i,n,a){var o=this.allocStringCached(e),l=this.allocStringCached(t),u=this.allocStringCached(r);s._BinaryenAddEventImport(this.ref,o,l,u,i,n,a)}setMemory(e,t,r,i,a=null,o=!1){var l=this.allocStringCached(a),u=r.length,c=new Array(u),p=new Uint8Array(u),_=new Array(u),h=new Array(u);for(let e=0;e<u;++e){let t=r[e],s=t.buffer,a=t.offset;c[e]=I(s),p[e]=0,_[e]=i==n.Target.WASM64?this.i64(i64_low(a),i64_high(a)):this.i32(i64_low(a)),h[e]=s.length}var d=A(c),m=I(p),y=A(_),T=function(e){if(!e)return 0;var t=e.length,r=s._malloc(t<<2),i=r;for(let r=0;r<t;++r){let t=e[r];s.__i32_store(i,t),i+=4}return r}(h);s._BinaryenSetMemory(this.ref,e,t,l,d,m,y,T,u,o),s._free(T),s._free(y),s._free(m),s._free(d);for(let e=u-1;e>=0;--e)s._free(c[e])}setFunctionTable(e,t,r,i){var n=r.length,a=new Array(n);for(let e=0;e<n;++e)a[e]=this.allocStringCached(r[e]);var o=A(a);s._BinaryenSetFunctionTable(this.ref,e,t,o,n,i),s._free(o)}addCustomSection(e,t){var r=this.allocStringCached(e),i=I(t);s._BinaryenAddCustomSection(this.ref,r,i,t.length),s._free(i)}getOptimizeLevel(){return s._BinaryenGetOptimizeLevel()}setOptimizeLevel(e){s._BinaryenSetOptimizeLevel(e)}getShrinkLevel(){return s._BinaryenGetShrinkLevel()}setShrinkLevel(e){s._BinaryenSetShrinkLevel(e)}getDebugInfo(){return s._BinaryenGetDebugInfo()}setDebugInfo(e){s._BinaryenSetDebugInfo(e)}getLowMemoryUnused(){return s._BinaryenGetLowMemoryUnused()}setLowMemoryUnused(e){s._BinaryenSetLowMemoryUnused(e)}getFastMath(){return s._BinaryenGetFastMath()}setFastMath(e){s._BinaryenSetFastMath(e)}getPassArgument(e){var t=this.allocStringCached(e),r=s._BinaryenGetPassArgument(t);return r?S(r):null}setPassArgument(e,t){var r=this.allocStringCached(e),i=this.allocStringCached(t);s._BinaryenSetPassArgument(r,i)}clearPassArguments(){s._BinaryenClearPassArguments()}getAlwaysInlineMaxSize(){return s._BinaryenGetAlwaysInlineMaxSize()}setAlwaysInlineMaxSize(e){s._BinaryenSetAlwaysInlineMaxSize(e)}getFlexibleInlineMaxSize(){return s._BinaryenGetFlexibleInlineMaxSize()}setFlexibleInlineMaxSize(e){s._BinaryenSetFlexibleInlineMaxSize(e)}getOneCallerInlineMaxSize(){return s._BinaryenGetOneCallerInlineMaxSize()}setOneCallerInlineMaxSize(e){s._BinaryenSetOneCallerInlineMaxSize(e)}getAllowInliningFunctionsWithLoops(){return s._BinaryenGetAllowInliningFunctionsWithLoops()}setAllowInliningFunctionsWithLoops(e){s._BinaryenSetAllowInliningFunctionsWithLoops(e)}getFeatures(){return s._BinaryenModuleGetFeatures(this.ref)}setFeatures(e){s._BinaryenModuleSetFeatures(this.ref,e)}runPass(e,t=0){var r=N(e);t?s._BinaryenFunctionRunPasses(t,this.ref,r,1):s._BinaryenModuleRunPasses(this.ref,r,1),s._free(r)}runPasses(e,t=0){var r=e.length,i=new Array(r);for(let t=0;t<r;++t)i[t]=N(e[t]);var n=A(i);t?s._BinaryenFunctionRunPasses(t,this.ref,n,r):s._BinaryenModuleRunPasses(this.ref,n,r),s._free(n);for(let e=r-1;e>=0;--e)s._free(i[e])}optimize(e,t,r=!1){if((e>=3||t>=2)&&(e=4),this.setOptimizeLevel(e),this.setShrinkLevel(t),this.setDebugInfo(r),this.setFastMath(!0),this.clearPassArguments(),e>=2&&0==t?(this.setAlwaysInlineMaxSize(12),this.setFlexibleInlineMaxSize(70),this.setOneCallerInlineMaxSize(200),this.setAllowInliningFunctionsWithLoops(e>=3)):(this.setAlwaysInlineMaxSize(e<=1||t>=2?2:6),this.setFlexibleInlineMaxSize(65),this.setOneCallerInlineMaxSize(80),this.setAllowInliningFunctionsWithLoops(!1)),e>0||t>0){let r=new Array;r.push("duplicate-function-elimination"),r.push("remove-unused-module-elements"),(e>=3||t>=1)&&(r.push("simplify-locals-notee-nostructure"),r.push("rse"),r.push("vacuum"),r.push("ssa-nomerge"),r.push("simplify-globals-optimizing"),r.push("remove-unused-brs"),r.push("remove-unused-names"),r.push("merge-blocks"),r.push("precompute-propagate")),e>=3&&(r.push("flatten"),r.push("vacuum"),r.push("simplify-locals-notee-nostructure"),r.push("merge-locals"),r.push("code-folding"),r.push("flatten"),r.push("vacuum"),r.push("local-cse"),r.push("reorder-locals")),r.push("optimize-instructions"),(e>=3||t>=1)&&r.push("dce"),r.push("remove-unused-names"),r.push("remove-unused-brs"),e>=3||t>=2?(r.push("inlining"),r.push("precompute-propagate")):r.push("precompute"),(e>=2||t>=1)&&(r.push("pick-load-signs"),r.push("simplify-globals-optimizing")),e>=3&&t<=1&&r.push("licm"),r.push("simplify-locals-nostructure"),r.push("vacuum"),r.push("reorder-locals"),r.push("remove-unused-brs"),r.push("coalesce-locals"),r.push("simplify-locals"),r.push("vacuum"),r.push("reorder-locals"),r.push("coalesce-locals"),r.push("reorder-locals"),(e>=3||t>=1)&&r.push("merge-locals"),r.push("vacuum"),(e>=2||t>=1)&&r.push("simplify-globals-optimizing"),r.push("merge-blocks"),r.push("remove-unused-brs"),r.push("remove-unused-names"),r.push("merge-blocks"),e>=3&&r.push("optimize-instructions"),(e>=2||t>=1)&&(r.push("rse"),r.push("vacuum")),(e>=2||t>=1)&&(r.push("simplify-globals-optimizing"),r.push("dae-optimizing")),(e>=2||t>=2)&&r.push("inlining-optimizing"),this.getLowMemoryUnused()&&(e>=3||t>=1?r.push("optimize-added-constants-propagate"):r.push("optimize-added-constants")),r.push("duplicate-import-elimination"),e>=2||t>=2?r.push("simplify-globals-optimizing"):(r.push("simplify-globals"),r.push("vacuum")),(e>=3||t>=1)&&r.push("code-folding"),e>=2||t>=1?r.push("precompute-propagate"):r.push("precompute"),r.push("directize"),r.push("dae-optimizing"),r.push("inlining-optimizing"),(e>=2||t>=1)&&(r.push("rse"),r.push("code-pushing"),e>=3&&(r.push("simplify-globals"),r.push("vacuum"),r.push("precompute-propagate"),r.push("inlining-optimizing"),r.push("directize"),r.push("dae-optimizing"),r.push("merge-locals"),r.push("coalesce-locals"),r.push("simplify-locals"),r.push("vacuum"),r.push("inlining"),r.push("precompute-propagate"),r.push("vacuum"),r.push("coalesce-locals")),r.push("remove-unused-brs"),r.push("remove-unused-names"),r.push("vacuum"),r.push("optimize-instructions"),r.push("simplify-globals-optimizing")),r.push("duplicate-function-elimination"),r.push("remove-unused-nonfunction-module-elements"),r.push("memory-packing"),r.push("remove-unused-module-elements"),this.runPasses(r)}}validate(){return 1==s._BinaryenModuleValidate(this.ref)}interpret(){s._BinaryenModuleInterpret(this.ref)}toBinary(e=null){var t=this.lit;assert(s._BinaryenSizeofLiteral()>=12);var r,i,n=N(e);s._BinaryenModuleAllocateAndWrite(t,this.ref,n),r=assert(s.__i32_load(t));var a=s.__i32_load(t+4);i=s.__i32_load(t+8);var o=new v(function(e,t){var r=new Uint8Array(t);for(let i=0;i<t;++i)r[i]=s.__i32_load8_u(e+i);return r}(r,a),S(i));return n&&s._free(n),s._free(r),i&&s._free(i),o}toText(e=!0){throw new Error("not implemented")}toAsmjs(){throw new Error("not implemented")}allocStringCached(e){if(null===e)return 0;var t=this.cachedStringsToPointers;if(t.has(e))return changetype(t.get(e));var r=N(e);return t.set(e,r),r}readStringCached(e){if(0==e)return null;var t=this.cachedPointersToStrings;if(t.has(e))return changetype(this.cachedPointersToStrings.get(e));var r=S(e);return t.set(e,r),r}dispose(){assert(this.ref);for(let e=Map_values(this.cachedStringsToPointers),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);s._free(r)}this.cachedStringsToPointers.clear(),this.cachedPointersToStrings.clear(),s._free(this.lit),s._BinaryenModuleDispose(this.ref),this.ref=0}createRelooper(){return b.create(this)}cloneExpression(e,t=!1,r=i32.MAX_VALUE){if(r<0)return 0;var i,n;switch(r-=1,s._BinaryenExpressionGetId(e)){case l.Const:switch(s._BinaryenExpressionGetType(e)){case a.I32:return this.i32(s._BinaryenConstGetValueI32(e));case a.I64:return this.i64(s._BinaryenConstGetValueI64Low(e),s._BinaryenConstGetValueI64High(e));case a.F32:return this.f32(s._BinaryenConstGetValueF32(e));case a.F64:return this.f64(s._BinaryenConstGetValueF64(e));case a.V128:case a.Externref:return 0;default:throw new Error("concrete type expected")}case l.LocalGet:return s._BinaryenLocalGet(this.ref,s._BinaryenLocalGetGetIndex(e),s._BinaryenExpressionGetType(e));case l.GlobalGet:{let t=s._BinaryenGlobalGetGetName(e);if(!t)break;return s._BinaryenGlobalGet(this.ref,t,s._BinaryenExpressionGetType(e))}case l.Load:if(!(i=this.cloneExpression(s._BinaryenLoadGetPtr(e),t,r)))break;return s._BinaryenLoadIsAtomic(e)?s._BinaryenAtomicLoad(this.ref,s._BinaryenLoadGetBytes(e),s._BinaryenLoadGetOffset(e),s._BinaryenExpressionGetType(e),i):s._BinaryenLoad(this.ref,s._BinaryenLoadGetBytes(e),s._BinaryenLoadIsSigned(e),s._BinaryenLoadGetOffset(e),s._BinaryenLoadGetAlign(e),s._BinaryenExpressionGetType(e),i);case l.Unary:if(!(i=this.cloneExpression(s._BinaryenUnaryGetValue(e),t,r)))break;return s._BinaryenUnary(this.ref,s._BinaryenUnaryGetOp(e),i);case l.Binary:if(!(i=this.cloneExpression(s._BinaryenBinaryGetLeft(e),t,r)))break;if(!(n=this.cloneExpression(s._BinaryenBinaryGetRight(e),t,r)))break;return s._BinaryenBinary(this.ref,s._BinaryenBinaryGetOp(e),i,n)}return 0}copyExpression(e){return s._BinaryenExpressionCopy(e,this.ref)}runExpression(e,t,r=50,i=1){var n=s._ExpressionRunnerCreate(this.ref,t,r,i),a=s._ExpressionRunnerRunAndDispose(n,e);return a&&(assert(d(a)==l.Const),assert(m(a)==m(e))),a}addDebugInfoFile(e){var t=N(e),r=s._BinaryenModuleAddDebugInfoFileName(this.ref,t);return s._free(t),r}getDebugInfoFile(e){return S(s._BinaryenModuleGetDebugInfoFileName(this.ref,e))}setDebugLocation(e,t,r,i,n){s._BinaryenFunctionSetDebugLocation(e,t,r,i,n)}}function h(e){if(!e)return a.None;switch(e.length){case 0:return a.None;case 1:return e[0]}var t=A(e),r=s._BinaryenTypeCreate(t,e.length);return s._free(t),r}function d(e){return s._BinaryenExpressionGetId(e)}function m(e){return s._BinaryenExpressionGetType(e)}function y(e){return s._BinaryenConstGetValueI32(e)}function T(e){return s._BinaryenConstGetValueI64Low(e)}function g(e){return s._BinaryenConstGetValueI64High(e)}function f(e){return s._BinaryenConstGetValueF32(e)}function E(e){return s._BinaryenConstGetValueF64(e)}t.Module=_,_.UNLIMITED_MEMORY=-1,_.UNLIMITED_TABLE=-1,t.createType=h,t.expandType=function(e){var t=s._BinaryenTypeArity(e),r=s._malloc(t<<2);s._BinaryenTypeExpand(e,r);var i=new Array(t);for(let e=0;e<t;++e)i[e]=s.__i32_load(r+(e<<2));return s._free(r),i},t.getExpressionId=d,t.getExpressionType=m,t.getConstValueI32=y,t.getConstValueI64Low=T,t.getConstValueI64High=g,t.getConstValueF32=f,t.getConstValueF64=E,t.isConstZero=function(e){if(d(e)!=l.Const)return!1;var t=m(e);return t==a.I32?0==y(e):t==a.I64?0==T(e)&&0==g(e):t==a.F32?0==f(e):t==a.F64&&0==E(e)},t.getLocalGetIndex=function(e){return s._BinaryenLocalGetGetIndex(e)},t.getLocalSetIndex=function(e){return s._BinaryenLocalSetGetIndex(e)},t.getLocalSetValue=function(e){return s._BinaryenLocalSetGetValue(e)},t.isLocalTee=function(e){return s._BinaryenLocalSetIsTee(e)},t.getGlobalGetName=function(e){return S(s._BinaryenGlobalGetGetName(e))},t.getBinaryOp=function(e){return s._BinaryenBinaryGetOp(e)},t.getBinaryLeft=function(e){return s._BinaryenBinaryGetLeft(e)},t.getBinaryRight=function(e){return s._BinaryenBinaryGetRight(e)},t.getUnaryOp=function(e){return s._BinaryenUnaryGetOp(e)},t.getUnaryValue=function(e){return s._BinaryenUnaryGetValue(e)},t.getLoadBytes=function(e){return s._BinaryenLoadGetBytes(e)},t.getLoadOffset=function(e){return s._BinaryenLoadGetOffset(e)},t.getLoadPtr=function(e){return s._BinaryenLoadGetPtr(e)},t.isLoadSigned=function(e){return s._BinaryenLoadIsSigned(e)},t.getStoreBytes=function(e){return s._BinaryenStoreGetBytes(e)},t.getStoreOffset=function(e){return s._BinaryenStoreGetOffset(e)},t.getStorePtr=function(e){return s._BinaryenStoreGetPtr(e)},t.getStoreValue=function(e){return s._BinaryenStoreGetValue(e)},t.getBlockName=function(e){return S(s._BinaryenBlockGetName(e))},t.getBlockChildCount=function(e){return s._BinaryenBlockGetNumChildren(e)},t.getBlockChildAt=function(e,t){return s._BinaryenBlockGetChildAt(e,t)},t.getIfCondition=function(e){return s._BinaryenIfGetCondition(e)},t.getIfTrue=function(e){return s._BinaryenIfGetIfTrue(e)},t.getIfFalse=function(e){return s._BinaryenIfGetIfFalse(e)},t.getLoopName=function(e){return S(s._BinaryenLoopGetName(e))},t.getLoopBody=function(e){return s._BinaryenLoopGetBody(e)},t.getBreakName=function(e){return S(s._BinaryenBreakGetName(e))},t.getBreakCondition=function(e){return s._BinaryenBreakGetCondition(e)},t.getSelectThen=function(e){return s._BinaryenSelectGetIfTrue(e)},t.getSelectElse=function(e){return s._BinaryenSelectGetIfFalse(e)},t.getSelectCondition=function(e){return s._BinaryenSelectGetCondition(e)},t.getDropValue=function(e){return s._BinaryenDropGetValue(e)},t.getReturnValue=function(e){return s._BinaryenReturnGetValue(e)},t.getCallTarget=function(e){return S(s._BinaryenCallGetTarget(e))},t.getCallOperandCount=function(e){return s._BinaryenCallGetNumOperands(e)},t.getCallOperandAt=function(e,t){return s._BinaryenCallGetOperandAt(e,t)},t.getMemoryGrowDelta=function(e){return s._BinaryenMemoryGrowGetDelta(e)},t.getFunctionBody=function(e){return s._BinaryenFunctionGetBody(e)},t.getFunctionName=function(e){return S(s._BinaryenFunctionGetName(e))},t.getFunctionParams=function(e){return s._BinaryenFunctionGetParams(e)},t.getFunctionResults=function(e){return s._BinaryenFunctionGetResults(e)},t.getFunctionVars=function(e){var t=s._BinaryenFunctionGetNumVars(e),r=new Array(t);for(let i=0;i<t;++i)r[i]=s._BinaryenFunctionGetVar(e,i);return r},t.getGlobalName=function(e){return S(s._BinaryenGlobalGetName(e))},t.getGlobalType=function(e){return s._BinaryenGlobalGetType(e)},t.isGlobalMutable=function(e){return s._BinaryenGlobalIsMutable(e)},t.getGlobalInit=function(e){return s._BinaryenGlobalGetInitExpr(e)},t.getEventName=function(e){return S(s._BinaryenEventGetName(e))},t.getEventAttribute=function(e){return s._BinaryenEventGetAttribute(e)},t.getEventParams=function(e){return s._BinaryenEventGetParams(e)},t.getEventResults=function(e){return s._BinaryenEventGetResults(e)};class b{constructor(e,t){this.module=e,this.ref=t}static create(e){return new b(e,s._RelooperCreate(e.ref))}addBlock(e){return s._RelooperAddBlock(this.ref,e)}addBranch(e,t,r=0,i=0){s._RelooperAddBranch(e,t,r,i)}addBlockWithSwitch(e,t){return s._RelooperAddBlockWithSwitch(this.ref,e,t)}addBranchForSwitch(e,t,r,i=0){var n=function(e){if(!e)return 0;var t=e.length,r=s._malloc(t<<2),i=r;for(let r=0;r<t;++r){let t=e[r];s.__i32_store(i,t),i+=4}return r}(r);s._RelooperAddBranchForSwitch(e,t,n,r.length,i),s._free(n)}renderAndDispose(e,t){return s._RelooperRenderAndDispose(this.ref,e,t)}}t.Relooper=b;function x(e,t=o.All){return s._BinaryenExpressionGetSideEffects(e,t)}function I(e){if(!e)return 0;var t=e.length,r=s._malloc(t);for(let i=0;i<t;++i)s.__i32_store8(r+i,e[i]);return r}function A(e){if(!e)return 0;assert(ASC_TARGET!=n.Target.WASM64);var t=e.length,r=s._malloc(t<<2),i=r;for(let r=0,n=t;r<n;++r){let t=e[r];s.__i32_store(i,t),i+=4}return r}function N(e){if(null===e)return 0;var t=s._malloc(function(e){var t=0;for(let r=0,i=e.length;r<i;++r){let n=e.charCodeAt(r);n>=55296&&n<=57343&&r+1<i&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++r)),t+=n<=127?1:n<=2047?2:n<=65535?3:4}return t}(e)+1)>>>0,r=t;for(let t=0,i=e.length;t<i;++t){let n=e.charCodeAt(t);n>=55296&&n<=57343&&t+1<i&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++t)),n<=127?s.__i32_store8(r++,n):n<=2047?(s.__i32_store8(r++,192|n>>>6),s.__i32_store8(r++,128|63&n)):n<=65535?(s.__i32_store8(r++,224|n>>>12),s.__i32_store8(r++,128|n>>>6&63),s.__i32_store8(r++,128|63&n)):(assert(n<2097152,"Invalid Unicode code point during allocString"),s.__i32_store8(r++,240|n>>>18),s.__i32_store8(r++,128|n>>>12&63),s.__i32_store8(r++,128|n>>>6&63),s.__i32_store8(r++,128|63&n))}return s.__i32_store8(r,0),t}function S(e){if(!e)return null;for(var t,r,i,n,a=new Array;t=s.__i32_load8_u(e++);)if(128&t)if(r=63&s.__i32_load8_u(e++),192!=(224&t))if(i=63&s.__i32_load8_u(e++),224==(240&t)?t=(15&t)<<12|r<<6|i:(n=63&s.__i32_load8_u(e++),240==(248&t)?t=(7&t)<<18|r<<12|i<<6|n:assert(!1,"Invalid UTF8 sequence during readString")),t<65536)a.push(t);else{let e=t-65536;a.push(55296|e>>>10),a.push(56320|1023&e)}else a.push((31&t)<<6|r);else a.push(t);return String.fromCharCodes(a)}t.SwitchBuilder=class{constructor(e,t){this.values=new Array,this.indexes=new Array,this.cases=new Array,this.defaultIndex=-1,this.module=e,this.condition=t}addCase(e,t){var r=this.cases,i=r.indexOf(t);i<0&&(i=r.length,r.push(t)),this.values.push(e),this.indexes.push(i)}addDefault(e){assert(-1==this.defaultIndex);var t=this.cases;this.defaultIndex=t.length,t.push(e)}render(e,t=""){var r=this.module,i=this.cases,n=i.length;if(!n)return r.drop(this.condition);var s=this.values,o=s.length,l=this.indexes,u=new Array(1+o+1),p=new Array(n);for(let e=0;e<n;++e)p[e]="case"+e.toString()+t;u[0]=r.local_set(e,this.condition,!1);for(let t=0;t<o;++t){let i=l[t];u[1+t]=r.br(p[i],r.binary(c.EqI32,r.local_get(e,a.I32),r.i32(s[t])))}var _=this.defaultIndex,h="default"+t;u[1+o]=r.br(~_?p[_]:h);var d=r.block(p[0],u);for(let e=1;e<n;++e){let t=i[e-1];t.unshift(d),d=r.block(p[e],t)}var m=i[n-1];return m.unshift(d),r.block(~_?null:h,m)}},function(e){e[e.None=0]="None",e[e.Branches=1]="Branches",e[e.Calls=2]="Calls",e[e.ReadsLocal=4]="ReadsLocal",e[e.WritesLocal=8]="WritesLocal",e[e.ReadsGlobal=16]="ReadsGlobal",e[e.WritesGlobal=32]="WritesGlobal",e[e.ReadsMemory=64]="ReadsMemory",e[e.WritesMemory=128]="WritesMemory",e[e.ImplicitTrap=256]="ImplicitTrap",e[e.IsAtomic=512]="IsAtomic",e[e.Throws=1024]="Throws",e[e.DanglingPop=2048]="DanglingPop",e[e.Any=4095]="Any"}(p=t.SideEffects||(t.SideEffects={})),t.getSideEffects=x,t.hasSideEffects=function(e,t=o.All){return x(e,t)!=p.None},t.allocPtrArray=A,t.readString=S;class v{constructor(e,t){this.output=e,this.sourceMap=t}}t.BinaryModule=v,t.needsExplicitUnreachable=function e(t){if(s._BinaryenExpressionGetType(t)!=a.Unreachable)return!1;switch(s._BinaryenExpressionGetId(t)){case l.Unreachable:case l.Return:return!1;case l.Break:return 0!=s._BinaryenBreakGetCondition(t);case l.Block:if(!s._BinaryenBlockGetName(t)){let r=s._BinaryenBlockGetNumChildren(t);return r>0&&e(s._BinaryenBlockGetChildAt(t,r-1))}}return!0}},215:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Precedence=t.Parser=void 0;const i=r(200),n=r(411),s=r(256),a=r(910),o=r(60);class l{constructor(e,t){this.source=e,this.reportNode=t}}class u extends s.DiagnosticEmitter{constructor(e=null,t=null){super(e),this.backlog=new Array,this.seenlog=new Set,this.donelog=new Set,this.onComment=null,this.currentSource=null,this.dependees=new Map,this.tryParseSignatureIsSignature=!1,this.parseParametersThis=null,this.sources=t||new Array}parseFile(e,t,r){var l=a.normalizePath(t),u=o.mangleInternalPath(t);if(!this.donelog.has(u)){if(this.donelog.add(u),this.seenlog.add(u),null===e){let e=this.dependees,r=null;return e.has(u)&&(r=assert(e.get(u))),void this.error(s.DiagnosticCode.File_0_not_found,r?r.reportNode.range:null,t)}var c=new o.Source(r?o.SourceKind.USER_ENTRY:t.startsWith(i.LIBRARY_PREFIX)?t.indexOf(i.PATH_DELIMITER,i.LIBRARY_PREFIX.length)<0?o.SourceKind.LIBRARY_ENTRY:o.SourceKind.LIBRARY:o.SourceKind.USER,l,e);this.sources.push(c),this.currentSource=c;var p=new n.Tokenizer(c,this.diagnostics);p.onComment=this.onComment;for(var _=c.statements;!p.skip(n.Token.ENDOFFILE);){let e=this.parseTopLevelStatement(p,null);e?_.push(e):this.skipStatement(p)}}}parseTopLevelStatement(e,t=null){for(var r=i.CommonFlags.NONE,a=-1,l=null;e.skip(n.Token.AT);){a<0&&(a=e.tokenPos);let t=this.parseDecorator(e);t?l?l.push(t):l=[t]:this.skipStatement(e)}var u=0,c=0,p=0,_=0;e.skip(n.Token.EXPORT)&&(a<0&&(a=e.tokenPos),r|=i.CommonFlags.EXPORT,u=e.tokenPos,c=e.pos,e.skip(n.Token.DEFAULT)&&(p=e.tokenPos,_=e.pos));var h=0,d=0,m=null!=t&&t.is(i.CommonFlags.AMBIENT);e.skip(n.Token.DECLARE)?m?this.error(s.DiagnosticCode.A_declare_modifier_cannot_be_used_in_an_already_ambient_context,e.range()):(a<0&&(a=e.tokenPos),h=a,d=e.pos,r|=i.CommonFlags.DECLARE|i.CommonFlags.AMBIENT):m&&(r|=i.CommonFlags.AMBIENT);var y=null,T=e.peek();switch(a<0&&(a=e.nextTokenPos),T){case n.Token.CONST:e.next(),r|=i.CommonFlags.CONST,y=e.skip(n.Token.ENUM)?this.parseEnum(e,r,l,a):this.parseVariable(e,r,l,a),l=null;break;case n.Token.LET:r|=i.CommonFlags.LET;case n.Token.VAR:e.next(),y=this.parseVariable(e,r,l,a),l=null;break;case n.Token.ENUM:e.next(),y=this.parseEnum(e,r,l,a),l=null;break;case n.Token.FUNCTION:e.next(),y=this.parseFunction(e,r,l,a),l=null;break;case n.Token.ABSTRACT:{let t=e.mark();e.next();let a=e.tokenPos,o=e.pos,l=e.peek(!0);if(e.nextTokenOnNewLine){e.reset(t),y=this.parseStatement(e,!0);break}if(l!=n.Token.CLASS){l==n.Token.INTERFACE&&this.error(s.DiagnosticCode._abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration,e.range(a,o)),e.reset(t),y=this.parseStatement(e,!0);break}e.discard(t),r|=i.CommonFlags.ABSTRACT}case n.Token.CLASS:case n.Token.INTERFACE:e.next(),y=this.parseClassOrInterface(e,r,l,a),l=null;break;case n.Token.NAMESPACE:{let t=e.mark();e.next(),e.peek(!1,n.IdentifierHandling.PREFER)==n.Token.IDENTIFIER?(e.discard(t),y=this.parseNamespace(e,r,l,a),l=null):(e.reset(t),y=this.parseStatement(e,!0));break}case n.Token.IMPORT:e.next(),y=(r|=i.CommonFlags.IMPORT)&i.CommonFlags.EXPORT?this.parseExportImport(e,a):this.parseImport(e);break;case n.Token.TYPE:{let t=e.mark();e.next(),e.peek(!1,n.IdentifierHandling.PREFER)==n.Token.IDENTIFIER?(e.discard(t),y=this.parseTypeDeclaration(e,r,l,a),l=null):(e.reset(t),y=this.parseStatement(e,!0));break}default:r&i.CommonFlags.EXPORT?_&&e.skipIdentifier(n.IdentifierHandling.PREFER)?(d&&this.error(s.DiagnosticCode.An_export_assignment_cannot_have_modifiers,e.range(h,d)),y=this.parseExportDefaultAlias(e,a,p,_),p=_=0):y=this.parseExport(e,a,0!=(r&i.CommonFlags.DECLARE)):(c&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(u,c),"export"),d&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(h,d),"declare"),t||(y=this.parseStatement(e,!0)))}if(l)for(let e=0,t=l.length;e<t;++e)this.error(s.DiagnosticCode.Decorators_are_not_valid_here,l[e].range);if(_&&null!==y)switch(y.kind){case o.NodeKind.ENUMDECLARATION:case o.NodeKind.FUNCTIONDECLARATION:case o.NodeKind.CLASSDECLARATION:case o.NodeKind.INTERFACEDECLARATION:case o.NodeKind.NAMESPACEDECLARATION:return o.Node.createExportDefaultStatement(y,e.range(a,e.pos));default:this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(p,_),"default")}return y}nextFile(){var e=this.backlog;return e.length?assert(e.shift()):null}getDependee(e){var t=this.dependees;if(t.has(e)){return assert(t.get(e)).source.internalPath}return null}finish(){if(this.backlog.length)throw new Error("backlog is not empty");this.backlog=[],this.seenlog.clear(),this.donelog.clear(),this.dependees.clear()}parseTypeName(e){for(var t=o.Node.createSimpleTypeName(e.readIdentifier(),e.range()),r=t;e.skip(n.Token.DOT);){if(!e.skip(n.Token.IDENTIFIER))return this.error(s.DiagnosticCode.Identifier_expected,e.range(e.pos)),null;{let t=o.Node.createSimpleTypeName(e.readIdentifier(),e.range());r.next=t,r=t}}return t}parseType(e,t=!0,r=!1){var i,a=e.next(),l=e.tokenPos;if(a==n.Token.OPENPAREN){let a=e.skip(n.Token.OPENPAREN),o=this.tryParseFunctionType(e);if(o){if(a){if(!e.skip(n.Token.CLOSEPAREN))return this.error(s.DiagnosticCode._0_expected,e.range(),")"),null;if(!e.skip(n.Token.BAR))return this.error(s.DiagnosticCode._0_expected,e.range(),"|"),null;e.skip(n.Token.NULL)||this.error(s.DiagnosticCode._0_expected,e.range(),"null"),o.isNullable=!0}return o}if(a||this.tryParseSignatureIsSignature)return this.error(s.DiagnosticCode.Unexpected_token,e.range()),null;if(!t)return this.error(s.DiagnosticCode.Unexpected_token,e.range()),null;{let t=this.parseType(e,!1,r);if(!t)return null;if(!e.skip(n.Token.CLOSEPAREN))return r||this.error(s.DiagnosticCode._0_expected,e.range(e.pos),")"),null;(i=t).range.start=l,i.range.end=e.pos}}else if(a==n.Token.VOID)i=o.Node.createNamedType(o.Node.createSimpleTypeName("void",e.range()),[],!1,e.range(l,e.pos));else if(a==n.Token.THIS)i=o.Node.createNamedType(o.Node.createSimpleTypeName("this",e.range()),[],!1,e.range(l,e.pos));else if(a==n.Token.TRUE||a==n.Token.FALSE)i=o.Node.createNamedType(o.Node.createSimpleTypeName("bool",e.range()),[],!1,e.range(l,e.pos));else if(a==n.Token.NULL)i=o.Node.createNamedType(o.Node.createSimpleTypeName("null",e.range()),[],!1,e.range(l,e.pos));else if(a==n.Token.STRINGLITERAL)e.readString(),i=o.Node.createNamedType(o.Node.createSimpleTypeName("string",e.range()),[],!1,e.range(l,e.pos));else{if(a!=n.Token.IDENTIFIER)return r||this.error(s.DiagnosticCode.Type_expected,e.range()),null;{let t=this.parseTypeName(e);if(!t)return null;let a=null;if(e.skip(n.Token.LESSTHAN)){do{let t=this.parseType(e,!0,r);if(!t)return null;a?a.push(t):a=[t]}while(e.skip(n.Token.COMMA));if(!e.skip(n.Token.GREATERTHAN))return r||this.error(s.DiagnosticCode._0_expected,e.range(e.pos),">"),null}a||(a=[]),i=o.Node.createNamedType(t,a,!1,e.range(l,e.pos))}}for(;e.skip(n.Token.BAR);){if(!e.skip(n.Token.NULL)){let t=e.pos,i=this.parseType(e,!1,!0);return r||this.error(s.DiagnosticCode._0_expected,i?i.range:e.range(t),"null"),null}i.isNullable=!0}for(;e.skip(n.Token.OPENBRACKET);){let t=e.tokenPos;if(!e.skip(n.Token.CLOSEBRACKET))return r||this.error(s.DiagnosticCode._0_expected,e.range(),"]"),null;let a=e.range(t,e.pos),u=!1;if(e.skip(n.Token.BAR)){if(!e.skip(n.Token.NULL))return r||this.error(s.DiagnosticCode._0_expected,e.range(),"null"),null;u=!0}if(i=o.Node.createNamedType(o.Node.createSimpleTypeName("Array",a),[i],u,e.range(l,e.pos)),u)break}return i}tryParseFunctionType(e){var t,r=e.mark(),i=e.tokenPos,a=null,l=null,u=!1,c=null,p=o.ParameterKind.DEFAULT;if(e.skip(n.Token.CLOSEPAREN))u=!0,e.discard(r),a=[];else{u=!1;do{let t=-1,i=o.ParameterKind.DEFAULT;if(e.skip(n.Token.DOT_DOT_DOT)&&(t=e.tokenPos,u=!0,e.discard(r),i=o.ParameterKind.REST),e.skip(n.Token.THIS)){if(t<0&&(t=e.tokenPos),!e.skip(n.Token.COLON))return e.reset(r),this.tryParseSignatureIsSignature=!1,null;{u=!0,e.discard(r);let t=this.parseType(e,!1);if(!t)return null;if(t.kind!=o.NodeKind.NAMEDTYPE)return this.error(s.DiagnosticCode.Identifier_expected,t.range),this.tryParseSignatureIsSignature=!0,null;l=t}}else{if(!e.skipIdentifier())return u?this.error(s.DiagnosticCode.Identifier_expected,e.range()):e.reset(r),this.tryParseSignatureIsSignature=u,null;{t<0&&(t=e.tokenPos);let l=o.Node.createIdentifierExpression(e.readIdentifier(),e.range(e.tokenPos,e.pos));if(e.skip(n.Token.QUESTION)&&(u=!0,e.discard(r),i==o.ParameterKind.REST?this.error(s.DiagnosticCode.A_rest_parameter_cannot_be_optional,e.range()):i=o.ParameterKind.OPTIONAL),e.skip(n.Token.COLON)){u=!0,e.discard(r);let n=this.parseType(e);if(!n)return this.tryParseSignatureIsSignature=u,null;let s=o.Node.createParameter(i,l,n,null,e.range(t,e.pos));a?a.push(s):a=[s]}else if(u||e.peek()==n.Token.COMMA&&(u=!0,e.discard(r)),u){let r=o.Node.createParameter(i,l,o.Node.createOmittedType(e.range(e.pos)),null,e.range(t,e.pos));a?a.push(r):a=[r],this.error(s.DiagnosticCode.Type_expected,r.type.range)}else a||(c=l,p=i)}}}while(e.skip(n.Token.COMMA));if(!e.skip(n.Token.CLOSEPAREN))return u?this.error(s.DiagnosticCode._0_expected,e.range(),")"):e.reset(r),this.tryParseSignatureIsSignature=u,null}if(!e.skip(n.Token.EQUALS_GREATERTHAN))return u?this.error(s.DiagnosticCode._0_expected,e.range(),"=>"):e.reset(r),this.tryParseSignatureIsSignature=u,null;if(!u&&(u=!0,e.discard(r),c)){let e=o.Node.createParameter(p,c,o.Node.createOmittedType(c.range.atEnd),null,c.range);a?a.push(e):a=[e],this.error(s.DiagnosticCode.Type_expected,e.type.range)}return(t=this.parseType(e))?(this.tryParseSignatureIsSignature=!0,a||(a=[]),o.Node.createFunctionType(a,t,l,!1,e.range(i,e.pos))):(this.tryParseSignatureIsSignature=u,null)}parseDecorator(e){var t=e.tokenPos;if(e.skipIdentifier()){let r,i=e.readIdentifier(),a=o.Node.createIdentifierExpression(i,e.range(t,e.pos));for(;e.skip(n.Token.DOT);){if(!e.skipIdentifier(n.IdentifierHandling.PREFER))return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;i=e.readIdentifier(),a=o.Node.createPropertyAccessExpression(a,o.Node.createIdentifierExpression(i,e.range()),e.range(t,e.pos))}if(!e.skip(n.Token.OPENPAREN))return o.Node.createDecorator(a,null,e.range(t,e.pos));if(r=this.parseArguments(e),r)return o.Node.createDecorator(a,r,e.range(t,e.pos))}else this.error(s.DiagnosticCode.Identifier_expected,e.range());return null}parseVariable(e,t,r,i,s=!1){var a=new Array;do{let i=this.parseVariableDeclaration(e,t,r,s);if(!i)return null;a.push(i)}while(e.skip(n.Token.COMMA));var l=o.Node.createVariableStatement(r,a,e.range(i,e.pos));return e.skip(n.Token.SEMICOLON),l}parseVariableDeclaration(e,t,r,a=!1){if(!e.skipIdentifier())return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;var l=o.Node.createIdentifierExpression(e.readIdentifier(),e.range());n.isIllegalVariableIdentifier(l.text)&&this.error(s.DiagnosticCode.Identifier_expected,l.range);var u=t;e.skip(n.Token.EXCLAMATION)&&(u|=i.CommonFlags.DEFINITELY_ASSIGNED);var c=null;e.skip(n.Token.COLON)&&(c=this.parseType(e,!0));var p=null;if(e.skip(n.Token.EQUALS)){if(u&i.CommonFlags.AMBIENT&&this.error(s.DiagnosticCode.Initializers_are_not_allowed_in_ambient_contexts,e.range()),!(p=this.parseExpression(e,2)))return null}else a||(u&i.CommonFlags.CONST?u&i.CommonFlags.AMBIENT||this.error(s.DiagnosticCode._const_declarations_must_be_initialized,l.range):c||this.error(s.DiagnosticCode.Type_expected,e.range(e.pos)));var _=n.Range.join(l.range,e.range());return null!==p&&0!=(u&i.CommonFlags.DEFINITELY_ASSIGNED)&&this.error(s.DiagnosticCode.A_definite_assignment_assertion_is_not_permitted_in_this_context,_),o.Node.createVariableDeclaration(l,r,u,c,p,_)}parseEnum(e,t,r,a){if(e.next()!=n.Token.IDENTIFIER)return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;var l=o.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.next()!=n.Token.OPENBRACE)return this.error(s.DiagnosticCode._0_expected,e.range(),"{"),null;for(var u=new Array;!e.skip(n.Token.CLOSEBRACE);){let t=this.parseEnumValue(e,i.CommonFlags.NONE);if(!t)return null;if(u.push(t),!e.skip(n.Token.COMMA)){if(e.skip(n.Token.CLOSEBRACE))break;return this.error(s.DiagnosticCode._0_expected,e.range(),"}"),null}}var c=o.Node.createEnumDeclaration(l,r,t,u,e.range(a,e.pos));return e.skip(n.Token.SEMICOLON),c}parseEnumValue(e,t){if(!e.skipIdentifier())return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;var r=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),i=null;return e.skip(n.Token.EQUALS)&&!(i=this.parseExpression(e,2))?null:o.Node.createEnumValueDeclaration(r,t,i,n.Range.join(r.range,e.range()))}parseReturn(e){var t=e.tokenPos,r=null;if(e.peek(!0)!=n.Token.SEMICOLON&&e.nextToken!=n.Token.CLOSEBRACE&&!e.nextTokenOnNewLine&&!(r=this.parseExpression(e)))return null;var i=o.Node.createReturnStatement(r,e.range(t,e.pos));return e.skip(n.Token.SEMICOLON),i}parseTypeParameters(e){for(var t=new Array,r=!1,i=e.tokenPos;!e.skip(n.Token.GREATERTHAN);){let i=this.parseTypeParameter(e);if(!i)return null;if(null!==i.defaultType?r=!0:r&&(this.error(s.DiagnosticCode.Required_type_parameters_may_not_follow_optional_type_parameters,i.range),i.defaultType=null),t.push(i),!e.skip(n.Token.COMMA)){if(e.skip(n.Token.GREATERTHAN))break;return this.error(s.DiagnosticCode._0_expected,e.range(),">"),null}}return t.length||this.error(s.DiagnosticCode.Type_parameter_list_cannot_be_empty,e.range(i,e.pos)),t}parseTypeParameter(e){if(e.next()==n.Token.IDENTIFIER){let t=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;if(e.skip(n.Token.EXTENDS)){let t=this.parseType(e);if(!t)return null;if(t.kind!=o.NodeKind.NAMEDTYPE)return this.error(s.DiagnosticCode.Identifier_expected,t.range),null;r=t}let i=null;if(e.skip(n.Token.EQUALS)){let t=this.parseType(e);if(!t)return null;if(t.kind!=o.NodeKind.NAMEDTYPE)return this.error(s.DiagnosticCode.Identifier_expected,t.range),null;i=t}return o.Node.createTypeParameter(t,r,i,n.Range.join(t.range,e.range()))}return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null}parseParameters(e,t=!1){var r=new Array,i=null,a=!1,l=!1,u=null;if(this.parseParametersThis=null,e.skip(n.Token.THIS)){if(!e.skip(n.Token.COLON))return this.error(s.DiagnosticCode._0_expected,e.range(),":"),null;if(!(u=this.parseType(e)))return null;if(u.kind==o.NodeKind.NAMEDTYPE?this.parseParametersThis=u:this.error(s.DiagnosticCode.Identifier_expected,u.range),!e.skip(n.Token.COMMA))return e.skip(n.Token.CLOSEPAREN)?r:(this.error(s.DiagnosticCode._0_expected,e.range(),")"),null)}for(;!e.skip(n.Token.CLOSEPAREN);){let u=this.parseParameter(e,t);if(!u)return null;switch(null===i||l||(this.error(s.DiagnosticCode.A_rest_parameter_must_be_last_in_a_parameter_list,i.name.range),l=!0),u.parameterKind){default:a&&this.error(s.DiagnosticCode.A_required_parameter_cannot_follow_an_optional_parameter,u.name.range);break;case o.ParameterKind.OPTIONAL:a=!0;break;case o.ParameterKind.REST:i=u}if(r.push(u),!e.skip(n.Token.COMMA)){if(e.skip(n.Token.CLOSEPAREN))break;return this.error(s.DiagnosticCode._0_expected,e.range(),")"),null}}return r}parseParameter(e,t=!1){var r=!1,a=!1,l=null,u=i.CommonFlags.NONE;if(t&&(e.skip(n.Token.PUBLIC)?(l=e.range(),u|=i.CommonFlags.PUBLIC):e.skip(n.Token.PROTECTED)?(l=e.range(),u|=i.CommonFlags.PROTECTED):e.skip(n.Token.PRIVATE)&&(l=e.range(),u|=i.CommonFlags.PRIVATE),e.peek()==n.Token.READONLY)){let t=e.mark();e.next(),e.peek()!=n.Token.COLON?(e.discard(t),l||(l=e.range()),u|=i.CommonFlags.READONLY):e.reset(t)}if(e.skip(n.Token.DOT_DOT_DOT)&&(u?this.error(s.DiagnosticCode.A_parameter_property_cannot_be_declared_using_a_rest_parameter,e.range()):l=e.range(),r=!0),e.skipIdentifier()){r||(l=e.range());let t=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),i=null;if((a=e.skip(n.Token.QUESTION))&&r&&this.error(s.DiagnosticCode.A_rest_parameter_cannot_be_optional,t.range),e.skip(n.Token.COLON)){if(i=this.parseType(e),!i)return null}else i=o.Node.createOmittedType(e.range(e.pos));let c=null;if(e.skip(n.Token.EQUALS)&&(r&&this.error(s.DiagnosticCode.A_rest_parameter_cannot_have_an_initializer,t.range),a?this.error(s.DiagnosticCode.Parameter_cannot_have_question_mark_and_initializer,t.range):a=!0,c=this.parseExpression(e,2),!c))return null;let p=o.Node.createParameter(r?o.ParameterKind.REST:a?o.ParameterKind.OPTIONAL:o.ParameterKind.DEFAULT,t,i,c,n.Range.join(assert(l),e.range()));return p.flags|=u,p}return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null}parseFunction(e,t,r,a){if(!e.skipIdentifier())return this.error(s.DiagnosticCode.Identifier_expected,e.range(e.pos)),null;var l=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),u=-1,c=null;if(e.skip(n.Token.LESSTHAN)){if(u=e.tokenPos,!(c=this.parseTypeParameters(e)))return null;t|=i.CommonFlags.GENERIC}if(!e.skip(n.Token.OPENPAREN))return this.error(s.DiagnosticCode._0_expected,e.range(e.pos),"("),null;u<0&&(u=e.tokenPos);var p=this.parseParameters(e);if(!p)return null;var _=this.parseParametersThis,h=0!=(t&i.CommonFlags.SET);h&&(1!=p.length&&this.error(s.DiagnosticCode.A_set_accessor_must_have_exactly_one_parameter,l.range),p.length>0&&null!==p[0].initializer&&this.error(s.DiagnosticCode.A_set_accessor_parameter_cannot_have_an_initializer,l.range)),t&i.CommonFlags.GET&&p.length&&this.error(s.DiagnosticCode.A_get_accessor_cannot_have_parameters,l.range);var d=null;if(e.skip(n.Token.COLON)&&!(d=this.parseType(e,!0,h)))return null;d||(d=o.Node.createOmittedType(e.range(e.pos)),h||this.error(s.DiagnosticCode.Type_expected,d.range));var m=o.Node.createFunctionType(p,d,_,!1,e.range(u,e.pos)),y=null;if(e.skip(n.Token.OPENBRACE)){if(t&i.CommonFlags.AMBIENT&&this.error(s.DiagnosticCode.An_implementation_cannot_be_declared_in_ambient_contexts,e.range()),!(y=this.parseBlockStatement(e,!1)))return null}else t&i.CommonFlags.AMBIENT||this.error(s.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,e.range(e.pos));var T=o.Node.createFunctionDeclaration(l,r,t,c,m,y,0,e.range(a,e.pos));return e.skip(n.Token.SEMICOLON),T}parseFunctionExpression(e){var t,r=e.tokenPos,i=0;if(e.token==n.Token.FUNCTION){if(t=e.skipIdentifier()?o.Node.createIdentifierExpression(e.readIdentifier(),e.range()):o.Node.createEmptyIdentifierExpression(e.range(e.pos)),!e.skip(n.Token.OPENPAREN))return this.error(s.DiagnosticCode._0_expected,e.range(e.pos),"("),null}else i=1,assert(e.token==n.Token.OPENPAREN),t=o.Node.createEmptyIdentifierExpression(e.range(e.tokenPos));var a=e.pos,l=this.parseParameters(e);return l?this.parseFunctionExpressionCommon(e,t,l,this.parseParametersThis,i,r,a):null}parseFunctionExpressionCommon(e,t,r,a,l,u=-1,c=-1){u<0&&(u=t.range.start),c<0&&(c=u);var p=null;if(2!=l&&e.skip(n.Token.COLON)){if(!(p=this.parseType(e)))return null}else p=o.Node.createOmittedType(e.range(e.pos));if(l&&!e.skip(n.Token.EQUALS_GREATERTHAN))return this.error(s.DiagnosticCode._0_expected,e.range(e.pos),"=>"),null;var _=o.Node.createFunctionType(r,p,a,!1,e.range(c,e.pos)),h=null;if(l)if(e.skip(n.Token.OPENBRACE))h=this.parseBlockStatement(e,!1);else{let t=this.parseExpression(e,2);t&&(h=o.Node.createExpressionStatement(t))}else{if(!e.skip(n.Token.OPENBRACE))return this.error(s.DiagnosticCode._0_expected,e.range(e.pos),"{"),null;h=this.parseBlockStatement(e,!1)}if(!h)return null;var d=o.Node.createFunctionDeclaration(t,null,i.CommonFlags.NONE,null,_,h,l,e.range(u,e.pos));return o.Node.createFunctionExpression(d)}parseClassOrInterface(e,t,r,a){var l=e.token==n.Token.INTERFACE;if(!e.skipIdentifier())return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;var u=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),c=null;if(e.skip(n.Token.LESSTHAN)){if(!(c=this.parseTypeParameters(e)))return null;t|=i.CommonFlags.GENERIC}var p=null;if(e.skip(n.Token.EXTENDS)){let t=this.parseType(e);if(!t)return null;if(t.kind!=o.NodeKind.NAMEDTYPE)return this.error(s.DiagnosticCode.Identifier_expected,t.range),null;p=t}var _=null;if(e.skip(n.Token.IMPLEMENTS)){l&&this.error(s.DiagnosticCode.Interface_declaration_cannot_have_implements_clause,e.range());do{let t=this.parseType(e);if(!t)return null;if(t.kind!=o.NodeKind.NAMEDTYPE)return this.error(s.DiagnosticCode.Identifier_expected,t.range),null;l||(_||(_=[]),_.push(t))}while(e.skip(n.Token.COMMA))}if(!e.skip(n.Token.OPENBRACE))return this.error(s.DiagnosticCode._0_expected,e.range(),"{"),null;var h,d=new Array;if(l?(assert(!_),h=o.Node.createInterfaceDeclaration(u,r,t,c,p,null,d,e.range(a,e.pos))):h=o.Node.createClassDeclaration(u,r,t,c,p,_,d,e.range(a,e.pos)),!e.skip(n.Token.CLOSEBRACE))do{let t=this.parseClassMember(e,h);if(t)t.kind==o.NodeKind.INDEXSIGNATURE?h.indexSignature=t:(assert(t instanceof o.DeclarationStatement),d.push(t));else if(this.skipStatement(e),e.skip(n.Token.ENDOFFILE))return this.error(s.DiagnosticCode._0_expected,e.range(),"}"),null}while(!e.skip(n.Token.CLOSEBRACE));return h.range.end=e.pos,h}parseClassExpression(e){var t,r=e.tokenPos;if(t=e.skipIdentifier()?o.Node.createIdentifierExpression(e.readIdentifier(),e.range()):o.Node.createEmptyIdentifierExpression(e.range(e.pos)),!e.skip(n.Token.OPENBRACE))return this.error(s.DiagnosticCode._0_expected,e.range(e.pos),"{"),null;var a=new Array,l=o.Node.createClassDeclaration(t,null,i.CommonFlags.NONE,null,null,null,a,e.range(r,e.pos));if(!e.skip(n.Token.CLOSEBRACE))do{let t=this.parseClassMember(e,l);if(t)t.kind==o.NodeKind.INDEXSIGNATURE?l.indexSignature=t:(assert(l instanceof o.DeclarationStatement),a.push(t));else if(this.skipStatement(e),e.skip(n.Token.ENDOFFILE))return this.error(s.DiagnosticCode._0_expected,e.range(),"}"),null}while(!e.skip(n.Token.CLOSEBRACE));return l.range.end=e.pos,o.Node.createClassExpression(l)}parseClassMember(e,t){var r=t.kind==o.NodeKind.INTERFACEDECLARATION,a=0,l=null;if(e.skip(n.Token.AT)){a=e.tokenPos;do{let t=this.parseDecorator(e);if(!t)break;l||(l=new Array),l.push(t)}while(e.skip(n.Token.AT));r&&null!==l&&this.error(s.DiagnosticCode.Decorators_are_not_valid_here,n.Range.join(l[0].range,l[l.length-1].range))}var u=t.flags&i.CommonFlags.AMBIENT;r&&(u|=i.CommonFlags.VIRTUAL);var c=0,p=0;e.skip(n.Token.PUBLIC)?(r?this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(),"public"):(u|=i.CommonFlags.PUBLIC,c=e.tokenPos,p=e.pos),a||(a=e.tokenPos)):e.skip(n.Token.PRIVATE)?(r?this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(),"private"):(u|=i.CommonFlags.PRIVATE,c=e.tokenPos,p=e.pos),a||(a=e.tokenPos)):e.skip(n.Token.PROTECTED)&&(r?this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(),"protected"):(u|=i.CommonFlags.PROTECTED,c=e.tokenPos,p=e.pos),a||(a=e.tokenPos));var _=0,h=0,d=0,m=0;e.skip(n.Token.STATIC)?(r?this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(),"static"):(u|=i.CommonFlags.STATIC,_=e.tokenPos,h=e.pos),a||(a=e.tokenPos)):(u|=i.CommonFlags.INSTANCE,e.skip(n.Token.ABSTRACT)&&(r||!t.is(i.CommonFlags.ABSTRACT)?this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(),"abstract"):(u|=i.CommonFlags.ABSTRACT,d=e.tokenPos,m=e.pos),a||(a=e.tokenPos)),t.flags&i.CommonFlags.GENERIC&&(u|=i.CommonFlags.GENERIC_CONTEXT));var y=0,T=0;if(e.peek()==n.Token.READONLY){let t=e.mark();e.next(),e.peek()!=n.Token.COLON?(e.discard(t),u|=i.CommonFlags.READONLY,y=e.tokenPos,T=e.pos,a||(a=y)):e.reset(t)}var g=e.mark(),f=!1,E=!1,b=0,x=0,I=!1,A=0,N=0;r||(e.skip(n.Token.GET)?e.peek(!0,n.IdentifierHandling.PREFER)!=n.Token.IDENTIFIER||e.nextTokenOnNewLine?e.reset(g):(u|=i.CommonFlags.GET,E=!0,b=e.tokenPos,x=e.pos,a||(a=b),u&i.CommonFlags.READONLY&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(y,T),"readonly")):e.skip(n.Token.SET)?e.peek(!0,n.IdentifierHandling.PREFER)!=n.Token.IDENTIFIER||e.nextTokenOnNewLine?e.reset(g):(u|=i.CommonFlags.SET,I=!0,A=e.tokenPos,N=e.pos,a||(a=A),u&i.CommonFlags.READONLY&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(y,T),"readonly")):e.skip(n.Token.CONSTRUCTOR)&&(u|=i.CommonFlags.CONSTRUCTOR,f=!0,a||(a=e.tokenPos),u&i.CommonFlags.STATIC&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(_,h),"static"),u&i.CommonFlags.ABSTRACT&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(d,m),"abstract"),u&i.CommonFlags.READONLY&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(y,T),"readonly")));var S,v=E||I;if(f)S=o.Node.createConstructorExpression(e.range());else{if(!v&&e.skip(n.Token.OPENBRACKET)){a||(a=e.tokenPos),u&i.CommonFlags.PUBLIC?this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(c,p),"public"):(u&i.CommonFlags.PROTECTED||u&i.CommonFlags.PRIVATE)&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(c,p),"protected"),u&i.CommonFlags.STATIC&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(_,h),"static"),u&i.CommonFlags.ABSTRACT&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(d,m),"abstract");let t=this.parseIndexSignature(e,u,l);return t?(e.skip(n.Token.SEMICOLON),t):(u&i.CommonFlags.READONLY&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(y,T),"readonly"),null)}if(!e.skipIdentifier(n.IdentifierHandling.ALWAYS))return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;a||(a=e.tokenPos),S=o.Node.createIdentifierExpression(e.readIdentifier(),e.range())}var C=null;if(e.skip(n.Token.LESSTHAN)){let t=e.tokenPos;if(!(C=this.parseTypeParameters(e)))return null;f?this.error(s.DiagnosticCode.Type_parameters_cannot_appear_on_a_constructor_declaration,e.range(t,e.pos)):v?this.error(s.DiagnosticCode.An_accessor_cannot_have_type_parameters,e.range(t,e.pos)):u|=i.CommonFlags.GENERIC}if(e.skip(n.Token.OPENPAREN)){let c=e.tokenPos,p=this.parseParameters(e,f);if(!p)return null;let _=this.parseParametersThis;if(f)for(let e=0,r=p.length;e<r;++e){let r=p[e];if(r.isAny(i.CommonFlags.PUBLIC|i.CommonFlags.PROTECTED|i.CommonFlags.PRIVATE|i.CommonFlags.READONLY)){let n=o.Node.createFieldDeclaration(r.name,null,r.flags|i.CommonFlags.INSTANCE,r.type,null,r.range);n.parameterIndex=e,r.implicitFieldDeclaration=n,t.members.push(n)}}else E?p.length&&this.error(s.DiagnosticCode.A_get_accessor_cannot_have_parameters,S.range):I?(1!=p.length&&this.error(s.DiagnosticCode.A_set_accessor_must_have_exactly_one_parameter,S.range),p.length>0&&null!==p[0].initializer&&this.error(s.DiagnosticCode.A_set_accessor_parameter_cannot_have_an_initializer,S.range)):"constructor"==S.text&&this.error(s.DiagnosticCode._0_keyword_cannot_be_used_here,S.range,"constructor");let h=null;if(e.skip(n.Token.COLON)){if(S.kind==o.NodeKind.CONSTRUCTOR?this.error(s.DiagnosticCode.Type_annotation_cannot_appear_on_a_constructor_declaration,e.range()):I&&this.error(s.DiagnosticCode.A_set_accessor_cannot_have_a_return_type_annotation,e.range()),h=this.parseType(e,I||S.kind==o.NodeKind.CONSTRUCTOR),!h)return null}else h=o.Node.createOmittedType(e.range(e.pos)),I||S.kind==o.NodeKind.CONSTRUCTOR||this.error(s.DiagnosticCode.Type_expected,h.range);let d=o.Node.createFunctionType(p,h,_,!1,e.range(c,e.pos)),m=null;if(e.skip(n.Token.OPENBRACE)){if(u&i.CommonFlags.AMBIENT?this.error(s.DiagnosticCode.An_implementation_cannot_be_declared_in_ambient_contexts,e.range()):u&i.CommonFlags.ABSTRACT?this.error(s.DiagnosticCode.Method_0_cannot_have_an_implementation_because_it_is_marked_abstract,e.range(),S.text):r&&this.error(s.DiagnosticCode._0_expected,e.range(),";"),m=this.parseBlockStatement(e,!1),!m)return null}else r||u&(i.CommonFlags.AMBIENT|i.CommonFlags.ABSTRACT)||this.error(s.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,e.range());let y=o.Node.createMethodDeclaration(S,l,u,C,d,m,e.range(a,e.pos));return r&&e.skip(n.Token.COMMA)||e.skip(n.Token.SEMICOLON),y}if(f)this.error(s.DiagnosticCode.Constructor_implementation_is_missing,S.range);else{if(!v){u&i.CommonFlags.ABSTRACT&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(d,m),"abstract"),u&i.CommonFlags.GET&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(b,x),"get"),u&i.CommonFlags.SET&&this.error(s.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(A,N),"set");let t=null;if(e.skip(n.Token.QUESTION)&&this.error(s.DiagnosticCode.Optional_properties_are_not_supported,e.range(a,e.pos)),e.skip(n.Token.EXCLAMATION)&&(u|=i.CommonFlags.DEFINITELY_ASSIGNED),e.skip(n.Token.COLON)){if(t=this.parseType(e),!t)return null}else this.error(s.DiagnosticCode.Type_expected,e.range());let c=null;if(e.skip(n.Token.EQUALS)&&(c=this.parseExpression(e),!c))return null;let p=e.range(a,e.pos);0==(u&i.CommonFlags.DEFINITELY_ASSIGNED)||!r&&null===c&&0==(u&i.CommonFlags.STATIC)||this.error(s.DiagnosticCode.A_definite_assignment_assertion_is_not_permitted_in_this_context,p);let _=o.Node.createFieldDeclaration(S,l,u,t,c,p);return r&&e.skip(n.Token.COMMA)||e.skip(n.Token.SEMICOLON),_}this.error(s.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,S.range)}return null}parseIndexSignature(e,t,r){null!==r&&r.length>0&&this.error(s.DiagnosticCode.Decorators_are_not_valid_here,n.Range.join(r[0].range,r[r.length-1].range));var i=e.tokenPos;if(e.skipIdentifier()){if("key"==e.readIdentifier())if(e.skip(n.Token.COLON)){let r=this.parseType(e);if(!r)return null;if(r.kind!=o.NodeKind.NAMEDTYPE)return this.error(s.DiagnosticCode.Type_expected,e.range()),null;if(e.skip(n.Token.CLOSEBRACKET)){if(e.skip(n.Token.COLON)){let n=this.parseType(e);return n?n.kind!=o.NodeKind.NAMEDTYPE?(this.error(s.DiagnosticCode.Identifier_expected,n.range),null):o.Node.createIndexSignature(r,n,t,e.range(i,e.pos)):null}this.error(s.DiagnosticCode._0_expected,e.range(),":")}else this.error(s.DiagnosticCode._0_expected,e.range(),"]")}else this.error(s.DiagnosticCode._0_expected,e.range(),":");else this.error(s.DiagnosticCode._0_expected,e.range(),"key")}else this.error(s.DiagnosticCode.Identifier_expected,e.range());return null}parseNamespace(e,t,r,i){if(e.skipIdentifier()){let a=o.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(n.Token.OPENBRACE)){let l=new Array,u=o.Node.createNamespaceDeclaration(a,r,t,l,e.range(i,e.pos));for(;!e.skip(n.Token.CLOSEBRACE);){let t=this.parseTopLevelStatement(e,u);if(t)l.push(t);else if(this.skipStatement(e),e.skip(n.Token.ENDOFFILE))return this.error(s.DiagnosticCode._0_expected,e.range(),"}"),null}return u.range.end=e.pos,e.skip(n.Token.SEMICOLON),u}this.error(s.DiagnosticCode._0_expected,e.range(),"{")}else this.error(s.DiagnosticCode.Identifier_expected,e.range());return null}parseExport(e,t,r){var i=null,a=assert(this.currentSource);if(e.skip(n.Token.OPENBRACE)){let u=new Array;for(;!e.skip(n.Token.CLOSEBRACE);){let t=this.parseExportMember(e);if(!t)return null;if(u.push(t),!e.skip(n.Token.COMMA)){if(e.skip(n.Token.CLOSEBRACE))break;return this.error(s.DiagnosticCode._0_expected,e.range(),"}"),null}}if(e.skip(n.Token.FROM)){if(!e.skip(n.Token.STRINGLITERAL))return this.error(s.DiagnosticCode.String_literal_expected,e.range()),null;i=o.Node.createStringLiteralExpression(e.readString(),e.range())}let c=o.Node.createExportStatement(u,i,r,e.range(t,e.pos));if(null!==i){let e=assert(c.internalPath);this.seenlog.has(e)||(this.dependees.set(e,new l(a,i)),this.backlog.push(e),this.seenlog.add(e))}return e.skip(n.Token.SEMICOLON),c}if(e.skip(n.Token.ASTERISK))if(e.skip(n.Token.FROM)){if(e.skip(n.Token.STRINGLITERAL)){i=o.Node.createStringLiteralExpression(e.readString(),e.range());let s=o.Node.createExportStatement(null,i,r,e.range(t,e.pos)),u=assert(s.internalPath),c=e.source,p=c.exportPaths;return p?p.includes(u)||p.push(u):c.exportPaths=[u],this.seenlog.has(u)||(this.dependees.set(u,new l(a,i)),this.backlog.push(u)),e.skip(n.Token.SEMICOLON),s}this.error(s.DiagnosticCode.String_literal_expected,e.range())}else this.error(s.DiagnosticCode._0_expected,e.range(),"from");else this.error(s.DiagnosticCode._0_expected,e.range(),"{");return null}parseExportMember(e){if(e.skipIdentifier(n.IdentifierHandling.ALWAYS)){let t=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;if(e.skip(n.Token.AS)){if(!e.skipIdentifier(n.IdentifierHandling.ALWAYS))return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;r=o.Node.createIdentifierExpression(e.readIdentifier(),e.range())}return r?o.Node.createExportMember(t,r,n.Range.join(t.range,r.range)):o.Node.createExportMember(t,null,t.range)}return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null}parseExportDefaultAlias(e,t,r,i){var s=e.readIdentifier(),a=e.range(),l=o.Node.createExportStatement([o.Node.createExportMember(o.Node.createIdentifierExpression(s,a),o.Node.createIdentifierExpression("default",e.range(r,i)),a)],null,!1,e.range(t,e.pos));return e.skip(n.Token.SEMICOLON),l}parseImport(e){var t=e.tokenPos,r=null,i=null,a=!1;if(e.skip(n.Token.OPENBRACE))for(r=new Array;!e.skip(n.Token.CLOSEBRACE);){let t=this.parseImportDeclaration(e);if(!t)return null;if(r.push(t),!e.skip(n.Token.COMMA)){if(e.skip(n.Token.CLOSEBRACE))break;return this.error(s.DiagnosticCode._0_expected,e.range(),"}"),null}}else if(e.skip(n.Token.ASTERISK)){if(!e.skip(n.Token.AS))return this.error(s.DiagnosticCode._0_expected,e.range(),"as"),null;if(!e.skipIdentifier())return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;i=o.Node.createIdentifierExpression(e.readIdentifier(),e.range())}else if(e.skip(n.Token.IDENTIFIER,n.IdentifierHandling.PREFER)){let t=e.readIdentifier(),i=e.range();if(r=[o.Node.createImportDeclaration(o.Node.createIdentifierExpression("default",i),o.Node.createIdentifierExpression(t,i),i)],e.skip(n.Token.COMMA))return this.error(s.DiagnosticCode.Not_implemented_0,e.range(),"Mixed default and named imports"),null}else a=!0;if(a||e.skip(n.Token.FROM)){if(e.skip(n.Token.STRINGLITERAL)){let s,a=o.Node.createStringLiteralExpression(e.readString(),e.range());i?(assert(!r),s=o.Node.createWildcardImportStatement(i,a,e.range(t,e.pos))):s=o.Node.createImportStatement(r,a,e.range(t,e.pos));let u=s.internalPath;return this.seenlog.has(u)||(this.dependees.set(u,new l(assert(this.currentSource),a)),this.backlog.push(u)),e.skip(n.Token.SEMICOLON),s}this.error(s.DiagnosticCode.String_literal_expected,e.range())}else this.error(s.DiagnosticCode._0_expected,e.range(),"from");return null}parseImportDeclaration(e){if(e.skipIdentifier(n.IdentifierHandling.ALWAYS)){let t=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;if(e.skip(n.Token.AS)){if(!e.skipIdentifier())return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;r=o.Node.createIdentifierExpression(e.readIdentifier(),e.range())}return r?o.Node.createImportDeclaration(t,r,n.Range.join(t.range,r.range)):o.Node.createImportDeclaration(t,null,t.range)}return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null}parseExportImport(e,t){if(e.skipIdentifier()){let r=o.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(n.Token.EQUALS)){if(e.skipIdentifier()){let i=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),s=o.Node.createExportImportStatement(i,r,e.range(t,e.pos));return e.skip(n.Token.SEMICOLON),s}this.error(s.DiagnosticCode.Identifier_expected,e.range())}else this.error(s.DiagnosticCode._0_expected,e.range(),"=")}else this.error(s.DiagnosticCode.Identifier_expected,e.range());return null}parseStatement(e,t=!1){var r=e.mark(),a=null;switch(e.next()){case n.Token.BREAK:a=this.parseBreak(e);break;case n.Token.CONST:a=this.parseVariable(e,i.CommonFlags.CONST,null,e.tokenPos);break;case n.Token.CONTINUE:a=this.parseContinue(e);break;case n.Token.DO:a=this.parseDoStatement(e);break;case n.Token.FOR:a=this.parseForStatement(e);break;case n.Token.IF:a=this.parseIfStatement(e);break;case n.Token.LET:a=this.parseVariable(e,i.CommonFlags.LET,null,e.tokenPos);break;case n.Token.VAR:a=this.parseVariable(e,i.CommonFlags.NONE,null,e.tokenPos);break;case n.Token.OPENBRACE:a=this.parseBlockStatement(e,t);break;case n.Token.RETURN:t&&this.error(s.DiagnosticCode.A_return_statement_can_only_be_used_within_a_function_body,e.range()),a=this.parseReturn(e);break;case n.Token.SEMICOLON:return o.Node.createEmptyStatement(e.range(e.tokenPos));case n.Token.SWITCH:a=this.parseSwitchStatement(e);break;case n.Token.THROW:a=this.parseThrowStatement(e);break;case n.Token.TRY:a=this.parseTryStatement(e);break;case n.Token.VOID:a=this.parseVoidStatement(e);break;case n.Token.WHILE:a=this.parseWhileStatement(e);break;case n.Token.TYPE:if(e.peek(!1,n.IdentifierHandling.PREFER)==n.Token.IDENTIFIER){a=this.parseTypeDeclaration(e,i.CommonFlags.NONE,null,e.tokenPos);break}default:e.reset(r),a=this.parseExpressionStatement(e)}return a?e.discard(r):(e.reset(r),this.skipStatement(e)),a}parseBlockStatement(e,t){for(var r=e.tokenPos,i=new Array;!e.skip(n.Token.CLOSEBRACE);){let r=e.mark(),s=this.parseStatement(e,t);if(s)e.discard(r),i.push(s);else{if(e.token==n.Token.ENDOFFILE)return null;e.reset(r),this.skipStatement(e)}}var s=o.Node.createBlockStatement(i,e.range(r,e.pos));return e.skip(n.Token.SEMICOLON),s}parseBreak(e){var t=null;e.peek(!0)!=n.Token.IDENTIFIER||e.nextTokenOnNewLine||(e.next(n.IdentifierHandling.PREFER),t=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()));var r=o.Node.createBreakStatement(t,e.range());return e.skip(n.Token.SEMICOLON),r}parseContinue(e){var t=null;e.peek(!0)!=n.Token.IDENTIFIER||e.nextTokenOnNewLine||(e.next(n.IdentifierHandling.PREFER),t=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()));var r=o.Node.createContinueStatement(t,e.range());return e.skip(n.Token.SEMICOLON),r}parseDoStatement(e){var t=e.tokenPos,r=this.parseStatement(e);if(!r)return null;if(e.skip(n.Token.WHILE))if(e.skip(n.Token.OPENPAREN)){let i=this.parseExpression(e);if(!i)return null;if(e.skip(n.Token.CLOSEPAREN)){let s=o.Node.createDoStatement(r,i,e.range(t,e.pos));return e.skip(n.Token.SEMICOLON),s}this.error(s.DiagnosticCode._0_expected,e.range(),")")}else this.error(s.DiagnosticCode._0_expected,e.range(),"(");else this.error(s.DiagnosticCode._0_expected,e.range(),"while");return null}parseExpressionStatement(e){var t=this.parseExpression(e);if(!t)return null;var r=o.Node.createExpressionStatement(t);return e.skip(n.Token.SEMICOLON),r}parseForStatement(e){var t=e.tokenPos;if(e.skip(n.Token.OPENPAREN)){let r=null;if(e.skip(n.Token.CONST))r=this.parseVariable(e,i.CommonFlags.CONST,null,e.tokenPos,!0);else if(e.skip(n.Token.LET))r=this.parseVariable(e,i.CommonFlags.LET,null,e.tokenPos,!0);else if(e.skip(n.Token.VAR))r=this.parseVariable(e,i.CommonFlags.NONE,null,e.tokenPos,!0);else if(!e.skip(n.Token.SEMICOLON)&&(r=this.parseExpressionStatement(e),!r))return null;if(r){if(e.skip(n.Token.OF)){if(r.kind==o.NodeKind.EXPRESSION)return r.expression.kind!=o.NodeKind.IDENTIFIER?(this.error(s.DiagnosticCode.Identifier_expected,r.range),null):this.parseForOfStatement(e,t,r);if(r.kind==o.NodeKind.VARIABLE){let i=r.declarations;for(let e=0,t=i.length;e<t;++e){let t=i[e].initializer;t&&this.error(s.DiagnosticCode.The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer,t.range)}return this.parseForOfStatement(e,t,r)}return this.error(s.DiagnosticCode.Identifier_expected,r.range),null}if(r.kind==o.NodeKind.VARIABLE){let e=r.declarations;for(let t=0,r=e.length;t<r;++t){let r=e[t];r.initializer||(r.flags&i.CommonFlags.CONST?this.error(s.DiagnosticCode._const_declarations_must_be_initialized,r.name.range):r.type||this.error(s.DiagnosticCode.Type_expected,r.name.range.atEnd))}}}if(e.token==n.Token.SEMICOLON){let i=null;if(!e.skip(n.Token.SEMICOLON)&&(i=this.parseExpressionStatement(e),!i))return null;if(e.token==n.Token.SEMICOLON){let a=null;if(!e.skip(n.Token.CLOSEPAREN)){if(a=this.parseExpression(e),!a)return null;if(!e.skip(n.Token.CLOSEPAREN))return this.error(s.DiagnosticCode._0_expected,e.range(),")"),null}let l=this.parseStatement(e);return l?o.Node.createForStatement(r,i?i.expression:null,a,l,e.range(t,e.pos)):null}this.error(s.DiagnosticCode._0_expected,e.range(),";")}else this.error(s.DiagnosticCode._0_expected,e.range(),";")}else this.error(s.DiagnosticCode._0_expected,e.range(),"(");return null}parseForOfStatement(e,t,r){var i=this.parseExpression(e);if(!i)return null;if(!e.skip(n.Token.CLOSEPAREN))return this.error(s.DiagnosticCode._0_expected,e.range(),")"),null;var a=this.parseStatement(e);return a?o.Node.createForOfStatement(r,i,a,e.range(t,e.pos)):null}parseIfStatement(e){var t=e.tokenPos;if(e.skip(n.Token.OPENPAREN)){let r=this.parseExpression(e);if(!r)return null;if(e.skip(n.Token.CLOSEPAREN)){let i=this.parseStatement(e);if(!i)return null;let s=null;return e.skip(n.Token.ELSE)&&(s=this.parseStatement(e),!s)?null:o.Node.createIfStatement(r,i,s,e.range(t,e.pos))}this.error(s.DiagnosticCode._0_expected,e.range(),")")}else this.error(s.DiagnosticCode._0_expected,e.range(),"(");return null}parseSwitchStatement(e){var t=e.tokenPos;if(e.skip(n.Token.OPENPAREN)){let r=this.parseExpression(e);if(!r)return null;if(e.skip(n.Token.CLOSEPAREN)){if(e.skip(n.Token.OPENBRACE)){let i=new Array;for(;!e.skip(n.Token.CLOSEBRACE);){let t=this.parseSwitchCase(e);if(!t)return null;i.push(t)}let s=o.Node.createSwitchStatement(r,i,e.range(t,e.pos));return e.skip(n.Token.SEMICOLON),s}this.error(s.DiagnosticCode._0_expected,e.range(),"{")}else this.error(s.DiagnosticCode._0_expected,e.range(),")")}else this.error(s.DiagnosticCode._0_expected,e.range(),"(");return null}parseSwitchCase(e){var t,r,i=e.tokenPos;if(e.skip(n.Token.CASE)){let a=this.parseExpression(e);if(!a)return null;if(e.skip(n.Token.COLON)){for(t=new Array;e.peek()!=n.Token.CASE&&e.nextToken!=n.Token.DEFAULT&&e.nextToken!=n.Token.CLOSEBRACE;){if(!(r=this.parseStatement(e)))return null;t.push(r)}return o.Node.createSwitchCase(a,t,e.range(i,e.pos))}this.error(s.DiagnosticCode._0_expected,e.range(),":")}else if(e.skip(n.Token.DEFAULT)){if(e.skip(n.Token.COLON)){for(t=new Array;e.peek()!=n.Token.CASE&&e.nextToken!=n.Token.DEFAULT&&e.nextToken!=n.Token.CLOSEBRACE;){if(!(r=this.parseStatement(e)))return null;t.push(r)}return o.Node.createSwitchCase(null,t,e.range(i,e.pos))}this.error(s.DiagnosticCode._0_expected,e.range(),":")}else this.error(s.DiagnosticCode._case_or_default_expected,e.range());return null}parseThrowStatement(e){var t=e.tokenPos,r=this.parseExpression(e);if(!r)return null;var i=o.Node.createThrowStatement(r,e.range(t,e.pos));return e.skip(n.Token.SEMICOLON),i}parseTryStatement(e){var t,r=e.tokenPos;if(e.skip(n.Token.OPENBRACE)){let i=new Array;for(;!e.skip(n.Token.CLOSEBRACE);){if(!(t=this.parseStatement(e)))return null;i.push(t)}let a=null,l=null,u=null;if(e.skip(n.Token.CATCH)){if(!e.skip(n.Token.OPENPAREN))return this.error(s.DiagnosticCode._0_expected,e.range(),"("),null;if(!e.skipIdentifier())return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;if(a=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),!e.skip(n.Token.CLOSEPAREN))return this.error(s.DiagnosticCode._0_expected,e.range(),")"),null;if(!e.skip(n.Token.OPENBRACE))return this.error(s.DiagnosticCode._0_expected,e.range(),"{"),null;for(l=[];!e.skip(n.Token.CLOSEBRACE);){if(!(t=this.parseStatement(e)))return null;l.push(t)}}if(e.skip(n.Token.FINALLY)){if(!e.skip(n.Token.OPENBRACE))return this.error(s.DiagnosticCode._0_expected,e.range(),"{"),null;for(u=[];!e.skip(n.Token.CLOSEBRACE);){if(!(t=this.parseStatement(e)))return null;u.push(t)}}if(!l&&!u)return this.error(s.DiagnosticCode._0_expected,e.range(),"catch"),null;let c=o.Node.createTryStatement(i,a,l,u,e.range(r,e.pos));return e.skip(n.Token.SEMICOLON),c}return this.error(s.DiagnosticCode._0_expected,e.range(),"{"),null}parseTypeDeclaration(e,t,r,a){if(e.skipIdentifier()){let l=o.Node.createIdentifierExpression(e.readIdentifier(),e.range()),u=null;if(e.skip(n.Token.LESSTHAN)){if(u=this.parseTypeParameters(e),!u)return null;t|=i.CommonFlags.GENERIC}if(e.skip(n.Token.EQUALS)){let i=this.parseType(e);if(!i)return null;let s=o.Node.createTypeDeclaration(l,r,t,u,i,e.range(a,e.pos));return e.skip(n.Token.SEMICOLON),s}this.error(s.DiagnosticCode._0_expected,e.range(),"=")}else this.error(s.DiagnosticCode.Identifier_expected,e.range());return null}parseVoidStatement(e){var t=e.tokenPos,r=this.parseExpression(e,21);if(!r)return null;var i=o.Node.createVoidStatement(r,e.range(t,e.pos));return e.skip(n.Token.SEMICOLON),i}parseWhileStatement(e){var t=e.tokenPos;if(e.skip(n.Token.OPENPAREN)){let r=this.parseExpression(e);if(!r)return null;if(e.skip(n.Token.CLOSEPAREN)){let i=this.parseStatement(e);if(!i)return null;let s=o.Node.createWhileStatement(r,i,e.range(t,e.pos));return e.skip(n.Token.SEMICOLON),s}this.error(s.DiagnosticCode._0_expected,e.range(),")")}else this.error(s.DiagnosticCode._0_expected,e.range(),"(");return null}parseExpressionStart(e){var t=e.next(n.IdentifierHandling.PREFER),r=e.tokenPos;switch(t){case n.Token.DOT_DOT_DOT:case n.Token.YIELD:case n.Token.EXCLAMATION:case n.Token.TILDE:case n.Token.PLUS:case n.Token.MINUS:case n.Token.TYPEOF:case n.Token.VOID:case n.Token.DELETE:{let i=this.parseExpression(e,17);return i?o.Node.createUnaryPrefixExpression(t,i,e.range(r,e.pos)):null}case n.Token.PLUS_PLUS:case n.Token.MINUS_MINUS:{let i=this.parseExpression(e,17);if(!i)return null;switch(i.kind){case o.NodeKind.IDENTIFIER:case o.NodeKind.ELEMENTACCESS:case o.NodeKind.PROPERTYACCESS:break;default:this.error(s.DiagnosticCode.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access,i.range)}return o.Node.createUnaryPrefixExpression(t,i,e.range(r,e.pos))}case n.Token.NEW:{if(!e.skipIdentifier())return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;let t=this.parseTypeName(e);if(!t)return null;let i=null,a=null;if(e.skip(n.Token.OPENPAREN)||null!==(i=this.tryParseTypeArgumentsBeforeArguments(e))){if(a=this.parseArguments(e),!a)return null}else a=[];return o.Node.createNewExpression(t,i,a,e.range(r,e.pos))}case n.Token.NULL:return o.Node.createNullExpression(e.range());case n.Token.TRUE:return o.Node.createTrueExpression(e.range());case n.Token.FALSE:return o.Node.createFalseExpression(e.range());case n.Token.THIS:return o.Node.createThisExpression(e.range());case n.Token.CONSTRUCTOR:return o.Node.createConstructorExpression(e.range());case n.Token.OPENPAREN:{if(e.skip(n.Token.CLOSEPAREN))return this.parseFunctionExpressionCommon(e,o.Node.createEmptyIdentifierExpression(e.range(r)),[],null,1);let t=e.mark(),i=!0;do{switch(e.next(n.IdentifierHandling.PREFER)){case n.Token.DOT_DOT_DOT:return e.reset(t),this.parseFunctionExpression(e);case n.Token.IDENTIFIER:switch(e.readIdentifier(),e.next()){case n.Token.CLOSEPAREN:if(!e.skip(n.Token.COLON)&&!e.skip(n.Token.EQUALS_GREATERTHAN)){i=!1;break}case n.Token.COLON:return e.reset(t),this.parseFunctionExpression(e);case n.Token.QUESTION:if(e.skip(n.Token.COLON)||e.skip(n.Token.COMMA)||e.skip(n.Token.CLOSEPAREN))return e.reset(t),this.parseFunctionExpression(e);i=!1;break;case n.Token.COMMA:break;default:i=!1}break;default:i=!1}}while(i);e.reset(t);let a=this.parseExpression(e);return a?e.skip(n.Token.CLOSEPAREN)?(a=o.Node.createParenthesizedExpression(a,e.range(r,e.pos)),this.maybeParseCallExpression(e,a)):(this.error(s.DiagnosticCode._0_expected,e.range(),")"),null):null}case n.Token.OPENBRACKET:{let t=new Array;for(;!e.skip(n.Token.CLOSEBRACKET);){let r;if(e.peek()==n.Token.COMMA)r=o.Node.createOmittedExpression(e.range(e.pos));else if(r=this.parseExpression(e,2),!r)return null;if(t.push(r),!e.skip(n.Token.COMMA)){if(e.skip(n.Token.CLOSEBRACKET))break;return this.error(s.DiagnosticCode._0_expected,e.range(),"]"),null}}return o.Node.createArrayLiteralExpression(t,e.range(r,e.pos))}case n.Token.OPENBRACE:{let t,r=e.tokenPos,i=new Array,a=new Array;for(;!e.skip(n.Token.CLOSEBRACE);){if(e.skipIdentifier())t=o.Node.createIdentifierExpression(e.readIdentifier(),e.range());else{if(!e.skip(n.Token.STRINGLITERAL))return this.error(s.DiagnosticCode.Identifier_expected,e.range()),null;t=o.Node.createIdentifierExpression(e.readString(),e.range()),t.isQuoted=!0}if(i.push(t),e.skip(n.Token.COLON)){let t=this.parseExpression(e,2);if(!t)return null;a.push(t)}else{if(t.isQuoted)return this.error(s.DiagnosticCode._0_expected,e.range(),":"),null;a.push(t)}if(!e.skip(n.Token.COMMA)){if(e.skip(n.Token.CLOSEBRACE))break;return this.error(s.DiagnosticCode._0_expected,e.range(),"}"),null}}return o.Node.createObjectLiteralExpression(i,a,e.range(r,e.pos))}case n.Token.LESSTHAN:{let t=this.parseType(e);if(!t)return null;if(!e.skip(n.Token.GREATERTHAN))return this.error(s.DiagnosticCode._0_expected,e.range(),">"),null;let i=this.parseExpression(e,19);return i?o.Node.createAssertionExpression(o.AssertionKind.PREFIX,i,t,e.range(r,e.pos)):null}case n.Token.IDENTIFIER:{let t=e.readIdentifier();if("null"==t)return o.Node.createNullExpression(e.range());let i=o.Node.createIdentifierExpression(t,e.range(r,e.pos));return e.skip(n.Token.TEMPLATELITERAL)?this.parseTemplateLiteral(e,i):e.peek(!0)!=n.Token.EQUALS_GREATERTHAN||e.nextTokenOnNewLine?this.maybeParseCallExpression(e,i,!0):this.parseFunctionExpressionCommon(e,o.Node.createEmptyIdentifierExpression(e.range(r)),[o.Node.createParameter(o.ParameterKind.DEFAULT,i,o.Node.createOmittedType(i.range.atEnd),null,i.range)],null,2,r)}case n.Token.SUPER:{e.peek()!=n.Token.DOT&&e.nextToken!=n.Token.OPENPAREN&&this.error(s.DiagnosticCode._super_must_be_followed_by_an_argument_list_or_member_access,e.range());let t=o.Node.createSuperExpression(e.range(r,e.pos));return this.maybeParseCallExpression(e,t)}case n.Token.STRINGLITERAL:return o.Node.createStringLiteralExpression(e.readString(),e.range(r,e.pos));case n.Token.TEMPLATELITERAL:return this.parseTemplateLiteral(e);case n.Token.INTEGERLITERAL:{let t=e.readInteger();return e.checkForIdentifierStartAfterNumericLiteral(),o.Node.createIntegerLiteralExpression(t,e.range(r,e.pos))}case n.Token.FLOATLITERAL:{let t=e.readFloat();return e.checkForIdentifierStartAfterNumericLiteral(),o.Node.createFloatLiteralExpression(t,e.range(r,e.pos))}case n.Token.SLASH:{let t=e.readRegexpPattern();return e.skip(n.Token.SLASH)?o.Node.createRegexpLiteralExpression(t,e.readRegexpFlags(),e.range(r,e.pos)):(this.error(s.DiagnosticCode._0_expected,e.range(),"/"),null)}case n.Token.FUNCTION:{let t=this.parseFunctionExpression(e);return t?this.maybeParseCallExpression(e,t):null}case n.Token.CLASS:return this.parseClassExpression(e);default:return t==n.Token.ENDOFFILE?this.error(s.DiagnosticCode.Unexpected_end_of_text,e.range(r)):this.error(s.DiagnosticCode.Expression_expected,e.range()),null}}tryParseTypeArgumentsBeforeArguments(e){var t=e.mark();if(!e.skip(n.Token.LESSTHAN))return null;var r=e.tokenPos,i=null;do{if(e.peek()===n.Token.GREATERTHAN)break;let r=this.parseType(e,!0,!0);if(!r)return e.reset(t),null;i?i.push(r):i=[r]}while(e.skip(n.Token.COMMA));if(e.skip(n.Token.GREATERTHAN)){let t=e.pos;if(e.skip(n.Token.OPENPAREN))return i||this.error(s.DiagnosticCode.Type_argument_list_cannot_be_empty,e.range(r,t)),i}return e.reset(t),null}parseArguments(e){for(var t=new Array;!e.skip(n.Token.CLOSEPAREN);){let r=this.parseExpression(e,2);if(!r)return null;if(t.push(r),!e.skip(n.Token.COMMA)){if(e.skip(n.Token.CLOSEPAREN))break;return this.error(s.DiagnosticCode._0_expected,e.range(),")"),null}}return t}parseExpression(e,t=1){assert(0!=t);var r=this.parseExpressionStart(e);if(!r)return null;for(var i,a=r.range.start;(i=c(e.peek()))>=t;){let l=e.next();switch(l){case n.Token.AS:if(e.skip(n.Token.CONST))r=o.Node.createAssertionExpression(o.AssertionKind.CONST,r,null,e.range(a,e.pos));else{let t=this.parseType(e);if(!t)return null;r=o.Node.createAssertionExpression(o.AssertionKind.AS,r,t,e.range(a,e.pos))}break;case n.Token.EXCLAMATION:r=o.Node.createAssertionExpression(o.AssertionKind.NONNULL,r,null,e.range(a,e.pos)),r=this.maybeParseCallExpression(e,r);break;case n.Token.INSTANCEOF:{let t=this.parseType(e);if(!t)return null;r=o.Node.createInstanceOfExpression(r,t,e.range(a,e.pos));break}case n.Token.OPENBRACKET:{let t=this.parseExpression(e);if(!t)return null;if(!e.skip(n.Token.CLOSEBRACKET))return this.error(s.DiagnosticCode._0_expected,e.range(),"]"),null;r=o.Node.createElementAccessExpression(r,t,e.range(a,e.pos)),r=this.maybeParseCallExpression(e,r);break}case n.Token.PLUS_PLUS:case n.Token.MINUS_MINUS:r.kind!=o.NodeKind.IDENTIFIER&&r.kind!=o.NodeKind.ELEMENTACCESS&&r.kind!=o.NodeKind.PROPERTYACCESS&&this.error(s.DiagnosticCode.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access,r.range),r=o.Node.createUnaryPostfixExpression(l,r,e.range(a,e.pos));break;case n.Token.QUESTION:{let i=this.parseExpression(e);if(!i)return null;if(!e.skip(n.Token.COLON))return this.error(s.DiagnosticCode._0_expected,e.range(),":"),null;let l=this.parseExpression(e,t>1?2:1);if(!l)return null;r=o.Node.createTernaryExpression(r,i,l,e.range(a,e.pos));break}case n.Token.COMMA:{let t=[r];do{if(!(r=this.parseExpression(e,2)))return null;t.push(r)}while(e.skip(n.Token.COMMA));r=o.Node.createCommaExpression(t,e.range(a,e.pos));break}case n.Token.DOT:if(e.skipIdentifier(n.IdentifierHandling.ALWAYS)){let t=o.Node.createIdentifierExpression(e.readIdentifier(),e.range());r=o.Node.createPropertyAccessExpression(r,t,e.range(a,e.pos))}else{let t=this.parseExpression(e,i+1);if(!t)return null;if(t.kind!=o.NodeKind.CALL)return this.error(s.DiagnosticCode.Identifier_expected,t.range),null;if(!(r=this.joinPropertyCall(e,a,r,t)))return null}if(e.skip(n.Token.TEMPLATELITERAL)){if(!(r=this.parseTemplateLiteral(e,r)))return null}else r=this.maybeParseCallExpression(e,r,!0);break;case n.Token.EQUALS:case n.Token.PLUS_EQUALS:case n.Token.MINUS_EQUALS:case n.Token.ASTERISK_ASTERISK_EQUALS:case n.Token.ASTERISK_EQUALS:case n.Token.SLASH_EQUALS:case n.Token.PERCENT_EQUALS:case n.Token.LESSTHAN_LESSTHAN_EQUALS:case n.Token.GREATERTHAN_GREATERTHAN_EQUALS:case n.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:case n.Token.AMPERSAND_EQUALS:case n.Token.CARET_EQUALS:case n.Token.BAR_EQUALS:case n.Token.ASTERISK_ASTERISK:{let t=this.parseExpression(e,i);if(!t)return null;r=o.Node.createBinaryExpression(l,r,t,e.range(a,e.pos));break}case n.Token.LESSTHAN:case n.Token.GREATERTHAN:case n.Token.LESSTHAN_EQUALS:case n.Token.GREATERTHAN_EQUALS:case n.Token.EQUALS_EQUALS:case n.Token.EQUALS_EQUALS_EQUALS:case n.Token.EXCLAMATION_EQUALS_EQUALS:case n.Token.EXCLAMATION_EQUALS:case n.Token.PLUS:case n.Token.MINUS:case n.Token.ASTERISK:case n.Token.SLASH:case n.Token.PERCENT:case n.Token.LESSTHAN_LESSTHAN:case n.Token.GREATERTHAN_GREATERTHAN:case n.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:case n.Token.AMPERSAND:case n.Token.BAR:case n.Token.CARET:case n.Token.AMPERSAND_AMPERSAND:case n.Token.BAR_BAR:{let t=this.parseExpression(e,i+1);if(!t)return null;r=o.Node.createBinaryExpression(l,r,t,e.range(a,e.pos));break}default:assert(!1)}}return r}parseTemplateLiteral(e,t=null){var r=t?t.range.start:e.tokenPos,i=new Array,a=new Array,l=new Array;for(i.push(e.readString(0,null!=t)),a.push(e.source.text.substring(e.readStringStart,e.readStringEnd));e.readingTemplateString;){let r=this.parseExpression(e);if(!r)return null;if(l.push(r),!e.skip(n.Token.CLOSEBRACE))return this.error(s.DiagnosticCode._0_expected,e.range(),"}"),null;i.push(e.readString(96,null!=t)),a.push(e.source.text.substring(e.readStringStart,e.readStringEnd))}return o.Node.createTemplateLiteralExpression(t,i,a,l,e.range(r,e.pos))}joinPropertyCall(e,t,r,i){var n=i.expression;switch(n.kind){case o.NodeKind.IDENTIFIER:i.expression=o.Node.createPropertyAccessExpression(r,n,e.range(t,e.pos));break;case o.NodeKind.CALL:{let s=this.joinPropertyCall(e,t,r,n);if(!s)return null;i.expression=s,i.range=e.range(t,e.pos);break}default:return this.error(s.DiagnosticCode.Identifier_expected,i.range),null}return i}maybeParseCallExpression(e,t,r=!1){for(var i=null;e.skip(n.Token.OPENPAREN)||r&&null!==(i=this.tryParseTypeArgumentsBeforeArguments(e));){let n=this.parseArguments(e);if(!n)break;t=o.Node.createCallExpression(t,i,n,e.range(t.range.start,e.pos)),r=!1}return t}skipStatement(e){for(e.peek(!0),e.nextTokenOnNewLine&&e.next();;){let t=e.peek(!0);if(t==n.Token.ENDOFFILE||t==n.Token.SEMICOLON){e.next();break}if(e.nextTokenOnNewLine)break;switch(e.next()){case n.Token.IDENTIFIER:e.readIdentifier();break;case n.Token.STRINGLITERAL:case n.Token.TEMPLATELITERAL:e.readString();break;case n.Token.INTEGERLITERAL:e.readInteger(),e.checkForIdentifierStartAfterNumericLiteral();break;case n.Token.FLOATLITERAL:e.readFloat(),e.checkForIdentifierStartAfterNumericLiteral();break;case n.Token.OPENBRACE:this.skipBlock(e)}}e.readingTemplateString=!1}skipBlock(e){var t=1,r=!0;do{switch(e.next()){case n.Token.ENDOFFILE:this.error(s.DiagnosticCode._0_expected,e.range(),"}"),r=!1;break;case n.Token.OPENBRACE:++t;break;case n.Token.CLOSEBRACE:--t||(r=!1);break;case n.Token.IDENTIFIER:e.readIdentifier();break;case n.Token.STRINGLITERAL:e.readString();break;case n.Token.INTEGERLITERAL:e.readInteger(),e.checkForIdentifierStartAfterNumericLiteral();break;case n.Token.FLOATLITERAL:e.readFloat(),e.checkForIdentifierStartAfterNumericLiteral()}}while(r)}}function c(e){switch(e){case n.Token.COMMA:return 1;case n.Token.EQUALS:case n.Token.PLUS_EQUALS:case n.Token.MINUS_EQUALS:case n.Token.ASTERISK_ASTERISK_EQUALS:case n.Token.ASTERISK_EQUALS:case n.Token.SLASH_EQUALS:case n.Token.PERCENT_EQUALS:case n.Token.LESSTHAN_LESSTHAN_EQUALS:case n.Token.GREATERTHAN_GREATERTHAN_EQUALS:case n.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:case n.Token.AMPERSAND_EQUALS:case n.Token.CARET_EQUALS:case n.Token.BAR_EQUALS:return 4;case n.Token.QUESTION:return 5;case n.Token.BAR_BAR:return 6;case n.Token.AMPERSAND_AMPERSAND:return 7;case n.Token.BAR:return 8;case n.Token.CARET:return 9;case n.Token.AMPERSAND:return 10;case n.Token.EQUALS_EQUALS:case n.Token.EXCLAMATION_EQUALS:case n.Token.EQUALS_EQUALS_EQUALS:case n.Token.EXCLAMATION_EQUALS_EQUALS:return 11;case n.Token.AS:case n.Token.IN:case n.Token.INSTANCEOF:case n.Token.LESSTHAN:case n.Token.GREATERTHAN:case n.Token.LESSTHAN_EQUALS:case n.Token.GREATERTHAN_EQUALS:return 12;case n.Token.LESSTHAN_LESSTHAN:case n.Token.GREATERTHAN_GREATERTHAN:case n.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:return 13;case n.Token.PLUS:case n.Token.MINUS:return 14;case n.Token.ASTERISK:case n.Token.SLASH:case n.Token.PERCENT:return 15;case n.Token.ASTERISK_ASTERISK:return 16;case n.Token.PLUS_PLUS:case n.Token.MINUS_MINUS:return 18;case n.Token.DOT:case n.Token.NEW:case n.Token.OPENBRACKET:case n.Token.EXCLAMATION:return 20}return 0}t.Parser=u,function(e){e[e.NONE=0]="NONE",e[e.COMMA=1]="COMMA",e[e.SPREAD=2]="SPREAD",e[e.YIELD=3]="YIELD",e[e.ASSIGNMENT=4]="ASSIGNMENT",e[e.CONDITIONAL=5]="CONDITIONAL",e[e.LOGICAL_OR=6]="LOGICAL_OR",e[e.LOGICAL_AND=7]="LOGICAL_AND",e[e.BITWISE_OR=8]="BITWISE_OR",e[e.BITWISE_XOR=9]="BITWISE_XOR",e[e.BITWISE_AND=10]="BITWISE_AND",e[e.EQUALITY=11]="EQUALITY",e[e.RELATIONAL=12]="RELATIONAL",e[e.SHIFT=13]="SHIFT",e[e.ADDITIVE=14]="ADDITIVE",e[e.MULTIPLICATIVE=15]="MULTIPLICATIVE",e[e.EXPONENTIATED=16]="EXPONENTIATED",e[e.UNARY_PREFIX=17]="UNARY_PREFIX",e[e.UNARY_POSTFIX=18]="UNARY_POSTFIX",e[e.CALL=19]="CALL",e[e.MEMBERACCESS=20]="MEMBERACCESS",e[e.GROUPING=21]="GROUPING"}(t.Precedence||(t.Precedence={}))},416:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findUsedLocals=void 0;const i=r(666),n=r(292);class s extends i.Visitor{constructor(e=new Set){super(),this.used=e}visitLocalGet(e){this.used.add(n._BinaryenLocalGetGetIndex(e))}visitLocalSet(e){this.used.add(n._BinaryenLocalSetGetIndex(e))}}var a=null;t.findUsedLocals=function(e,t=new Set){var r=a;return r?r.used=t:a=r=new s(t),r.visit(e),t}},666:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceChild=t.Pass=t.Visitor=void 0;const i=r(656),n=r(292);class s{constructor(){this.stack=new Array,this._currentExpression=0}get currentExpression(){var e=this._currentExpression;if(!e)throw new Error("not walking expressions");return e}get parentExpressionOrNull(){var e=this.stack,t=e.length;return t?e[t-1]:0}visitBlock(e){}visitIf(e){}visitLoop(e){}visitBreak(e){}visitSwitch(e){}visitCallPre(e){}visitCall(e){}visitCallIndirectPre(e){}visitCallIndirect(e){}visitLocalGet(e){}visitLocalSet(e){}visitGlobalGet(e){}visitGlobalSet(e){}visitLoad(e){}visitStore(e){}visitConst(e){}visitUnary(e){}visitBinary(e){}visitSelect(e){}visitDrop(e){}visitReturn(e){}visitMemorySize(e){}visitMemoryGrow(e){}visitNop(e){}visitUnreachable(e){}visitAtomicRMW(e){}visitAtomicCmpxchg(e){}visitAtomicWait(e){}visitAtomicNotify(e){}visitAtomicFence(e){}visitSIMDExtract(e){}visitSIMDReplace(e){}visitSIMDShuffle(e){}visitSIMDTernary(e){}visitSIMDShift(e){}visitSIMDLoad(e){}visitMemoryInit(e){}visitDataDrop(e){}visitMemoryCopy(e){}visitMemoryFill(e){}visitPop(e){}visitRefNull(e){}visitRefIs(e){}visitRefFunc(e){}visitRefEq(e){}visitTry(e){}visitThrow(e){}visitRethrow(e){}visitTupleMake(e){}visitTupleExtract(e){}visitI31New(e){}visitI31Get(e){}visitCallRef(e){}visitRefTest(e){}visitRefCast(e){}visitBrOn(e){}visitRttCanon(e){}visitRttSub(e){}visitStructNew(e){}visitStructGet(e){}visitStructSet(e){}visitArrayNew(e){}visitArrayGet(e){}visitArraySet(e){}visitArrayLen(e){}visitRefAs(e){}visitName(e){}visitLabel(e){}visitIndex(e){}visitEvent(e){}visit(e){let t=this._currentExpression;switch(this._currentExpression=assert(e),n._BinaryenExpressionGetId(e)){case i.ExpressionId.Block:{this.stack.push(e);let t=n._BinaryenBlockGetName(e);t&&this.visitLabel(t);for(let t=0,r=n._BinaryenBlockGetNumChildren(e);t<r;++t)this.visit(n._BinaryenBlockGetChildAt(e,t));assert(this.stack.pop()==e),this.visitBlock(e);break}case i.ExpressionId.If:{this.stack.push(e),this.visit(n._BinaryenIfGetCondition(e)),this.visit(n._BinaryenIfGetIfTrue(e));let t=n._BinaryenIfGetIfFalse(e);t&&this.visit(t),assert(this.stack.pop()==e),this.visitIf(e);break}case i.ExpressionId.Loop:{this.stack.push(e);let t=n._BinaryenLoopGetName(e);t&&this.visitLabel(t),this.visit(n._BinaryenLoopGetBody(e)),assert(this.stack.pop()==e),this.visitLoop(e);break}case i.ExpressionId.Break:{this.stack.push(e),this.visitLabel(n._BinaryenBreakGetName(e));let t=n._BinaryenBreakGetCondition(e);t&&this.visit(t);let r=n._BinaryenBreakGetValue(e);r&&this.visit(r),assert(this.stack.pop()==e),this.visitBreak(e);break}case i.ExpressionId.Switch:{this.stack.push(e);let t=n._BinaryenSwitchGetDefaultName(e);t&&this.visitLabel(t);let r=n._BinaryenSwitchGetNumNames(e);for(let t=0;t<r;++t)this.visitLabel(n._BinaryenSwitchGetNameAt(e,t));this.visit(n._BinaryenSwitchGetCondition(e));let i=n._BinaryenSwitchGetValue(e);i&&this.visit(i),assert(this.stack.pop()==e),this.visitSwitch(e);break}case i.ExpressionId.Call:{this.visitCallPre(e),this.stack.push(e),this.visitName(n._BinaryenCallGetTarget(e));let t=n._BinaryenCallGetNumOperands(e);for(let r=0;r<t;++r)this.visit(n._BinaryenCallGetOperandAt(e,r));assert(this.stack.pop()==e),this.visitCall(e);break}case i.ExpressionId.CallIndirect:this.visitCallIndirectPre(e),this.stack.push(e),this.visit(n._BinaryenCallIndirectGetTarget(e));for(let t=0,r=n._BinaryenCallIndirectGetNumOperands(e);t<r;++t)this.visit(n._BinaryenCallIndirectGetOperandAt(e,t));assert(this.stack.pop()==e),this.visitCallIndirect(e);break;case i.ExpressionId.LocalGet:this.stack.push(e),this.visitIndex(n._BinaryenLocalGetGetIndex(e)),assert(this.stack.pop()==e),this.visitLocalGet(e);break;case i.ExpressionId.LocalSet:this.stack.push(e),this.visitIndex(n._BinaryenLocalSetGetIndex(e)),this.visit(n._BinaryenLocalSetGetValue(e)),assert(this.stack.pop()==e),this.visitLocalSet(e);break;case i.ExpressionId.GlobalGet:this.stack.push(e),this.visitName(n._BinaryenGlobalGetGetName(e)),assert(this.stack.pop()==e),this.visitGlobalGet(e);break;case i.ExpressionId.GlobalSet:this.stack.push(e),this.visitName(n._BinaryenGlobalSetGetName(e)),this.visit(n._BinaryenGlobalSetGetValue(e)),assert(this.stack.pop()==e),this.visitGlobalSet(e);break;case i.ExpressionId.Load:this.stack.push(e),this.visit(n._BinaryenLoadGetPtr(e)),assert(this.stack.pop()==e),this.visitLoad(e);break;case i.ExpressionId.Store:this.stack.push(e),this.visit(n._BinaryenStoreGetPtr(e)),this.visit(n._BinaryenStoreGetValue(e)),assert(this.stack.pop()==e),this.visitStore(e);break;case i.ExpressionId.Const:this.visitConst(e);break;case i.ExpressionId.Unary:this.stack.push(e),this.visit(n._BinaryenUnaryGetValue(e)),assert(this.stack.pop()==e),this.visitUnary(e);break;case i.ExpressionId.Binary:this.stack.push(e),this.visit(n._BinaryenBinaryGetLeft(e)),this.visit(n._BinaryenBinaryGetRight(e)),assert(this.stack.pop()==e),this.visitBinary(e);break;case i.ExpressionId.Select:this.stack.push(e),this.visit(n._BinaryenSelectGetIfTrue(e)),this.visit(n._BinaryenSelectGetIfFalse(e)),this.visit(n._BinaryenSelectGetCondition(e)),assert(this.stack.pop()==e),this.visitSelect(e);break;case i.ExpressionId.Drop:this.stack.push(e),this.visit(n._BinaryenDropGetValue(e)),assert(this.stack.pop()==e),this.visitDrop(e);break;case i.ExpressionId.Return:{let t=n._BinaryenReturnGetValue(e);t&&(this.stack.push(e),this.visit(t),assert(this.stack.pop()==e)),this.visitReturn(e);break}case i.ExpressionId.MemorySize:this.visitMemorySize(e);break;case i.ExpressionId.MemoryGrow:this.stack.push(e),this.visit(n._BinaryenMemoryGrowGetDelta(e)),assert(this.stack.pop()==e),this.visitMemoryGrow(e);break;case i.ExpressionId.Nop:this.visitNop(e);break;case i.ExpressionId.Unreachable:this.visitUnreachable(e);break;case i.ExpressionId.AtomicRMW:this.stack.push(e),this.visit(n._BinaryenAtomicRMWGetPtr(e)),this.visit(n._BinaryenAtomicRMWGetValue(e)),assert(this.stack.pop()==e),this.visitAtomicRMW(e);break;case i.ExpressionId.AtomicCmpxchg:this.stack.push(e),this.visit(n._BinaryenAtomicCmpxchgGetPtr(e)),this.visit(n._BinaryenAtomicCmpxchgGetExpected(e)),this.visit(n._BinaryenAtomicCmpxchgGetReplacement(e)),assert(this.stack.pop()==e),this.visitAtomicCmpxchg(e);break;case i.ExpressionId.AtomicWait:this.stack.push(e),this.visit(n._BinaryenAtomicWaitGetPtr(e)),this.visit(n._BinaryenAtomicWaitGetExpected(e)),this.visit(n._BinaryenAtomicWaitGetTimeout(e)),assert(this.stack.pop()==e),this.visitAtomicWait(e);break;case i.ExpressionId.AtomicNotify:this.stack.push(e),this.visit(n._BinaryenAtomicNotifyGetPtr(e)),this.visit(n._BinaryenAtomicNotifyGetNotifyCount(e)),assert(this.stack.pop()==e),this.visitAtomicNotify(e);break;case i.ExpressionId.AtomicFence:this.visitAtomicFence(e);break;case i.ExpressionId.SIMDExtract:this.stack.push(e),this.visit(n._BinaryenSIMDExtractGetVec(e)),assert(this.stack.pop()==e),this.visitSIMDExtract(e);break;case i.ExpressionId.SIMDReplace:this.stack.push(e),this.visit(n._BinaryenSIMDReplaceGetVec(e)),this.visit(n._BinaryenSIMDReplaceGetValue(e)),assert(this.stack.pop()==e),this.visitSIMDReplace(e);break;case i.ExpressionId.SIMDShuffle:this.stack.push(e),this.visit(n._BinaryenSIMDShuffleGetLeft(e)),this.visit(n._BinaryenSIMDShuffleGetRight(e)),assert(this.stack.pop()==e),this.visitSIMDShuffle(e);break;case i.ExpressionId.SIMDTernary:this.stack.push(e),this.visit(n._BinaryenSIMDTernaryGetA(e)),this.visit(n._BinaryenSIMDTernaryGetB(e)),this.visit(n._BinaryenSIMDTernaryGetC(e)),assert(this.stack.pop()==e),this.visitSIMDTernary(e);break;case i.ExpressionId.SIMDShift:this.stack.push(e),this.visit(n._BinaryenSIMDShiftGetVec(e)),this.visit(n._BinaryenSIMDShiftGetShift(e)),assert(this.stack.pop()==e),this.visitSIMDShift(e);break;case i.ExpressionId.SIMDLoad:this.stack.push(e),this.visit(n._BinaryenSIMDLoadGetPtr(e)),assert(this.stack.pop()==e),this.visitSIMDLoad(e);break;case i.ExpressionId.MemoryInit:this.stack.push(e),this.visit(n._BinaryenMemoryInitGetDest(e)),this.visit(n._BinaryenMemoryInitGetOffset(e)),this.visit(n._BinaryenMemoryInitGetSize(e)),assert(this.stack.pop()==e),this.visitMemoryInit(e);break;case i.ExpressionId.DataDrop:this.visitDataDrop(e);break;case i.ExpressionId.MemoryCopy:this.stack.push(e),this.visit(n._BinaryenMemoryCopyGetDest(e)),this.visit(n._BinaryenMemoryCopyGetSource(e)),this.visit(n._BinaryenMemoryCopyGetSize(e)),assert(this.stack.pop()==e),this.visitMemoryCopy(e);break;case i.ExpressionId.MemoryFill:this.stack.push(e),this.visit(n._BinaryenMemoryFillGetDest(e)),this.visit(n._BinaryenMemoryFillGetValue(e)),this.visit(n._BinaryenMemoryFillGetSize(e)),assert(this.stack.pop()==e),this.visitMemoryFill(e);break;case i.ExpressionId.Pop:this.visitPop(e);break;case i.ExpressionId.RefNull:this.visitRefNull(e);break;case i.ExpressionId.RefIs:this.stack.push(e),this.visit(n._BinaryenRefIsGetValue(e)),assert(this.stack.pop()==e),this.visitRefIs(e);break;case i.ExpressionId.RefFunc:this.stack.push(e),this.visitName(n._BinaryenRefFuncGetFunc(e)),assert(this.stack.pop()==e),this.visitRefFunc(e);break;case i.ExpressionId.RefEq:this.stack.push(e),this.visit(n._BinaryenRefEqGetLeft(e)),this.visit(n._BinaryenRefEqGetRight(e)),assert(this.stack.pop()==e),this.visitRefEq(e);break;case i.ExpressionId.Try:{this.stack.push(e),this.visit(n._BinaryenTryGetBody(e));let t=n._BinaryenTryGetNumCatchBodies(e);for(let r=0;r<t;++r)this.visit(n._BinaryenTryGetCatchBodyAt(e,r));assert(this.stack.pop()==e),this.visitTry(e);break}case i.ExpressionId.Throw:{this.stack.push(e),this.visitEvent(n._BinaryenThrowGetEvent(e));let t=n._BinaryenThrowGetNumOperands(e);for(let r=0;r<t;++r)this.visit(n._BinaryenThrowGetOperandAt(e,r));assert(this.stack.pop()==e),this.visitThrow(e);break}case i.ExpressionId.Rethrow:this.visitRethrow(e);break;case i.ExpressionId.TupleMake:{let t=n._BinaryenTupleMakeGetNumOperands(e);if(t){this.stack.push(e);for(let r=0;r<t;++r)this.visit(n._BinaryenTupleMakeGetOperandAt(e,r));assert(this.stack.pop()==e)}this.visitTupleMake(e);break}case i.ExpressionId.TupleExtract:this.stack.push(e),this.visit(n._BinaryenTupleExtractGetTuple(e)),assert(this.stack.pop()==e),this.visitTupleExtract(e);break;case i.ExpressionId.I31New:this.stack.push(e),this.visit(n._BinaryenI31NewGetValue(e)),assert(this.stack.pop()==e),this.visitI31New(e);break;case i.ExpressionId.I31Get:this.stack.push(e),this.visit(n._BinaryenI31GetGetI31(e)),assert(this.stack.pop()==e),this.visitI31Get(e);break;case i.ExpressionId.CallRef:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitCallRef(e);break;case i.ExpressionId.RefTest:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitRefTest(e);break;case i.ExpressionId.RefCast:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitRefCast(e);break;case i.ExpressionId.BrOn:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitBrOn(e);break;case i.ExpressionId.RttCanon:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitRttCanon(e);break;case i.ExpressionId.RttSub:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitRttSub(e);break;case i.ExpressionId.StructNew:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitStructNew(e);break;case i.ExpressionId.StructGet:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitStructGet(e);break;case i.ExpressionId.StructSet:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitStructSet(e);break;case i.ExpressionId.ArrayNew:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitArrayNew(e);break;case i.ExpressionId.ArrayGet:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitArrayGet(e);break;case i.ExpressionId.ArraySet:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitArraySet(e);break;case i.ExpressionId.ArrayLen:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitArrayLen(e);break;case i.ExpressionId.RefAs:this.stack.push(e),assert(!1),assert(this.stack.pop()==e),this.visitRefAs(e);break;default:throw new Error("unexpected expression kind")}this._currentExpression=t}}t.Visitor=s;function a(e,t,r){switch(n._BinaryenExpressionGetId(e)){case i.ExpressionId.Block:{let i=n._BinaryenBlockGetNumChildren(e);for(let s=0;s<i;++s){let i=n._BinaryenBlockGetChildAt(e,s);if(i==t)return n._BinaryenBlockSetChildAt(e,s,r),i}break}case i.ExpressionId.If:{let i=n._BinaryenIfGetCondition(e);if(i==t)return n._BinaryenIfSetCondition(e,r),i;let s=n._BinaryenIfGetIfTrue(e);if(s==t)return n._BinaryenIfSetIfTrue(e,r),s;let a=n._BinaryenIfGetIfFalse(e);if(a==t)return n._BinaryenIfSetIfFalse(e,r),a;break}case i.ExpressionId.Loop:{let i=n._BinaryenLoopGetBody(e);if(i==t)return n._BinaryenLoopSetBody(e,r),i;break}case i.ExpressionId.Break:{let i=n._BinaryenBreakGetCondition(e);if(i==t)return n._BinaryenBreakSetCondition(e,r),i;let s=n._BinaryenBreakGetValue(e);if(s==t)return n._BinaryenBreakSetValue(e,r),s;break}case i.ExpressionId.Switch:{let i=n._BinaryenSwitchGetCondition(e);if(i==t)return n._BinaryenSwitchSetCondition(e,r),i;let s=n._BinaryenSwitchGetValue(e);if(s==t)return n._BinaryenSwitchSetValue(e,r),s;break}case i.ExpressionId.Call:{let i=n._BinaryenCallGetNumOperands(e);for(let s=0;s<i;++s){let i=n._BinaryenCallGetOperandAt(e,s);if(i==t)return n._BinaryenCallSetOperandAt(e,s,r),i}break}case i.ExpressionId.CallIndirect:{let i=n._BinaryenCallIndirectGetTarget(e);if(i==t)return n._BinaryenCallIndirectSetTarget(e,r),i;let s=n._BinaryenCallIndirectGetNumOperands(e);for(let i=0;i<s;++i){let s=n._BinaryenCallIndirectGetOperandAt(e,i);if(s==t)return n._BinaryenCallIndirectSetOperandAt(e,i,r),s}break}case i.ExpressionId.LocalGet:break;case i.ExpressionId.LocalSet:{let i=n._BinaryenLocalSetGetValue(e);if(i==t)return n._BinaryenLocalSetSetValue(e,r),i;break}case i.ExpressionId.GlobalGet:break;case i.ExpressionId.GlobalSet:{let i=n._BinaryenGlobalSetGetValue(e);if(i==t)return n._BinaryenGlobalSetSetValue(e,r),i;break}case i.ExpressionId.Load:{let i=n._BinaryenLoadGetPtr(e);if(i==t)return n._BinaryenLoadSetPtr(e,r),i;break}case i.ExpressionId.Store:{let i=n._BinaryenStoreGetPtr(e);if(i==t)return n._BinaryenStoreSetPtr(e,r),i;let s=n._BinaryenStoreGetValue(e);if(s==t)return n._BinaryenStoreSetValue(e,r),s;break}case i.ExpressionId.Const:break;case i.ExpressionId.Unary:{let i=n._BinaryenUnaryGetValue(e);if(i==t)return n._BinaryenUnarySetValue(e,r),i;break}case i.ExpressionId.Binary:{let i=n._BinaryenBinaryGetLeft(e);if(i==t)return n._BinaryenBinarySetLeft(e,r),i;let s=n._BinaryenBinaryGetRight(e);if(s==t)return n._BinaryenBinarySetRight(e,r),s;break}case i.ExpressionId.Select:{let i=n._BinaryenSelectGetIfTrue(e);if(i==t)return n._BinaryenSelectSetIfTrue(e,r),i;let s=n._BinaryenSelectGetIfFalse(e);if(s==t)return n._BinaryenSelectSetIfFalse(e,r),s;let a=n._BinaryenSelectGetCondition(e);if(a==t)return n._BinaryenSelectSetCondition(e,r),a;break}case i.ExpressionId.Drop:{let i=n._BinaryenDropGetValue(e);if(i==t)return n._BinaryenDropSetValue(e,r),i;break}case i.ExpressionId.Return:{let i=n._BinaryenReturnGetValue(e);if(i==t)return n._BinaryenReturnSetValue(e,r),i;break}case i.ExpressionId.MemorySize:break;case i.ExpressionId.MemoryGrow:{let i=n._BinaryenMemoryGrowGetDelta(e);if(i==t)return n._BinaryenMemoryGrowSetDelta(e,r),i;break}case i.ExpressionId.Nop:case i.ExpressionId.Unreachable:break;case i.ExpressionId.AtomicRMW:{let i=n._BinaryenAtomicRMWGetPtr(e);if(i==t)return n._BinaryenAtomicRMWSetPtr(e,r),i;let s=n._BinaryenAtomicRMWGetValue(e);if(s==t)return n._BinaryenAtomicRMWSetValue(e,r),s;break}case i.ExpressionId.AtomicCmpxchg:{let i=n._BinaryenAtomicCmpxchgGetPtr(e);if(i==t)return n._BinaryenAtomicCmpxchgSetPtr(e,r),i;let s=n._BinaryenAtomicCmpxchgGetExpected(e);if(s==t)return n._BinaryenAtomicCmpxchgSetExpected(e,r),s;let a=n._BinaryenAtomicCmpxchgGetReplacement(e);if(a==t)return n._BinaryenAtomicCmpxchgSetReplacement(e,r),a;break}case i.ExpressionId.AtomicWait:{let i=n._BinaryenAtomicWaitGetPtr(e);if(i==t)return n._BinaryenAtomicWaitSetPtr(e,r),i;let s=n._BinaryenAtomicWaitGetExpected(e);if(s==t)return n._BinaryenAtomicWaitSetExpected(e,r),s;let a=n._BinaryenAtomicWaitGetTimeout(e);if(a==t)return n._BinaryenAtomicWaitSetTimeout(e,r),a;break}case i.ExpressionId.AtomicNotify:{let i=n._BinaryenAtomicNotifyGetPtr(e);if(i==t)return n._BinaryenAtomicNotifySetPtr(e,r),i;let s=n._BinaryenAtomicNotifyGetNotifyCount(e);if(s==t)return n._BinaryenAtomicNotifySetNotifyCount(e,r),s;break}case i.ExpressionId.AtomicFence:break;case i.ExpressionId.SIMDExtract:{let i=n._BinaryenSIMDExtractGetVec(e);if(i==t)return n._BinaryenSIMDExtractSetVec(e,r),i;break}case i.ExpressionId.SIMDReplace:{let i=n._BinaryenSIMDReplaceGetVec(e);if(i==t)return n._BinaryenSIMDReplaceSetVec(e,r),i;let s=n._BinaryenSIMDReplaceGetValue(e);if(s==t)return n._BinaryenSIMDReplaceSetValue(e,r),s;break}case i.ExpressionId.SIMDShuffle:{let i=n._BinaryenSIMDShuffleGetLeft(e);if(i==t)return n._BinaryenSIMDShuffleSetLeft(e,r),i;let s=n._BinaryenSIMDShuffleGetRight(e);if(s==t)return n._BinaryenSIMDShuffleSetRight(e,r),s;break}case i.ExpressionId.SIMDTernary:{let i=n._BinaryenSIMDTernaryGetA(e);if(i==t)return n._BinaryenSIMDTernarySetA(e,r),i;let s=n._BinaryenSIMDTernaryGetB(e);if(s==t)return n._BinaryenSIMDTernarySetB(e,r),s;let a=n._BinaryenSIMDTernaryGetC(e);if(a==t)return n._BinaryenSIMDTernarySetC(e,r),a;break}case i.ExpressionId.SIMDShift:{let i=n._BinaryenSIMDShiftGetVec(e);if(i==t)return n._BinaryenSIMDShiftSetVec(e,r),i;let s=n._BinaryenSIMDShiftGetShift(e);if(s==t)return n._BinaryenSIMDShiftSetShift(e,r),s;break}case i.ExpressionId.SIMDLoad:{let i=n._BinaryenSIMDLoadGetPtr(e);if(i==t)return n._BinaryenSIMDLoadSetPtr(e,r),i;break}case i.ExpressionId.MemoryInit:{let i=n._BinaryenMemoryInitGetDest(e);if(i==t)return n._BinaryenMemoryInitSetDest(e,r),i;let s=n._BinaryenMemoryInitGetOffset(e);if(s==t)return n._BinaryenMemoryInitSetOffset(e,r),s;let a=n._BinaryenMemoryInitGetSize(e);if(a==t)return n._BinaryenMemoryInitSetSize(e,r),a;break}case i.ExpressionId.DataDrop:break;case i.ExpressionId.MemoryCopy:{let i=n._BinaryenMemoryCopyGetDest(e);if(i==t)return n._BinaryenMemoryCopySetDest(e,r),i;let s=n._BinaryenMemoryCopyGetSource(e);if(s==t)return n._BinaryenMemoryCopySetSource(e,r),s;let a=n._BinaryenMemoryCopyGetSize(e);if(a==t)return n._BinaryenMemoryCopySetSize(e,r),a;break}case i.ExpressionId.MemoryFill:{let i=n._BinaryenMemoryFillGetDest(e);if(i==t)return n._BinaryenMemoryFillSetDest(e,r),i;let s=n._BinaryenMemoryFillGetValue(e);if(s==t)return n._BinaryenMemoryFillSetValue(e,r),s;let a=n._BinaryenMemoryFillGetSize(e);if(a==t)return n._BinaryenMemoryFillSetSize(e,r),a;break}case i.ExpressionId.Pop:case i.ExpressionId.RefNull:break;case i.ExpressionId.RefIs:{let i=n._BinaryenRefIsGetValue(e);if(i==t)return n._BinaryenRefIsSetValue(e,r),i;break}case i.ExpressionId.RefFunc:break;case i.ExpressionId.RefEq:{let i=n._BinaryenRefEqGetLeft(e);if(i==t)return n._BinaryenRefEqSetLeft(e,r),i;let s=n._BinaryenRefEqGetRight(e);if(s==t)return n._BinaryenRefEqSetRight(e,r),s;break}case i.ExpressionId.Try:{let i=n._BinaryenTryGetBody(e);if(i==t)return n._BinaryenTrySetBody(e,r),i;let s=n._BinaryenTryGetNumCatchBodies(e);for(let i=0;i<s;++i){let s=n._BinaryenTryGetCatchBodyAt(e,i);if(s==t)return n._BinaryenTrySetCatchBodyAt(e,i,r),s}break}case i.ExpressionId.Throw:{let i=n._BinaryenThrowGetNumOperands(e);for(let s=0;s<i;++s){let i=n._BinaryenThrowGetOperandAt(e,s);if(i==t)return n._BinaryenThrowSetOperandAt(e,s,r),i}break}case i.ExpressionId.Rethrow:break;case i.ExpressionId.TupleMake:{let i=n._BinaryenTupleMakeGetNumOperands(e);for(let s=0;s<i;++s){let i=n._BinaryenTupleMakeGetOperandAt(e,s);if(i==t)return n._BinaryenTupleMakeSetOperandAt(e,s,r),i}break}case i.ExpressionId.TupleExtract:{let i=n._BinaryenTupleExtractGetTuple(e);if(i==t)return n._BinaryenTupleExtractSetTuple(e,r),i;break}case i.ExpressionId.I31New:{let i=n._BinaryenI31NewGetValue(e);if(i==t)return n._BinaryenI31NewSetValue(e,r),i;break}case i.ExpressionId.I31Get:{let i=n._BinaryenI31GetGetI31(e);if(i==t)return n._BinaryenI31GetSetI31(e,r),i;break}case i.ExpressionId.CallRef:case i.ExpressionId.RefTest:case i.ExpressionId.RefCast:case i.ExpressionId.BrOn:case i.ExpressionId.RttCanon:case i.ExpressionId.RttSub:case i.ExpressionId.StructNew:case i.ExpressionId.StructGet:case i.ExpressionId.StructSet:case i.ExpressionId.ArrayNew:case i.ExpressionId.ArrayGet:case i.ExpressionId.ArraySet:case i.ExpressionId.ArrayLen:case i.ExpressionId.RefAs:assert(!1);break;default:throw new Error("unexpected expression id")}return 0}t.Pass=class extends s{constructor(e){super(),this.module=e,this._currentFunction=0,this._currentGlobal=0}get currentFunction(){var e=this._currentFunction;if(!e)throw new Error("not walking a function");return e}get currentGlobal(){var e=this._currentGlobal;if(!e)throw new Error("not walking a global");return e}walkModule(){this.walkFunctions(),this.walkGlobals()}walkFunctions(){var e=this.module.ref;for(let t=0,r=n._BinaryenGetNumFunctions(e);t<r;++t)this.walkFunction(n._BinaryenGetFunctionByIndex(e,t))}walkFunction(e){var t=n._BinaryenFunctionGetBody(e);t&&(this._currentFunction=e,this.visit(t),this._currentFunction=0)}walkGlobals(){var e=this.module.ref;for(let t=0,r=n._BinaryenGetNumGlobals(e);t<r;++t)this.walkGlobal(n._BinaryenGetGlobalByIndex(e,t))}walkGlobal(e){this._currentGlobal=e;var t=n._BinaryenGlobalGetInitExpr(e);t&&this.visit(t),this._currentGlobal=0}replaceCurrent(e){var t=this.currentExpression,r=this.currentFunction;if(n._BinaryenFunctionGetBody(r)==t)n._BinaryenFunctionSetBody(r,e);else{var i=assert(this.parentExpressionOrNull);if(!a(i,t,e))throw Error("failed to replace expression");n._BinaryenExpressionFinalize(i)}}},t.replaceChild=a},865:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RtraceMemory=void 0;const i=r(666),n=r(656),s=r(292);class a extends i.Pass{constructor(e){super(e.module),this.seenStores=!1,this.ptrType=e.options.nativeSizeType}checkRT(){return this.module.readStringCached(s._BinaryenFunctionGetName(this.currentFunction)).startsWith("~lib/rt/")}visitStore(e){var t=this.module,r=s._BinaryenStoreGetPtr(e),i=s._BinaryenStoreGetOffset(e),n=s._BinaryenStoreGetBytes(e);s._BinaryenStoreSetPtr(e,t.call("~onstore",[r,t.i32(i),t.i32(n),t.i32(i32(this.checkRT()))],this.ptrType)),this.seenStores=!0}walkModule(){super.walkModule(),this.seenStores&&this.module.addFunctionImport("~onstore","rtrace","onstore",n.createType([this.ptrType,n.NativeType.I32,n.NativeType.I32,n.NativeType.I32]),this.ptrType)}}t.RtraceMemory=a},231:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowStackPass=void 0;const i=r(666),n=r(292),s=r(656),a=r(346);function o(e,t){return n._BinaryenExpressionGetId(t)==s.ExpressionId.Call&&e.readStringCached(n._BinaryenCallGetTarget(t))==a.BuiltinNames.tostack?(assert(1==n._BinaryenCallGetNumOperands(t)),n._BinaryenCallGetOperandAt(t,0)):0}function l(e,t){switch(n._BinaryenExpressionGetId(t)){case s.ExpressionId.Const:return!s.isConstZero(t);case s.ExpressionId.LocalGet:case s.ExpressionId.LocalSet:return!1}return!0}class u extends i.Pass{constructor(e){super(e.module),this.slotMaps=new Map,this.tempMaps=new Map,this.exportMap=new Map,this.hasStackCheckFunction=!1,this.callSlotOffset=0,this.callSlotStack=new Array,this.compiler=e}get options(){return this.compiler.options}get ptrType(){return this.options.nativeSizeType}get ptrSize(){return this.ptrType==s.NativeType.I64?8:4}get ptrBinaryAdd(){return this.ptrType==s.NativeType.I64?s.BinaryOp.AddI64:s.BinaryOp.AddI32}get ptrBinarySub(){return this.ptrType==s.NativeType.I64?s.BinaryOp.SubI64:s.BinaryOp.SubI32}ptrConst(e){return this.ptrType==s.NativeType.I64?this.module.i64(e):this.module.i32(e)}noteSlot(e,t){let r;if(this.slotMaps.has(e)){if(r=changetype(this.slotMaps.get(e)),r.has(t))return changetype(r.get(t))}else r=new Map,this.slotMaps.set(e,r);let i=r.size;return r.set(t,i),i}noteExport(e,t){t.length&&this.exportMap.set(e,t)}getSharedTemp(e,t){let r;if(this.tempMaps.has(e)){if(r=changetype(this.tempMaps.get(e)),r.has(t))return changetype(r.get(t))}else r=new Map,this.tempMaps.set(e,r);let i=n._BinaryenFunctionGetNumLocals(e)+r.size;return r.set(t,i),i}makeStackOffset(e){assert(0!=e);var t=this.module,r=t.global_set(a.BuiltinNames.stack_pointer,t.binary(e>=0?this.ptrBinaryAdd:this.ptrBinarySub,t.global_get(a.BuiltinNames.stack_pointer,this.ptrType),this.ptrConst(abs(e))));return e>0?r:t.block(null,[r,this.makeStackCheck()],s.NativeType.None)}makeStackFill(e,t){assert(e>0);var r=this.module;if(this.options.hasFeature(8)&&e>16)t.push(r.memory_fill(r.global_get(a.BuiltinNames.stack_pointer,this.ptrType),r.i32(0),this.ptrConst(e)));else{let i=e;for(;i>=8;)t.push(r.store(8,r.global_get(a.BuiltinNames.stack_pointer,this.ptrType),r.i64(0),s.NativeType.I64,e-i)),i-=8;i&&(assert(4==i),t.push(r.store(4,r.global_get(a.BuiltinNames.stack_pointer,this.ptrType),r.i32(0),s.NativeType.I32,e-i)))}}makeStackCheck(){var e=this.module;return this.hasStackCheckFunction||(this.hasStackCheckFunction=!0,e.addFunction("~stack_check",s.NativeType.None,s.NativeType.None,null,e.if(e.binary(s.BinaryOp.LtI32,e.global_get(a.BuiltinNames.stack_pointer,this.ptrType),e.global_get(a.BuiltinNames.data_end,this.ptrType)),this.compiler.makeStaticAbort(this.compiler.ensureStaticString("stack overflow"),this.compiler.program.nativeSource)))),e.call("~stack_check",null,s.NativeType.None)}updateCallOperands(e){var t=this.module,r=0;for(let i=0,s=e.length;i<s;++i){let s=o(t,e[i]);if(!s)continue;if(!l(0,s)){e[i]=s;continue}let u=this.currentFunction,c=n._BinaryenFunctionGetNumLocals(u),p=this.noteSlot(u,c+this.callSlotOffset+i),_=this.getSharedTemp(u,this.ptrType),h=new Array;h.push(t.local_set(_,s,!1)),h.push(t.store(this.ptrSize,t.global_get(a.BuiltinNames.stack_pointer,this.ptrType),t.local_get(_,this.ptrType),this.ptrType,p*this.ptrSize)),h.push(t.local_get(_,this.ptrType)),e[i]=t.block(null,h,this.ptrType),++r}return r}visitCallPre(e){var t=n._BinaryenCallGetNumOperands(e),r=new Array(t);for(let i=0;i<t;++i)r[i]=n._BinaryenCallGetOperandAt(e,i);let i=this.updateCallOperands(r);for(let t=0,i=r.length;t<i;++t)n._BinaryenCallSetOperandAt(e,t,r[t]);i&&(this.callSlotOffset+=i),this.callSlotStack.push(i)}visitCall(e){let t=this.callSlotStack.pop();t&&(this.callSlotOffset-=t)}visitCallIndirectPre(e){let t=n._BinaryenCallIndirectGetNumOperands(e),r=new Array(t);for(let i=0;i<t;++i)r[i]=n._BinaryenCallIndirectGetOperandAt(e,i);let i=this.updateCallOperands(r);for(let t=0,i=r.length;t<i;++t)n._BinaryenCallIndirectSetOperandAt(e,t,r[t]);i&&(this.callSlotOffset+=i),this.callSlotStack.push(i)}visitCallIndirect(e){let t=this.callSlotStack.pop();t&&(this.callSlotOffset-=t)}visitLocalSet(e){let t=this.module,r=o(t,n._BinaryenLocalSetGetValue(e));if(!r)return;if(!l(0,r))return void n._BinaryenLocalSetSetValue(e,r);let i=n._BinaryenLocalSetGetIndex(e),u=this.noteSlot(this.currentFunction,i),c=new Array;c.push(t.store(this.ptrSize,t.global_get(a.BuiltinNames.stack_pointer,this.ptrType),t.local_tee(i,r,!1),this.ptrType,u*this.ptrSize)),n._BinaryenLocalSetIsTee(e)?(c.push(t.local_get(i,this.ptrType)),this.replaceCurrent(t.flatten(c,this.ptrType))):this.replaceCurrent(t.flatten(c,s.NativeType.None))}updateFunction(e){let t=n._BinaryenFunctionGetName(e),r=n._BinaryenFunctionGetParams(e),i=n._BinaryenFunctionGetResults(e),a=assert(n._BinaryenFunctionGetBody(e)),o=n._BinaryenFunctionGetNumVars(e),l=new Array;for(let t=0;t<o;++t)l[t]=n._BinaryenFunctionGetVar(e,t);let u=this.tempMaps;if(u.has(e)){let t=changetype(u.get(e));for(let e=Map_keys(t),r=0,i=e.length;r<i;++r)l.push(e[r])}let c=this.module.ref;n._BinaryenRemoveFunction(c,t);let p=s.allocPtrArray(l);n._BinaryenAddFunction(c,t,r,i,p,l.length,a),n._free(p)}updateExport(e,t){var r=this.module,i=r.ref;assert(n._BinaryenExportGetKind(e)==s.ExternalKind.Function);var o=n._BinaryenExportGetValue(e),l=r.readStringCached(o),u=n._BinaryenExportGetName(e),c=n._BinaryenGetFunction(i,o),p=n._BinaryenFunctionGetParams(c),_=s.expandType(p),h=_.length,d=n._BinaryenFunctionGetResults(c),m=h,y=new Array,T=assert(t.length),g=T*this.ptrSize,f="export:"+l,E=r.allocStringCached(f);if(0==n._BinaryenGetFunction(i,E)){let e=new Array;e.push(this.makeStackOffset(-g));for(let i=0;i<T;++i)e.push(r.store(this.ptrSize,r.global_get(a.BuiltinNames.stack_pointer,this.ptrType),r.local_get(t[i],this.ptrType),this.ptrType,i*this.ptrSize));let o=new Array(h);for(let e=0;e<h;++e)o[e]=r.local_get(e,_[e]);if(d!=s.NativeType.None){let t=m++;y.push(d),e.push(r.local_set(t,r.call(l,o,d),!1)),e.push(this.makeStackOffset(+g)),e.push(r.local_get(t,d))}else e.push(r.call(l,o,d)),e.push(this.makeStackOffset(+g));let u=s.allocPtrArray(y);n._BinaryenAddFunction(i,E,p,d,u,y.length,r.block(null,e,d)),n._free(u)}n._BinaryenRemoveExport(i,u),n._BinaryenAddFunctionExport(i,E,u)}walkModule(){super.walkModule();var e=this.module,t=new c(this);for(let r=Map_keys(this.slotMaps),i=0,a=r.length;i<a;++i){let a=r[i],o=changetype(this.slotMaps.get(a)).size*this.ptrSize;t.frameSize=o,t.walkFunction(a);let l=new Array;l.push(this.makeStackOffset(-o)),this.makeStackFill(o,l);let u=n._BinaryenFunctionGetBody(a),c=n._BinaryenExpressionGetType(u);if(c==s.NativeType.Unreachable)l.push(u);else if(c==s.NativeType.None)l.push(u),l.push(this.makeStackOffset(+o));else{let t=this.getSharedTemp(a,c);l.push(e.local_set(t,u,!1)),l.push(this.makeStackOffset(+o)),l.push(e.local_get(t,c))}n._BinaryenFunctionSetBody(a,e.flatten(l,c))}for(let e=Map_keys(this.tempMaps),t=0,r=e.length;t<r;++t)this.updateFunction(e[t]);var r=this.exportMap;for(let t=Map_keys(r),i=0,s=t.length;i<s;++i){let s=t[i],a=n._BinaryenGetExport(e.ref,e.allocStringCached(s)),o=changetype(r.get(s));this.updateExport(a,o)}}}t.ShadowStackPass=u;class c extends i.Pass{constructor(e){super(e.module),this.frameSize=0,this.parentPass=e}visitReturn(e){assert(this.frameSize);var t=this.module,r=n._BinaryenReturnGetValue(e),i=new Array;if(r){let s=n._BinaryenExpressionGetType(r),a=this.parentPass.getSharedTemp(this.currentFunction,s);i.push(t.local_set(a,r,!1)),i.push(this.parentPass.makeStackOffset(+this.frameSize)),n._BinaryenReturnSetValue(e,t.local_get(a,s))}else i.push(this.parentPass.makeStackOffset(+this.frameSize));i.push(e),this.replaceCurrent(t.flatten(i,s.NativeType.Unreachable))}}},974:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultParameterName=t.mangleInternalName=t.Interface=t.InterfacePrototype=t.Class=t.ClassPrototype=t.IndexSignature=t.Property=t.PropertyPrototype=t.Field=t.FieldPrototype=t.Function=t.FunctionPrototype=t.Local=t.Parameter=t.Global=t.EnumValue=t.VariableLikeElement=t.ConstantValueKind=t.Enum=t.Namespace=t.TypeDefinition=t.File=t.TypedElement=t.isTypedElement=t.DeclaredElement=t.isDeclaredElement=t.Element=t.DecoratorFlags=t.ElementKind=t.Program=t.OperatorKind=void 0;const i=r(200),n=r(256),s=r(699),a=r(411),o=r(60),l=r(910),u=r(742),c=r(154),p=r(215),_=r(346),h=15;class d{constructor(e,t,r,i,n){this.localFile=e,this.localIdentifier=t,this.foreignIdentifier=r,this.foreignPath=i,this.foreignPathAlt=n}}class m{constructor(e,t,r,i){this.localIdentifier=e,this.foreignIdentifier=t,this.foreignPath=r,this.foreignPathAlt=i}}class y{constructor(e,t,r){this.foreignPath=e,this.foreignPathAlt=t,this.pathLiteral=r}}var T,g,f;!function(e){e[e.INVALID=0]="INVALID",e[e.INDEXED_GET=1]="INDEXED_GET",e[e.INDEXED_SET=2]="INDEXED_SET",e[e.UNCHECKED_INDEXED_GET=3]="UNCHECKED_INDEXED_GET",e[e.UNCHECKED_INDEXED_SET=4]="UNCHECKED_INDEXED_SET",e[e.ADD=5]="ADD",e[e.SUB=6]="SUB",e[e.MUL=7]="MUL",e[e.DIV=8]="DIV",e[e.REM=9]="REM",e[e.POW=10]="POW",e[e.BITWISE_AND=11]="BITWISE_AND",e[e.BITWISE_OR=12]="BITWISE_OR",e[e.BITWISE_XOR=13]="BITWISE_XOR",e[e.BITWISE_SHL=14]="BITWISE_SHL",e[e.BITWISE_SHR=15]="BITWISE_SHR",e[e.BITWISE_SHR_U=16]="BITWISE_SHR_U",e[e.EQ=17]="EQ",e[e.NE=18]="NE",e[e.GT=19]="GT",e[e.GE=20]="GE",e[e.LT=21]="LT",e[e.LE=22]="LE",e[e.PLUS=23]="PLUS",e[e.MINUS=24]="MINUS",e[e.NOT=25]="NOT",e[e.BITWISE_NOT=26]="BITWISE_NOT",e[e.PREFIX_INC=27]="PREFIX_INC",e[e.PREFIX_DEC=28]="PREFIX_DEC",e[e.POSTFIX_INC=29]="POSTFIX_INC",e[e.POSTFIX_DEC=30]="POSTFIX_DEC"}(T=t.OperatorKind||(t.OperatorKind={})),function(e){e.fromDecorator=function(t,r){switch(assert(r.length),t){case o.DecoratorKind.OPERATOR:case o.DecoratorKind.OPERATOR_BINARY:switch(r.charCodeAt(0)){case 91:if("[]"==r)return e.INDEXED_GET;if("[]="==r)return e.INDEXED_SET;break;case 123:if("{}"==r)return e.UNCHECKED_INDEXED_GET;if("{}="==r)return e.UNCHECKED_INDEXED_SET;break;case 43:if("+"==r)return e.ADD;break;case 45:if("-"==r)return e.SUB;break;case 42:if("*"==r)return e.MUL;if("**"==r)return e.POW;break;case 47:if("/"==r)return e.DIV;break;case 37:if("%"==r)return e.REM;break;case 38:if("&"==r)return e.BITWISE_AND;break;case 124:if("|"==r)return e.BITWISE_OR;break;case 94:if("^"==r)return e.BITWISE_XOR;break;case 61:if("=="==r)return e.EQ;break;case 33:if("!="==r)return e.NE;break;case 62:if(">"==r)return e.GT;if(">="==r)return e.GE;if(">>"==r)return e.BITWISE_SHR;if(">>>"==r)return e.BITWISE_SHR_U;break;case 60:if("<"==r)return e.LT;if("<="==r)return e.LE;if("<<"==r)return e.BITWISE_SHL}break;case o.DecoratorKind.OPERATOR_PREFIX:switch(r.charCodeAt(0)){case 43:if("+"==r)return e.PLUS;if("++"==r)return e.PREFIX_INC;break;case 45:if("-"==r)return e.MINUS;if("--"==r)return e.PREFIX_DEC;break;case 33:if("!"==r)return e.NOT;break;case 126:if("~"==r)return e.BITWISE_NOT}break;case o.DecoratorKind.OPERATOR_POSTFIX:switch(r.charCodeAt(0)){case 43:if("++"==r)return e.POSTFIX_INC;break;case 45:if("--"==r)return e.POSTFIX_DEC}}return e.INVALID},e.fromBinaryToken=function(t){switch(t){case a.Token.PLUS:case a.Token.PLUS_EQUALS:return e.ADD;case a.Token.MINUS:case a.Token.MINUS_EQUALS:return e.SUB;case a.Token.ASTERISK:case a.Token.ASTERISK_EQUALS:return e.MUL;case a.Token.SLASH:case a.Token.SLASH_EQUALS:return e.DIV;case a.Token.PERCENT:case a.Token.PERCENT_EQUALS:return e.REM;case a.Token.ASTERISK_ASTERISK:case a.Token.ASTERISK_ASTERISK_EQUALS:return e.POW;case a.Token.AMPERSAND:case a.Token.AMPERSAND_EQUALS:return e.BITWISE_AND;case a.Token.BAR:case a.Token.BAR_EQUALS:return e.BITWISE_OR;case a.Token.CARET:case a.Token.CARET_EQUALS:return e.BITWISE_XOR;case a.Token.LESSTHAN_LESSTHAN:case a.Token.LESSTHAN_LESSTHAN_EQUALS:return e.BITWISE_SHL;case a.Token.GREATERTHAN_GREATERTHAN:case a.Token.GREATERTHAN_GREATERTHAN_EQUALS:return e.BITWISE_SHR;case a.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:case a.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:return e.BITWISE_SHR_U;case a.Token.EQUALS_EQUALS:return e.EQ;case a.Token.EXCLAMATION_EQUALS:return e.NE;case a.Token.GREATERTHAN:return e.GT;case a.Token.GREATERTHAN_EQUALS:return e.GE;case a.Token.LESSTHAN:return e.LT;case a.Token.LESSTHAN_EQUALS:return e.LE}return e.INVALID},e.fromUnaryPrefixToken=function(t){switch(t){case a.Token.PLUS:return e.PLUS;case a.Token.MINUS:return e.MINUS;case a.Token.EXCLAMATION:return e.NOT;case a.Token.TILDE:return e.BITWISE_NOT;case a.Token.PLUS_PLUS:return e.PREFIX_INC;case a.Token.MINUS_MINUS:return e.PREFIX_DEC}return e.INVALID},e.fromUnaryPostfixToken=function(t){switch(t){case a.Token.PLUS_PLUS:return e.POSTFIX_INC;case a.Token.MINUS_MINUS:return e.POSTFIX_DEC}return e.INVALID}}(T=t.OperatorKind||(t.OperatorKind={}));class E extends n.DiagnosticEmitter{constructor(e,t=null){super(t),this.options=e,this.sources=[],this.diagnosticsOffset=0,this.nextClassId=0,this.nextSignatureId=0,this.initialized=!1,this.filesByName=new Map,this.elementsByName=new Map,this.elementsByDeclaration=new Map,this.instancesByName=new Map,this.wrapperClasses=new Map,this.managedClasses=new Map,this.uniqueSignatures=new Array(0),this._arrayBufferViewInstance=null,this._arrayBufferInstance=null,this._arrayPrototype=null,this._staticArrayPrototype=null,this._setPrototype=null,this._mapPrototype=null,this._functionPrototype=null,this._int8ArrayPrototype=null,this._int16ArrayPrototype=null,this._int32ArrayPrototype=null,this._int64ArrayPrototype=null,this._uint8ArrayPrototype=null,this._uint8ClampedArrayPrototype=null,this._uint16ArrayPrototype=null,this._uint32ArrayPrototype=null,this._uint64ArrayPrototype=null,this._float32ArrayPrototype=null,this._float64ArrayPrototype=null,this._stringInstance=null,this._objectInstance=null,this._templateStringsArrayInstance=null,this._allocInstance=null,this._reallocInstance=null,this._freeInstance=null,this._newInstance=null,this._renewInstance=null,this._linkInstance=null,this._collectInstance=null,this._visitInstance=null,this._typeinfoInstance=null,this._instanceofInstance=null,this._newBufferInstance=null,this._newArrayInstance=null,this._BLOCKInstance=null,this._OBJECTInstance=null,this.nativeDummySignature=null;var r=new o.Source(o.SourceKind.LIBRARY_ENTRY,i.LIBRARY_SUBST+".wasm","[native code]");this.nativeSource=r,this.parser=new p.Parser(this.diagnostics,this.sources),this.resolver=new u.Resolver(this);var n=new v(this,r);this.nativeFile=n,this.filesByName.set(n.internalName,n)}get nativeRange(){return this.nativeSource.range}get arrayBufferViewInstance(){var e=this._arrayBufferViewInstance;return e||(this._arrayBufferViewInstance=e=this.requireClass(i.CommonNames.ArrayBufferView)),e}get arrayBufferInstance(){var e=this._arrayBufferInstance;return e||(this._arrayBufferInstance=e=this.requireClass(i.CommonNames.ArrayBuffer)),e}get arrayPrototype(){var e=this._arrayPrototype;return e||(this._arrayPrototype=e=this.require(i.CommonNames.Array,g.CLASS_PROTOTYPE)),e}get staticArrayPrototype(){var e=this._staticArrayPrototype;return e||(this._staticArrayPrototype=e=this.require(i.CommonNames.StaticArray,g.CLASS_PROTOTYPE)),e}get setPrototype(){var e=this._setPrototype;return e||(this._setPrototype=e=this.require(i.CommonNames.Set,g.CLASS_PROTOTYPE)),e}get mapPrototype(){var e=this._mapPrototype;return e||(this._mapPrototype=e=this.require(i.CommonNames.Map,g.CLASS_PROTOTYPE)),e}get functionPrototype(){var e=this._functionPrototype;return e||(this._functionPrototype=e=this.require(i.CommonNames.Function,g.CLASS_PROTOTYPE)),e}get int8ArrayPrototype(){var e=this._int8ArrayPrototype;return e||(this._int8ArrayPrototype=e=this.require(i.CommonNames.Int8Array,g.CLASS_PROTOTYPE)),e}get int16ArrayPrototype(){var e=this._int16ArrayPrototype;return e||(this._int16ArrayPrototype=e=this.require(i.CommonNames.Int16Array,g.CLASS_PROTOTYPE)),e}get int32ArrayPrototype(){var e=this._int32ArrayPrototype;return e||(this._int32ArrayPrototype=e=this.require(i.CommonNames.Int32Array,g.CLASS_PROTOTYPE)),e}get int64ArrayPrototype(){var e=this._int64ArrayPrototype;return e||(this._int64ArrayPrototype=e=this.require(i.CommonNames.Int64Array,g.CLASS_PROTOTYPE)),e}get uint8ArrayPrototype(){var e=this._uint8ArrayPrototype;return e||(this._uint8ArrayPrototype=e=this.require(i.CommonNames.Uint8Array,g.CLASS_PROTOTYPE)),e}get uint8ClampedArrayPrototype(){var e=this._uint8ClampedArrayPrototype;return e||(this._uint8ClampedArrayPrototype=e=this.require(i.CommonNames.Uint8ClampedArray,g.CLASS_PROTOTYPE)),e}get uint16ArrayPrototype(){var e=this._uint16ArrayPrototype;return e||(this._uint16ArrayPrototype=e=this.require(i.CommonNames.Uint16Array,g.CLASS_PROTOTYPE)),e}get uint32ArrayPrototype(){var e=this._uint32ArrayPrototype;return e||(this._uint32ArrayPrototype=e=this.require(i.CommonNames.Uint32Array,g.CLASS_PROTOTYPE)),e}get uint64ArrayPrototype(){var e=this._uint64ArrayPrototype;return e||(this._uint64ArrayPrototype=e=this.require(i.CommonNames.Uint64Array,g.CLASS_PROTOTYPE)),e}get float32ArrayPrototype(){var e=this._float32ArrayPrototype;return e||(this._float32ArrayPrototype=e=this.require(i.CommonNames.Float32Array,g.CLASS_PROTOTYPE)),e}get float64ArrayPrototype(){var e=this._float64ArrayPrototype;return e||(this._float64ArrayPrototype=e=this.require(i.CommonNames.Float64Array,g.CLASS_PROTOTYPE)),e}get stringInstance(){var e=this._stringInstance;return e||(this._stringInstance=e=this.requireClass(i.CommonNames.String)),e}get objectInstance(){var e=this._objectInstance;return e||(this._objectInstance=e=this.requireClass(i.CommonNames.Object)),e}get templateStringsArrayInstance(){var e=this._templateStringsArrayInstance;return e||(this._templateStringsArrayInstance=e=this.requireClass(i.CommonNames.TemplateStringsArray)),e}get abortInstance(){var e=this.lookup(i.CommonNames.abort);return e&&e.kind==g.FUNCTION_PROTOTYPE?this.resolver.resolveFunction(e,null):null}get allocInstance(){var e=this._allocInstance;return e||(this._allocInstance=e=this.requireFunction(i.CommonNames.alloc)),e}get reallocInstance(){var e=this._reallocInstance;return e||(this._reallocInstance=e=this.requireFunction(i.CommonNames.realloc)),e}get freeInstance(){var e=this._freeInstance;return e||(this._freeInstance=e=this.requireFunction(i.CommonNames.free)),e}get newInstance(){var e=this._newInstance;return e||(this._newInstance=e=this.requireFunction(i.CommonNames.new_)),e}get renewInstance(){var e=this._renewInstance;return e||(this._renewInstance=e=this.requireFunction(i.CommonNames.renew)),e}get linkInstance(){var e=this._linkInstance;return e||(this._linkInstance=e=this.requireFunction(i.CommonNames.link)),e}get collectInstance(){var e=this._collectInstance;return e||(this._collectInstance=e=this.requireFunction(i.CommonNames.collect)),e}get visitInstance(){var e=this._visitInstance;return e||(this._visitInstance=e=this.requireFunction(i.CommonNames.visit)),e}get typeinfoInstance(){var e=this._typeinfoInstance;return e||(this._typeinfoInstance=e=this.requireFunction(i.CommonNames.typeinfo)),e}get instanceofInstance(){var e=this._instanceofInstance;return e||(this._instanceofInstance=e=this.requireFunction(i.CommonNames.instanceof_)),e}get newBufferInstance(){var e=this._newBufferInstance;return e||(this._newBufferInstance=e=this.requireFunction(i.CommonNames.newBuffer)),e}get newArrayInstance(){var e=this._newArrayInstance;return e||(this._newArrayInstance=e=this.requireFunction(i.CommonNames.newArray)),e}get BLOCKInstance(){var e=this._BLOCKInstance;return e||(this._BLOCKInstance=e=this.requireClass(i.CommonNames.BLOCK)),e}get OBJECTInstance(){var e=this._OBJECTInstance;return e||(this._OBJECTInstance=e=this.requireClass(i.CommonNames.OBJECT)),e}get isWasi(){return this.elementsByName.has(i.CommonNames.ASC_WASI)}getSource(e){var t=this.sources;for(let r=0;r<t.length;++r){let i=t[r];if(i.internalPath==e)return i.text}return null}get blockOverhead(){return this.BLOCKInstance.nextMemoryOffset}get objectOverhead(){return this.OBJECTInstance.nextMemoryOffset-this.blockOverhead+h&-16}get totalOverhead(){return this.blockOverhead+this.objectOverhead}computeBlockStart(e){var t=this.blockOverhead;return(e+t+h&-16)-t}computeBlockStart64(e){var t=i64_new(this.blockOverhead);return i64_sub(i64_align(i64_add(e,t),16),t)}computeBlockSize(e,t){t&&(e+=this.objectOverhead);var r=this.computeBlockStart(e),i=this.blockOverhead,n=(3*this.options.usizeType.byteSize+i+h&-16)-i;r<n&&(r=n);if(r>=1<<30||0!=(3&r))throw new Error("invalid block size");return r}makeNativeVariableDeclaration(e,t=i.CommonFlags.NONE){var r=this.nativeSource.range;return o.Node.createVariableDeclaration(o.Node.createIdentifierExpression(e,r),null,t,null,null,r)}makeNativeTypeDeclaration(e,t=i.CommonFlags.NONE){var r=this.nativeSource.range,n=o.Node.createIdentifierExpression(e,r);return o.Node.createTypeDeclaration(n,null,t,null,o.Node.createOmittedType(r),r)}makeNativeFunctionDeclaration(e,t=i.CommonFlags.NONE){var r=this.nativeSource.range,n=this.nativeDummySignature;return n||(this.nativeDummySignature=n=o.Node.createFunctionType([],o.Node.createNamedType(o.Node.createSimpleTypeName(i.CommonNames.void_,r),null,!1,r),null,!1,r)),o.Node.createFunctionDeclaration(o.Node.createIdentifierExpression(e,r),null,t,null,n,null,0,r)}makeNativeNamespaceDeclaration(e,t=i.CommonFlags.NONE){var r=this.nativeSource.range;return o.Node.createNamespaceDeclaration(o.Node.createIdentifierExpression(e,r),null,t,[],r)}makeNativeFunction(e,t,r=this.nativeFile,n=i.CommonFlags.NONE,s=f.NONE){return new w(e,new P(e,r,this.makeNativeFunctionDeclaration(e,n),s),null,t)}getElementByDeclaration(e){var t=this.elementsByDeclaration;return t.has(e)?assert(t.get(e)):null}initialize(){if(!this.initialized){this.initialized=!0;var e=this.options;this.registerNativeType(i.CommonNames.i8,s.Type.i8),this.registerNativeType(i.CommonNames.i16,s.Type.i16),this.registerNativeType(i.CommonNames.i32,s.Type.i32),this.registerNativeType(i.CommonNames.i64,s.Type.i64),this.registerNativeType(i.CommonNames.isize,e.isizeType),this.registerNativeType(i.CommonNames.u8,s.Type.u8),this.registerNativeType(i.CommonNames.u16,s.Type.u16),this.registerNativeType(i.CommonNames.u32,s.Type.u32),this.registerNativeType(i.CommonNames.u64,s.Type.u64),this.registerNativeType(i.CommonNames.usize,e.usizeType),this.registerNativeType(i.CommonNames.bool,s.Type.bool),this.registerNativeType(i.CommonNames.f32,s.Type.f32),this.registerNativeType(i.CommonNames.f64,s.Type.f64),this.registerNativeType(i.CommonNames.void_,s.Type.void),this.registerNativeType(i.CommonNames.number,s.Type.f64),this.registerNativeType(i.CommonNames.boolean,s.Type.bool),this.nativeFile.add(i.CommonNames.native,new C(i.CommonNames.native,this.nativeFile,this.makeNativeTypeDeclaration(i.CommonNames.native,i.CommonFlags.EXPORT|i.CommonFlags.GENERIC),f.BUILTIN)),this.nativeFile.add(i.CommonNames.indexof,new C(i.CommonNames.indexof,this.nativeFile,this.makeNativeTypeDeclaration(i.CommonNames.indexof,i.CommonFlags.EXPORT|i.CommonFlags.GENERIC),f.BUILTIN)),this.nativeFile.add(i.CommonNames.valueof,new C(i.CommonNames.valueof,this.nativeFile,this.makeNativeTypeDeclaration(i.CommonNames.valueof,i.CommonFlags.EXPORT|i.CommonFlags.GENERIC),f.BUILTIN)),this.nativeFile.add(i.CommonNames.returnof,new C(i.CommonNames.returnof,this.nativeFile,this.makeNativeTypeDeclaration(i.CommonNames.returnof,i.CommonFlags.EXPORT|i.CommonFlags.GENERIC),f.BUILTIN)),this.registerNativeType(i.CommonNames.v128,s.Type.v128),this.registerNativeType(i.CommonNames.funcref,s.Type.funcref),this.registerNativeType(i.CommonNames.externref,s.Type.externref),this.registerNativeType(i.CommonNames.anyref,s.Type.anyref),this.registerNativeType(i.CommonNames.eqref,s.Type.eqref),this.registerNativeType(i.CommonNames.i31ref,s.Type.i31ref),this.registerNativeType(i.CommonNames.dataref,s.Type.dataref),this.registerConstantInteger(i.CommonNames.ASC_TARGET,s.Type.i32,i64_new(e.isWasm64?i.Target.WASM64:i.Target.WASM32)),this.registerConstantInteger(i.CommonNames.ASC_NO_ASSERT,s.Type.bool,i64_new(e.noAssert?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_MEMORY_BASE,s.Type.i32,i64_new(e.memoryBase,0)),this.registerConstantInteger(i.CommonNames.ASC_TABLE_BASE,s.Type.i32,i64_new(e.tableBase,0)),this.registerConstantInteger(i.CommonNames.ASC_OPTIMIZE_LEVEL,s.Type.i32,i64_new(e.optimizeLevelHint,0)),this.registerConstantInteger(i.CommonNames.ASC_SHRINK_LEVEL,s.Type.i32,i64_new(e.shrinkLevelHint,0)),this.registerConstantInteger(i.CommonNames.ASC_LOW_MEMORY_LIMIT,s.Type.i32,i64_new(e.lowMemoryLimit,0)),this.registerConstantInteger(i.CommonNames.ASC_EXPORT_RUNTIME,s.Type.bool,i64_new(e.exportRuntime?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_VERSION_MAJOR,s.Type.i32,i64_new(e.bundleMajorVersion)),this.registerConstantInteger(i.CommonNames.ASC_VERSION_MINOR,s.Type.i32,i64_new(e.bundleMinorVersion)),this.registerConstantInteger(i.CommonNames.ASC_VERSION_PATCH,s.Type.i32,i64_new(e.bundlePatchVersion)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_SIGN_EXTENSION,s.Type.bool,i64_new(e.hasFeature(1)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_MUTABLE_GLOBALS,s.Type.bool,i64_new(e.hasFeature(2)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_NONTRAPPING_F2I,s.Type.bool,i64_new(e.hasFeature(4)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_BULK_MEMORY,s.Type.bool,i64_new(e.hasFeature(8)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_SIMD,s.Type.bool,i64_new(e.hasFeature(16)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_THREADS,s.Type.bool,i64_new(e.hasFeature(32)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_EXCEPTION_HANDLING,s.Type.bool,i64_new(e.hasFeature(64)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_TAIL_CALLS,s.Type.bool,i64_new(e.hasFeature(128)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_REFERENCE_TYPES,s.Type.bool,i64_new(e.hasFeature(256)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_MULTI_VALUE,s.Type.bool,i64_new(e.hasFeature(512)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_GC,s.Type.bool,i64_new(e.hasFeature(1024)?1:0,0)),this.registerConstantInteger(i.CommonNames.ASC_FEATURE_MEMORY64,s.Type.bool,i64_new(e.hasFeature(2048)?1:0,0));var t=new Array,r=new Map,l=new Map,u=new Array,c=new Array;for(let e=0,i=this.sources.length;e<i;++e){let i=this.sources[e],n=new v(this,i);this.filesByName.set(n.internalName,n);let s=i.statements;for(let e=0,i=s.length;e<i;++e){let i=s[e];switch(i.kind){case o.NodeKind.EXPORT:this.initializeExports(i,n,r,l);break;case o.NodeKind.EXPORTDEFAULT:this.initializeExportDefault(i,n,u,c);break;case o.NodeKind.IMPORT:this.initializeImports(i,n,t,r);break;case o.NodeKind.VARIABLE:this.initializeVariables(i,n);break;case o.NodeKind.CLASSDECLARATION:this.initializeClass(i,n,u,c);break;case o.NodeKind.ENUMDECLARATION:this.initializeEnum(i,n);break;case o.NodeKind.FUNCTIONDECLARATION:this.initializeFunction(i,n);break;case o.NodeKind.INTERFACEDECLARATION:this.initializeInterface(i,n,u);break;case o.NodeKind.NAMESPACEDECLARATION:this.initializeNamespace(i,n,u,c);break;case o.NodeKind.TYPEDECLARATION:this.initializeTypeDefinition(i,n)}}}for(let e=Map_keys(l),t=0,r=e.length;t<r;++t){let r=e[t],i=assert(l.get(r));for(let e=0,t=i.length;e<t;++e){let t=unchecked(i[e]),s=this.lookupForeignFile(t.foreignPath,t.foreignPathAlt);s?r.ensureExportStar(s):this.error(n.DiagnosticCode.File_0_not_found,t.pathLiteral.range,t.pathLiteral.value)}}for(;;){let e=0,i=!1;for(;e<t.length;){let n=t[e],s=n.localIdentifier,a=n.foreignIdentifier,o=assert(this.lookupForeignFile(n.foreignPath,n.foreignPathAlt));if(a){let l=this.lookupForeign(a.text,o,r);l?(n.localFile.add(s.text,l,s),t.splice(e,1),i=!0):++e}else{let r=n.localFile,a=s.text;r.add(a,o.asAliasNamespace(a,r,s),s),t.splice(e,1),i=!0}}if(!i){for(let e=0,r=t.length;e<r;++e){let r=t[e],i=r.foreignIdentifier;i&&this.error(n.DiagnosticCode.Module_0_has_no_exported_member_1,i.range,r.foreignPath,i.text)}break}}for(let e=Map_keys(r),t=0,i=e.length;t<i;++t){let i=unchecked(e[t]),s=assert(r.get(i));for(let e=Map_keys(s),t=0,a=e.length;t<a;++t){let a=unchecked(e[t]),o=assert(s.get(a)),l=o.localIdentifier.text,u=o.foreignPath;if(u){let e=assert(this.lookupForeignFile(u,assert(o.foreignPathAlt))),t=this.lookupForeign(l,e,r);t?i.ensureExport(a,t):this.error(n.DiagnosticCode.Module_0_has_no_exported_member_1,o.localIdentifier.range,u,l)}else{let e=i.lookupInSelf(l);if(e)i.ensureExport(a,e);else{let e=this.lookup(l);null!==e&&I(e.kind)?i.ensureExport(a,e):this.error(n.DiagnosticCode.Module_0_has_no_exported_member_1,o.foreignIdentifier.range,i.internalName,o.foreignIdentifier.text)}}}}assert(0==this.arrayBufferInstance.id),assert(1==this.stringInstance.id),assert(2==this.arrayBufferViewInstance.id),this.registerWrapperClass(s.Type.i8,i.CommonNames.I8),this.registerWrapperClass(s.Type.i16,i.CommonNames.I16),this.registerWrapperClass(s.Type.i32,i.CommonNames.I32),this.registerWrapperClass(s.Type.i64,i.CommonNames.I64),this.registerWrapperClass(e.isizeType,i.CommonNames.Isize),this.registerWrapperClass(s.Type.u8,i.CommonNames.U8),this.registerWrapperClass(s.Type.u16,i.CommonNames.U16),this.registerWrapperClass(s.Type.u32,i.CommonNames.U32),this.registerWrapperClass(s.Type.u64,i.CommonNames.U64),this.registerWrapperClass(e.usizeType,i.CommonNames.Usize),this.registerWrapperClass(s.Type.bool,i.CommonNames.Bool),this.registerWrapperClass(s.Type.f32,i.CommonNames.F32),this.registerWrapperClass(s.Type.f64,i.CommonNames.F64),e.hasFeature(16)&&this.registerWrapperClass(s.Type.v128,i.CommonNames.V128),e.hasFeature(256)&&(this.registerWrapperClass(s.Type.funcref,i.CommonNames.Funcref),this.registerWrapperClass(s.Type.externref,i.CommonNames.Externref),e.hasFeature(1024)&&(this.registerWrapperClass(s.Type.anyref,i.CommonNames.Anyref),this.registerWrapperClass(s.Type.eqref,i.CommonNames.Eqref),this.registerWrapperClass(s.Type.i31ref,i.CommonNames.I31ref),this.registerWrapperClass(s.Type.dataref,i.CommonNames.Dataref)));var p=this.resolver;for(let e=0,t=u.length;e<t;++e){let t=u[e],r=assert(t.extendsNode),i=p.resolveTypeName(r.name,t.parent);if(i)if(t.kind==g.CLASS_PROTOTYPE)if(i.kind==g.CLASS_PROTOTYPE){let e=i;e.hasDecorator(f.FINAL)&&this.error(n.DiagnosticCode.Class_0_is_final_and_cannot_be_extended,r.range,e.identifierNode.text),e.hasDecorator(f.UNMANAGED)!=t.hasDecorator(f.UNMANAGED)&&this.error(n.DiagnosticCode.Unmanaged_classes_cannot_extend_managed_classes_and_vice_versa,a.Range.join(t.identifierNode.range,r.range)),t.basePrototype=e}else this.error(n.DiagnosticCode.A_class_may_only_extend_another_class,r.range);else t.kind==g.INTERFACE_PROTOTYPE&&(i.kind==g.INTERFACE_PROTOTYPE?t.basePrototype=i:this.error(n.DiagnosticCode.An_interface_can_only_extend_an_interface,r.range))}for(let e=0,t=c.length;e<t;++e){let t=c[e],r=assert(t.implementsNodes);for(let e=0,i=r.length;e<i;++e){let i=r[e],s=p.resolveTypeName(i.name,t.parent);if(s)if(s.kind==g.INTERFACE_PROTOTYPE){let e=s,r=t.interfacePrototypes;r||(t.interfacePrototypes=r=new Array),r.push(e)}else this.error(n.DiagnosticCode.A_class_can_only_implement_an_interface,i.range)}}for(let e=0,t=u.length;e<t;++e){let t=u[e],r=t.basePrototype;r&&this.markVirtuals(t,r)}for(let e=0,t=c.length;e<t;++e){let t=c[e],r=t.basePrototype,i=t.interfacePrototypes;if(r&&this.markVirtuals(t,r),i)for(let e=0,r=i.length;e<r;++e)this.markVirtuals(t,i[e])}{let t=e.globalAliases;t||(t=new Map);let r=this.isWasi;t.has(i.CommonNames.abort)||t.set(i.CommonNames.abort,r?_.BuiltinNames.wasiAbort:_.BuiltinNames.abort),t.has(i.CommonNames.trace)||t.set(i.CommonNames.trace,r?_.BuiltinNames.wasiTrace:_.BuiltinNames.trace),t.has(i.CommonNames.seed)||t.set(i.CommonNames.seed,r?_.BuiltinNames.wasiSeed:_.BuiltinNames.seed),t.has(i.CommonNames.Math)||t.set(i.CommonNames.Math,i.CommonNames.NativeMath),t.has(i.CommonNames.Mathf)||t.set(i.CommonNames.Mathf,i.CommonNames.NativeMathf);for(let e=Map_keys(t),r=0,i=e.length;r<i;++r){let i=unchecked(e[r]),n=changetype(t.get(i));if(assert(null!=n),!n.length){this.elementsByName.delete(i);continue}let a=n.charCodeAt(0);if(a>=48&&a<=57)this.registerConstantInteger(i,s.Type.i32,i64_new(parseInt(n,10)));else{let e=this.elementsByName;if(!e.has(n))throw new Error("no such global element: "+n);e.set(i,assert(e.get(n)))}}}for(let e=Map_values(this.filesByName),t=0,r=e.length;t<r;++t){let r=unchecked(e[t]);r.source.sourceKind==o.SourceKind.USER_ENTRY&&this.markModuleExports(r)}}}markVirtuals(e,t){var r=e.instanceMembers;if(r)for(;;){let e=t.instanceMembers;if(e)for(let t=Map_values(r),s=0,a=t.length;s<a;++s){let r=t[s];if(!r.isAny(i.CommonFlags.CONSTRUCTOR|i.CommonFlags.PRIVATE)&&e.has(r.name)){let t=assert(e.get(r.name));if(r.kind==g.FUNCTION_PROTOTYPE&&t.kind==g.FUNCTION_PROTOTYPE){let e=r,s=t;e.visibilityEquals(s)||this.errorRelated(n.DiagnosticCode.Overload_signatures_must_all_be_public_private_or_protected,e.identifierNode.range,s.identifierNode.range),t.set(i.CommonFlags.VIRTUAL);let a=s.overloads;a||(s.overloads=a=new Set),a.add(r);let o=s.instances;if(o)for(let e=Map_values(o),t=0,r=e.length;t<r;++t){e[t].set(i.CommonFlags.VIRTUAL)}}else if(r.kind==g.PROPERTY_PROTOTYPE&&t.kind==g.PROPERTY_PROTOTYPE){let e=r,s=t;e.visibilityEquals(s)||this.errorRelated(n.DiagnosticCode.Overload_signatures_must_all_be_public_private_or_protected,e.identifierNode.range,s.identifierNode.range),s.set(i.CommonFlags.VIRTUAL);let a=s.getterPrototype;if(a){a.set(i.CommonFlags.VIRTUAL);let t=e.getterPrototype;if(t){let e=a.overloads;e||(a.overloads=e=new Set),e.add(t)}let r=a.instances;if(r)for(let e=Map_values(r),t=0,n=e.length;t<n;++t){e[t].set(i.CommonFlags.VIRTUAL)}}let o=s.setterPrototype;if(null!==o&&null!==e.setterPrototype){o.set(i.CommonFlags.VIRTUAL);let t=e.setterPrototype;if(t){let e=o.overloads;e||(o.overloads=e=new Set),e.add(t)}let r=o.instances;if(r)for(let e=Map_values(r),t=0,n=e.length;t<n;++t){e[t].set(i.CommonFlags.VIRTUAL)}}}else this.errorRelated(n.DiagnosticCode.Duplicate_identifier_0,r.identifierNode.range,t.identifierNode.range,t.identifierNode.text)}}let s=t.basePrototype;if(!s)break;t=s}}lookup(e){var t=this.elementsByName;return t.has(e)?assert(t.get(e)):null}require(e,t){var r=this.lookup(e);if(!r)throw new Error("Missing standard library component: "+e);if(r.kind!=t)throw Error("Invalid standard library component kind: "+e);return r}requireGlobal(e){return this.require(e,g.GLOBAL)}requireClass(e){var t=this.require(e,g.CLASS_PROTOTYPE),r=this.resolver.resolveClass(t,null);if(!r)throw new Error("Invalid standard library class: "+e);return r}requireFunction(e,t=null){var r=this.require(e,g.FUNCTION_PROTOTYPE),i=this.resolver.resolveFunction(r,t);if(!i)throw new Error("Invalid standard library function: "+e);return i}markModuleExports(e){var t=e.exports;if(t)for(let e=Map_values(t),r=0,i=e.length;r<i;++r){let t=unchecked(e[r]);this.markModuleExport(t)}var r=e.exportsStar;if(r)for(let e=0,t=r.length;e<t;++e)this.markModuleExports(r[e])}markModuleExport(e){switch(e.set(i.CommonFlags.MODULE_EXPORT),e.kind){case g.CLASS_PROTOTYPE:{let t=e.instanceMembers;if(t)for(let e=Map_values(t),r=0,i=e.length;r<i;++r){let t=unchecked(e[r]);this.markModuleExport(t)}break}case g.PROPERTY_PROTOTYPE:{let t=e,r=t.getterPrototype;r&&this.markModuleExport(r);let i=t.setterPrototype;i&&this.markModuleExport(i);break}case g.PROPERTY:case g.FUNCTION:case g.FIELD:case g.CLASS:assert(!1)}var t=e.members;if(t)for(let e=Map_values(t),r=0,i=e.length;r<i;++r){let t=unchecked(e[r]);this.markModuleExport(t)}}registerNativeType(e,t){var r=new C(e,this.nativeFile,this.makeNativeTypeDeclaration(e,i.CommonFlags.EXPORT),f.BUILTIN);r.setType(t),this.nativeFile.add(e,r)}registerWrapperClass(e,t){var r=this.wrapperClasses;assert(!e.isInternalReference&&!r.has(e));var i=assert(this.lookup(t));assert(i.kind==g.CLASS_PROTOTYPE);var n=assert(this.resolver.resolveClass(i,null));n.wrappedType=e,r.set(e,n)}registerConstantInteger(e,t,r){assert(t.isIntegerInclReference);var n=new F(e,this.nativeFile,f.NONE,this.makeNativeVariableDeclaration(e,i.CommonFlags.CONST|i.CommonFlags.EXPORT));n.setConstantIntegerValue(r,t),this.nativeFile.add(e,n)}registerConstantFloat(e,t,r){assert(t.isFloatValue);var n=new F(e,this.nativeFile,f.NONE,this.makeNativeVariableDeclaration(e,i.CommonFlags.CONST|i.CommonFlags.EXPORT));n.setConstantFloatValue(r,t),this.nativeFile.add(e,n)}ensureGlobal(e,t){var r=this.elementsByName;if(r.has(e)){let i=assert(r.get(e));if(i!==t){let r=z(i,t);if(!r)return I(i.kind)?this.errorRelated(n.DiagnosticCode.Duplicate_identifier_0,t.identifierNode.range,i.declaration.name.range,e):this.error(n.DiagnosticCode.Duplicate_identifier_0,t.identifierNode.range,e),t;t=r}}return r.set(e,t),t}lookupForeignFile(e,t){var r=this.filesByName;return r.has(e)?assert(r.get(e)):r.has(t)?assert(r.get(t)):null}lookupForeign(e,t,r){for(;;){let i=t.lookupExport(e);if(i)return i;if(r.has(t)){let n=assert(r.get(t));if(n.has(e)){let r=assert(n.get(e)),s=r.foreignPath;if(s){let i=this.lookupForeignFile(s,assert(r.foreignPathAlt));if(!i)return null;e=r.localIdentifier.text,t=i;continue}if(i=t.lookupInSelf(r.localIdentifier.text),i)return i}}break}var i=t.exportsStar;if(i)for(let t=0,n=i.length;t<n;++t){let n=this.lookupForeign(e,i[t],r);if(n)return n}return null}checkDecorators(e,t){var r=f.NONE;if(e)for(let i=0,s=e.length;i<s;++i){let s=e[i],a=o.DecoratorKind.fromNode(s.name),l=f.fromKind(a);l&&(l==f.BUILTIN?t&l||s.range.source.isLibrary?r|=l:this.error(n.DiagnosticCode.Decorator_0_is_not_valid_here,s.range,s.name.range.toString()):t&l?r&l?this.error(n.DiagnosticCode.Duplicate_decorator,s.range):r|=l:this.error(n.DiagnosticCode.Decorator_0_is_not_valid_here,s.range,s.name.range.toString()))}return r}initializeClass(e,t,r,s){var l=e.name.text,u=new M(l,t,e,this.checkDecorators(e.decorators,f.GLOBAL|f.FINAL|f.UNMANAGED));if(!t.add(l,u))return null;var c=e.implementsTypes;if(c){let t=c.length;t&&(u.hasDecorator(f.UNMANAGED)?this.error(n.DiagnosticCode.Unmanaged_classes_cannot_implement_interfaces,a.Range.join(e.name.range,c[t-1].range)):s.push(u))}e.extendsType&&r.push(u);var p=e.members;for(let e=0,t=p.length;e<t;++e){let t=p[e];switch(t.kind){case o.NodeKind.FIELDDECLARATION:this.initializeField(t,u);break;case o.NodeKind.METHODDECLARATION:{let e=t;if(t.isAny(i.CommonFlags.GET|i.CommonFlags.SET))this.initializeProperty(e,u);else{let t=this.initializeMethod(e,u);null!==t&&e.name.kind==o.NodeKind.CONSTRUCTOR&&(u.constructorPrototype=t)}break}case o.NodeKind.INDEXSIGNATURE:break;default:assert(!1)}}return u}initializeField(e,t){var r,n=e.name.text,s=e.decorators,a=f.UNSAFE;if(t.is(i.CommonFlags.AMBIENT)&&(a|=f.EXTERNAL),e.is(i.CommonFlags.STATIC)){if(assert(t.kind!=g.INTERFACE_PROTOTYPE),a|=f.LAZY,e.is(i.CommonFlags.READONLY)&&(a|=f.INLINE),r=new F(n,t,this.checkDecorators(s,a),e),!t.add(n,r))return}else if(assert(!e.isAny(i.CommonFlags.ABSTRACT|i.CommonFlags.GET|i.CommonFlags.SET)),r=new B(n,t,e,this.checkDecorators(s,a)),!t.addInstance(n,r))return}initializeMethod(e,t){var r=e.name.text,n=e.is(i.CommonFlags.STATIC),s=f.INLINE|f.UNSAFE;e.is(i.CommonFlags.GENERIC)||(s|=f.OPERATOR_BINARY|f.OPERATOR_PREFIX|f.OPERATOR_POSTFIX),t.is(i.CommonFlags.AMBIENT)&&(s|=f.EXTERNAL);var a=new P(r,t,e,this.checkDecorators(e.decorators,s));if(n){if(assert(e.name.kind!=o.NodeKind.CONSTRUCTOR),!t.add(r,a))return null}else if(!t.addInstance(r,a))return null;return this.checkOperatorOverloads(e.decorators,a,t),a}checkOperatorOverloads(e,t,r){if(e)for(let i=0,s=e.length;i<s;++i){let s=e[i];switch(s.decoratorKind){case o.DecoratorKind.OPERATOR:case o.DecoratorKind.OPERATOR_BINARY:case o.DecoratorKind.OPERATOR_PREFIX:case o.DecoratorKind.OPERATOR_POSTFIX:{let e=s.args,i=e?e.length:0;if(1==i){let e=s.args[0];if(e.isLiteralKind(o.LiteralKind.STRING)){let i=e.value,a=T.fromDecorator(s.decoratorKind,i);if(a==T.INVALID)this.error(n.DiagnosticCode._0_is_not_a_valid_operator,e.range,i);else{let i=r.overloadPrototypes;i.has(a)?this.error(n.DiagnosticCode.Duplicate_function_implementation,e.range):(t.operatorKind=a,i.set(a,t))}}else this.error(n.DiagnosticCode.String_literal_expected,e.range)}else this.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,s.range,"1",i.toString())}}}}ensureProperty(e,t){var r=e.name.text;if(e.is(i.CommonFlags.STATIC)){let i=t.members;if(null===i||!i.has(r)){let i=new U(r,t,e);return t.add(r,i)?i:null}{let e=assert(i.get(r));if(e.kind==g.PROPERTY_PROTOTYPE)return e}}else{let i=t.instanceMembers;if(null===i||!i.has(r)){let i=new U(r,t,e);return t.addInstance(r,i)?i:null}{let e=assert(i.get(r));if(e.kind==g.PROPERTY_PROTOTYPE)return e}}return this.error(n.DiagnosticCode.Duplicate_property_0,e.name.range,r),null}initializeProperty(e,t){var r=this.ensureProperty(e,t);if(r){var s=e.name.text,a=e.is(i.CommonFlags.GET);if(a){if(r.getterPrototype)return void this.error(n.DiagnosticCode.Duplicate_property_0,e.name.range,s)}else if(r.setterPrototype)return void this.error(n.DiagnosticCode.Duplicate_property_0,e.name.range,s);var o=new P((a?i.GETTER_PREFIX:i.SETTER_PREFIX)+s,r,e,this.checkDecorators(e.decorators,f.INLINE|f.UNSAFE));a?r.getterPrototype=o:r.setterPrototype=o}}initializeEnum(e,t){var r=e.name.text,i=new R(r,t,e,this.checkDecorators(e.decorators,f.GLOBAL|f.INLINE|f.LAZY));if(!t.add(r,i))return null;var n=e.values;for(let e=0,t=n.length;e<t;++e)this.initializeEnumValue(n[e],i);return i}initializeEnumValue(e,t){var r=e.name.text,i=new L(r,t,e,this.checkDecorators(e.decorators,f.NONE));t.add(r,i)}initializeExports(e,t,r,n){var s=e.members;if(s)for(let i=0,n=s.length;i<n;++i)this.initializeExport(s[i],t,e.internalPath,r);else{let r;n.has(t)?r=assert(n.get(t)):n.set(t,r=[]);let s=e.internalPath;r.push(new y(s,s.endsWith(i.INDEX_SUFFIX)?s.substring(0,s.length-i.INDEX_SUFFIX.length):s+i.INDEX_SUFFIX,assert(e.path)))}}initializeExport(e,t,r,s){var a=e.localName.text,o=e.exportedName.text,l=t.lookupExport(o);if(l)this.error(n.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.exportedName.range,o);else if(null===r)if(l=t.lookupInSelf(a))t.ensureExport(o,l);else{let r;s.has(t)?r=assert(s.get(t)):s.set(t,r=new Map),r.set(o,new m(e.localName,e.exportedName,null,null))}else{let n;s.has(t)?n=assert(s.get(t)):s.set(t,n=new Map),n.set(o,new m(e.localName,e.exportedName,r,r.endsWith(i.INDEX_SUFFIX)?r.substring(0,r.length-i.INDEX_SUFFIX.length):r+i.INDEX_SUFFIX))}}initializeExportDefault(e,t,r,i){var s=e.declaration,a=null;switch(s.kind){case o.NodeKind.ENUMDECLARATION:a=this.initializeEnum(s,t);break;case o.NodeKind.FUNCTIONDECLARATION:a=this.initializeFunction(s,t);break;case o.NodeKind.CLASSDECLARATION:a=this.initializeClass(s,t,r,i);break;case o.NodeKind.INTERFACEDECLARATION:a=this.initializeInterface(s,t,r);break;case o.NodeKind.NAMESPACEDECLARATION:a=this.initializeNamespace(s,t,r,i);break;default:assert(!1)}if(a){let e=t.exports;if(e){if(e.has("default")){let t=assert(e.get("default"));return void this.errorRelated(n.DiagnosticCode.Duplicate_identifier_0,s.name.range,t.declaration.name.range,"default")}}else t.exports=e=new Map;e.set("default",a)}}initializeImports(e,t,r,n){var s=e.declarations;if(s)for(let i=0,a=s.length;i<a;++i)this.initializeImport(s[i],t,e.internalPath,r,n);else{let n=e.namespaceName;n&&r.push(new d(t,n,null,e.internalPath,e.internalPath+i.INDEX_SUFFIX))}}initializeImport(e,t,r,n,s){var a=r.endsWith(i.INDEX_SUFFIX)?r.substring(0,r.length-i.INDEX_SUFFIX.length):r+i.INDEX_SUFFIX,o=this.lookupForeignFile(r,a);if(o){var l=this.lookupForeign(e.foreignName.text,o,s);if(l)return void t.add(e.name.text,l,e.name)}n.push(new d(t,e.name,e.foreignName,r,a))}initializeFunction(e,t){var r=e.name.text,n=f.UNSAFE|f.BUILTIN;e.is(i.CommonFlags.AMBIENT)?n|=f.EXTERNAL:(n|=f.INLINE,(e.range.source.isLibrary||e.is(i.CommonFlags.EXPORT))&&(n|=f.LAZY)),e.is(i.CommonFlags.INSTANCE)||t.kind!=g.CLASS_PROTOTYPE&&(n|=f.GLOBAL);var s=new P(r,t,e,this.checkDecorators(e.decorators,n));return t.add(r,s)?s:null}initializeInterface(e,t,r){var n=e.name.text,s=new K(n,t,e,this.checkDecorators(e.decorators,f.GLOBAL));if(!t.add(n,s))return null;e.extendsType&&r.push(s);var a=e.members;for(let e=0,t=a.length;e<t;++e){let t=a[e];switch(t.kind){case o.NodeKind.FIELDDECLARATION:this.initializeFieldAsProperty(t,s);break;case o.NodeKind.METHODDECLARATION:{let e=t;t.isAny(i.CommonFlags.GET|i.CommonFlags.SET)?this.initializeProperty(e,s):this.initializeMethod(e,s);break}default:assert(!1)}}return s}initializeFieldAsProperty(e,t){var r=e.type;r||(r=o.Node.createOmittedType(e.name.range.atEnd)),this.initializeProperty(o.Node.createMethodDeclaration(e.name,e.decorators,e.flags|i.CommonFlags.GET,null,o.Node.createFunctionType([],r,null,!1,e.range),null,e.range),t),e.is(i.CommonFlags.READONLY)||this.initializeProperty(o.Node.createMethodDeclaration(e.name,e.decorators,e.flags|i.CommonFlags.SET,null,o.Node.createFunctionType([o.Node.createParameter(o.ParameterKind.DEFAULT,e.name,r,null,e.name.range)],o.Node.createOmittedType(e.name.range.atEnd),null,!1,e.range),null,e.range),t)}initializeNamespace(e,t,r,i){var n=e.name.text,s=new O(n,t,e,this.checkDecorators(e.decorators,f.GLOBAL));if(!t.add(n,s))return null;var a=assert(t.lookupInSelf(n)),l=e.members;for(let e=0,t=l.length;e<t;++e){let t=l[e];switch(t.kind){case o.NodeKind.CLASSDECLARATION:this.initializeClass(t,s,r,i);break;case o.NodeKind.ENUMDECLARATION:this.initializeEnum(t,s);break;case o.NodeKind.FUNCTIONDECLARATION:this.initializeFunction(t,s);break;case o.NodeKind.INTERFACEDECLARATION:this.initializeInterface(t,s,r);break;case o.NodeKind.NAMESPACEDECLARATION:this.initializeNamespace(t,s,r,i);break;case o.NodeKind.TYPEDECLARATION:this.initializeTypeDefinition(t,s);break;case o.NodeKind.VARIABLE:this.initializeVariables(t,s);break;default:assert(!1)}}return s!=a&&W(s,a),a}initializeTypeDefinition(e,t){var r=e.name.text,i=new C(r,t,e,this.checkDecorators(e.decorators,f.NONE));t.add(r,i)}initializeVariables(e,t){var r=e.declarations;for(let e=0,n=r.length;e<n;++e){let n=r[e],s=n.name.text,a=f.GLOBAL|f.LAZY;n.is(i.CommonFlags.DECLARE)&&(a|=f.EXTERNAL),n.is(i.CommonFlags.CONST)&&(a|=f.INLINE);let o=new F(s,t,this.checkDecorators(n.decorators,a),n);t.add(s,o)}}}t.Program=E,function(e){e[e.GLOBAL=0]="GLOBAL",e[e.LOCAL=1]="LOCAL",e[e.ENUM=2]="ENUM",e[e.ENUMVALUE=3]="ENUMVALUE",e[e.FUNCTION_PROTOTYPE=4]="FUNCTION_PROTOTYPE",e[e.FUNCTION=5]="FUNCTION",e[e.FUNCTION_TARGET=6]="FUNCTION_TARGET",e[e.CLASS_PROTOTYPE=7]="CLASS_PROTOTYPE",e[e.CLASS=8]="CLASS",e[e.INTERFACE_PROTOTYPE=9]="INTERFACE_PROTOTYPE",e[e.INTERFACE=10]="INTERFACE",e[e.FIELD_PROTOTYPE=11]="FIELD_PROTOTYPE",e[e.FIELD=12]="FIELD",e[e.PROPERTY_PROTOTYPE=13]="PROPERTY_PROTOTYPE",e[e.PROPERTY=14]="PROPERTY",e[e.NAMESPACE=15]="NAMESPACE",e[e.FILE=16]="FILE",e[e.TYPEDEFINITION=17]="TYPEDEFINITION",e[e.INDEXSIGNATURE=18]="INDEXSIGNATURE"}(g=t.ElementKind||(t.ElementKind={})),function(e){e[e.NONE=0]="NONE",e[e.GLOBAL=1]="GLOBAL",e[e.OPERATOR_BINARY=2]="OPERATOR_BINARY",e[e.OPERATOR_PREFIX=4]="OPERATOR_PREFIX",e[e.OPERATOR_POSTFIX=8]="OPERATOR_POSTFIX",e[e.UNMANAGED=16]="UNMANAGED",e[e.FINAL=32]="FINAL",e[e.INLINE=64]="INLINE",e[e.EXTERNAL=128]="EXTERNAL",e[e.BUILTIN=256]="BUILTIN",e[e.LAZY=512]="LAZY",e[e.UNSAFE=1024]="UNSAFE"}(f=t.DecoratorFlags||(t.DecoratorFlags={})),function(e){e.fromKind=function(t){switch(t){case o.DecoratorKind.GLOBAL:return e.GLOBAL;case o.DecoratorKind.OPERATOR:case o.DecoratorKind.OPERATOR_BINARY:return e.OPERATOR_BINARY;case o.DecoratorKind.OPERATOR_PREFIX:return e.OPERATOR_PREFIX;case o.DecoratorKind.OPERATOR_POSTFIX:return e.OPERATOR_POSTFIX;case o.DecoratorKind.UNMANAGED:return e.UNMANAGED;case o.DecoratorKind.FINAL:return e.FINAL;case o.DecoratorKind.INLINE:return e.INLINE;case o.DecoratorKind.EXTERNAL:return e.EXTERNAL;case o.DecoratorKind.BUILTIN:return e.BUILTIN;case o.DecoratorKind.LAZY:return e.LAZY;case o.DecoratorKind.UNSAFE:return e.UNSAFE;default:return e.NONE}}}(f=t.DecoratorFlags||(t.DecoratorFlags={}));class b{constructor(e,t,r,n,s){this.kind=e,this.name=t,this.internalName=r,this.program=n,this.flags=i.CommonFlags.NONE,this.decoratorFlags=f.NONE,this.members=null,this.shadowType=null,this.program=n,this.name=t,this.internalName=r,s?this.parent=s:(assert(this.kind==g.FILE),this.parent=this)}get file(){for(var e=this;;)if((e=e.parent).kind==g.FILE)return e}is(e){return(this.flags&e)==e}isAny(e){return 0!=(this.flags&e)}set(e){this.flags|=e}unset(e){this.flags&=~e}hasDecorator(e){return(this.decoratorFlags&e)==e}lookupInSelf(e){var t=this.members;return null!==t&&t.has(e)?assert(t.get(e)):null}add(e,t,r=null){var i=t.declaration,s=this.members;if(s){if(s.has(e)){let i=assert(s.get(e));if(i.parent!==this);else{let e=z(i,t);if(!e){let e=r||t.identifierNode;return I(i.kind)?this.program.errorRelated(n.DiagnosticCode.Duplicate_identifier_0,e.range,i.identifierNode.range,e.text):this.program.error(n.DiagnosticCode.Duplicate_identifier_0,e.range,e.text),!1}t=e}}}else this.members=s=new Map;s.set(e,t);var a=this.program;return t.kind==g.FUNCTION_PROTOTYPE&&t.isBound||(a.elementsByName.set(t.internalName,t),a.elementsByDeclaration.set(i,t)),!0}get isPublic(){return!this.isAny(i.CommonFlags.PRIVATE|i.CommonFlags.PROTECTED)}get isImplicitlyPublic(){return this.isPublic&&!this.is(i.CommonFlags.PUBLIC)}visibilityEquals(e){if(this.isPublic==e.isPublic)return!0;const t=i.CommonFlags.PRIVATE|i.CommonFlags.PROTECTED;return(this.flags&t)==(e.flags&t)}toString(){return this.internalName+", kind="+this.kind.toString()}}t.Element=b;var x=new Set;function I(e){return x.has(e)}t.isDeclaredElement=I;class A extends b{constructor(e,t,r,i,n,s){super(e,t,r,i,n),this.declaration=s,x.add(e),this.declaration=s,this.flags=s.flags}get isDeclaredInLibrary(){return this.declaration.range.source.isLibrary}get identifierNode(){return this.declaration.name}get identifierAndSignatureRange(){var e=this.declaration,t=e.name;if(e.kind==o.NodeKind.FUNCTIONDECLARATION||e.kind==o.NodeKind.METHODDECLARATION){let r=e.signature;return a.Range.join(t.range,r.range)}return t.range}get decoratorNodes(){return this.declaration.decorators}isCompatibleOverride(e){var t=this,r=t.kind;if(r==e.kind)switch(r){case g.FUNCTION:return t.signature.isAssignableTo(e.signature,!0);case g.PROPERTY:{let r=t,i=e,n=r.getterInstance,s=i.getterInstance;if(n){if(!s||!n.signature.isAssignableTo(s.signature,!0))return!1}else if(s)return!1;let a=r.setterInstance,o=i.setterInstance;if(a){if(!o||!a.signature.isAssignableTo(o.signature,!0))return!1}else if(o)return!1;return!0}}return!1}}t.DeclaredElement=A;var N=new Set;t.isTypedElement=function(e){return N.has(e)};class S extends A{constructor(e,t,r,i,n,a){super(e,t,r,i,n,a),this.type=s.Type.void,N.add(e)}setType(e){assert(!this.is(i.CommonFlags.RESOLVED)),this.type=e,this.set(i.CommonFlags.RESOLVED)}}t.TypedElement=S;class v extends b{constructor(e,t){super(g.FILE,t.normalizedPath,t.internalPath,e,null),this.source=t,this.exports=null,this.exportsStar=null,this.aliasNamespaces=new Array,this.source=t,assert(!e.filesByName.has(this.internalName)),e.filesByName.set(this.internalName,this);var r=this.program.makeNativeFunction("start:"+this.internalName,new s.Signature(e,null,s.Type.void),this);r.internalName=r.name,this.startFunction=r}add(e,t,r=null){return t.hasDecorator(f.GLOBAL)&&(t=this.program.ensureGlobal(e,t)),!!super.add(e,t,r)&&((t=assert(this.lookupInSelf(e))).is(i.CommonFlags.EXPORT)&&!r&&this.ensureExport(t.name,t),!0)}lookupInSelf(e){var t=super.lookupInSelf(e);if(t)return t;var r=this.exportsStar;if(r)for(let i=0,n=r.length;i<n;++i)if(t=r[i].lookupInSelf(e))return t;return null}lookup(e){var t=this.lookupInSelf(e);return t||this.program.lookup(e)}ensureExport(e,t){var r=this.exports;r||(this.exports=r=new Map),r.set(e,t),this.source.sourceKind==o.SourceKind.LIBRARY_ENTRY&&this.program.ensureGlobal(e,t);for(let r=0;r<this.aliasNamespaces.length;r++){this.aliasNamespaces[r].add(e,t)}}ensureExportStar(e){var t=this.exportsStar;if(t){if(t.includes(e))return}else this.exportsStar=t=[];t.push(e)}lookupExport(e){var t=this.exports;if(null!==t&&t.has(e))return assert(t.get(e));var r=this.exportsStar;if(r)for(let t=0,i=r.length;t<i;++t){let i=r[t].lookupExport(e);if(i)return i}return null}asAliasNamespace(e,t,r){var n=this.program.makeNativeNamespaceDeclaration(e);n.name=r;var s=new O(e,t,n);return s.set(i.CommonFlags.SCOPED),this.copyExportsToNamespace(s),this.aliasNamespaces.push(s),s}copyExportsToNamespace(e){var t=this.exports;if(t)for(let r=Map_keys(t),i=0,n=r.length;i<n;++i){let n=unchecked(r[i]),s=assert(t.get(n));e.add(n,s)}var r=this.exportsStar;if(r)for(let t=0,i=r.length;t<i;++t)r[t].copyExportsToNamespace(e)}}t.File=v;class C extends S{constructor(e,t,r,i=f.NONE){super(g.TYPEDEFINITION,e,Y(e,t,!1),t.program,t,r),this.decoratorFlags=i}get typeParameterNodes(){return this.declaration.typeParameters}get typeNode(){return this.declaration.type}lookup(e){return this.parent.lookup(e)}}t.TypeDefinition=C;class O extends A{constructor(e,t,r,i=f.NONE){super(g.NAMESPACE,e,Y(e,t,!1),t.program,t,r),this.decoratorFlags=i}lookup(e){var t=this.lookupInSelf(e);return t||this.parent.lookup(e)}}t.Namespace=O;class R extends S{constructor(e,t,r,i=f.NONE){super(g.ENUM,e,Y(e,t,!1),t.program,t,r),this.decoratorFlags=i,this.setType(s.Type.i32)}lookup(e){var t=this.lookupInSelf(e);return t||this.parent.lookup(e)}}t.Enum=R,function(e){e[e.NONE=0]="NONE",e[e.INTEGER=1]="INTEGER",e[e.FLOAT=2]="FLOAT"}(t.ConstantValueKind||(t.ConstantValueKind={}));class k extends S{constructor(e,t,r,i=r.program.makeNativeVariableDeclaration(t)){super(e,t,Y(t,r,!1),r.program,r,i),this.constantValueKind=0,this.constantIntegerValue=i64_zero,this.constantFloatValue=0,this.flags=i.flags}get typeNode(){return this.declaration.type}get initializerNode(){return this.declaration.initializer}setConstantIntegerValue(e,t){assert(t.isIntegerInclReference),this.type=t,this.constantValueKind=1,this.constantIntegerValue=e,this.set(i.CommonFlags.CONST|i.CommonFlags.INLINED|i.CommonFlags.RESOLVED)}setConstantFloatValue(e,t){assert(t.isFloatValue),this.type=t,this.constantValueKind=2,this.constantFloatValue=e,this.set(i.CommonFlags.CONST|i.CommonFlags.INLINED|i.CommonFlags.RESOLVED)}lookup(e){return this.parent.lookup(e)}}t.VariableLikeElement=k;class L extends k{constructor(e,t,r,i=f.NONE){super(g.ENUMVALUE,e,t,r),this.isImmutable=!1,this.decoratorFlags=i,this.setType(s.Type.i32)}get valueNode(){return this.declaration.initializer}lookup(e){return this.parent.lookup(e)}}t.EnumValue=L;class F extends k{constructor(e,t,r,i=t.program.makeNativeVariableDeclaration(e)){super(g.GLOBAL,e,t,i),this.decoratorFlags=r}}t.Global=F;t.Parameter=class{constructor(e,t,r=null){this.name=e,this.type=t,this.initializer=r}};class D extends k{constructor(e,t,r,i,n=i.program.makeNativeVariableDeclaration(e)){super(g.LOCAL,e,i,n),this.index=t,this.originalName=e,this.index=t,assert(r!=s.Type.void),this.setType(r)}setTemporaryName(e){this.name=e,this.internalName=Y(e,this.parent,!1)}resetTemporaryName(){var e=this.originalName;this.name=e,this.internalName=Y(e,this.parent,!1)}}t.Local=D;class P extends A{constructor(e,t,r,n=f.NONE){super(g.FUNCTION_PROTOTYPE,e,Y(e,t,r.is(i.CommonFlags.INSTANCE)),t.program,t,r),this.operatorKind=T.INVALID,this.instances=null,this.overloads=null,this.boundPrototypes=null,this.decoratorFlags=n}get typeParameterNodes(){return this.declaration.typeParameters}get functionTypeNode(){return this.declaration.signature}get bodyNode(){return this.declaration.body}get arrowKind(){return this.declaration.arrowKind}get isBound(){var e=this.parent;return e.kind==g.CLASS||e.kind==g.PROPERTY_PROTOTYPE&&(e.parent.kind==g.CLASS||e.parent.kind==g.INTERFACE)}toBound(e){assert(this.is(i.CommonFlags.INSTANCE)),assert(!this.isBound);var t=this.boundPrototypes;if(t){if(t.has(e))return assert(t.get(e))}else this.boundPrototypes=t=new Map;var r=this.declaration;assert(r.kind==o.NodeKind.METHODDECLARATION);var n=new P(this.name,e,r,this.decoratorFlags);return n.flags=this.flags,n.operatorKind=this.operatorKind,n.overloads=this.overloads,t.set(e,n),n}getResolvedInstance(e){var t=this.instances;return null!==t&&t.has(e)?assert(t.get(e)):null}setResolvedInstance(e,t){var r=this.instances;r?assert(!r.has(e)):this.instances=r=new Map,r.set(e,t)}lookup(e){return this.parent.lookup(e)}}t.FunctionPrototype=P;class w extends S{constructor(e,t,r,n,s=null){super(g.FUNCTION,e,Y(e,t.parent,t.is(i.CommonFlags.INSTANCE)),t.program,t.parent,t.declaration),this.localsByName=new Map,this.localsByIndex=[],this.additionalLocals=[],this.debugLocations=[],this.ref=0,this.varargsStub=null,this.virtualStub=null,this.memorySegment=null,this.nextInlineId=0,this.nextAnonymousId=0,this.tempI32s=null,this.tempI64s=null,this.tempF32s=null,this.tempF64s=null,this.tempV128s=null,this.tempFuncrefs=null,this.tempExternrefs=null,this.tempAnyrefs=null,this.tempEqrefs=null,this.tempI31refs=null,this.tempDatarefs=null,this.nextBreakId=0,this.breakStack=null,this.breakLabel=null,this.prototype=t,this.typeArguments=r,this.signature=n,this.flags=t.flags|i.CommonFlags.RESOLVED,this.decoratorFlags=t.decoratorFlags,this.contextualTypeArguments=s,this.original=this;var a=t.program;if(this.type=n.type,!t.is(i.CommonFlags.AMBIENT)){let e=0,t=n.thisType;if(t){let r=new D(i.CommonNames.this_,e++,t,this);this.localsByName.set(i.CommonNames.this_,r),this.localsByIndex[r.index]=r}let r=n.parameterTypes;for(let t=0,i=r.length;t<i;++t){let i=r[t],n=this.getParameterName(t),s=new D(n,e++,i,this);this.localsByName.set(n,s),this.localsByIndex[s.index]=s}}this.flow=c.Flow.createParent(this),V(a,this)}getParameterName(e){var t=this.declaration.signature.parameters;return t.length>e?t[e].name.text:X(e)}newStub(e){var t=new w(this.original.name+i.STUB_DELIMITER+e,this.prototype,this.typeArguments,this.signature.clone(),this.contextualTypeArguments);return t.original=this.original,t.set(this.flags&~i.CommonFlags.COMPILED|i.CommonFlags.STUB),t}addLocal(e,t=null,r=null){var n=this.signature.parameterTypes.length+this.additionalLocals.length;this.is(i.CommonFlags.INSTANCE)&&++n;var s=null!==t?t:"var$"+n.toString();r||(r=this.program.makeNativeVariableDeclaration(s));var a=new D(s,n,e,this,r);if(t){if(this.localsByName.has(t))throw new Error("duplicate local name");this.localsByName.set(t,a)}return this.localsByIndex[a.index]=a,this.additionalLocals.push(e),a}lookup(e){var t=this.localsByName;return t.has(e)?assert(t.get(e)):this.parent.lookup(e)}finalize(e,t){this.ref=t;var r=this.breakStack;if(assert(!r||!r.length),this.breakStack=r=null,this.breakLabel=null,this.tempI32s=this.tempI64s=this.tempF32s=this.tempF64s=null,this.program.options.sourceMap){let r=this.debugLocations;for(let i=0,n=r.length;i<n;++i){let n=r[i],s=n.source;e.setDebugLocation(t,n.debugInfoRef,s.debugInfoIndex,s.lineAt(n.start),s.columnAt()-1)}}}}t.Function=w;class B extends A{constructor(e,t,r,n=f.NONE){super(g.FIELD_PROTOTYPE,e,Y(e,t,assert(r.is(i.CommonFlags.INSTANCE))),t.program,t,r),this.decoratorFlags=n}get typeNode(){return this.declaration.type}get initializerNode(){return this.declaration.initializer}get parameterIndex(){return this.declaration.parameterIndex}lookup(e){return this.parent.lookup(e)}}t.FieldPrototype=B;t.Field=class extends k{constructor(e,t,r){super(g.FIELD,e.name,t,e.declaration),this.memoryOffset=-1,this.getterRef=0,this.setterRef=0,this._internalGetterName=null,this._internalSetterName=null,this._internalGetterSignature=null,this._internalSetterSignature=null,this.prototype=e,this.flags=e.flags,this.decoratorFlags=e.decoratorFlags,assert(r!=s.Type.void),this.setType(r),V(this.program,this)}get thisType(){var e=this.parent;return assert(e.kind==g.CLASS),e.type}get internalGetterName(){var e=this._internalGetterName;return null===e&&(this._internalGetterName=e=this.parent.internalName+i.INSTANCE_DELIMITER+i.GETTER_PREFIX+this.name),e}get internalSetterName(){var e=this._internalSetterName;return null===e&&(this._internalSetterName=e=this.parent.internalName+i.INSTANCE_DELIMITER+i.SETTER_PREFIX+this.name),e}get internalGetterSignature(){var e=this._internalGetterSignature;return e||(this._internalGetterSignature=e=new s.Signature(this.program,null,this.type,this.thisType)),e}get internalSetterSignature(){var e=this._internalSetterSignature;return e||(this._internalGetterSignature=e=new s.Signature(this.program,[this.type],s.Type.void,this.thisType)),e}};class U extends A{constructor(e,t,r){super(g.PROPERTY_PROTOTYPE,e,Y(e,t,r.is(i.CommonFlags.INSTANCE)),t.program,t,r),this.getterPrototype=null,this.setterPrototype=null,this.instance=null,this.boundPrototypes=null,this.flags&=~(i.CommonFlags.GET|i.CommonFlags.SET)}lookup(e){return this.parent.lookup(e)}get isBound(){switch(this.parent.kind){case g.CLASS:case g.INTERFACE:return!0}return!1}toBound(e){assert(this.is(i.CommonFlags.INSTANCE)),assert(!this.isBound);var t=this.boundPrototypes;if(t){if(t.has(e))return assert(t.get(e))}else this.boundPrototypes=t=new Map;var r=this.declaration;assert(r.kind==o.NodeKind.METHODDECLARATION);var n=new U(this.name,e,r);n.flags=this.flags;var s=this.getterPrototype;s&&(n.getterPrototype=s.toBound(e));var a=this.setterPrototype;return a&&(n.setterPrototype=a.toBound(e)),t.set(e,n),n}}t.PropertyPrototype=U;t.Property=class extends k{constructor(e,t){super(g.PROPERTY,e.name,t,o.Node.createVariableDeclaration(e.identifierNode,null,e.is(i.CommonFlags.INSTANCE)?i.CommonFlags.INSTANCE:i.CommonFlags.NONE,null,null,e.identifierNode.range)),this.getterInstance=null,this.setterInstance=null,this.prototype=e,this.flags=e.flags,this.decoratorFlags=e.decoratorFlags,this.is(i.CommonFlags.INSTANCE)&&V(this.program,this)}lookup(e){return this.parent.lookup(e)}};t.IndexSignature=class extends S{constructor(e){super(g.INDEXSIGNATURE,"[]",e.internalName+"[]",e.program,e,e.program.makeNativeVariableDeclaration("[]"))}getGetterInstance(e){return this.parent.lookupOverload(T.INDEXED_GET,e)}getSetterInstance(e){return this.parent.lookupOverload(T.INDEXED_SET,e)}lookup(e){return this.parent.lookup(e)}};class M extends A{constructor(e,t,r,n=f.NONE,s=!1){super(s?g.INTERFACE_PROTOTYPE:g.CLASS_PROTOTYPE,e,Y(e,t,r.is(i.CommonFlags.INSTANCE)),t.program,t,r),this.instanceMembers=null,this.basePrototype=null,this.interfacePrototypes=null,this.constructorPrototype=null,this.overloadPrototypes=new Map,this.instances=null,this.extendees=new Set,this.decoratorFlags=n}get typeParameterNodes(){return this.declaration.typeParameters}get extendsNode(){return this.declaration.extendsType}get implementsNodes(){return this.declaration.implementsTypes}get isBuiltinArray(){var e=this.program.arrayBufferViewInstance;return null!==e&&this.extends(e.prototype)}extends(e){var t=this,r=new Set;do{if(r.has(t))break;if(r.add(t),t===e)return!0;t=t.basePrototype}while(t);return!1}addInstance(e,t){var r=t.declaration,s=this.instanceMembers;if(s){if(s.has(e)){let r=assert(s.get(e)),i=z(r,t);if(!i)return I(r.kind)?this.program.errorRelated(n.DiagnosticCode.Duplicate_identifier_0,t.identifierNode.range,r.declaration.name.range,t.identifierNode.text):this.program.error(n.DiagnosticCode.Duplicate_identifier_0,t.identifierNode.range,t.identifierNode.text),!1;t=i}}else this.instanceMembers=s=new Map;return s.set(e,t),t.is(i.CommonFlags.EXPORT)&&this.is(i.CommonFlags.MODULE_EXPORT)&&t.set(i.CommonFlags.MODULE_EXPORT),this.program.elementsByDeclaration.set(r,t),!0}getResolvedInstance(e){var t=this.instances;return null!==t&&t.has(e)?t.get(e):null}setResolvedInstance(e,t){var r=this.instances;r?assert(!r.has(e)):this.instances=r=new Map,r.set(e,t)}lookup(e){return this.parent.lookup(e)}}t.ClassPrototype=M;class G extends S{constructor(e,t,r=null,n=!1){super(n?g.INTERFACE:g.CLASS,e,Y(e,t.parent,t.is(i.CommonFlags.INSTANCE)),t.program,t.parent,t.declaration),this.base=null,this.interfaces=null,this.contextualTypeArguments=null,this.nextMemoryOffset=0,this.constructorInstance=null,this.overloads=null,this.indexSignature=null,this._id=0,this.rttiFlags=0,this.wrappedType=null,this.extendees=null,this.implementers=null,this.didCheckFieldInitialization=!1,this.visitRef=0;var a=this.program;this.prototype=t,this.flags=t.flags,this.decoratorFlags=t.decoratorFlags,this.typeArguments=r;var o=a.options.usizeType,l=new s.Type(o.kind,-129&o.flags|256,o.size);if(l.classReference=this,this.setType(l),!this.hasDecorator(f.UNMANAGED)){let e=a.nextClassId++;this._id=e,a.managedClasses.set(e,this)}var u=t.typeParameterNodes;if(r){let e=r.length;if(!u||e!=u.length)throw new Error("type argument count mismatch");if(e){let t=this.contextualTypeArguments;t||(this.contextualTypeArguments=t=new Map);for(let i=0;i<e;++i)t.set(u[i].name.text,r[i])}}else if(null!==u&&u.length>0)throw new Error("type argument count mismatch");V(a,this)}get id(){return this._id}get isBuiltinArray(){return this.prototype.isBuiltinArray}get isArrayLike(){if(this.isBuiltinArray)return!0;var e=this.lookupInSelf("length");return null!==e&&(e.kind==g.FIELD||e.kind==g.PROPERTY_PROTOTYPE&&null!==e.getterPrototype)&&(null!==this.lookupOverload(T.INDEXED_GET)||null!==this.lookupOverload(T.UNCHECKED_INDEXED_GET))}setBase(e){assert(!this.base),this.base=e;var t=e.extendees;t||(e.extendees=t=new Set),t.add(this);var r=e.contextualTypeArguments;if(r){let e=this.contextualTypeArguments;for(let t=Map_keys(r),i=0,n=t.length;i<n;++i){let n=unchecked(t[i]),s=assert(r.get(n));e?e.has(n)||e.set(n,s):(this.contextualTypeArguments=e=new Map,e.set(n,s))}}}addInterface(e){var t=this.interfaces;t||(this.interfaces=t=new Set),t.add(e);var r=e.implementers;r||(e.implementers=r=new Set),r.add(this)}isAssignableTo(e){var t=this;do{if(t==e)return!0;if(e.kind==g.INTERFACE){let r=t.interfaces;if(r)for(let t=Set_values(r),i=0,n=t.length;i<n;++i){if(t[i].isAssignableTo(e))return!0}}t=t.base}while(t);return!1}lookupOverload(e,t=!1){if(t)switch(e){case T.INDEXED_GET:{let e=this.lookupOverload(T.UNCHECKED_INDEXED_GET);if(e)return e;break}case T.INDEXED_SET:{let e=this.lookupOverload(T.UNCHECKED_INDEXED_SET);if(e)return e;break}default:assert(!1)}var r=this;do{let t=r.overloads;if(null!=t&&t.has(e))return assert(t.get(e));r=r.base}while(r);return null}lookup(e){return this.parent.lookup(e)}getMethod(e,t=null){var r=this.members;if(null!==r&&r.has(e)){let i=changetype(r.get(e));if(i.kind==g.FUNCTION_PROTOTYPE)return this.program.resolver.resolveFunction(i,t)}return null}offsetof(e){var t=assert(this.members);assert(t.has(e));var r=t.get(e);return assert(r.kind==g.FIELD),r.memoryOffset}createBuffer(e=0){var t=this.program,r=this.nextMemoryOffset+e,i=t.computeBlockSize(r,!0),n=new Uint8Array(t.blockOverhead+i),s=t.OBJECTInstance;return s.writeField("mmInfo",i,n,0),s.writeField("gcInfo",0,n,0),s.writeField("gcInfo2",0,n,0),s.writeField("rtId",this.id,n,0),s.writeField("rtSize",r,n,0),n}writeField(e,t,r,i=this.program.totalOverhead){var n=this.lookupInSelf(e);if(null!==n&&n.kind==g.FIELD){let e=n,s=i+e.memoryOffset,a=e.type.kind;switch(a){case 0:case 5:return assert(!i64_is(t)),l.writeI8(i32(t),r,s),1;case 1:case 6:return assert(!i64_is(t)),l.writeI16(i32(t),r,s),2;case 2:case 7:return assert(!i64_is(t)),l.writeI32(i32(t),r,s),4;case 4:case 9:return this.program.options.isWasm64?(i64_is(t)?l.writeI64(t,r,s):l.writeI32AsI64(i32(t),r,s,9==a),8):(i64_is(t)?l.writeI64AsI32(t,r,s,9==a):l.writeI32(i32(t),r,s),4);case 3:case 8:return i64_is(t)?l.writeI64(t,r,s):l.writeI32AsI64(i32(t),r,s,8==a),8;case 11:return assert(!i64_is(t)),l.writeF32(f32(t),r,s),4;case 12:return assert(!i64_is(t)),l.writeF64(f64(t),r,s),8}}return assert(!1),0}extends(e){return this.prototype.extends(e)}getTypeArgumentsTo(e){var t=this;do{if(t.prototype===e)return t.typeArguments;t=t.base}while(t);return null}getArrayValueType(){var e=this,t=this.program,r=t.arrayPrototype;if(this.extends(r))return this.getTypeArgumentsTo(r)[0];var i=t.staticArrayPrototype;if(this.extends(i))return this.getTypeArgumentsTo(i)[0];for(var n=t.arrayBufferViewInstance;e.base!==n;)e=assert(e.base);var a=e.prototype;switch(a.name.charCodeAt(0)){case 70:if(a==t.float32ArrayPrototype)return s.Type.f32;if(a==t.float64ArrayPrototype)return s.Type.f64;break;case 73:if(a==t.int8ArrayPrototype)return s.Type.i8;if(a==t.int16ArrayPrototype)return s.Type.i16;if(a==t.int32ArrayPrototype)return s.Type.i32;if(a==t.int64ArrayPrototype)return s.Type.i64;break;case 85:if(a==t.uint8ArrayPrototype)return s.Type.u8;if(a==t.uint8ClampedArrayPrototype)return s.Type.u8;if(a==t.uint16ArrayPrototype)return s.Type.u16;if(a==t.uint32ArrayPrototype)return s.Type.u32;if(a==t.uint64ArrayPrototype)return s.Type.u64}return assert(!1),s.Type.void}get isPointerfree(){var e=this.program,t=this.members;if(t){for(let e=Map_values(t),r=0,i=e.length;r<i;++r){let t=unchecked(e[r]);if(t.kind==g.FIELD){if(t.type.isManaged)return!1}}if(t.has(i.CommonNames.visit)){let t=this.prototype;if(t==e.arrayPrototype||t==e.staticArrayPrototype||t==e.setPrototype||t==e.mapPrototype){let e=assert(this.getTypeArgumentsTo(t));for(let t=0,r=e.length;t<r;++t)if(e[t].isManaged)return!1;return!0}return!1}}return!0}getAllExtendees(e=null,t=new Set){var r=this.extendees;if(r)for(let i=Set_values(r),n=0,s=i.length;n<s;++n){let r=i[n];if(e){let t=r.prototype.instanceMembers;if(null!==t&&t.has(e))continue}t.add(r),r.getAllExtendees(e,t)}return t}}t.Class=G;class K extends M{constructor(e,t,r,i){super(e,t,r,i,!0)}}t.InterfacePrototype=K;function V(e,t){assert(!e.instancesByName.has(t.internalName)),e.instancesByName.set(t.internalName,t)}function z(e,t){if(assert(e.program===t.program),t.members)return null;var r=null;switch(e.kind){case g.FUNCTION_PROTOTYPE:switch(t.kind){case g.NAMESPACE:W(t,e),r=e;break;case g.TYPEDEFINITION:e.shadowType||(e.shadowType=t,W(t,e),r=e)}break;case g.CLASS_PROTOTYPE:case g.ENUM:if(t.kind==g.NAMESPACE){W(t,e),r=e;break}break;case g.NAMESPACE:switch(t.kind){case g.ENUM:case g.CLASS_PROTOTYPE:case g.FUNCTION_PROTOTYPE:W(e,t),r=t;break;case g.NAMESPACE:W(t,e),r=e;break;case g.TYPEDEFINITION:e.shadowType||(e.shadowType=t,W(t,e),r=e)}break;case g.GLOBAL:t.kind==g.TYPEDEFINITION&&(e.shadowType||(e.shadowType=t,W(t,e),r=e));break;case g.TYPEDEFINITION:switch(t.kind){case g.GLOBAL:case g.FUNCTION_PROTOTYPE:case g.NAMESPACE:t.shadowType||(t.shadowType=e,W(e,t),r=t)}}if(r){(e.is(i.CommonFlags.EXPORT)||e.hasDecorator(f.GLOBAL))!=(t.is(i.CommonFlags.EXPORT)||t.hasDecorator(f.GLOBAL))&&e.program.error(n.DiagnosticCode.Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local,r.identifierNode.range,r.identifierNode.text)}return r}function W(e,t){var r=e.members;if(r){let e=t.members;e||(t.members=e=new Map);for(let t=Map_keys(r),i=0,n=t.length;i<n;++i){let n=unchecked(t[i]),s=assert(r.get(n));e.set(n,s)}}}function Y(e,t,r,n=!1){switch(t.kind){case g.FILE:return n?e:t.internalName+i.PATH_DELIMITER+e;case g.FUNCTION:return n?e:(assert(!r),t.internalName+i.INNER_DELIMITER+e);case g.PROPERTY_PROTOTYPE:case g.PROPERTY:t=t.parent;default:return Y(t.name,t.parent,t.is(i.CommonFlags.INSTANCE),n)+(r?i.INSTANCE_DELIMITER:i.STATIC_DELIMITER)+e}}t.Interface=class extends G{constructor(e,t,r=null){super(e,t,r,!0)}},t.mangleInternalName=Y;var H=[];function X(e){for(let t=H.length;t<=e;++t)H.push("$"+t.toString());return H[e]}t.getDefaultParameterName=X},742:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resolver=t.ReportMode=void 0;const i=r(256),n=r(974),s=r(411),a=r(60),o=r(699),l=r(200),u=r(910),c=r(411),p=r(346);var _;!function(e){e[e.REPORT=0]="REPORT",e[e.SWALLOW=1]="SWALLOW"}(_=t.ReportMode||(t.ReportMode={}));class h extends i.DiagnosticEmitter{constructor(e){super(e.diagnostics),this.currentThisExpression=null,this.currentElementExpression=null,this.resolveClassPending=new Set,this.program=e}resolveType(e,t,r=null,i=_.REPORT){switch(e.kind){case a.NodeKind.NAMEDTYPE:return this.resolveNamedType(e,t,r,i);case a.NodeKind.FUNCTIONTYPE:return this.resolveFunctionType(e,t,r,i);default:assert(!1)}return null}resolveNamedType(e,t,r=null,s=_.REPORT){var a=e.name,c=e.typeArguments,p=!a.next;if(p){let t=a.identifier.text;if(null!==r&&r.has(t)){let n=assert(r.get(t));if(null!==c&&c.length>0&&s==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_not_generic,e.range,n.toString()),e.isNullable){if(n.isInternalReference)return n.asNullable();s==_.REPORT&&this.error(i.DiagnosticCode.Type_0_cannot_be_nullable,e.range,n.toString())}return n}}var h=this.resolveTypeName(a,t,s);if(!h)return null;var d=h.shadowType;if(d)h=d;else{if(h.kind==n.ElementKind.ENUM)return null!==c&&c.length>0&&s==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_not_generic,e.range,h.internalName),e.isNullable&&s==_.REPORT&&this.error(i.DiagnosticCode.Type_0_cannot_be_nullable,e.range,h.name+"/i32"),o.Type.i32;if(h.kind==n.ElementKind.CLASS_PROTOTYPE||h.kind==n.ElementKind.INTERFACE_PROTOTYPE){let i=this.resolveClassInclTypeArguments(h,c,t,u.uniqueMap(r),e,s);return i?e.isNullable?i.type.asNullable():i.type:null}}if(h.kind==n.ElementKind.TYPEDEFINITION){let n=h;if(h.is(l.CommonFlags.RESOLVED)){null!==c&&c.length>0&&s==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_not_generic,e.range,h.internalName);let t=n.type;if(e.isNullable){if(t.isInternalReference)return t.asNullable();s==_.REPORT&&this.error(i.DiagnosticCode.Type_0_cannot_be_nullable,a.range,a.identifier.text)}return t}if(p){let i=a.identifier.text;if(i==l.CommonNames.native)return this.resolveBuiltinNativeType(e,t,r,s);if(i==l.CommonNames.indexof)return this.resolveBuiltinIndexofType(e,t,r,s);if(i==l.CommonNames.valueof)return this.resolveBuiltinValueofType(e,t,r,s);if(i==l.CommonNames.returnof)return this.resolveBuiltinReturnTypeType(e,t,r,s)}let o=n.typeParameterNodes,d=null;if(o){if(d=this.resolveTypeArguments(o,c,t,r=u.uniqueMap(r),e,s),!d)return null}else null!==c&&c.length>0&&this.error(i.DiagnosticCode.Type_0_is_not_generic,e.range,a.identifier.text);let m=this.resolveType(n.typeNode,h,r,s);if(!m)return null;if(e.isNullable){if(m.isInternalReference)return m.asNullable();s==_.REPORT&&this.error(i.DiagnosticCode.Type_0_cannot_be_nullable,a.range,a.identifier.text)}return m}return s==_.REPORT&&this.error(i.DiagnosticCode.Cannot_find_name_0,a.range,a.identifier.text),null}resolveFunctionType(e,t,r=null,n=_.REPORT){var s=e.explicitThisType,l=null;if(s&&!(l=this.resolveType(s,t,r,n)))return null;var u=e.parameters,c=u.length,p=new Array(c),h=0,d=!1;for(let e=0;e<c;++e){let s=u[e];switch(s.parameterKind){case a.ParameterKind.DEFAULT:h=e+1;break;case a.ParameterKind.REST:assert(e==c),d=!0}let o=s.type;if(a.isTypeOmitted(o))return n==_.REPORT&&this.error(i.DiagnosticCode.Type_expected,o.range),null;let l=this.resolveType(o,t,r,n);if(!l)return null;p[e]=l}var m,y=e.returnType;if(a.isTypeOmitted(y))n==_.REPORT&&this.error(i.DiagnosticCode.Type_expected,y.range),m=o.Type.void;else if(!(m=this.resolveType(y,t,r,n)))return null;var T=new o.Signature(this.program,p,m,l);return T.requiredParameters=h,T.hasRest=d,e.isNullable?T.type.asNullable():T.type}resolveBuiltinNativeType(e,t,r=null,n=_.REPORT){var s=e.typeArguments;if(!s||1!=s.length){if(n==_.REPORT){let t=0;s&&(t=s.length),this.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.range,"1",t.toString())}return null}var a=this.resolveType(s[0],t,r,n);if(!a)return null;switch(a.kind){case 0:case 1:case 2:return o.Type.i32;case 4:if(!this.program.options.isWasm64)return o.Type.i32;case 3:return o.Type.i64;case 5:case 6:case 7:case 10:return o.Type.u32;case 9:if(!this.program.options.isWasm64)return o.Type.u32;case 8:return o.Type.u64;case 11:return o.Type.f32;case 12:return o.Type.f64;case 13:return o.Type.v128;case 20:return o.Type.void;default:assert(!1)}return null}resolveBuiltinIndexofType(e,t,r=null,s=_.REPORT){var a=e.typeArguments;if(!a||1!=a.length){if(s==_.REPORT){let t=0;a&&(t=a.length),this.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.range,"1",t.toString())}return null}var o=this.resolveType(a[0],t,r,s);if(!o)return null;var u=o.classReference;if(!u)return s==_.REPORT&&this.error(i.DiagnosticCode.Index_signature_is_missing_in_type_0,a[0].range,o.toString()),null;var c=u.lookupOverload(n.OperatorKind.INDEXED_GET);return c?c.is(l.CommonFlags.STATIC)?(assert(2==c.signature.parameterTypes.length),c.signature.parameterTypes[1]):(assert(1==c.signature.parameterTypes.length),c.signature.parameterTypes[0]):(s==_.REPORT&&this.error(i.DiagnosticCode.Index_signature_is_missing_in_type_0,a[0].range,o.toString()),null)}resolveBuiltinValueofType(e,t,r=null,s=_.REPORT){var a=e.typeArguments;if(!a||1!=a.length){let t=0;return a&&(t=a.length),s==_.REPORT&&this.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.range,"1",t.toString()),null}var o=this.resolveType(a[0],t,r,s);if(!o)return null;var l=o.getClassOrWrapper(this.program);if(l){let e=l.lookupOverload(n.OperatorKind.INDEXED_GET);if(e)return e.signature.returnType}return s==_.REPORT&&this.error(i.DiagnosticCode.Index_signature_is_missing_in_type_0,a[0].range,o.toString()),null}resolveBuiltinReturnTypeType(e,t,r=null,n=_.REPORT){var s=e.typeArguments;if(!s||1!=s.length){if(n==_.REPORT){let t=0;s&&(t=s.length),this.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,e.range,"1",t.toString())}return null}var a=this.resolveType(s[0],t,r,n);if(!a)return null;var o=a.getSignature();return o?o.returnType:(n==_.REPORT&&this.error(i.DiagnosticCode.Type_0_has_no_call_signatures,s[0].range,a.toString()),null)}resolveTypeName(e,t,r=_.REPORT){var n=t.lookup(e.identifier.text);if(!n)return r==_.REPORT&&this.error(i.DiagnosticCode.Cannot_find_name_0,e.range,e.identifier.text),null;for(var s=e,a=e.next;a;){if(!(n=n.lookupInSelf(a.identifier.text)))return r==_.REPORT&&this.error(i.DiagnosticCode.Property_0_does_not_exist_on_type_1,a.range,a.identifier.text,s.identifier.text),null;s=a,a=a.next}return n}resolveTypeArguments(e,t,r,n=u.uniqueMap(),a=null,o=_.REPORT){var l=0,c=0;for(let t=0,r=e.length;t<r;++t)e[t].defaultType||++l,++c;var p=t?t.length:0;if(p<l||p>c)return o==_.REPORT&&this.error(i.DiagnosticCode.Expected_0_type_arguments_but_got_1,p?s.Range.join(t[0].range,t[p-1].range):a.range,(p<l?l:c).toString(),p.toString()),null;var h=new Array(c),d=u.uniqueMap(n);n.clear();for(let i=0;i<c;++i){let s=i<p?this.resolveType(t[i],r,d,o):this.resolveType(assert(e[i].defaultType),r,u.uniqueMap(n),o);if(!s)return null;n.set(e[i].name.text,s),h[i]=s}return h}maybeInferCall(e,t,r,n=_.REPORT){var s=e.typeArguments;if(s)return t.is(l.CommonFlags.GENERIC)?this.resolveFunctionInclTypeArguments(t,s,r.actualFunction,u.uniqueMap(r.contextualTypeArguments),e,n):(n==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_not_generic,e.expression.range,t.internalName),null);if(t.is(l.CommonFlags.GENERIC)){let s=u.uniqueMap(r.contextualTypeArguments),a=assert(t.typeParameterNodes),l=a.length,c=new Set;for(let e=0;e<l;++e){let t=a[e].name.text;s.set(t,o.Type.auto),c.add(t)}let p=t.functionTypeNode.parameters,h=p.length,d=e.args,m=d.length;for(let t=0;t<h;++t){let l=t<m?d[t]:p[t].initializer;if(!l)return n==_.REPORT&&this.error(i.DiagnosticCode.Expected_0_arguments_but_got_1,e.range,h.toString(),m.toString()),null;let u=p[t].type;if(u.hasGenericComponent(a)){let e=this.resolveExpression(l,r,o.Type.auto,_.SWALLOW);e&&this.propagateInferredGenericTypes(u,e,r,s,c)}}let y=new Array(l);for(let t=0;t<l;++t){let l=a[t],u=l.name.text;if(s.has(u)){let e=assert(s.get(u));if(e!=o.Type.auto){y[t]=e;continue}let i=l.defaultType;if(i){let e=this.resolveType(i,r.actualFunction,s,n);if(!e)return null;y[t]=e;continue}}return n==_.REPORT&&this.error(i.DiagnosticCode.Type_argument_expected,e.expression.range.atEnd),null}return this.resolveFunction(t,y,u.uniqueMap(r.contextualTypeArguments),n)}return this.resolveFunction(t,null,u.uniqueMap(),n)}propagateInferredGenericTypes(e,t,r,i,s){if(e.kind==a.NodeKind.NAMEDTYPE){let a=e,l=a.typeArguments;if(null!==l&&l.length>0){let e=t.classReference;if(e){let t=this.resolveTypeName(a.name,r.actualFunction);if(!t||t.kind!=n.ElementKind.CLASS_PROTOTYPE)return;if(e.prototype==t){let t=e.typeArguments;if(null!==t&&t.length==l.length){for(let e=0,n=t.length;e<n;++e)this.propagateInferredGenericTypes(l[e],t[e],r,i,s);return}}}}else{let e=a.name.identifier.text;if(i.has(e)){let r=assert(i.get(e));(r==o.Type.auto||s.has(e)&&r.isAssignableTo(t))&&i.set(e,t)}}}else if(e.kind==a.NodeKind.FUNCTIONTYPE){let n=e,a=n.parameters;if(null!==a&&a.length>0){let e=t.signatureReference;if(e){let t=e.parameterTypes,o=e.thisType;if(t.length==a.length&&!o==!n.explicitThisType){for(let e=0,n=t.length;e<n;++e)this.propagateInferredGenericTypes(a[e].type,t[e],r,i,s);return this.propagateInferredGenericTypes(n.returnType,e.returnType,r,i,s),void(o&&this.propagateInferredGenericTypes(n.explicitThisType,o,r,i,s))}}}}}getTypeOfElement(e){var t=e.kind;if(t==n.ElementKind.GLOBAL&&!this.ensureResolvedLazyGlobal(e,_.SWALLOW))return null;if(n.isTypedElement(t)){let t=e.type;assert(t!=o.Type.void);let r=t.getClassOrWrapper(this.program);if(r){let e=r.wrappedType;e&&(t=e)}return t}return null}getElementOfType(e){let t=e.getClassOrWrapper(this.program);return t||null}lookupExpression(e,t,r=o.Type.auto,i=_.REPORT){for(;e.kind==a.NodeKind.PARENTHESIZED;)e=e.expression;switch(e.kind){case a.NodeKind.ASSERTION:return this.lookupAssertionExpression(e,t,r,i);case a.NodeKind.BINARY:return this.lookupBinaryExpression(e,t,r,i);case a.NodeKind.CALL:return this.lookupCallExpression(e,t,r,i);case a.NodeKind.COMMA:return this.lookupCommaExpression(e,t,r,i);case a.NodeKind.ELEMENTACCESS:return this.lookupElementAccessExpression(e,t,r,i);case a.NodeKind.FUNCTION:return this.lookupFunctionExpression(e,t,r,i);case a.NodeKind.IDENTIFIER:case a.NodeKind.FALSE:case a.NodeKind.NULL:case a.NodeKind.TRUE:return this.lookupIdentifierExpression(e,t,t.actualFunction,i);case a.NodeKind.THIS:return this.lookupThisExpression(e,t,r,i);case a.NodeKind.SUPER:return this.lookupSuperExpression(e,t,r,i);case a.NodeKind.INSTANCEOF:return this.lookupInstanceOfExpression(e,t,r,i);case a.NodeKind.LITERAL:return this.lookupLiteralExpression(e,t,r,i);case a.NodeKind.NEW:return this.lookupNewExpression(e,t,r,i);case a.NodeKind.PROPERTYACCESS:return this.lookupPropertyAccessExpression(e,t,r,i);case a.NodeKind.TERNARY:return this.lookupTernaryExpression(e,t,r,i);case a.NodeKind.UNARYPOSTFIX:return this.lookupUnaryPostfixExpression(e,t,r,i);case a.NodeKind.UNARYPREFIX:return this.lookupUnaryPrefixExpression(e,t,r,i)}return assert(!1),null}resolveExpression(e,t,r=o.Type.auto,i=_.REPORT){for(;e.kind==a.NodeKind.PARENTHESIZED;)e=e.expression;switch(e.kind){case a.NodeKind.ASSERTION:return this.resolveAssertionExpression(e,t,r,i);case a.NodeKind.BINARY:return this.resolveBinaryExpression(e,t,r,i);case a.NodeKind.CALL:return this.resolveCallExpression(e,t,r,i);case a.NodeKind.COMMA:return this.resolveCommaExpression(e,t,r,i);case a.NodeKind.ELEMENTACCESS:return this.resolveElementAccessExpression(e,t,r,i);case a.NodeKind.FUNCTION:return this.resolveFunctionExpression(e,t,r,i);case a.NodeKind.IDENTIFIER:case a.NodeKind.FALSE:case a.NodeKind.NULL:case a.NodeKind.TRUE:return this.resolveIdentifierExpression(e,t,r,t.actualFunction,i);case a.NodeKind.THIS:return this.resolveThisExpression(e,t,r,i);case a.NodeKind.SUPER:return this.resolveSuperExpression(e,t,r,i);case a.NodeKind.INSTANCEOF:return this.resolveInstanceOfExpression(e,t,r,i);case a.NodeKind.LITERAL:return this.resolveLiteralExpression(e,t,r,i);case a.NodeKind.NEW:return this.resolveNewExpression(e,t,r,i);case a.NodeKind.PROPERTYACCESS:return this.resolvePropertyAccessExpression(e,t,r,i);case a.NodeKind.TERNARY:return this.resolveTernaryExpression(e,t,r,i);case a.NodeKind.UNARYPOSTFIX:return this.resolveUnaryPostfixExpression(e,t,r,i);case a.NodeKind.UNARYPREFIX:return this.resolveUnaryPrefixExpression(e,t,r,i)}return assert(!1),null}lookupIdentifierExpression(e,t,r=t.actualFunction,n=_.REPORT){switch(e.kind){case a.NodeKind.TRUE:case a.NodeKind.FALSE:case a.NodeKind.NULL:{let i=this.resolveIdentifierExpression(e,t,o.Type.auto,r,n);return i?this.getElementOfType(i):null}}var s,l=e.text;if(s=t.lookup(l))return this.currentThisExpression=null,this.currentElementExpression=null,s;var u=t.outer;return u&&(s=u.lookup(l))||(s=r.lookup(l))||(s=this.program.lookup(l))?(this.currentThisExpression=null,this.currentElementExpression=null,s):(n==_.REPORT&&this.error(i.DiagnosticCode.Cannot_find_name_0,e.range,l),null)}resolveIdentifierExpression(e,t,r=o.Type.auto,s=t.actualFunction,l=_.REPORT){switch(e.kind){case a.NodeKind.TRUE:case a.NodeKind.FALSE:return o.Type.bool;case a.NodeKind.NULL:{let e=r.getClass();if(e)return e.type.asNullable();{let e=r.getSignature();if(e)return e.type.asNullable();if(r.isExternalReference)return r}return this.program.options.usizeType}}var c=this.lookupIdentifierExpression(e,t,s,l);if(!c)return null;if(c.kind==n.ElementKind.FUNCTION_PROTOTYPE){let e=this.resolveFunction(c,null,u.uniqueMap(),l);if(!e)return null;c=e}var p=this.getTypeOfElement(c);return p||l==_.REPORT&&this.error(i.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),p}ensureResolvedLazyGlobal(e,t=_.REPORT){if(e.is(l.CommonFlags.RESOLVED))return!0;var r,i=e.typeNode;return!!(r=i?this.resolveType(i,e.parent,null,t):this.resolveExpression(assert(e.initializerNode),e.file.startFunction.flow,o.Type.auto,t))&&(e.setType(r),!0)}lookupPropertyAccessExpression(e,t,r,s=_.REPORT){var a=e.expression,c=this.lookupExpression(a,t,r,s);if(!c)return null;var p=e.property.text;switch(c.kind){case n.ElementKind.GLOBAL:if(!this.ensureResolvedLazyGlobal(c,s))return null;case n.ElementKind.ENUMVALUE:case n.ElementKind.LOCAL:case n.ElementKind.FIELD:{let t=c,r=t.type;assert(r!=o.Type.void);let n=r.getClassOrWrapper(this.program);if(!n)return s==_.REPORT&&this.error(i.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.property.range,p,t.type.toString()),null;c=n;break}case n.ElementKind.PROPERTY_PROTOTYPE:{let e=this.resolveProperty(c,s);if(!e)return null;c=e}case n.ElementKind.PROPERTY:{let t=assert(c.getterInstance).signature.returnType,r=t.getClassOrWrapper(this.program);if(!r)return s==_.REPORT&&this.error(i.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.property.range,p,t.toString()),null;c=r;break}case n.ElementKind.INDEXSIGNATURE:{let t=c.parent;assert(t.kind==n.ElementKind.CLASS);let r=t,a=assert(this.currentElementExpression),o=r.lookupOverload(n.OperatorKind.INDEXED_GET);if(!o)return s==_.REPORT&&this.error(i.DiagnosticCode.Index_signature_is_missing_in_type_0,a.range,t.internalName),null;let l=o.signature.returnType,u=l.getClassOrWrapper(this.program);if(!u)return s==_.REPORT&&this.error(i.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.property.range,p,l.toString()),null;c=u;break}case n.ElementKind.FUNCTION_PROTOTYPE:{let e=c.shadowType;if(e){if(!e.is(l.CommonFlags.RESOLVED)){let t=this.resolveType(e.typeNode,e.parent,null,s);t&&e.setType(t)}let t=e.type.classReference;t&&(c=t.prototype);break}if(!c.is(l.CommonFlags.GENERIC)){let e=c.members;if(!e||!e.has(p)){let e=this.resolveFunction(c,null,u.uniqueMap(),_.SWALLOW);if(e){let t=e.type.getClassOrWrapper(this.program);t&&(c=t)}}}break}}switch(c.kind){case n.ElementKind.CLASS_PROTOTYPE:case n.ElementKind.INTERFACE_PROTOTYPE:case n.ElementKind.CLASS:case n.ElementKind.INTERFACE:for(;;){let e=c.members;if(null!==e&&e.has(p)){let t=assert(e.get(p));if(t.kind==n.ElementKind.PROPERTY_PROTOTYPE){let e=this.resolveProperty(t,s);if(!e)return null;t=e,e.is(l.CommonFlags.STATIC)?this.currentThisExpression=null:this.currentThisExpression=a}else this.currentThisExpression=a;return this.currentElementExpression=null,t}if(c.kind==n.ElementKind.CLASS_PROTOTYPE||c.kind==n.ElementKind.INTERFACE_PROTOTYPE){let e=c.basePrototype;if(!e)break;c=e}else{if(c.kind!=n.ElementKind.CLASS&&c.kind!=n.ElementKind.INTERFACE)break;{let e=c.base;if(!e)break;c=e}}}break;default:{let e=c.members;if(null!==e&&e.has(p))return this.currentThisExpression=a,this.currentElementExpression=null,assert(e.get(p));break}}return s==_.REPORT&&this.error(i.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.property.range,p,c.internalName),null}resolvePropertyAccessExpression(e,t,r,n=_.REPORT){var s=this.lookupPropertyAccessExpression(e,t,r,n);if(!s)return null;var a=this.getTypeOfElement(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),a}lookupElementAccessExpression(e,t,r,n=_.REPORT){var s=e.expression,a=this.resolveExpression(s,t,r,n);if(!a)return null;let o=a.getClassOrWrapper(this.program);if(o)do{let t=o.indexSignature;if(t)return this.currentThisExpression=s,this.currentElementExpression=e.elementExpression,t;o=o.base}while(o);return n==_.REPORT&&this.error(i.DiagnosticCode.Index_signature_is_missing_in_type_0,s.range,a.toString()),null}resolveElementAccessExpression(e,t,r,n=_.REPORT){var s=this.lookupElementAccessExpression(e,t,r,n);if(!s)return null;var a=this.getTypeOfElement(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),a}determineIntegerLiteralType(e,t){if(t.isValue)switch(t.kind){case 0:if(i64_is_i8(e))return o.Type.i8;break;case 5:if(i64_is_u8(e))return o.Type.u8;break;case 1:if(i64_is_i16(e))return o.Type.i16;break;case 6:if(i64_is_u16(e))return o.Type.u16;break;case 2:if(i64_is_i32(e))return o.Type.i32;break;case 7:if(i64_is_u32(e))return o.Type.u32;break;case 10:if(i64_is_bool(e))return o.Type.bool;break;case 4:if(!this.program.options.isWasm64){if(i64_is_i32(e))return o.Type.isize32;break}return o.Type.isize64;case 9:if(!this.program.options.isWasm64){if(i64_is_u32(e))return o.Type.usize32;break}return o.Type.usize64;case 3:return o.Type.i64;case 8:return o.Type.u64;case 11:return o.Type.f32;case 12:return o.Type.f64}return i64_is_i32(e)?o.Type.i32:i64_is_u32(e)?o.Type.u32:o.Type.i64}lookupAssertionExpression(e,t,r=o.Type.auto,n=_.REPORT){switch(e.assertionKind){case a.AssertionKind.AS:case a.AssertionKind.PREFIX:{let r=this.resolveType(assert(e.toType),t.actualFunction,t.contextualTypeArguments,n);if(!r)return null;let s=this.getElementOfType(r);return s||(n==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_illegal_in_this_context,e.range,r.toString()),this.currentThisExpression=null,this.currentElementExpression=null,null)}case a.AssertionKind.NONNULL:return this.lookupExpression(e.expression,t,r,n);case a.AssertionKind.CONST:return this.error(i.DiagnosticCode.Not_implemented_0,e.range,"Const assertion"),null}return assert(!1),null}resolveAssertionExpression(e,t,r=o.Type.auto,n=_.REPORT){switch(e.assertionKind){case a.AssertionKind.AS:case a.AssertionKind.PREFIX:return this.resolveType(assert(e.toType),t.actualFunction,t.contextualTypeArguments,n);case a.AssertionKind.NONNULL:{let i=this.resolveExpression(e.expression,t,r,n);return i?i.nonNullableType:null}case a.AssertionKind.CONST:{let s=this.lookupExpression(e,t,r,n);if(!s)return null;let a=this.getTypeOfElement(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),a}default:assert(!1)}return null}lookupUnaryPrefixExpression(e,t,r=o.Type.auto,n=_.REPORT){var s=this.resolveUnaryPrefixExpression(e,t,r,n);if(!s)return null;var a=this.getElementOfType(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,c.operatorTokenToString(e.operator),s.toString()),a}resolveUnaryPrefixExpression(e,t,r=o.Type.auto,s=_.REPORT){var l=e.operand,u=e.operator;switch(u){case c.Token.MINUS:if(l.isLiteralKind(a.LiteralKind.INTEGER))return this.determineIntegerLiteralType(i64_sub(i64_zero,l.value),r);case c.Token.PLUS:case c.Token.PLUS_PLUS:case c.Token.MINUS_MINUS:{let a=this.resolveExpression(l,t,r,s);if(!a)return null;let o=a.getClassOrWrapper(this.program);if(o){let e=o.lookupOverload(n.OperatorKind.fromUnaryPrefixToken(u));if(e)return e.signature.returnType}return a.isNumericValue?a:(s==_.REPORT&&this.error(i.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,c.operatorTokenToString(u),a.toString()),null)}case c.Token.EXCLAMATION:{let e=this.resolveExpression(l,t,r,s);if(!e)return null;let i=e.getClassOrWrapper(this.program);if(i){let e=i.lookupOverload(n.OperatorKind.NOT);if(e)return e.signature.returnType}return o.Type.bool}case c.Token.TILDE:{let a=this.resolveExpression(l,t,r,s);if(!a)return null;let o=a.getClassOrWrapper(this.program);if(o){let e=o.lookupOverload(n.OperatorKind.BITWISE_NOT);if(e)return e.signature.returnType}return a.isNumericValue?a.intType:(s==_.REPORT&&this.error(i.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,"~",a.toString()),null)}default:assert(!1)}return null}lookupUnaryPostfixExpression(e,t,r=o.Type.auto,n=_.REPORT){var s=this.resolveUnaryPostfixExpression(e,t,r,n);if(!s)return null;var a=this.getElementOfType(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,c.operatorTokenToString(e.operator),s.toString()),a}resolveUnaryPostfixExpression(e,t,r=o.Type.auto,s=_.REPORT){var a=e.operator;switch(a){case c.Token.PLUS_PLUS:case c.Token.MINUS_MINUS:{let o=this.resolveExpression(e.operand,t,r,s);if(!o)return null;let l=o.getClassOrWrapper(this.program);if(l){let e=l.lookupOverload(n.OperatorKind.fromUnaryPostfixToken(a));if(e)return e.signature.returnType}return o.isNumericValue?o:(s==_.REPORT&&this.error(i.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,c.operatorTokenToString(a),o.toString()),null)}}return assert(!1),null}lookupBinaryExpression(e,t,r=o.Type.auto,n=_.REPORT){var s=this.resolveBinaryExpression(e,t,r,n);if(!s)return null;var a=this.getElementOfType(s);return a||(n==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_illegal_in_this_context,e.range,s.toString()),null)}resolveBinaryExpression(e,t,r=o.Type.auto,s=_.REPORT){var a=e.left,l=e.right,u=e.operator;switch(u){case c.Token.EQUALS:case c.Token.PLUS_EQUALS:case c.Token.MINUS_EQUALS:case c.Token.ASTERISK_EQUALS:case c.Token.ASTERISK_ASTERISK_EQUALS:case c.Token.SLASH_EQUALS:case c.Token.PERCENT_EQUALS:case c.Token.LESSTHAN_LESSTHAN_EQUALS:case c.Token.GREATERTHAN_GREATERTHAN_EQUALS:case c.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:case c.Token.AMPERSAND_EQUALS:case c.Token.BAR_EQUALS:case c.Token.CARET_EQUALS:return this.resolveExpression(a,t,r,s);case c.Token.LESSTHAN:case c.Token.GREATERTHAN:case c.Token.LESSTHAN_EQUALS:case c.Token.GREATERTHAN_EQUALS:{let l=this.resolveExpression(a,t,r,s);if(!l)return null;let p=l.getClassOrWrapper(this.program);if(p){let e=p.lookupOverload(n.OperatorKind.fromBinaryToken(u));if(e)return e.signature.returnType}return l.isNumericValue?o.Type.bool:(s==_.REPORT&&this.error(i.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,c.operatorTokenToString(u),l.toString()),null)}case c.Token.EQUALS_EQUALS:case c.Token.EXCLAMATION_EQUALS:{let e=this.resolveExpression(a,t,r,s);if(!e)return null;let i=e.getClassOrWrapper(this.program);if(i){let e=i.lookupOverload(n.OperatorKind.fromBinaryToken(u));if(e)return e.signature.returnType}return o.Type.bool}case c.Token.EQUALS_EQUALS_EQUALS:case c.Token.EXCLAMATION_EQUALS_EQUALS:return o.Type.bool;case c.Token.PLUS:case c.Token.MINUS:case c.Token.ASTERISK:case c.Token.SLASH:case c.Token.PERCENT:{let c=this.resolveExpression(a,t,r,s);if(!c)return null;let p=c.getClassOrWrapper(this.program);if(p){let e=p.lookupOverload(n.OperatorKind.fromBinaryToken(u));if(e)return e.signature.returnType}let h=this.resolveExpression(l,t,c,s);if(!h)return null;let d=o.Type.commonDenominator(c,h,!1);return d||s==_.REPORT&&this.error(i.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,c.toString(),h.toString()),d}case c.Token.ASTERISK_ASTERISK:{let c=this.resolveExpression(a,t,r,s);if(!c)return null;let p=c.getClassOrWrapper(this.program);if(p){let e=p.lookupOverload(n.OperatorKind.fromBinaryToken(u));if(e)return e.signature.returnType}let h=this.resolveExpression(l,t,c,s);if(!h)return null;let d=o.Type.commonDenominator(c,h,!1);return d||s==_.REPORT&&this.error(i.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,c.toString(),h.toString()),d}case c.Token.LESSTHAN_LESSTHAN:case c.Token.GREATERTHAN_GREATERTHAN:case c.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:{let o=this.resolveExpression(a,t,r,s);if(!o)return null;let l=o.getClassOrWrapper(this.program);if(l){let e=l.lookupOverload(n.OperatorKind.fromBinaryToken(u));if(e)return e.signature.returnType}return o.isIntegerValue?o:(s==_.REPORT&&this.error(i.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,c.operatorTokenToString(u),o.toString()),null)}case c.Token.AMPERSAND:case c.Token.BAR:case c.Token.CARET:{let p=this.resolveExpression(a,t,r,s);if(!p)return null;let h=p.getClassOrWrapper(this.program);if(h){let e=h.lookupOverload(n.OperatorKind.fromBinaryToken(u));if(e)return e.signature.returnType}let d=this.resolveExpression(l,t,r,s);if(!d)return null;let m=o.Type.commonDenominator(p,d,!1);return m&&m.isIntegerValue||s==_.REPORT&&this.error(i.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,c.operatorTokenToString(u),p.toString(),d.toString()),m}case c.Token.AMPERSAND_AMPERSAND:case c.Token.BAR_BAR:return this.resolveExpression(a,t,r,s)}return assert(!1),null}lookupThisExpression(e,t,r=o.Type.auto,n=_.REPORT){if(t.isInline){let e=t.lookupLocal(l.CommonNames.this_);if(e)return this.currentThisExpression=null,this.currentElementExpression=null,e}var s=t.actualFunction.parent;return s?(this.currentThisExpression=null,this.currentElementExpression=null,s):(n==_.REPORT&&this.error(i.DiagnosticCode._this_cannot_be_referenced_in_current_location,e.range),null)}resolveThisExpression(e,t,r=o.Type.auto,n=_.REPORT){var s=this.lookupThisExpression(e,t,r,n);if(!s)return null;var a=this.getTypeOfElement(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),a}lookupSuperExpression(e,t,r=o.Type.auto,s=_.REPORT){if(t.isInline){let e=t.lookupLocal(l.CommonNames.super_);if(e)return this.currentThisExpression=null,this.currentElementExpression=null,e}var a=t.actualFunction.parent;if(null!==a&&a.kind==n.ElementKind.CLASS){let e=a.base;if(e)return this.currentThisExpression=null,this.currentElementExpression=null,e}return s==_.REPORT&&this.error(i.DiagnosticCode._super_can_only_be_referenced_in_a_derived_class,e.range),null}resolveSuperExpression(e,t,r=o.Type.auto,n=_.REPORT){var s=this.lookupSuperExpression(e,t,r,n);if(!s)return null;var a=this.getTypeOfElement(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),a}lookupLiteralExpression(e,t,r=o.Type.auto,n=_.REPORT){switch(this.currentThisExpression=e,this.currentElementExpression=null,e.literalKind){case a.LiteralKind.INTEGER:{let t=this.determineIntegerLiteralType(e.value,r);return assert(t.getClassOrWrapper(this.program))}case a.LiteralKind.FLOAT:{let e=r==o.Type.f32?o.Type.f32:o.Type.f64;return assert(e.getClassOrWrapper(this.program))}case a.LiteralKind.STRING:case a.LiteralKind.TEMPLATE:return this.program.stringInstance;case a.LiteralKind.ARRAY:{let s=r.getClass();if(null!==s&&s.prototype==this.program.arrayPrototype)return this.getElementOfType(r);let l=e.elementExpressions,u=l.length,c=o.Type.auto,p=0;for(let e=0,r=u;e<r;++e){let r=l[e];if(r)if(r.kind==a.NodeKind.NULL&&u>1)++p;else{let e=this.resolveExpression(r,t,c);if(!e)return null;if(c==o.Type.auto)c=e;else if(e!=c){let t=o.Type.commonDenominator(c,e,!1);t&&(c=t)}}}if(c==o.Type.auto){if(p!=u)return n==_.REPORT&&this.error(i.DiagnosticCode.The_type_argument_for_type_parameter_0_cannot_be_inferred_from_the_usage_Consider_specifying_the_type_arguments_explicitly,e.range,"T"),null;c=this.program.options.usizeType}return p>0&&c.isInternalReference&&(c=c.asNullable()),assert(this.resolveClass(this.program.arrayPrototype,[c]))}case a.LiteralKind.OBJECT:return r.isClass?r.classReference:(n==_.REPORT&&this.error(i.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),null)}return assert(!1),null}resolveLiteralExpression(e,t,r=o.Type.auto,n=_.REPORT){var s=this.lookupLiteralExpression(e,t,r,n);if(!s)return null;var a=this.getTypeOfElement(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),a}lookupCallExpression(e,t,r=o.Type.void,n=_.REPORT){var s=this.resolveCallExpression(e,t,r,n);if(!s)return null;var a=this.getElementOfType(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_illegal_in_this_context,e.range,s.toString()),a}resolveCallExpression(e,t,r=o.Type.void,s=_.REPORT){var a=e.expression,l=this.lookupExpression(a,t,r,s);if(!l)return null;switch(l.kind){case n.ElementKind.FUNCTION_PROTOTYPE:{let i=l;if(i.internalName==p.BuiltinNames.unchecked&&e.args.length>0)return this.resolveExpression(e.args[0],t,r,s);let n=this.maybeInferCall(e,i,t,s);return n?n.signature.returnType:null}case n.ElementKind.GLOBAL:case n.ElementKind.LOCAL:case n.ElementKind.FIELD:{let e=l.type,t=this.getElementOfType(e);if(!t||t.kind!=n.ElementKind.CLASS)break;l=t}case n.ElementKind.CLASS:{let e=l.getTypeArgumentsTo(this.program.functionPrototype);if(null!==e&&e.length>0){let t=e[0];return assert(t.signatureReference).returnType}break}}return s==_.REPORT&&this.error(i.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,a.range,l.internalName),null}lookupCommaExpression(e,t,r=o.Type.auto,i=_.REPORT){var n=e.expressions;return this.lookupExpression(n[assert(n.length)-1],t,r,i)}resolveCommaExpression(e,t,r=o.Type.auto,i=_.REPORT){var n=e.expressions;return this.resolveExpression(n[assert(n.length)-1],t,r,i)}lookupInstanceOfExpression(e,t,r=o.Type.auto,i=_.REPORT){return assert(o.Type.bool.getClassOrWrapper(this.program))}resolveInstanceOfExpression(e,t,r=o.Type.auto,i=_.REPORT){return o.Type.bool}lookupTernaryExpression(e,t,r,n=_.REPORT){var s=this.resolveTernaryExpression(e,t,r,n);if(!s)return null;var a=this.getElementOfType(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_illegal_in_this_context,e.range,s.toString()),a}resolveTernaryExpression(e,t,r,n=_.REPORT){var s=this.resolveExpression(e.ifThen,t,r,n);if(!s)return null;var a=this.resolveExpression(e.ifElse,t,s,n);if(!a)return null;var l=o.Type.commonDenominator(s,a,!1);return l||n==_.REPORT&&this.error(i.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"?:",s.toString(),a.toString()),l}lookupNewExpression(e,t,r,s=_.REPORT){var a=this.resolveTypeName(e.typeName,t.actualFunction,s);return a?a.kind==n.ElementKind.CLASS_PROTOTYPE?this.resolveClassInclTypeArguments(a,e.typeArguments,t.actualFunction,u.uniqueMap(t.contextualTypeArguments),e,s):(s==_.REPORT&&this.error(i.DiagnosticCode.This_expression_is_not_constructable,e.range),null):null}resolveNewExpression(e,t,r,n=_.REPORT){var s=this.lookupNewExpression(e,t,r,n);if(!s)return null;var a=this.getTypeOfElement(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Expression_cannot_be_represented_by_a_type,e.range),a}lookupFunctionExpression(e,t,r,n=_.REPORT){var s=this.resolveFunctionExpression(e,t,r,n);if(!s)return null;var a=this.getElementOfType(s);return a||n==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_illegal_in_this_context,e.range,s.toString()),a}resolveFunctionExpression(e,t,r,i=_.REPORT){return this.resolveFunctionType(e.declaration.signature,t.actualFunction,t.contextualTypeArguments,i)}resolveFunction(e,t,r=u.uniqueMap(),s=_.REPORT){var c=e.parent.kind==n.ElementKind.PROPERTY_PROTOTYPE?e.parent.parent:e.parent,p=null,h=t?o.typesToString(t):"";if(e.is(l.CommonFlags.INSTANCE)){assert(c.kind==n.ElementKind.CLASS||c.kind==n.ElementKind.INTERFACE),p=c;let t=e.getResolvedInstance(h);if(t)return t;let i=p.typeArguments;if(i){let e=assert(p.prototype.typeParameterNodes),t=e.length;assert(t==e.length);for(let n=0;n<t;++n){let t=e[n].name.text;r.has(t)||r.set(t,i[n])}}}else{assert(c.kind!=n.ElementKind.CLASS);let t=e.getResolvedInstance(h);if(t)return t}var d,m=e.functionTypeNode,y=e.typeParameterNodes;if(null!==t&&(d=t.length)>0){assert(null!==y&&d==y.length);for(let e=0;e<d;++e)r.set(y[e].name.text,t[e])}else assert(!y||0==y.length);var T=null,g=m.explicitThisType;if(g){if(!(T=this.resolveType(g,e.parent,r,s)))return null;r.set(l.CommonNames.this_,T)}else p&&(T=p.type,r.set(l.CommonNames.this_,T));var f,E=m.parameters,b=E.length,x=new Array(b),I=0;for(let t=0;t<b;++t){let n=E[t];n.parameterKind==a.ParameterKind.DEFAULT&&(I=t+1);let l=n.type;if(a.isTypeOmitted(l))return s==_.REPORT&&this.error(i.DiagnosticCode.Type_expected,l.range),null;let u=this.resolveType(l,e.parent,r,s);if(!u)return null;if(u==o.Type.void)return s==_.REPORT&&this.error(i.DiagnosticCode.Type_expected,l.range),null;x[t]=u}if(e.is(l.CommonFlags.SET))f=o.Type.void;else if(e.is(l.CommonFlags.CONSTRUCTOR))f=p.type;else{let t=m.returnType;if(a.isTypeOmitted(t))return s==_.REPORT&&this.error(i.DiagnosticCode.Type_expected,t.range),null;let n=this.resolveType(t,e.parent,r,s);if(!n)return null;f=n}var A=new o.Signature(this.program,x,f,T);A.requiredParameters=I;var N=e.name;h.length&&(N+="<"+h+">");var S=new n.Function(N,e,t,A,r);return e.setResolvedInstance(h,S),S}resolveFunctionInclTypeArguments(e,t,r,s,a,o=_.REPORT){var u=e.parent.kind==n.ElementKind.PROPERTY_PROTOTYPE?e.parent.parent:e.parent,c=null;if(e.is(l.CommonFlags.GENERIC)){if(e.is(l.CommonFlags.INSTANCE)){assert(u.kind==n.ElementKind.CLASS);let e=u,t=e.typeArguments;if(t){let r=assert(e.prototype.typeParameterNodes),i=t.length;assert(i==r.length);for(let e=0;e<i;++e)s.set(r[e].name.text,t[e])}}if(!(c=this.resolveTypeArguments(assert(e.typeParameterNodes),t,r,s,a,o)))return null}else if(null!==t&&t.length>0)return o==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_not_generic,a.range,e.internalName),null;return this.resolveFunction(e,c,s,o)}resolveClass(e,t,r=u.uniqueMap(),s=_.REPORT){var a=t?o.typesToString(t):"",l=e.getResolvedInstance(a);if(l)return l;var c=e.name;a.length&&(c+="<"+a+">"),l=e.kind==n.ElementKind.INTERFACE_PROTOTYPE?new n.Interface(c,e,t):new n.Class(c,e,t),e.setResolvedInstance(a,l);var p=this.resolveClassPending;if(p.add(l),t){let i=assert(e.typeParameterNodes),n=i.length,s=t.length;assert(s==n);for(let e=0;e<s;++e)r.set(i[e].name.text,t[e])}else{let t=e.typeParameterNodes;assert(!(null!==t&&t.length>0))}l.contextualTypeArguments=r;var h=!1,d=e.basePrototype;if(d){let t=d;do{if(t==e)return this.error(i.DiagnosticCode._0_is_referenced_directly_or_indirectly_in_its_own_base_expression,e.identifierNode.range,e.internalName),null;t=t.basePrototype}while(t);let n=assert(e.extendsNode),a=this.resolveClassInclTypeArguments(d,n.typeArguments,e.parent,u.uniqueMap(r),n,s);if(!a)return null;l.setBase(a),p.has(a)&&(h=!0)}var m=e.interfacePrototypes;if(m)for(let t=0,a=m.length;t<a;++t){let a=m[t],o=a;do{if(o==e)return this.error(i.DiagnosticCode._0_is_referenced_directly_or_indirectly_in_its_own_base_expression,e.identifierNode.range,e.internalName),null;o=o.basePrototype}while(o);let c=assert(e.implementsNodes[t]),_=this.resolveClassInclTypeArguments(a,c.typeArguments,e.parent,u.uniqueMap(r),c,s);if(!_)return null;assert(_.kind==n.ElementKind.INTERFACE),l.addInterface(_),p.has(_)&&(h=!0)}return h||this.finishResolveClass(l,s),l}finishResolveClass(e,t){var r=e.members;r||(e.members=r=new Map);var s=this.resolveClassPending,a=new Map,c=e.interfaces;if(c)for(let e=Set_values(c),t=0,n=e.length;t<n;++t){let n=e[t];assert(!s.has(n));let o=n.members;if(o)for(let e=Map_keys(o),t=0,n=e.length;t<n;++t){let n=unchecked(e[t]),s=assert(o.get(n));if(r.has(n)){let e=assert(r.get(n));if(!s.isCompatibleOverride(e)){this.errorRelated(i.DiagnosticCode.This_overload_signature_is_not_compatible_with_its_implementation_signature,s.identifierAndSignatureRange,e.identifierAndSignatureRange);continue}}r.set(n,s),a.set(n,s)}}var p=0,h=e.base;if(h){assert(!s.has(h));let e=h.members;if(e)for(let t=Map_keys(e),n=0,s=t.length;n<s;++n){let s=unchecked(t[n]),o=assert(e.get(s));if(r.has(s)){let e=assert(r.get(s));if(!o.isCompatibleOverride(e)){this.errorRelated(i.DiagnosticCode.This_overload_signature_is_not_compatible_with_its_implementation_signature,o.identifierAndSignatureRange,e.identifierAndSignatureRange);continue}}r.set(s,o),o.is(l.CommonFlags.ABSTRACT)?a.set(s,o):a.delete(s)}p=h.nextMemoryOffset}var d=e.prototype,m=d.instanceMembers,y=new Array;if(m)for(let r=Map_values(m),s=0,c=r.length;s<c;++s){let c=unchecked(r[s]),m=c.name;switch(c.kind){case n.ElementKind.FIELD_PROTOTYPE:{let r=c,s=r.typeNode,a=null;if(s){if(a=this.resolveType(s,d.parent,e.contextualTypeArguments,t),a==o.Type.void){t==_.REPORT&&this.error(i.DiagnosticCode.Type_expected,s.range);break}}else{if(h){let e=h.members;if(null!==e&&e.has(r.name)){let t=assert(e.get(r.name));t.is(l.CommonFlags.PRIVATE)||(assert(t.kind==n.ElementKind.FIELD),a=t.type)}}a||t==_.REPORT&&this.error(i.DiagnosticCode.Type_expected,r.identifierNode.range.atEnd)}if(!a)break;let y=new n.Field(r,e,a);assert(u.isPowerOf2(a.byteSize));let T=a.byteSize-1;p&T&&(p=1+(p|T)),y.memoryOffset=p,p+=a.byteSize,e.add(m,y);break}case n.ElementKind.FUNCTION_PROTOTYPE:{let t=c.toBound(e);e.add(t.name,t);break}case n.ElementKind.PROPERTY_PROTOTYPE:{let t=c.toBound(e);e.add(t.name,t);break}default:assert(!1)}c.is(l.CommonFlags.ABSTRACT)||a.delete(m)}for(let e=0,t=y.length;e<t;++e){let t=y[e],r=t.getterInstance;if(r){let e=t.setterInstance;null===e||r.visibilityEquals(e)||this.errorRelated(i.DiagnosticCode.Getter_and_setter_accessors_do_not_agree_in_visibility,r.identifierNode.range,e.identifierNode.range)}else this.error(i.DiagnosticCode.Property_0_only_has_a_setter_and_is_missing_a_getter,t.identifierNode.range,t.name)}if(e.kind!=n.ElementKind.INTERFACE){if(!e.is(l.CommonFlags.ABSTRACT)&&a.size>0)for(let t=Map_keys(a),r=0,n=t.length;r<n;++r){let n=t[r],s=assert(a.get(n));this.errorRelated(i.DiagnosticCode.Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_2,e.identifierNode.range,s.identifierNode.range,e.internalName,n,s.parent.internalName)}e.nextMemoryOffset=p;{let r=e.lookupInSelf(l.CommonNames.constructor);if(null!==r&&r.parent===e){assert(r.kind==n.ElementKind.FUNCTION_PROTOTYPE);let i=this.resolveFunction(r,null,assert(e.contextualTypeArguments),t);i&&(e.constructorInstance=i)}}}var T=d.overloadPrototypes;for(let r=Map_keys(T),s=0,a=r.length;s<a;++s){let a,o=unchecked(r[s]),c=assert(T.get(o));if(assert(o!=n.OperatorKind.INVALID),c.is(l.CommonFlags.INSTANCE)){let r=c.toBound(e);a=this.resolveFunction(r,null,u.uniqueMap(),t)}else a=this.resolveFunction(c,null,u.uniqueMap(),t);if(!a)continue;let p=e.overloads;if(p||(e.overloads=p=new Map),a.is(l.CommonFlags.INSTANCE))switch(o){case n.OperatorKind.PREFIX_INC:case n.OperatorKind.PREFIX_DEC:case n.OperatorKind.POSTFIX_INC:case n.OperatorKind.POSTFIX_DEC:{let r=a.signature.returnType;r.isAssignableTo(e.type)||t==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_not_assignable_to_type_1,c.functionTypeNode.returnType.range,r.toString(),e.type.toString())}}if(p.has(o))t==_.REPORT&&this.error(i.DiagnosticCode.Duplicate_decorator,a.declaration.range);else if(p.set(o,a),o==n.OperatorKind.INDEXED_GET||o==n.OperatorKind.INDEXED_SET){let t=e.indexSignature;t||(e.indexSignature=t=new n.IndexSignature(e)),o==n.OperatorKind.INDEXED_GET&&t.setType(a.signature.returnType)}}assert(s.has(e)),s.delete(e);for(let r=Set_values(s),i=0,n=r.length;i<n;++i){let n=r[i],a=n.base===e,o=n.interfaces;if(o){let t=!1;for(let r=Set_values(o),i=0,n=r.length;i<n;++i){let n=r[i];n===e?a=!0:s.has(n)&&(t=!0)}if(t)continue}a&&this.finishResolveClass(n,t)}}resolveClassInclTypeArguments(e,t,r,n,s,a=_.REPORT){var o=null;if(e.is(l.CommonFlags.GENERIC)){if(!(o=this.resolveTypeArguments(assert(e.typeParameterNodes),t,r,n,s,a)))return null}else if(null!==t&&t.length>0)return a==_.REPORT&&this.error(i.DiagnosticCode.Type_0_is_not_generic,s.range,e.internalName),null;return this.resolveClass(e,o,n,a)}resolveProperty(e,t=_.REPORT){var r=e.instance;if(r)return r;e.instance=r=new n.Property(e,e);var i=e.getterPrototype;if(i){let e=this.resolveFunction(i,null,u.uniqueMap(),t);e&&(r.getterInstance=e,r.setType(e.signature.returnType))}var s=e.setterPrototype;if(s){let e=this.resolveFunction(s,null,u.uniqueMap(),t);e&&(r.setterInstance=e,r.is(l.CommonFlags.RESOLVED)||(assert(1==e.signature.parameterTypes.length),r.setType(e.signature.parameterTypes[0])))}return r}}t.Resolver=h},411:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.State=t.Tokenizer=t.Range=t.operatorTokenToString=t.isIllegalVariableIdentifier=t.tokenIsAlsoIdentifier=t.tokenFromKeyword=t.IdentifierHandling=t.Token=void 0;const i=r(256),n=r(60),s=r(910);var a,o;function l(e){switch(assert(e.length),e.charCodeAt(0)){case 97:if("abstract"==e)return a.ABSTRACT;if("as"==e)return a.AS;if("async"==e)return a.ASYNC;if("await"==e)return a.AWAIT;break;case 98:if("break"==e)return a.BREAK;break;case 99:if("case"==e)return a.CASE;if("catch"==e)return a.CATCH;if("class"==e)return a.CLASS;if("continue"==e)return a.CONTINUE;if("const"==e)return a.CONST;if("constructor"==e)return a.CONSTRUCTOR;break;case 100:if("debugger"==e)return a.DEBUGGER;if("declare"==e)return a.DECLARE;if("default"==e)return a.DEFAULT;if("delete"==e)return a.DELETE;if("do"==e)return a.DO;break;case 101:if("else"==e)return a.ELSE;if("enum"==e)return a.ENUM;if("export"==e)return a.EXPORT;if("extends"==e)return a.EXTENDS;break;case 102:if("false"==e)return a.FALSE;if("finally"==e)return a.FINALLY;if("for"==e)return a.FOR;if("from"==e)return a.FROM;if("function"==e)return a.FUNCTION;break;case 103:if("get"==e)return a.GET;break;case 105:if("if"==e)return a.IF;if("implements"==e)return a.IMPLEMENTS;if("import"==e)return a.IMPORT;if("in"==e)return a.IN;if("instanceof"==e)return a.INSTANCEOF;if("interface"==e)return a.INTERFACE;if("is"==e)return a.IS;break;case 107:if("keyof"==e)return a.KEYOF;break;case 108:if("let"==e)return a.LET;break;case 109:if("module"==e)return a.MODULE;break;case 110:if("namespace"==e)return a.NAMESPACE;if("new"==e)return a.NEW;if("null"==e)return a.NULL;break;case 111:if("of"==e)return a.OF;break;case 112:if("package"==e)return a.PACKAGE;if("private"==e)return a.PRIVATE;if("protected"==e)return a.PROTECTED;if("public"==e)return a.PUBLIC;break;case 114:if("readonly"==e)return a.READONLY;if("return"==e)return a.RETURN;break;case 115:if("set"==e)return a.SET;if("static"==e)return a.STATIC;if("super"==e)return a.SUPER;if("switch"==e)return a.SWITCH;break;case 116:if("this"==e)return a.THIS;if("throw"==e)return a.THROW;if("true"==e)return a.TRUE;if("try"==e)return a.TRY;if("type"==e)return a.TYPE;if("typeof"==e)return a.TYPEOF;break;case 118:if("var"==e)return a.VAR;if("void"==e)return a.VOID;break;case 119:if("while"==e)return a.WHILE;if("with"==e)return a.WITH;break;case 121:if("yield"==e)return a.YIELD}return a.INVALID}function u(e){switch(e){case a.ABSTRACT:case a.AS:case a.CONSTRUCTOR:case a.DECLARE:case a.DELETE:case a.FROM:case a.FOR:case a.GET:case a.INSTANCEOF:case a.IS:case a.KEYOF:case a.MODULE:case a.NAMESPACE:case a.NULL:case a.READONLY:case a.SET:case a.TYPE:case a.VOID:return!0;default:return!1}}!function(e){e[e.ABSTRACT=0]="ABSTRACT",e[e.AS=1]="AS",e[e.ASYNC=2]="ASYNC",e[e.AWAIT=3]="AWAIT",e[e.BREAK=4]="BREAK",e[e.CASE=5]="CASE",e[e.CATCH=6]="CATCH",e[e.CLASS=7]="CLASS",e[e.CONST=8]="CONST",e[e.CONTINUE=9]="CONTINUE",e[e.CONSTRUCTOR=10]="CONSTRUCTOR",e[e.DEBUGGER=11]="DEBUGGER",e[e.DECLARE=12]="DECLARE",e[e.DEFAULT=13]="DEFAULT",e[e.DELETE=14]="DELETE",e[e.DO=15]="DO",e[e.ELSE=16]="ELSE",e[e.ENUM=17]="ENUM",e[e.EXPORT=18]="EXPORT",e[e.EXTENDS=19]="EXTENDS",e[e.FALSE=20]="FALSE",e[e.FINALLY=21]="FINALLY",e[e.FOR=22]="FOR",e[e.FROM=23]="FROM",e[e.FUNCTION=24]="FUNCTION",e[e.GET=25]="GET",e[e.IF=26]="IF",e[e.IMPLEMENTS=27]="IMPLEMENTS",e[e.IMPORT=28]="IMPORT",e[e.IN=29]="IN",e[e.INSTANCEOF=30]="INSTANCEOF",e[e.INTERFACE=31]="INTERFACE",e[e.IS=32]="IS",e[e.KEYOF=33]="KEYOF",e[e.LET=34]="LET",e[e.MODULE=35]="MODULE",e[e.NAMESPACE=36]="NAMESPACE",e[e.NEW=37]="NEW",e[e.NULL=38]="NULL",e[e.OF=39]="OF",e[e.PACKAGE=40]="PACKAGE",e[e.PRIVATE=41]="PRIVATE",e[e.PROTECTED=42]="PROTECTED",e[e.PUBLIC=43]="PUBLIC",e[e.READONLY=44]="READONLY",e[e.RETURN=45]="RETURN",e[e.SET=46]="SET",e[e.STATIC=47]="STATIC",e[e.SUPER=48]="SUPER",e[e.SWITCH=49]="SWITCH",e[e.THIS=50]="THIS",e[e.THROW=51]="THROW",e[e.TRUE=52]="TRUE",e[e.TRY=53]="TRY",e[e.TYPE=54]="TYPE",e[e.TYPEOF=55]="TYPEOF",e[e.VAR=56]="VAR",e[e.VOID=57]="VOID",e[e.WHILE=58]="WHILE",e[e.WITH=59]="WITH",e[e.YIELD=60]="YIELD",e[e.OPENBRACE=61]="OPENBRACE",e[e.CLOSEBRACE=62]="CLOSEBRACE",e[e.OPENPAREN=63]="OPENPAREN",e[e.CLOSEPAREN=64]="CLOSEPAREN",e[e.OPENBRACKET=65]="OPENBRACKET",e[e.CLOSEBRACKET=66]="CLOSEBRACKET",e[e.DOT=67]="DOT",e[e.DOT_DOT_DOT=68]="DOT_DOT_DOT",e[e.SEMICOLON=69]="SEMICOLON",e[e.COMMA=70]="COMMA",e[e.LESSTHAN=71]="LESSTHAN",e[e.GREATERTHAN=72]="GREATERTHAN",e[e.LESSTHAN_EQUALS=73]="LESSTHAN_EQUALS",e[e.GREATERTHAN_EQUALS=74]="GREATERTHAN_EQUALS",e[e.EQUALS_EQUALS=75]="EQUALS_EQUALS",e[e.EXCLAMATION_EQUALS=76]="EXCLAMATION_EQUALS",e[e.EQUALS_EQUALS_EQUALS=77]="EQUALS_EQUALS_EQUALS",e[e.EXCLAMATION_EQUALS_EQUALS=78]="EXCLAMATION_EQUALS_EQUALS",e[e.EQUALS_GREATERTHAN=79]="EQUALS_GREATERTHAN",e[e.PLUS=80]="PLUS",e[e.MINUS=81]="MINUS",e[e.ASTERISK_ASTERISK=82]="ASTERISK_ASTERISK",e[e.ASTERISK=83]="ASTERISK",e[e.SLASH=84]="SLASH",e[e.PERCENT=85]="PERCENT",e[e.PLUS_PLUS=86]="PLUS_PLUS",e[e.MINUS_MINUS=87]="MINUS_MINUS",e[e.LESSTHAN_LESSTHAN=88]="LESSTHAN_LESSTHAN",e[e.GREATERTHAN_GREATERTHAN=89]="GREATERTHAN_GREATERTHAN",e[e.GREATERTHAN_GREATERTHAN_GREATERTHAN=90]="GREATERTHAN_GREATERTHAN_GREATERTHAN",e[e.AMPERSAND=91]="AMPERSAND",e[e.BAR=92]="BAR",e[e.CARET=93]="CARET",e[e.EXCLAMATION=94]="EXCLAMATION",e[e.TILDE=95]="TILDE",e[e.AMPERSAND_AMPERSAND=96]="AMPERSAND_AMPERSAND",e[e.BAR_BAR=97]="BAR_BAR",e[e.QUESTION=98]="QUESTION",e[e.COLON=99]="COLON",e[e.EQUALS=100]="EQUALS",e[e.PLUS_EQUALS=101]="PLUS_EQUALS",e[e.MINUS_EQUALS=102]="MINUS_EQUALS",e[e.ASTERISK_EQUALS=103]="ASTERISK_EQUALS",e[e.ASTERISK_ASTERISK_EQUALS=104]="ASTERISK_ASTERISK_EQUALS",e[e.SLASH_EQUALS=105]="SLASH_EQUALS",e[e.PERCENT_EQUALS=106]="PERCENT_EQUALS",e[e.LESSTHAN_LESSTHAN_EQUALS=107]="LESSTHAN_LESSTHAN_EQUALS",e[e.GREATERTHAN_GREATERTHAN_EQUALS=108]="GREATERTHAN_GREATERTHAN_EQUALS",e[e.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS=109]="GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS",e[e.AMPERSAND_EQUALS=110]="AMPERSAND_EQUALS",e[e.BAR_EQUALS=111]="BAR_EQUALS",e[e.CARET_EQUALS=112]="CARET_EQUALS",e[e.AT=113]="AT",e[e.IDENTIFIER=114]="IDENTIFIER",e[e.STRINGLITERAL=115]="STRINGLITERAL",e[e.INTEGERLITERAL=116]="INTEGERLITERAL",e[e.FLOATLITERAL=117]="FLOATLITERAL",e[e.TEMPLATELITERAL=118]="TEMPLATELITERAL",e[e.INVALID=119]="INVALID",e[e.ENDOFFILE=120]="ENDOFFILE"}(a=t.Token||(t.Token={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.PREFER=1]="PREFER",e[e.ALWAYS=2]="ALWAYS"}(o=t.IdentifierHandling||(t.IdentifierHandling={})),t.tokenFromKeyword=l,t.tokenIsAlsoIdentifier=u,t.isIllegalVariableIdentifier=function(e){switch(assert(e.length),e.charCodeAt(0)){case 100:return"delete"==e;case 102:return"for"==e;case 105:return"instanceof"==e;case 110:return"null"==e;case 118:return"void"==e}return!1},t.operatorTokenToString=function(e){switch(e){case a.DELETE:return"delete";case a.IN:return"in";case a.INSTANCEOF:return"instanceof";case a.NEW:return"new";case a.TYPEOF:return"typeof";case a.VOID:return"void";case a.YIELD:return"yield";case a.DOT_DOT_DOT:return"...";case a.COMMA:return",";case a.LESSTHAN:return"<";case a.GREATERTHAN:return">";case a.LESSTHAN_EQUALS:return"<=";case a.GREATERTHAN_EQUALS:return">=";case a.EQUALS_EQUALS:return"==";case a.EXCLAMATION_EQUALS:return"!=";case a.EQUALS_EQUALS_EQUALS:return"===";case a.EXCLAMATION_EQUALS_EQUALS:return"!==";case a.PLUS:return"+";case a.MINUS:return"-";case a.ASTERISK_ASTERISK:return"**";case a.ASTERISK:return"*";case a.SLASH:return"/";case a.PERCENT:return"%";case a.PLUS_PLUS:return"++";case a.MINUS_MINUS:return"--";case a.LESSTHAN_LESSTHAN:return"<<";case a.GREATERTHAN_GREATERTHAN:return">>";case a.GREATERTHAN_GREATERTHAN_GREATERTHAN:return">>>";case a.AMPERSAND:return"&";case a.BAR:return"|";case a.CARET:return"^";case a.EXCLAMATION:return"!";case a.TILDE:return"~";case a.AMPERSAND_AMPERSAND:return"&&";case a.BAR_BAR:return"||";case a.EQUALS:return"=";case a.PLUS_EQUALS:return"+=";case a.MINUS_EQUALS:return"-=";case a.ASTERISK_EQUALS:return"*=";case a.ASTERISK_ASTERISK_EQUALS:return"**=";case a.SLASH_EQUALS:return"/=";case a.PERCENT_EQUALS:return"%=";case a.LESSTHAN_LESSTHAN_EQUALS:return"<<=";case a.GREATERTHAN_GREATERTHAN_EQUALS:return">>=";case a.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:return">>>=";case a.AMPERSAND_EQUALS:return"&=";case a.BAR_EQUALS:return"|=";case a.CARET_EQUALS:return"^=";default:return assert(!1),""}};class c{constructor(e,t){this.debugInfoRef=0,this.start=e,this.end=t}static join(e,t){if(e.source!=t.source)throw new Error("source mismatch");let r=new c(e.start<t.start?e.start:t.start,e.end>t.end?e.end:t.end);return r.source=e.source,r}equals(e){return this.source==e.source&&this.start==e.start&&this.end==e.end}get atStart(){let e=new c(this.start,this.start);return e.source=this.source,e}get atEnd(){let e=new c(this.end,this.end);return e.source=this.source,e}toString(){return this.source.text.substring(this.start,this.end)}}t.Range=c;class p extends i.DiagnosticEmitter{constructor(e,t=null){super(t),this.end=0,this.pos=0,this.token=-1,this.tokenPos=0,this.nextToken=-1,this.nextTokenPos=0,this.nextTokenOnNewLine=!1,this.onComment=null,this.readingTemplateString=!1,this.readStringStart=0,this.readStringEnd=0,t||(t=[]),this.diagnostics=t,this.source=e;var r=e.text,i=r.length,n=0;if(n<i&&65279==r.charCodeAt(n)&&++n,n+1<i&&35==r.charCodeAt(n)&&33==r.charCodeAt(n+1))for(n+=2;n<i&&10!=r.charCodeAt(n);)++n;this.pos=n,this.end=i}next(e=o.DEFAULT){var t;this.nextToken=-1;do{t=this.unsafeNext(e)}while(t==a.INVALID);return this.token=t,t}unsafeNext(e=o.DEFAULT,t=i32.MAX_VALUE){for(var r=this.source.text,c=this.end,p=this.pos;p<c;){this.tokenPos=p;let _=r.charCodeAt(p);switch(_){case 13:if(!(++p<c&&10==r.charCodeAt(p)))break;case 10:case 9:case 11:case 12:case 32:++p;break;case 33:return++p,t>1&&p<c&&61==r.charCodeAt(p)?(++p,t>2&&p<c&&61==r.charCodeAt(p)?(this.pos=p+1,a.EXCLAMATION_EQUALS_EQUALS):(this.pos=p,a.EXCLAMATION_EQUALS)):(this.pos=p,a.EXCLAMATION);case 34:case 39:return this.pos=p,a.STRINGLITERAL;case 96:return this.pos=p,a.TEMPLATELITERAL;case 37:return++p,t>1&&p<c&&61==r.charCodeAt(p)?(this.pos=p+1,a.PERCENT_EQUALS):(this.pos=p,a.PERCENT);case 38:if(++p,t>1&&p<c){let e=r.charCodeAt(p);if(38==e)return this.pos=p+1,a.AMPERSAND_AMPERSAND;if(61==e)return this.pos=p+1,a.AMPERSAND_EQUALS}return this.pos=p,a.AMPERSAND;case 40:return this.pos=p+1,a.OPENPAREN;case 41:return this.pos=p+1,a.CLOSEPAREN;case 42:if(++p,t>1&&p<c){let e=r.charCodeAt(p);if(61==e)return this.pos=p+1,a.ASTERISK_EQUALS;if(42==e)return++p,t>2&&p<c&&61==r.charCodeAt(p)?(this.pos=p+1,a.ASTERISK_ASTERISK_EQUALS):(this.pos=p,a.ASTERISK_ASTERISK)}return this.pos=p,a.ASTERISK;case 43:if(++p,t>1&&p<c){let e=r.charCodeAt(p);if(43==e)return this.pos=p+1,a.PLUS_PLUS;if(61==e)return this.pos=p+1,a.PLUS_EQUALS}return this.pos=p,a.PLUS;case 44:return this.pos=p+1,a.COMMA;case 45:if(++p,t>1&&p<c){let e=r.charCodeAt(p);if(45==e)return this.pos=p+1,a.MINUS_MINUS;if(61==e)return this.pos=p+1,a.MINUS_EQUALS}return this.pos=p,a.MINUS;case 46:if(++p,t>1&&p<c){let e=r.charCodeAt(p);if(s.isDecimalDigit(e))return this.pos=p-1,a.FLOATLITERAL;if(t>2&&p+1<c&&46==e&&46==r.charCodeAt(p+1))return this.pos=p+2,a.DOT_DOT_DOT}return this.pos=p,a.DOT;case 47:{let e=p;if(++p,t>1&&p<c){let t=r.charCodeAt(p);if(47==t){let t=n.CommentKind.LINE;for(p+1<c&&47==r.charCodeAt(p+1)&&(++p,t=n.CommentKind.TRIPLE);++p<c;)if(10==r.charCodeAt(p)){++p;break}this.onComment&&this.onComment(t,r.substring(e,p),this.range(e,p));break}if(42==t){let t=!1;for(;++p<c;)if(_=r.charCodeAt(p),42==_&&p+1<c&&47==r.charCodeAt(p+1)){p+=2,t=!0;break}t?this.onComment&&this.onComment(n.CommentKind.BLOCK,r.substring(e,p),this.range(e,p)):this.error(i.DiagnosticCode._0_expected,this.range(p),"*/");break}if(61==t)return this.pos=p+1,a.SLASH_EQUALS}return this.pos=p,a.SLASH}case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.pos=p,this.testInteger()?a.INTEGERLITERAL:a.FLOATLITERAL;case 58:return this.pos=p+1,a.COLON;case 59:return this.pos=p+1,a.SEMICOLON;case 60:if(++p,t>1&&p<c){let e=r.charCodeAt(p);if(60==e)return++p,t>2&&p<c&&61==r.charCodeAt(p)?(this.pos=p+1,a.LESSTHAN_LESSTHAN_EQUALS):(this.pos=p,a.LESSTHAN_LESSTHAN);if(61==e)return this.pos=p+1,a.LESSTHAN_EQUALS}return this.pos=p,a.LESSTHAN;case 61:if(++p,t>1&&p<c){let e=r.charCodeAt(p);if(61==e)return++p,t>2&&p<c&&61==r.charCodeAt(p)?(this.pos=p+1,a.EQUALS_EQUALS_EQUALS):(this.pos=p,a.EQUALS_EQUALS);if(62==e)return this.pos=p+1,a.EQUALS_GREATERTHAN}return this.pos=p,a.EQUALS;case 62:if(++p,t>1&&p<c){let e=r.charCodeAt(p);if(62==e){if(++p,t>2&&p<c){if(e=r.charCodeAt(p),62==e)return++p,t>3&&p<c&&61==r.charCodeAt(p)?(this.pos=p+1,a.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS):(this.pos=p,a.GREATERTHAN_GREATERTHAN_GREATERTHAN);if(61==e)return this.pos=p+1,a.GREATERTHAN_GREATERTHAN_EQUALS}return this.pos=p,a.GREATERTHAN_GREATERTHAN}if(61==e)return this.pos=p+1,a.GREATERTHAN_EQUALS}return this.pos=p,a.GREATERTHAN;case 63:return this.pos=p+1,a.QUESTION;case 91:return this.pos=p+1,a.OPENBRACKET;case 93:return this.pos=p+1,a.CLOSEBRACKET;case 94:return++p,t>1&&p<c&&61==r.charCodeAt(p)?(this.pos=p+1,a.CARET_EQUALS):(this.pos=p,a.CARET);case 123:return this.pos=p+1,a.OPENBRACE;case 124:if(++p,t>1&&p<c){let e=r.charCodeAt(p);if(124==e)return this.pos=p+1,a.BAR_BAR;if(61==e)return this.pos=p+1,a.BAR_EQUALS}return this.pos=p,a.BAR;case 125:return this.pos=p+1,a.CLOSEBRACE;case 126:return this.pos=p+1,a.TILDE;case 64:return this.pos=p+1,a.AT;default:{if(s.isIdentifierStart(_)){let t=p;for(;++p<c&&s.isIdentifierPart(_=r.charCodeAt(p)););if(e!=o.ALWAYS){let i=l(r.substring(t,p));if(i!==a.INVALID&&(e!==o.PREFER||!u(i)))return this.pos=p,i}return this.pos=t,a.IDENTIFIER}if(s.isWhiteSpace(_)){++p;break}let t=p++;return 55296==(64512&_)&&p<c&&56320==(64512&r.charCodeAt(p))&&++p,this.error(i.DiagnosticCode.Invalid_character,this.range(t,p)),this.pos=p,a.INVALID}}}return this.pos=p,a.ENDOFFILE}peek(e=!1,t=o.DEFAULT,r=i32.MAX_VALUE){var i=this.source.text;if(this.nextToken<0){let n,o=this.pos,l=this.token,u=this.tokenPos;do{n=this.unsafeNext(t,r)}while(n==a.INVALID);if(this.nextToken=n,this.nextTokenPos=this.tokenPos,e){this.nextTokenOnNewLine=!1;for(let e=o,t=this.nextTokenPos;e<t;++e)if(s.isLineBreak(i.charCodeAt(e))){this.nextTokenOnNewLine=!0;break}}this.pos=o,this.token=l,this.tokenPos=u}return this.nextToken}skipIdentifier(e=o.PREFER){return this.skip(a.IDENTIFIER,e)}skip(e,t=o.DEFAULT){var r,i=this.pos,n=this.token,s=this.tokenPos,l=i32.MAX_VALUE;e==a.GREATERTHAN&&(l=1);do{r=this.unsafeNext(t,l)}while(r==a.INVALID);return r==e?(this.token=e,this.nextToken=-1,!0):(this.pos=i,this.token=n,this.tokenPos=s,!1)}mark(){var e=h;return e?(h=null,e.pos=this.pos,e.token=this.token,e.tokenPos=this.tokenPos):e=new _(this.pos,this.token,this.tokenPos),e}discard(e){h=e}reset(e){this.pos=e.pos,this.token=e.token,this.tokenPos=e.tokenPos,this.nextToken=-1}range(e=-1,t=-1){e<0?(e=this.tokenPos,t=this.pos):t<0&&(t=e);let r=new c(e,t);return r.source=this.source,r}readIdentifier(){for(var e=this.source.text,t=this.end,r=this.pos,i=r;++r<t&&s.isIdentifierPart(e.charCodeAt(r)););return this.pos=r,e.substring(i,r)}readString(e=0,t=!1){var r=this.source.text,n=this.end,a=this.pos;e||(e=r.charCodeAt(a++));var o=a;this.readStringStart=o;for(var l="";;){if(a>=n){l+=r.substring(o,a),this.error(i.DiagnosticCode.Unterminated_string_literal,this.range(o-1,n)),this.readStringEnd=n;break}let u=r.charCodeAt(a);if(u==e){this.readStringEnd=a,l+=r.substring(o,a++);break}if(92!=u){if(96==e){if(36==u&&a+1<n&&123==r.charCodeAt(a+1))return l+=r.substring(o,a),this.readStringEnd=a,this.pos=a+2,this.readingTemplateString=!0,l}else if(s.isLineBreak(u)){l+=r.substring(o,a),this.error(i.DiagnosticCode.Unterminated_string_literal,this.range(o-1,a)),this.readStringEnd=a;break}++a}else l+=r.substring(o,a),this.pos=a,l+=this.readEscapeSequence(t),o=a=this.pos}return this.pos=a,this.readingTemplateString=!1,l}readEscapeSequence(e=!1){var t=this.pos,r=this.end;if(++this.pos>=r)return this.error(i.DiagnosticCode.Unexpected_end_of_text,this.range(r)),"";var n=this.source.text,a=n.charCodeAt(this.pos++);switch(a){case 48:return e&&this.pos<r&&s.isDecimalDigit(n.charCodeAt(this.pos))?(++this.pos,n.substring(t,this.pos)):"\0";case 98:return"\b";case 116:return"\t";case 110:return"\n";case 118:return"\v";case 102:return"\f";case 114:return"\r";case 39:return"'";case 34:return'"';case 117:return this.pos<r&&123==n.charCodeAt(this.pos)?(++this.pos,this.readExtendedUnicodeEscape(e?t:-1)):this.readUnicodeEscape(e?t:-1);case 120:return this.readHexadecimalEscape(2,e?t:-1);case 13:this.pos<r&&10==n.charCodeAt(this.pos)&&++this.pos;case 10:case 8232:case 8233:return"";default:return String.fromCharCode(a)}}readRegexpPattern(){for(var e=this.source.text,t=this.pos,r=this.end,n=!1;;){if(this.pos>=r){this.error(i.DiagnosticCode.Unterminated_regular_expression_literal,this.range(t,r));break}if(92==e.charCodeAt(this.pos)){++this.pos,n=!0;continue}let a=e.charCodeAt(this.pos);if(!n&&47==a)break;if(s.isLineBreak(a)){this.error(i.DiagnosticCode.Unterminated_regular_expression_literal,this.range(t,this.pos));break}++this.pos,n=!1}return e.substring(t,this.pos)}readRegexpFlags(){for(var e=this.source.text,t=this.pos,r=this.end,n=0;this.pos<r;){let t=e.charCodeAt(this.pos);if(!s.isIdentifierPart(t))break;switch(++this.pos,t){case 103:n|=1&n?-1:1;break;case 105:n|=2&n?-1:2;break;case 109:n|=4&n?-1:4;break;default:n=-1}}return-1==n&&this.error(i.DiagnosticCode.Invalid_regular_expression_flags,this.range(t,this.pos)),e.substring(t,this.pos)}testInteger(){var e=this.source.text,t=this.pos,r=this.end;if(t+1<r&&48==e.charCodeAt(t))switch(32|e.charCodeAt(t+2)){case 120:case 98:case 111:return!0}for(;t<r;){let r=e.charCodeAt(t);if(46==r||101==(32|r))return!1;if(95!=r&&(r<48||r>57))break;t++}return!0}readInteger(){var e=this.source.text,t=this.pos;if(t+2<this.end&&48==e.charCodeAt(t)){switch(32|e.charCodeAt(t+1)){case 120:return this.pos=t+2,this.readHexInteger();case 98:return this.pos=t+2,this.readBinaryInteger();case 111:return this.pos=t+2,this.readOctalInteger()}if(s.isOctalDigit(e.charCodeAt(t+1))){let e=t;this.pos=t+1;let r=this.readOctalInteger();return this.error(i.DiagnosticCode.Octal_literals_are_not_allowed_in_strict_mode,this.range(e,this.pos)),r}}return this.readDecimalInteger()}readHexInteger(){var e=this.source.text;let t=this.pos;for(var r=this.end,n=t,s=n,a=i64_new(0),o=i64_new(4);t<r;){let r=e.charCodeAt(t);if(r>=48&&r<=57)a=i64_add(i64_shl(a,o),i64_new(r-48));else if(r>=65&&r<=70)a=i64_add(i64_shl(a,o),i64_new(10+r-65));else if(r>=97&&r<=102)a=i64_add(i64_shl(a,o),i64_new(10+r-97));else{if(95!=r)break;s==t&&this.error(s==n?i.DiagnosticCode.Numeric_separators_are_not_allowed_here:i.DiagnosticCode.Multiple_consecutive_numeric_separators_are_not_permitted,this.range(t)),s=t+1}++t}return t==n?this.error(i.DiagnosticCode.Hexadecimal_digit_expected,this.range(n)):s==t&&this.error(i.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(s-1)),this.pos=t,a}readDecimalInteger(){for(var e=this.source.text,t=this.pos,r=this.end,n=t,s=n,a=i64_new(0),o=i64_new(10);t<r;){let r=e.charCodeAt(t);if(r>=48&&r<=57)a=i64_add(i64_mul(a,o),i64_new(r-48));else{if(95!=r)break;s==t?this.error(s==n?i.DiagnosticCode.Numeric_separators_are_not_allowed_here:i.DiagnosticCode.Multiple_consecutive_numeric_separators_are_not_permitted,this.range(t)):t-1==n&&48==e.charCodeAt(t-1)&&this.error(i.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(t)),s=t+1}++t}return t==n?this.error(i.DiagnosticCode.Digit_expected,this.range(n)):s==t&&this.error(i.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(s-1)),this.pos=t,a}readOctalInteger(){for(var e=this.source.text,t=this.pos,r=this.end,n=t,s=n,a=i64_new(0),o=i64_new(3);t<r;){let r=e.charCodeAt(t);if(r>=48&&r<=55)a=i64_add(i64_shl(a,o),i64_new(r-48));else{if(95!=r)break;s==t&&this.error(s==n?i.DiagnosticCode.Numeric_separators_are_not_allowed_here:i.DiagnosticCode.Multiple_consecutive_numeric_separators_are_not_permitted,this.range(t)),s=t+1}++t}return t==n?this.error(i.DiagnosticCode.Octal_digit_expected,this.range(n)):s==t&&this.error(i.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(s-1)),this.pos=t,a}readBinaryInteger(){for(var e=this.source.text,t=this.pos,r=this.end,n=t,s=n,a=i64_new(0),o=i64_new(1);t<r;){let r=e.charCodeAt(t);if(48==r)a=i64_shl(a,o);else if(49==r)a=i64_add(i64_shl(a,o),o);else{if(95!=r)break;s==t&&this.error(s==n?i.DiagnosticCode.Numeric_separators_are_not_allowed_here:i.DiagnosticCode.Multiple_consecutive_numeric_separators_are_not_permitted,this.range(t)),s=t+1}++t}return t==n?this.error(i.DiagnosticCode.Binary_digit_expected,this.range(n)):s==t&&this.error(i.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(s-1)),this.pos=t,a}readFloat(){return this.readDecimalFloat()}readDecimalFloat(){var e=this.source.text,t=this.end,r=this.pos,i=this.readDecimalFloatPartial(!1);if(this.pos<t&&46==e.charCodeAt(this.pos)&&(++this.pos,i+=this.readDecimalFloatPartial()),this.pos<t){let r=e.charCodeAt(this.pos);101==(32|r)&&((++this.pos<t&&45==(r=e.charCodeAt(this.pos))||43==r&&s.isDecimalDigit(e.charCodeAt(this.pos+1)))&&++this.pos,i+=this.readDecimalFloatPartial())}let n=e.substring(r,this.pos);return i&&(n=n.replaceAll("_","")),parseFloat(n)}readDecimalFloatPartial(e=!0){for(var t=this.source.text,r=this.pos,n=r,a=this.end,o=n,l=0;r<a;){let a=t.charCodeAt(r);if(95==a)o==r?this.error(o==n?i.DiagnosticCode.Numeric_separators_are_not_allowed_here:i.DiagnosticCode.Multiple_consecutive_numeric_separators_are_not_permitted,this.range(r)):e||r-1!=n||48!=t.charCodeAt(r-1)||this.error(i.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(r)),o=r+1,++l;else if(!s.isDecimalDigit(a))break;++r}return r!=n&&o==r&&this.error(i.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(o-1)),this.pos=r,l}readHexFloat(){throw new Error("not implemented")}readHexadecimalEscape(e=2,t=-1){for(var r=0,n=this.source.text,s=this.pos,a=this.end;s<a;){let a=n.charCodeAt(s++);if(a>=48&&a<=57)r=(r<<4)+a-48;else if(a>=65&&a<=70)r=(r<<4)+a+-55;else{if(!(a>=97&&a<=102))return~t?(this.pos=--s,n.substring(t,s)):(this.pos=s,this.error(i.DiagnosticCode.Hexadecimal_digit_expected,this.range(s-1,s)),"");r=(r<<4)+a+-87}if(0==--e)break}return e?(this.pos=s,~t?n.substring(t,s):(this.error(i.DiagnosticCode.Unexpected_end_of_text,this.range(s)),"")):(this.pos=s,String.fromCharCode(r))}checkForIdentifierStartAfterNumericLiteral(){var e=this.pos;e<this.end&&s.isIdentifierStart(this.source.text.charCodeAt(e))&&this.error(i.DiagnosticCode.An_identifier_or_keyword_cannot_immediately_follow_a_numeric_literal,this.range(e))}readUnicodeEscape(e=-1){return this.readHexadecimalEscape(4,e)}readExtendedUnicodeEscape(e=-1){var t=this.pos,r=this.readHexInteger(),n=i64_low(r),s=!1;assert(!i64_high(r)),n>1114111&&(-1==e&&this.error(i.DiagnosticCode.An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive,this.range(t,this.pos)),s=!0);var a=this.end,o=this.source.text;return this.pos>=a?(-1==e&&this.error(i.DiagnosticCode.Unexpected_end_of_text,this.range(t,a)),s=!0):125==o.charCodeAt(this.pos)?++this.pos:(-1==e&&this.error(i.DiagnosticCode.Unterminated_Unicode_escape_sequence,this.range(t,this.pos)),s=!0),s?~e?o.substring(e,this.pos):"":n<65536?String.fromCharCode(n):String.fromCharCode(n-65536>>>10|55296,n-65536&1023|56320)}}t.Tokenizer=p;class _{constructor(e,t,r){this.pos=e,this.token=t,this.tokenPos=r}}t.State=_;var h=null},699:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Signature=t.typesToString=t.typesToNativeTypes=t.Type=t.TypeFlags=t.TypeKind=void 0;const i=r(974),n=r(656);!function(e){e[e.I8=0]="I8",e[e.I16=1]="I16",e[e.I32=2]="I32",e[e.I64=3]="I64",e[e.ISIZE=4]="ISIZE",e[e.U8=5]="U8",e[e.U16=6]="U16",e[e.U32=7]="U32",e[e.U64=8]="U64",e[e.USIZE=9]="USIZE",e[e.BOOL=10]="BOOL",e[e.F32=11]="F32",e[e.F64=12]="F64",e[e.V128=13]="V128",e[e.FUNCREF=14]="FUNCREF",e[e.EXTERNREF=15]="EXTERNREF",e[e.ANYREF=16]="ANYREF",e[e.EQREF=17]="EQREF",e[e.I31REF=18]="I31REF",e[e.DATAREF=19]="DATAREF",e[e.VOID=20]="VOID"}(t.TypeKind||(t.TypeKind={})),function(e){e[e.NONE=0]="NONE",e[e.SIGNED=1]="SIGNED",e[e.UNSIGNED=2]="UNSIGNED",e[e.INTEGER=4]="INTEGER",e[e.FLOAT=8]="FLOAT",e[e.VARYING=16]="VARYING",e[e.SHORT=32]="SHORT",e[e.LONG=64]="LONG",e[e.VALUE=128]="VALUE",e[e.REFERENCE=256]="REFERENCE",e[e.NULLABLE=512]="NULLABLE",e[e.VECTOR=1024]="VECTOR",e[e.EXTERNAL=2048]="EXTERNAL",e[e.CLASS=4096]="CLASS",e[e.FUNCTION=8192]="FUNCTION"}(t.TypeFlags||(t.TypeFlags={}));class s{constructor(e,t,r){this._nonNullableType=null,this._nullableType=null,this.kind=e,this.flags=t,this.size=r,this.byteSize=ceil(r/8),this.classReference=null,this.signatureReference=null,512&t?this._nullableType=this:this._nonNullableType=this}get intType(){if(this==s.auto)return this;switch(this.kind){case 0:return s.i8;case 1:return s.i16;case 11:case 2:return s.i32;case 12:case 3:return s.i64;case 4:return 64==this.size?s.isize64:s.isize32;case 5:return s.u8;case 6:return s.u16;case 7:return s.u32;case 8:return s.u64;case 9:return 64==this.size?s.usize64:s.usize32;case 10:default:return s.i32}}get exceptVoid(){return 20==this.kind?s.auto:this}get alignLog2(){return 31-clz(this.byteSize)}get isValue(){return this.is(128)}get isIntegerValue(){return this.is(132)}get isShortIntegerValue(){return this.is(164)}get isLongIntegerValue(){return this.is(196)}get isSignedIntegerValue(){return this.is(133)}get isUnsignedIntegerValue(){return this.is(134)}get isVaryingIntegerValue(){return this.is(148)}get isIntegerInclReference(){return this.is(4)}get isFloatValue(){return this.is(136)}get isNumericValue(){return this.isIntegerValue||this.isFloatValue}get isBooleanValue(){return this==s.bool}get isVectorValue(){return this.is(1152)}get isReference(){return this.is(256)}get isNullableReference(){return this.is(768)}get isInternalReference(){return this.is(260)}get isExternalReference(){return this.is(2304)}get isClass(){return!!this.isInternalReference&&null!==this.classReference}getClass(){return this.isInternalReference?this.classReference:null}getClassOrWrapper(e){let t=this.getClass();if(t)return t;{let t=this.getSignature();if(t){let r=t.type,i=assert(e.resolver.resolveClass(e.functionPrototype,[r]));return i.wrappedType=r,i}{let t=e.wrapperClasses;if(t.has(this))return assert(t.get(this))}}return null}get isFunction(){return!!this.isInternalReference&&null!==this.signatureReference}getSignature(){return this.isInternalReference?this.signatureReference:null}get isManaged(){if(this.isInternalReference){let e=this.classReference;return e?!e.hasDecorator(i.DecoratorFlags.UNMANAGED):null!==this.signatureReference}return!1}get isUnmanaged(){var e=this.classReference;return null!==e&&e.hasDecorator(i.DecoratorFlags.UNMANAGED)}get nonNullableType(){return this.isExternalReference?this:assert(this._nonNullableType)}get nullableType(){return this._nullableType}computeSmallIntegerShift(e){return e.size-this.size}computeSmallIntegerMask(e){var t=this.is(2)?this.size:this.size-1;return-1>>>e.size-t}is(e){return(this.flags&e)==e}isAny(e){return 0!=(this.flags&e)}asNullable(){assert(this.isInternalReference);var e=this._nullableType;return e||(assert(!this.isNullableReference),this._nullableType=e=new s(this.kind,512|this.flags,this.size),e.classReference=this.classReference,e.signatureReference=this.signatureReference,e._nonNullableType=this),e}equals(e){return this.kind==e.kind&&(!this.isReference||this.classReference==e.classReference&&this.signatureReference==e.signatureReference&&this.isNullableReference==e.isNullableReference)}isAssignableTo(e,t=!1){var r,i,n,s;if(this.isReference){if(e.isReference&&(!this.isNullableReference||e.isNullableReference))if(r=this.getClass()){if(i=e.getClass())return r.isAssignableTo(i)}else if(n=this.getSignature()){if(s=e.getSignature())return n.isAssignableTo(s)}else if(this.isExternalReference&&(this.kind==e.kind||16==e.kind&&15!=this.kind))return!0}else if(!e.isReference)if(this.isIntegerValue)if(e.isIntegerValue){if(!t||this.isBooleanValue||this.isSignedIntegerValue==e.isSignedIntegerValue)return this.size<=e.size}else{if(11==e.kind)return this.size<=23;if(12==e.kind)return this.size<=52}else if(this.isFloatValue){if(e.isFloatValue)return this.size<=e.size}else if(this.isVectorValue&&e.isVectorValue)return this.size==e.size;return!1}isStrictlyAssignableTo(e,t=!1){return this.isReference?this.isAssignableTo(e):!e.isReference&&(this.isIntegerValue?e.isIntegerValue&&e.size==this.size&&(!t||this.isSignedIntegerValue==e.isSignedIntegerValue):this.kind==e.kind)}isChangeableTo(e){if(this.is(4)&&e.is(4)){let t=this.size;return t==e.size&&(t>=32||this.is(1)==e.is(1))}return this.kind==e.kind}static commonDenominator(e,t,r){return t.isAssignableTo(e,r)?e:e.isAssignableTo(t,r)?t:null}toString(e=!1){const t=e?"|null":" | null";if(this.isReference){let r=this.getClass();if(r)return this.isNullableReference?r.internalName+t:r.internalName;{let r=this.getSignature();if(r)return this.isNullableReference?"("+r.toString(e)+")"+t:r.toString(e)}}switch(this.kind){case 0:return"i8";case 1:return"i16";case 2:return"i32";case 3:return"i64";case 4:return"isize";case 5:return"u8";case 6:return"u16";case 7:return"u32";case 8:return"u64";case 9:return"usize";case 10:return"bool";case 11:return"f32";case 12:return"f64";case 13:return"v128";case 14:return"funcref";case 15:return"externref";case 16:return"anyref";case 17:return"eqref";case 18:return"i31ref";case 19:return"dataref";default:assert(!1);case 20:return"void"}}toNativeType(){switch(this.kind){default:assert(!1);case 0:case 1:case 2:case 5:case 6:case 7:case 10:return n.NativeType.I32;case 4:case 9:if(64!=this.size)return n.NativeType.I32;case 3:case 8:return n.NativeType.I64;case 11:return n.NativeType.F32;case 12:return n.NativeType.F64;case 13:return n.NativeType.V128;case 14:return n.NativeType.Funcref;case 15:return n.NativeType.Externref;case 16:return n.NativeType.Anyref;case 17:return n.NativeType.Eqref;case 18:return n.NativeType.I31ref;case 19:return n.NativeType.Dataref;case 20:return n.NativeType.None}}}function a(e){var t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=e[i].toNativeType();return r}t.Type=s,s.i8=new s(0,165,8),s.i16=new s(1,165,16),s.i32=new s(2,133,32),s.i64=new s(3,197,64),s.isize32=new s(4,149,32),s.isize64=new s(4,213,64),s.u8=new s(5,166,8),s.u16=new s(6,166,16),s.u32=new s(7,134,32),s.u64=new s(8,198,64),s.usize32=new s(9,150,32),s.usize64=new s(9,214,64),s.bool=new s(10,166,1),s.f32=new s(11,137,32),s.f64=new s(12,201,64),s.v128=new s(13,1152,128),s.funcref=new s(14,2816,0),s.externref=new s(15,2816,0),s.anyref=new s(16,2816,0),s.eqref=new s(17,2816,0),s.i31ref=new s(18,2304,0),s.dataref=new s(19,2816,0),s.void=new s(20,0,0),s.auto=new s(s.i32.kind,s.i32.flags,s.i32.size),t.typesToNativeTypes=a,t.typesToString=function(e){var t=e.length;if(!t)return"";var r=new Array(t);for(let i=0;i<t;++i)r[i]=e[i].toString(!0);return r.join(",")};class o{constructor(e,t=null,r=null,i=null){this.id=0,this.parameterTypes=t||[],this.requiredParameters=0,this.returnType=r||s.void,this.thisType=i,this.program=e,this.hasRest=!1;var n=e.options.usizeType,a=new s(n.kind,-129&n.flags|256,n.size);this.type=a,a.signatureReference=this;var o=e.uniqueSignatures,l=o.length;for(let e=0;e<l;e++){let t=o[e];if(this.equals(t))return this.id=t.id,this}this.id=e.nextSignatureId++,e.uniqueSignatures.push(this)}get nativeParams(){var e=this.thisType,t=this.parameterTypes,r=t.length;if(!r)return e?e.toNativeType():n.NativeType.None;if(e){let i=new Array(1+r);i[0]=e.toNativeType();for(let e=0;e<r;++e)i[e+1]=t[e].toNativeType();return n.createType(i)}return n.createType(a(t))}get nativeResults(){return this.returnType.toNativeType()}equals(e){var t=this.thisType,r=e.thisType;if(null!==t){if(null===r||!t.equals(r))return!1}else if(r)return!1;if(this.hasRest!=e.hasRest)return!1;var i=this.parameterTypes,n=e.parameterTypes,s=i.length;if(s!=n.length)return!1;for(let e=0;e<s;++e)if(!i[e].equals(n[e]))return!1;return this.returnType.equals(e.returnType)}isAssignableTo(e,t=!1){var r=this.thisType,i=e.thisType;if(null!==r){if(null===i||!r.isAssignableTo(i))return!1}else if(i)return!1;if(this.hasRest!=e.hasRest)return!1;var n=this.parameterTypes,s=e.parameterTypes,a=n.length;if(a!=s.length)return!1;for(let e=0;e<a;++e){let t=n[e],r=s[e];if(!t.isAssignableTo(r))return!1}var o=this.returnType,l=e.returnType;return o==l||o.isAssignableTo(l)}get hasManagedOperands(){var e=this.thisType;if(e&&e.isManaged)return!0;var t=this.parameterTypes;for(let e=0,r=t.length;e<r;++e)if(t[e].isManaged)return!0;return!1}getManagedOperandIndices(){var e=new Array,t=0,r=this.thisType;r&&(r.isManaged&&e.push(t),++t);var i=this.parameterTypes;for(let r=0,n=i.length;r<n;++r)i[r].isManaged&&e.push(t),++t;return e}toString(e=!1){var t=new Array;t.push(e?"%28":"(");var r=0,i=this.thisType;i&&(t.push(e?"this:":"this: "),assert(!i.signatureReference),t.push(i.toString(e)),r=1);var n=this.parameterTypes,s=n.length;if(s){let i=this.requiredParameters,a=this.hasRest?s-1:-1;for(let o=0;o<s;++o,++r)r&&t.push(e?"%2C":", "),o==a&&t.push("..."),t.push(n[o].toString(e)),o>=i&&o!=a&&t.push("?")}return t.push(e?"%29=>":") => "),t.push(this.returnType.toString(e)),t.join("")}clone(){var e=this.parameterTypes,t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=e[i];return new o(this.program,r,this.returnType,this.thisType)}}t.Signature=o},540:(e,t)=>{"use strict";function r(e,t){return i32(e[t])|i32(e[t+1])<<8|i32(e[t+2])<<16|i32(e[t+3])<<24}function i(e,t,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function n(e,t){var i=r(e,t),n=r(e,t+4);return i64_new(i,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.writeF64=t.readF64=t.writeF32=t.readF32=t.writeI64AsI32=t.writeI64=t.readI64=t.writeI32AsI64=t.writeI32=t.readI32=t.writeI16=t.readI16=t.writeI8=t.readI8=void 0,t.readI8=function(e,t){return e[t]},t.writeI8=function(e,t,r){t[r]=e},t.readI16=function(e,t){return i32(e[t])|i32(e[t+1])<<8},t.writeI16=function(e,t,r){t[r]=e,t[r+1]=e>>>8},t.readI32=r,t.writeI32=i,t.writeI32AsI64=function(e,t,r,n=!1){i(e,t,r),i(n||e>=0?0:-1,t,r+4)},t.readI64=n,t.writeI64=function(e,t,r){i(i64_low(e),t,r),i(i64_high(e),t,r+4)},t.writeI64AsI32=function(e,t,r,n=!1){assert(n?i64_is_u32(e):i64_is_i32(e)),i(i64_low(e),t,r)},t.readF32=function(e,t){return i32_as_f32(r(e,t))},t.writeF32=function(e,t,r){i(f32_as_i32(e),t,r)},t.readF64=function(e,t){return i64_as_f64(n(e,t))},t.writeF64=function(e,t,r){var n=f64_as_i64(e);i(i64_low(n),t,r),i(i64_high(n),t,r+4)}},189:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueMap=void 0,t.uniqueMap=function(e=null,t=null){var r=new Map;if(e)for(let t=Map_keys(e),i=0,n=t.length;i<n;++i){let n=unchecked(t[i]),s=assert(e.get(n));r.set(n,s)}if(t)for(let e=Map_keys(t),i=0,n=e.length;i<n;++i){let n=unchecked(e[i]),s=assert(t.get(n));r.set(n,s)}return r}},910:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(540),t),n(r(189),t),n(r(96),t),n(r(841),t),n(r(95),t),n(r(311),t),n(r(560),t)},96:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPowerOf2=void 0,t.isPowerOf2=function(e){return 0!=e&&0==(e&e-1)}},841:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dirname=t.resolvePath=t.normalizePath=void 0;const i=r(200),n=47;function s(e){for(var t,r=0,i=e.length;r+1<i&&46==e.charCodeAt(r)&&e.charCodeAt(r+1)==n;)r+=2;for((r>0||i<e.length)&&(e=e.substring(r,i),i-=r,r=0);r+1<i;){if(t=!1,e.charCodeAt(r)==n&&46==e.charCodeAt(r+1)){if((t=r+2==i)||r+2<i&&e.charCodeAt(r+2)==n){e=t?e.substring(0,r):e.substring(0,r)+e.substring(r+2),i-=2;continue}if((t=r+3==i)&&46==e.charCodeAt(r+2)||r+3<i&&46==e.charCodeAt(r+2)&&e.charCodeAt(r+3)==n){let s=r;for(;--s>=0;)if(e.charCodeAt(s)==n){r-s==3&&46==e.charCodeAt(s+1)&&46==e.charCodeAt(s+2)||(e=t?e.substring(0,s):e.substring(0,s)+e.substring(r+3),i-=r+3-s,r=s-1);break}if(s<0&&r>0&&(2!=r||46!=e.charCodeAt(0)||46!=e.charCodeAt(1))){i=(e=e.substring(r+4)).length;continue}}}r++}return i>0?e:"."}function a(e){var t=e.length;if(t<=1){if(0==t)return".";if(e.charCodeAt(0)==n)return e}for(;--t>0;)if(e.charCodeAt(t)==n)return e.substring(0,t);return"."}t.normalizePath=s,t.resolvePath=function(e,t){return e.startsWith("std/")?e:s(a(t)+i.PATH_DELIMITER+e)},t.dirname=a},95:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.colorize=t.setColorsEnabled=t.isColorsEnabled=t.COLOR_RESET=t.COLOR_WHITE=t.COLOR_CYAN=t.COLOR_MAGENTA=t.COLOR_BLUE=t.COLOR_YELLOW=t.COLOR_GREEN=t.COLOR_RED=t.COLOR_GRAY=void 0,t.COLOR_GRAY="[90m",t.COLOR_RED="[91m",t.COLOR_GREEN="[92m",t.COLOR_YELLOW="[93m",t.COLOR_BLUE="[94m",t.COLOR_MAGENTA="[95m",t.COLOR_CYAN="[96m",t.COLOR_WHITE="[97m",t.COLOR_RESET="[0m";var r=!0;t.isColorsEnabled=function(){return r},t.setColorsEnabled=function(e){return r=e,e},t.colorize=function(e,i){return r?i+e+t.COLOR_RESET:e}},311:(e,t)=>{"use strict";function r(e){return e>=48&&e<=57}Object.defineProperty(t,"__esModule",{value:!0}),t.indent=t.isIdentifierPart=t.isIdentifierStart=t.isTrivialAlphanum=t.isHexDigit=t.isOctalDigit=t.isDecimalDigit=t.isWhiteSpace=t.isLineBreak=t.CharCode=void 0,function(e){e[e.NULL=0]="NULL",e[e.LINEFEED=10]="LINEFEED",e[e.CARRIAGERETURN=13]="CARRIAGERETURN",e[e.LINESEPARATOR=8232]="LINESEPARATOR",e[e.PARAGRAPHSEPARATOR=8233]="PARAGRAPHSEPARATOR",e[e.NEXTLINE=133]="NEXTLINE",e[e.SPACE=32]="SPACE",e[e.NONBREAKINGSPACE=160]="NONBREAKINGSPACE",e[e.ENQUAD=8192]="ENQUAD",e[e.EMQUAD=8193]="EMQUAD",e[e.ENSPACE=8194]="ENSPACE",e[e.EMSPACE=8195]="EMSPACE",e[e.THREEPEREMSPACE=8196]="THREEPEREMSPACE",e[e.FOURPEREMSPACE=8197]="FOURPEREMSPACE",e[e.SIXPEREMSPACE=8198]="SIXPEREMSPACE",e[e.FIGURESPACE=8199]="FIGURESPACE",e[e.PUNCTUATIONSPACE=8200]="PUNCTUATIONSPACE",e[e.THINSPACE=8201]="THINSPACE",e[e.HAIRSPACE=8202]="HAIRSPACE",e[e.ZEROWIDTHSPACE=8203]="ZEROWIDTHSPACE",e[e.NARROWNOBREAKSPACE=8239]="NARROWNOBREAKSPACE",e[e.IDEOGRAPHICSPACE=12288]="IDEOGRAPHICSPACE",e[e.MATHEMATICALSPACE=8287]="MATHEMATICALSPACE",e[e.OGHAM=5760]="OGHAM",e[e._=95]="_",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.AMPERSAND=38]="AMPERSAND",e[e.ASTERISK=42]="ASTERISK",e[e.AT=64]="AT",e[e.BACKSLASH=92]="BACKSLASH",e[e.BACKTICK=96]="BACKTICK",e[e.BAR=124]="BAR",e[e.CARET=94]="CARET",e[e.CLOSEBRACE=125]="CLOSEBRACE",e[e.CLOSEBRACKET=93]="CLOSEBRACKET",e[e.CLOSEPAREN=41]="CLOSEPAREN",e[e.COLON=58]="COLON",e[e.COMMA=44]="COMMA",e[e.DOLLAR=36]="DOLLAR",e[e.DOT=46]="DOT",e[e.DOUBLEQUOTE=34]="DOUBLEQUOTE",e[e.EQUALS=61]="EQUALS",e[e.EXCLAMATION=33]="EXCLAMATION",e[e.GREATERTHAN=62]="GREATERTHAN",e[e.HASH=35]="HASH",e[e.LESSTHAN=60]="LESSTHAN",e[e.MINUS=45]="MINUS",e[e.OPENBRACE=123]="OPENBRACE",e[e.OPENBRACKET=91]="OPENBRACKET",e[e.OPENPAREN=40]="OPENPAREN",e[e.PERCENT=37]="PERCENT",e[e.PLUS=43]="PLUS",e[e.QUESTION=63]="QUESTION",e[e.SEMICOLON=59]="SEMICOLON",e[e.SINGLEQUOTE=39]="SINGLEQUOTE",e[e.SLASH=47]="SLASH",e[e.TILDE=126]="TILDE",e[e.BACKSPACE=8]="BACKSPACE",e[e.FORMFEED=12]="FORMFEED",e[e.BYTEORDERMARK=65279]="BYTEORDERMARK",e[e.TAB=9]="TAB",e[e.VERTICALTAB=11]="VERTICALTAB"}(t.CharCode||(t.CharCode={})),t.isLineBreak=function(e){switch(e){case 10:case 13:case 8232:case 8233:return!0;default:return!1}},t.isWhiteSpace=function(e){switch(e){case 32:case 9:case 11:case 12:case 160:case 133:case 5760:case 8239:case 8287:case 12288:case 65279:return!0;default:return e>=8192&&e<=8203}},t.isDecimalDigit=r,t.isOctalDigit=function(e){return e>=48&&e<=55},t.isHexDigit=function(e){return r(e)||(32|e)>=97&&(32|e)<=102},t.isTrivialAlphanum=function(e){return e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=57},t.isIdentifierStart=function(e){let t=32|e;return t>=97&&t<=122||95==e||36==e||e>127&&(!((r=e)<170||r>65500)&&s(r,i));var r},t.isIdentifierPart=function(e){const t=32|e;return t>=97&&t<=122||e>=48&&e<=57||95==e||36==e||e>127&&(!((r=e)<170||r>65500)&&s(r,n));var r};const i=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2208,2208,2210,2220,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3807,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7098,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7413,7414,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11506,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43744,43754,43762,43764,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],n=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,768,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1155,1159,1162,1319,1329,1366,1369,1369,1377,1415,1425,1469,1471,1471,1473,1474,1476,1477,1479,1479,1488,1514,1520,1522,1552,1562,1568,1641,1646,1747,1749,1756,1759,1768,1770,1788,1791,1791,1808,1866,1869,1969,1984,2037,2042,2042,2048,2093,2112,2139,2208,2208,2210,2220,2276,2302,2304,2403,2406,2415,2417,2423,2425,2431,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2500,2503,2504,2507,2510,2519,2519,2524,2525,2527,2531,2534,2545,2561,2563,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2641,2641,2649,2652,2654,2654,2662,2677,2689,2691,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2787,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2876,2884,2887,2888,2891,2893,2902,2903,2908,2909,2911,2915,2918,2927,2929,2929,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3006,3010,3014,3016,3018,3021,3024,3024,3031,3031,3046,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3140,3142,3144,3146,3149,3157,3158,3160,3161,3168,3171,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3260,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3299,3302,3311,3313,3314,3330,3331,3333,3340,3342,3344,3346,3386,3389,3396,3398,3400,3402,3406,3415,3415,3424,3427,3430,3439,3450,3455,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3807,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3948,3953,3972,3974,3991,3993,4028,4038,4038,4096,4169,4176,4253,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4957,4959,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5908,5920,5940,5952,5971,5984,5996,5998,6e3,6002,6003,6016,6099,6103,6103,6108,6109,6112,6121,6155,6157,6160,6169,6176,6263,6272,6314,6320,6389,6400,6428,6432,6443,6448,6459,6470,6509,6512,6516,6528,6571,6576,6601,6608,6617,6656,6683,6688,6750,6752,6780,6783,6793,6800,6809,6823,6823,6912,6987,6992,7001,7019,7027,7040,7155,7168,7223,7232,7241,7245,7293,7376,7378,7380,7414,7424,7654,7676,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8204,8205,8255,8256,8276,8276,8305,8305,8319,8319,8336,8348,8400,8412,8417,8417,8421,8432,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11647,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11744,11775,11823,11823,12293,12295,12321,12335,12337,12341,12344,12348,12353,12438,12441,12442,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42539,42560,42607,42612,42621,42623,42647,42655,42737,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43047,43072,43123,43136,43204,43216,43225,43232,43255,43259,43259,43264,43309,43312,43347,43360,43388,43392,43456,43471,43481,43520,43574,43584,43597,43600,43609,43616,43638,43642,43643,43648,43714,43739,43741,43744,43759,43762,43766,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44010,44012,44013,44016,44025,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65024,65039,65056,65062,65075,65076,65101,65103,65136,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500];function s(e,t){if(e<t[0])return!1;for(var r,i,n=0,s=t.length;n+1<s;){if(r=n+(s-n>>1),(i=t[r-=1&r])<=e&&e<=t[r+1])return!0;e<i?s=r:n=r+2}return!1}t.indent=function(e,t){for(;t>=4;)e.push("        "),t-=4;t>=2&&(e.push("    "),t-=2),t&&e.push("  ")}},560:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.v128_zero=void 0,t.v128_zero=new Uint8Array(16)},466:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureToString=t.Feature=void 0,function(e){e[e.NONE=0]="NONE",e[e.SIGN_EXTENSION=1]="SIGN_EXTENSION",e[e.MUTABLE_GLOBALS=2]="MUTABLE_GLOBALS",e[e.NONTRAPPING_F2I=4]="NONTRAPPING_F2I",e[e.BULK_MEMORY=8]="BULK_MEMORY",e[e.SIMD=16]="SIMD",e[e.THREADS=32]="THREADS",e[e.EXCEPTION_HANDLING=64]="EXCEPTION_HANDLING",e[e.TAIL_CALLS=128]="TAIL_CALLS",e[e.REFERENCE_TYPES=256]="REFERENCE_TYPES",e[e.MULTI_VALUE=512]="MULTI_VALUE",e[e.GC=1024]="GC",e[e.MEMORY64=2048]="MEMORY64"}(t.Feature||(t.Feature={})),t.featureToString=function(e){switch(e){case 1:return"sign-extension";case 2:return"mutable-globals";case 4:return"nontrapping-f2i";case 8:return"bulk-memory";case 16:return"simd";case 32:return"threads";case 64:return"exception-handling";case 128:return"tail-calls";case 256:return"reference-types";case 512:return"multi-value";case 1024:return"gc";case 2048:return"memory64"}return assert(!1),""}},607:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Target=void 0,function(e){e[e.JS=0]="JS",e[e.WASM32=1]="WASM32",e[e.WASM64=2]="WASM64"}(t.Target||(t.Target={}))},604:function(e,t){"use strict";var r=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.TypeinfoFlags=t.Typeinfo=void 0;let i=class{constructor(){this.flags=0,this.base=0}};i=r([unmanaged],i),t.Typeinfo=i,function(e){e[e.NONE=0]="NONE",e[e.ARRAYBUFFERVIEW=1]="ARRAYBUFFERVIEW",e[e.ARRAY=2]="ARRAY",e[e.STATICARRAY=4]="STATICARRAY",e[e.SET=8]="SET",e[e.MAP=16]="MAP",e[e.POINTERFREE=32]="POINTERFREE",e[e.VALUE_ALIGN_0=64]="VALUE_ALIGN_0",e[e.VALUE_ALIGN_1=128]="VALUE_ALIGN_1",e[e.VALUE_ALIGN_2=256]="VALUE_ALIGN_2",e[e.VALUE_ALIGN_3=512]="VALUE_ALIGN_3",e[e.VALUE_ALIGN_4=1024]="VALUE_ALIGN_4",e[e.VALUE_SIGNED=2048]="VALUE_SIGNED",e[e.VALUE_FLOAT=4096]="VALUE_FLOAT",e[e.VALUE_NULLABLE=8192]="VALUE_NULLABLE",e[e.VALUE_MANAGED=16384]="VALUE_MANAGED",e[e.KEY_ALIGN_0=32768]="KEY_ALIGN_0",e[e.KEY_ALIGN_1=65536]="KEY_ALIGN_1",e[e.KEY_ALIGN_2=131072]="KEY_ALIGN_2",e[e.KEY_ALIGN_3=262144]="KEY_ALIGN_3",e[e.KEY_ALIGN_4=524288]="KEY_ALIGN_4",e[e.KEY_SIGNED=1048576]="KEY_SIGNED",e[e.KEY_FLOAT=2097152]="KEY_FLOAT",e[e.KEY_NULLABLE=4194304]="KEY_NULLABLE",e[e.KEY_MANAGED=8388608]="KEY_MANAGED"}(t.TypeinfoFlags||(t.TypeinfoFlags={}))},292:(e,t,r)=>{const i=r.g.binaryen||(r.g.binaryen=r(911));e.exports=i;const{Module:n}=r(656);n.prototype.toText=function(e=!0){return e?i.wrapModule(this.ref).emitStackIR(!0):i.wrapModule(this.ref).emitText()},n.prototype.toAsmjs=function(){return i.wrapModule(this.ref).emitAsmjs()}},710:(e,t,r)=>{r.g.Map_keys=function(e){return Array.from(e.keys())},r.g.Map_values=function(e){return Array.from(e.values())},r.g.Set_values=function(e){return Array.from(e.values())}},620:(e,t,r)=>{const i=new Float64Array(1),n=new Float32Array(i.buffer),s=new Int32Array(i.buffer);r.g.f32_as_i32=function(e){return n[0]=e,s[0]},r.g.i32_as_f32=function(e){return s[0]=e,n[0]},r.g.f64_as_i64=function(e){return i[0]=e,i64_new(s[0],s[1])},r.g.i64_as_f64=function(e){return s[0]=i64_low(e),s[1]=i64_high(e),i[0]}},875:(e,t,r)=>{const i=r.g.Long||r(720);r.g.i64_zero=i.ZERO,r.g.i64_one=i.ONE,r.g.i64_neg_one=i.fromInt(-1),r.g.i64_is=function(e){return i.isLong(e)},r.g.i64_new=function(e,t){return i.fromBits(e,t)},r.g.i64_low=function(e){return e.low},r.g.i64_high=function(e){return e.high},r.g.i64_add=function(e,t){return e.add(t)},r.g.i64_sub=function(e,t){return e.sub(t)},r.g.i64_mul=function(e,t){return e.mul(t)},r.g.i64_pow=function(e,t){var n=t.low,s=t.high;if(s<=0){if(s<0)return e.eq(r.g.i64_neg_one)?1&n?e:i.ONE:e.eq(i.ONE)?e:i.ZERO;if(0==n)return i.ONE;if(1==n)return e;if(2==n)return e.mul(e)}for(var a=i.ONE;n|s;)1&n&&(a=a.mul(e)),t=t.shru(1),e=e.mul(e),n=t.low,s=t.high;return a},r.g.i64_div=function(e,t){return e.div(t)},r.g.i64_div_u=function(e,t){return e.toUnsigned().div(t.toUnsigned()).toSigned()},r.g.i64_rem=function(e,t){return e.mod(t)},r.g.i64_rem_u=function(e,t){return e.toUnsigned().mod(t.toUnsigned()).toSigned()},r.g.i64_and=function(e,t){return e.and(t)},r.g.i64_or=function(e,t){return e.or(t)},r.g.i64_xor=function(e,t){return e.xor(t)},r.g.i64_shl=function(e,t){return e.shl(t)},r.g.i64_shr=function(e,t){return e.shr(t)},r.g.i64_shr_u=function(e,t){return e.shru(t)},r.g.i64_not=function(e){return e.not()},r.g.i64_eq=function(e,t){return e.eq(t)},r.g.i64_ne=function(e,t){return e.ne(t)},r.g.i64_gt=function(e,t){return e.gt(t)},r.g.i64_align=function(e,t){assert(t&&0==(t&t-1));var r=i.fromInt(t-1);return e.add(r).and(r.not())},r.g.i64_is_i8=function(e){return 0===e.high&&e.low>=0&&e.low<=i8.MAX_VALUE||-1===e.high&&e.low>=i8.MIN_VALUE&&e.low<0},r.g.i64_is_i16=function(e){return 0===e.high&&e.low>=0&&e.low<=i16.MAX_VALUE||-1===e.high&&e.low>=i16.MIN_VALUE&&e.low<0},r.g.i64_is_i32=function(e){return 0===e.high&&e.low>=0||-1===e.high&&e.low<0},r.g.i64_is_u8=function(e){return 0===e.high&&e.low>>>0<=u8.MAX_VALUE},r.g.i64_is_u16=function(e){return 0===e.high&&e.low>>>0<=u16.MAX_VALUE},r.g.i64_is_u32=function(e){return 0===e.high},r.g.i64_is_bool=function(e){return 0==(e.high|-2&e.low)};const n=i.fromNumber(f32.MIN_SAFE_INTEGER),s=i.fromNumber(f32.MAX_SAFE_INTEGER);r.g.i64_is_f32=function(e){return e.gte(n)&&e.lte(s)};const a=i.fromNumber(f64.MIN_SAFE_INTEGER),o=i.fromNumber(f64.MAX_SAFE_INTEGER);r.g.i64_is_f64=function(e){return e.gte(a)&&e.lte(o)},r.g.i64_to_f32=function(e){return r.g.Math.fround(e.toNumber())},r.g.i64_to_f64=function(e){return e.toNumber()},r.g.i64_to_string=function(e,t){return t?e.toUnsigned().toString():e.toString()}},352:(e,t,r)=>{var i="undefined"!=typeof window&&window||void 0!==r.g&&r.g||self;i.ASC_TARGET=0,i.ASC_NO_ASSERT=!1,i.ASC_MEMORY_BASE=0,i.ASC_OPTIMIZE_LEVEL=3,i.ASC_SHRINK_LEVEL=0,i.ASC_FEATURE_MUTABLE_GLOBAL=!1,i.ASC_FEATURE_SIGN_EXTENSION=!1,i.ASC_FEATURE_BULK_MEMORY=!1,i.ASC_FEATURE_SIMD=!1,i.ASC_FEATURE_THREADS=!1;var n=new Float64Array(1),s=new Uint32Array(n.buffer);function a(){Error.captureStackTrace?Error.captureStackTrace(this,a):this.stack=this.name+": "+this.message+"\n"+(new Error).stack}function o(e){this.message=e||"assertion failed",Error.captureStackTrace?Error.captureStackTrace(this,o):this.stack=this.name+": "+this.message+"\n"+(new Error).stack}function l(e,t){if(e===t){if(0!==e)return 0;e=1/e,t=1/t}else{var r=e!=e,i=t!=t;if(r|i)return r-i;null==e&&(e=String(e)),null==t&&(t=String(t))}return e>t?1:-1}Object.defineProperties(i.i8=function(e){return e<<24>>24},{MIN_VALUE:{value:-128,writable:!1},MAX_VALUE:{value:127,writable:!1}}),Object.defineProperties(i.i16=function(e){return e<<16>>16},{MIN_VALUE:{value:-32768,writable:!1},MAX_VALUE:{value:32767,writable:!1}}),Object.defineProperties(i.i32=i.isize=function(e){return 0|e},{MIN_VALUE:{value:-2147483648,writable:!1},MAX_VALUE:{value:2147483647,writable:!1}}),Object.defineProperties(i.u8=function(e){return 255&e},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:255,writable:!1}}),Object.defineProperties(i.u16=function(e){return 65535&e},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:65535,writable:!1}}),Object.defineProperties(i.u32=i.usize=function(e){return e>>>0},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:4294967295,writable:!1}}),Object.defineProperties(i.bool=function(e){return!!e},{MIN_VALUE:{value:!1,writable:!1},MAX_VALUE:{value:!0,writable:!1}}),Object.defineProperties(i.f32=function(e){return Math.fround(e)},{EPSILON:{value:1.1920928955078125e-7,writable:!1},MIN_VALUE:{value:1401298464324817e-60,writable:!1},MAX_VALUE:{value:34028234663852886e22,writable:!1},MIN_NORMAL_VALUE:{value:11754943508222875e-54,writable:!1},MIN_SAFE_INTEGER:{value:-16777215,writable:!1},MAX_SAFE_INTEGER:{value:16777215,writable:!1},POSITIVE_INFINITY:{value:1/0,writable:!1},NEGATIVE_INFINITY:{value:-1/0,writable:!1},NaN:{value:NaN,writable:!1}}),Object.defineProperties(i.f64=function(e){return+e},{EPSILON:{value:2220446049250313e-31,writable:!1},MIN_VALUE:{value:5e-324,writable:!1},MAX_VALUE:{value:17976931348623157e292,writable:!1},MIN_NORMAL_VALUE:{value:22250738585072014e-324,writable:!1},MIN_SAFE_INTEGER:{value:-9007199254740991,writable:!1},MAX_SAFE_INTEGER:{value:9007199254740991,writable:!1},POSITIVE_INFINITY:{value:1/0,writable:!1},NEGATIVE_INFINITY:{value:-1/0,writable:!1},NaN:{value:NaN,writable:!1}}),i.clz=Math.clz32,i.ctz=function(e){var t=Math.clz32(e&-e);return e?31-t:t},i.popcnt=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},i.rotl=function(e,t){return e<<(t&=31)|e>>>32-t},i.rotr=function(e,t){return e>>>(t&=31)|e<<32-t},i.abs=Math.abs,i.max=Math.max,i.min=Math.min,i.ceil=Math.ceil,i.floor=Math.floor,i.nearest=function(e){return.5===Math.abs(e-Math.trunc(e))?2*Math.round(.5*e):Math.round(e)},i.select=function(e,t,r){return r?e:t},i.sqrt=Math.sqrt,i.trunc=Math.trunc,i.copysign=function(e,t){return Math.abs(e)*Math.sign(t)},i.bswap=function(e){var t=e>>8&16711935,r=(16711935&e)<<8;return(t=(e=t|r)>>16&65535)|(r=(65535&e)<<16)},i.bswap16=function(e){return e<<8&65280|e>>8&255|4294901760&e},a.prototype=Object.create(Error.prototype),a.prototype.name="UnreachableError",a.prototype.message="unreachable",i.unreachable=function(){throw new a},o.prototype=Object.create(Error.prototype),o.prototype.name="AssertionError",i.assert=function(e,t){if(e)return e;throw new o(t)},i.changetype=function(e){return e},String.fromCharCodes=function(e){const t=8192,r=e.length;if(r<=t)return String.fromCharCode.apply(String,e);let i=0,n="";for(;i<r;)n+=String.fromCharCode.apply(String,e.slice(i,Math.min(i+t,r))),i+=t;return n},String.fromCodePoints=function(e){const t=8192,r=e.length;if(r<=t)return String.fromCodePoint.apply(String,e);let i=0,n="";for(;i<r;)n+=String.fromCodePoint.apply(String,e.slice(i,Math.min(i+t,r))),i+=t;return n},String.prototype.at||Object.defineProperty(String.prototype,"at",{value:function(e){return this.charAt(e>=0?e:e+this.length)},configurable:!0}),String.prototype.replaceAll||Object.defineProperty(String.prototype,"replaceAll",{value:function(e,t){var r=this.split(e).join(t);return e.length||(r=t+r+t),r},configurable:!0});const u=Array.prototype.sort;Array.prototype.sort=function(e){return u.call(this,e||l)},[Array,Uint8ClampedArray,Uint8Array,Int8Array,Uint16Array,Int16Array,Uint32Array,Int32Array,Float32Array,Float64Array].forEach((e=>{e.prototype.at||Object.defineProperty(e.prototype,"at",{value:function(e){return this[e>=0?e:e+this.length]},configurable:!0})})),i.isInteger=Number.isInteger,i.isFloat=function(e){return"number"==typeof e},i.isNullable=function(e){return!0},i.isReference=function(e){return"object"==typeof e||"string"==typeof e},i.isFunction=function(e){return"function"==typeof e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isArray=Array.isArray,i.isArrayLike=function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&Math.trunc(e.length)===e.length},i.isDefined=function(e){return void 0!==e},i.isConstant=function(e){return!1},i.unchecked=function(e){return e},i.fmod=function(e,t){return e%t},i.fmodf=function(e,t){return Math.fround(e%t)},i.JSMath=Math,Object.defineProperties(i.JSMath,{sincos_sin:{value:0,writable:!0},sincos_cos:{value:0,writable:!0},signbit:{value:function(e){return n[0]=e,Boolean(s[1]>>>31)}},sincos:{value:function(e){this.sincos_sin=Math.sin(e),this.sincos_cos=Math.cos(e)}},exp2:{value:function(e){return Math.pow(2,e)}}}),i.unmanaged=function(){},i.trace=function(e,t){t&&(e+=Array.prototype.slice.call(arguments,2,2+t)),console.error("trace: "+e)},Object.defineProperty(Int8Array,"wrap",{value:function(e,t,r){return new Int8Array(e,t,r)}}),Object.defineProperty(Uint8Array,"wrap",{value:function(e,t,r){return new Uint8Array(e,t,r)}}),Object.defineProperty(Uint8ClampedArray,"wrap",{value:function(e,t,r){return new Uint8ClampedArray(e,t,r)}}),Object.defineProperty(Int16Array,"wrap",{value:function(e,t,r){return new Int16Array(e,t,r)}}),Object.defineProperty(Uint16Array,"wrap",{value:function(e,t,r){return new Uint16Array(e,t,r)}}),Object.defineProperty(Int32Array,"wrap",{value:function(e,t,r){return new Int32Array(e,t,r)}}),Object.defineProperty(Uint32Array,"wrap",{value:function(e,t,r){return new Uint32Array(e,t,r)}}),Object.defineProperty(Float32Array,"wrap",{value:function(e,t,r){return new Float32Array(e,t,r)}}),Object.defineProperty(Float64Array,"wrap",{value:function(e,t,r){return new Float64Array(e,t,r)}})},911:t=>{"use strict";t.exports=e}},r={};function i(e){if(r[e])return r[e].exports;var n=r[e]={exports:{}};return t[e].call(n.exports,n,n.exports,i),n.exports}return i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i(308),i(780)})()}));
//# sourceMappingURL=assemblyscript.js.map